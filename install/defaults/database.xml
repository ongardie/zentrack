<database>
 <version>3.0.0a</version>

 <abstractTables>
    <table name="ABSTRACT_DESCRIPTORS">
        <column name="name" type="string" ftype="text" label="Name">
	  <size>50</size>
	  <description>The name or title of the entry</description>
	</column>
	<column name="description" type="string" ftype="text" label="Description"/>      
	<column name="last_update" type="date" ftype="hidden">
	  <default>NOW</default>
	</column>
	<column name="syslock" type="byte" ftype="hidden">
	  <default>0</default>
	  <description>If set to 1, field is locked(restricted access)</description>
	</column>
    </table>

    <table name="ABSTRACT_DATA_TYPE">
      <description>Includes common fields for data types to be used as objects</description>
      <inherit>ABSTRACT_DESCRIPTORS</inherit>
      <columns>
	<column name="priority" type="shortint" ftype="text" label="Priority">
	  <description>The order this item will appear in, highest appears at top, items of same priority are sorted alphabetically</description>
        </column>
	<column name="isactive" type="byte" ftype="checkbox" label="Active">
	  <default>1</default>
	  <description>Controls whether this item is actively used... items cannot be deleted, but they can be deactivated by unchecking this box</description>
	</column>
      </columns>
    </table>

    <table name="ABSTRACT_FILTER_TYPE">
      <columns>
	<column name="table_name" type="value" ftype="hidden"/>
	<column name="field_name" type="value" ftype="select">
	  <criteria type="helper">field:table_name</criteria>
	</column>
	<column name="andor" type="byte" ftype="select" label="Grouping">
	  <criteria type="standard">grouping</criteria>
	</column>
	<column name="field_comp" type="value" ftype="select" label="Operator">
	  <criteria type="standard">comparison</criteria>
	</column>
	<column name="field_value" type="string" ftype="text" label="Value"/>
      </columns>
    </table>

    <table name="ABSTRACT_INDEX_BASE">
      <description>Includes common index fields for associations</description>
      <columns>
        <column name="user_id" type="integer" ftype="searchbox">
	  <reference>user.user_id</reference>
	</column>
        <column name="bin_id" type="integer" ftype="selection">
	  <reference>bin.bin_id</reference>
	</column>
      </columns>
    </table>

    <table name="ABSTRACT_INDEX_LIST">
      <description>Includes the common primary keys</description>
      <inherit>ABSTRACT_INDEX_BASE</inherit>
      <columns>
        <column name="ticket_id" type="integer" ftype="searchbox">
	  <reference>ticket.ticket_id</reference>
	</column>
      </columns>
    </table>
 </abstractTables>

 <tables>
    <table name="ACCESS">
      <description>Access Priviledges</description>
      <columns>
        <column name="access_id" type="primarykey" ftype="hidden"/>
	<column name="bin_id" type="integer" ftype="selection">
	  <reference>bin.bin_id</reference>
	</column>
	<column name="role_id" type="integer" ftype="selection">
	  <reference>role.role_id</reference>
	</column>
	<column name="action_id" type="integer" ftype="selection">
	  <reference>action.action_id</reference>
	</column>
	<column name="yesorno" type="byte" ftype="checkbox" label="Active">
	  <default>1</default>
	</column>
      </columns>
      <indexList>
        <index name="access_ba">bin_id,action_id</index>
	<index name="access_bra">bin_id,role_id,action_id</index>
      </indexList>
    </table>

    <table name="ACTION">
      <description>Actions and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="action_id" type="primarykey" ftype="hidden"/>
	<column name="action_type" type="value" ftype="selection" label="Action Type">
	  <criteria type="list">Normal,Script,URL</criteria>
	  <default>Normal</default>
	</column>
	<column name="helper" type="value" ftype="text" label="Action Helper"/>
	<column name="is_button" type="byte" ftype="checkbox"/>
	<column name="icon_name" type="value" ftype="text" label="Icon">
	  <description>Leave blank to disable icon</description>
	</column>
	<column name="owner_reqs" type="byte" ftype="select" label="Assigned To">
	  <description>The requirements for ownership of ticket vs this action</description>
	  <criteria type="list">
	     [0]None
	     [1]Owner
	     [2]Not owner
	     [3]Unowned
	     [4]Owned
	     [5]Owner or unowned
	   </criteria>
	</column>
	<column name="stage_reqs" type="string" ftype="checklist" label="Stage">
	  <description>The required stage of the ticket to perform this action</description>
	  <criteria type="zenlist">stages</criteria>
	</column>
	<column name="bin_reqs" type="string" ftype="checklist" label="Bin">
	  <description>Set this action to only be active in certain bins (blank=all)</description>
	  <criteria type="zenlist">bins</criteria>
	</column>
      </columns>
      <indexList>
        <index name="act_get">action_id,isactive</index>
	<index name="act_sort">name,priority</index>
	<index name="act_check">owner_reqs,stage_reqs,bin_reqs</index>
      </indexList>
    </table>

    <table name="ACTION_PARAMS">
      <description>Action parameters to be passed for each action</description>
      <columns>
        <column name="action_params_id" type="primary_key" ftype="hidden"/>
	<column name="param_number" type="shortint" ftype="text" label="Order"/>
	<column name="param_type" type="value" ftype="select" label="Parameter Type">
	  <!-- the selections for special value may require a definition in the value field -->
	  <criteria type="list">
	      Action ID
	      Action Name
	      Trigger ID
	      Environment Variable
	      Ticket Field
	      User Field
	      Login Field
	      Timestamp
	      Date
	      Text
	  </criteria>
	  <description>
	     This Field defines what sort of parameter will be used, the value of which will usually be found in the Value field.  Note that the correct object type must be available to make this work.  I.e. you have to be on a page with a user_id to access user fields, or a page with a ticket_id to access ticket fields.

	     Action ID: the id of the action occuring
	     Action Name: the name of the action occuring
	     Trigger ID: the trigger causing the action, if applicable
	     Environment Variable: an apache environment setting (HTTP_REFERRER, USER_AGENT, etc)
	     Ticket Field: provide a column from the TICKET table (ticket_id,bin_id,owner_id,etc)
	     User Field: provide a field from the USER table (user_id,fname,lname,etc)
	     Login Field: refers to currently logged in user (login_id, login_role, login_name, login_inits)
	     Timestamp: provides a unix timestamp representing right now (no value needed)
	     Date: provides a date representing right now, the value should be a strftime() format
	     Text: pass whatever is typed in the Value field	     
	   </description>
	</column>
	<column name="param_value" type="string" ftype="text" label="Value"/>
      </columns>
      <indexList>
         <index name="act_prms_ordr">param_number</index>
      </indexList>
    </table>

    <table name="ATTACHMENT">
      <description>References attachments (physically stored in includes/cache/attachments)</description>
      <inherit>ABSTRACT_DESCRIPTORS</inherit>
      <columns>
        <column name="attachment_id" type="primarykey" ftype="immutable"/>
	<column name="ticket_id" type="integer" ftype="immutable" label="Ticket ID">
	  <reference>ticket.ticket_id</reference>
	</column>
	<column name="log_id" type="integer" ftype="immutable" label="Log Entry">
	  <reference>log.log_id</reference>
	</column>
	<column name="file_name" type="value" ftype="immutable" label="File Name"/>
	<column name="file_type" type="value" ftype="immutable" label="File Type"/>
      </columns>
      <indexList>
        <index name="attchmt_ordr">name</index>
      </indexList>
    </table>

    <table name="BIN">
      <description>Bins and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="bin_id" type="primarykey" ftype="immutable" label="Bin ID"/>
      </columns>
      <indexList>
        <index name="bin_ordr">priority,name</index>
	<index name="bin_actv">isactive</index>
      </indexList>
    </table>
    
    <table name="FIELD_DEFS">
      <description>The information about tables and their fields</description>
      <columns>
	<column name="col_unique" type="byte" ftype="hidden"/>
	<column name="col_ftype" type="value" ftype="hidden"/>
	<column name="col_notnull" type="byte" ftype="hidden"/>
	<column name="col_default" type="string" ftype="immutable"/>
	<column name="col_reference" type="string" ftype="hidden">
	  <size>50</size>
	</column>
        <column name="col_crit_type" type="value" ftype="hidden"/>
	<column name="col_criteria" type="text" ftype="hidden"/>	
        <column name="table_name" type="value" ftype="immutable" label="Table"/>
	<column name="col_name" type="value" ftype="immutable" label="Name">
	  <description>The actual name of the column in the database</description>
	</column>
	<column name="col_type" type="value" ftype="immutable" label="Type"/>
	<!-- if this is a custom field, the status will be 1-visible or 2-hidden
	     regular fields have a status of 0-permanent -->
	<column name="col_status" type="byte" ftype="select" label="Visible">
	  <criteria type="helper">field:col_name</criteria>
	</column>
	<column name="col_size" type="integer" ftype="immutable" label="Length"/>
	<column name="col_updated" type="date" ftype="immutable" label="Last Upated"/>
	<column name="col_order" type="smallint" ftype="text" label="Order"/>
	<column name="col_label" type="value" ftype="text" label="Label">
	  <description>The name displayed for this column to users</description>
	</column>
	<column name="col_description" type="string" ftype="text" label="Description"/>	
      </columns>
      <indexList>
        <index name="fldefs_tblname">table_name</index>
	<index name="fldefs_col">col_name</index>
	<index name="fldefs_sort">table_name,col_name</index>
      </indexList>
    </table>

    <table name="FILTER">
      <description>Filter properties and info</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="filter_id" type="primarykey" ftype="hidden"/>
      </columns>
    </table>

    <table name="FILTER_FIELDS">
      <description>Fields and values that are used by filter for searching</description>
      <inherit>ABSTRACT_FILTER_TYPE</inherit>
      <columns>
        <column name="filter_id" type="integer" ftype="hidden">
	  <reference>filter.filter_id</reference>
	</column>
      </columns>      
    </table>

    <table name="FILTER_INDEX">
      <description>Index for determining access to the filters</description>
      <inherit>ABSTRACT_INDEX_BASE</inherit>
      <columns>
        <column name="filter_index_id" type="primarykey" ftype="hidden"/>
      </columns>
    </table>

    <table name="LOG">
      <description>Store log entries</description>
      <inherit>ABSTRACT_INDEX_LIST</inherit>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="log_id" type="primarykey" ftype="hidden"/>
	<column name="ticket_id" type="integer">
	  <reference>ticket.ticket_id</reference>
	</column>
	<column name="task_id" type="integer" ftype="select">
	  <reference>task.task_id</reference>
	</column>
	<column name="ctime" type="date" ftype="hidden"/>
	<column name="hours" type="decimal" ftype="text" label="Hours Worked">
	  <description>Hours associated with this log entry, decimals are acceptable here</description>
	</column>
	<column name="entry" type="text" ftype="textarea" label="Details"/>	  
      </columns>
      <customList>
	<column name="action_id" type="integer">
	  <default>{action_id}</default>
	  <reference>action.action_id</reference>
	</column>
        <column name="user_inits" type="string" ftype="hidden">
	  <description>Initials of person who created entry</description>
	  <default>{login_inits}</default>
	  <size>5</size>
	</column>
      </customList>
      <indexList>
        <index name="log_sort">ctime</index>
	<index name="log_get">ticket_id</index>
      </indexList>
    </table>

    <table name="NOTIFY">
      <description>Store notify lists</description>
      <columns>
        <column name="notify_id" type="primarykey" ftype="hidden"/>
	<column name="bin_id" type="integer" ftype="hidden">
	  <reference>bin.bin_id</reference>
	</column>
	<column name="ticket_id" type="integer" ftype="hidden">
	  <reference>ticket.ticket_id</reference>
	</column>
	<column name="user_id" type="integer" ftype="searchbox" label="User ID">
	  <reference>user.user_id</reference>
	</column>
	<column name="name" type="string" ftype="text" label="Name">
	  <size>50</size>
	</column>
	<column name="email" type="email" ftype="text" label="Email"/>
	<column name="priority" type="byte" ftype="select" label="Notify Volume">
	  <criteria type="list">[1]Low,[2]Medium,[3]High</criteria>
	  <default>3</default>
	</column>
      </columns>
    </table>

    <table name="PREFS">
      <description>User Preferences</description>
      <columns>
	<column name="user_id" type="integer" ftype="hidden">
	  <default>{login_id}</default>
	  <reference>user.user_id</reference>
	</column>
	<column name="pref_name" type="value" ftype="hidden"/>
	<column name="pref_value" type="string" ftype="hidden"/>
      </columns>
    </table>

    <table name="PRIORITY">
      <description>Priorities and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
	<column name="priority_id" type="primary_key" ftype="hidden"/>
	<column name="colorpick" type="value" ftype="colorbox">
	  <description>The color provided here will be used to highlight tickets in the list view, leaving this blank will use the default background color</description>
	</column>
      </columns>
    </table>
    
    <table name="REPORT">
      <description>Report template properties</description>
      <columns>
        <column name="report_id" type="primarykey" ftype="hidden"/>
	<column name="report_type" type="byte" ftype="select">
	  <criteria type="list">[0]Text,[1]Image,[2]Both</criteria>
	  <default>1</default>
	</column>
	<column name="name" type="string" ftype="text" label="Report Name">
	  <size>50</size>
	  <notnull>true</notnull>
	  <description>The name of this report template</description>
	</column>
	<column name="description" type="string" ftype="text" label="Description"/>
	<column name="rep_title" type="string" ftype="text" label="Chart Title">
	  <size>50</size>
	</column>
	<column name="rep_subtitle" type="string" ftype="text" label="Chart Subtitle">
	  <size>100</size>
	</column>
	<column name="filter_id" type="integer" ftype="select" label="Filter Name">
	  <criteria type="helper">{login_id},{login_bins}</criteria>
	  <reference>filter.filter_id</reference>
	</column>
	<column name="date_start" type="date" ftype="datebox" label="Start Date">
	  <description>Leave blank to create a floating range (i.e. from the current date)</description>
	</column>
	<column name="date_range" type="value" ftype="select" label="Range">
	  <criteria type="standard">timeset</criteria>
	  <default>Weeks</default>
	  <description>Range to graph</description>
	</column>
	<column name="date_span" type="smallint" ftype="text" label="Span">
	  <description>The number of divisions to show, more than 10 will be merged</description>
	  <default>8</default>
	</column>
      </columns>
      <indexList>
        <index name="report_sort">name</index>
      </indexList>
    </table>

    <table name="REPORT_FIELDS">
      <description>Data fields to be displayed on report</description>
      <columns>
        <column name="report_id" type="integer" ftype="hidden">
	  <reference>report.report_id</reference>
	</column>
	<column name="table_name" type="value" ftype="hidden"/>
	<column name="field_name" type="value" ftype="select" label="Field Name">
	  <criteria type="helper">field:table_name</criteria>
	</column>
	<column name="disp_method" type="value" ftype="radio" label="Calculate">
	  <criteria type="list">Average,Count,Sum</criteria>
	  <default>Total</default>
	</column>	
      </columns>
    </table>

    <table name="REPORT_INDEX">
      <description>Control who views each report template</description>
      <inherit>ABSTRACT_INDEX_BASE</inherit>
      <columns>
        <column name="report_id" type="integer" ftype="hidden"/>
      </columns>
      <indexList>
        <index name="repind_find">bin_id,user_id</index>
      </indexList>
    </table>

    <table name="ROLE">
      <description>User roles and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="role_id" type="primarykey" ftype="hidden"/>
      </columns>
      <indexList>
        <index name="role_sort">priority,name</index>
        <index name="role_get">role_id,isactive</index>
      </indexList>
    </table>

    <table name="SETTING">
      <description>System settings</description>
      <inherit>ABSTRACT_DESCRIPTORS</inherit>
      <columns>
        <column name="setting_id" type="primary_key" ftype="hidden"/>
	<column name="set_category" type="value" ftype="immutable" label="Category"/>
	<column name="field_type" type="value" ftype="hidden"/>
	<column name="field_criteria" type="string" ftype="hidden"/>
	<column name="set_name" type="value" ftype="immutable" label="Name"/>
	<column name="set_value" type="string" ftype="setting" label="Value">
	  <criteria type="helper">field:field_type,field:field_criteria</criteria>
	</column>	
      </columns>
      <indexList>
        <index name="setting_cat">category</index>
	<index name="setting_name">name</index>
	<index name="setting_sort">category,name</index>
      </indexList>
    </table>

    <!-- stages are the successor of ticket status (open,closed,pending) -->
    <table name="STAGE">
      <description>Stages of ticket progress</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="stage_id" type="primarykey" ftype="hidden"/>	
      </columns>
      <indexList>
        <index name="stage_sort">priority,name</index>
        <index name="stage_get">stage_id,isactive</index>
      </indexList>
    </table>

    <table name="SYSTEM">
      <description>Systems and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="system_id" type="primary_key" ftype="hidden"/>
      </columns>
      <indexList>
        <index name="sys_sort">priority,name</index>
        <index name="sys_get">system_id,isactive</index>
      </indexList>
    </table>

    <!-- meta data from the database construction -->
    <table name="TABLE_DEFS">
      <description>Meta data describing how tables are structures</description>
      <columns>
        <column name="tbl_name" type="value" ftype="immutable" label="Name"/>
	<column name="tbl_inherits" type="string" ftype="immutable" label="Inherited From"/>
	<column name="tbl_version" type="value" ftype="immutable" label="Version"/>
	<column name="tbl_updated" type="date" ftype="immutable" label="Last Update"/>
      </columns>
      <indexList>
        <index name="tbldef_name">tbl_name</index>
	<index name="tbldef_find">tbl_name,tbl_updated</index>
      </indexList>
    </table>

    <!-- tasks are types of log entries -->
    <table name="TASK">
      <description>Log entry types</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="task_id" type="primarykey" ftype="hidden"/>
      </columns>
      <indexList>
        <index name="task_sort">priority,name</index>
	<index name="task_get">task_id,isactive</index>
      </indexList>
    </table>

    <table name="TICKET">
      <description>Ticket entries and their properties</description>
      <inherit>ABSTRACT_DESCRIPTORS</inherit>
      <columns>
        <column name="ticket_id" type="primarykey" ftype="immutable" label="Ticket ID"/>
	<column name="otime" type="date" ftype="immutable" label="Opened"/>
	<column name="ctime" type="date" ftype="immutable" label="Closed"/>
	<column name="stage_id" type="integer" ftype="immutable" label="Status">
	  <reference>stage.stage_id</reference>
	</column>
	<column name="priority_id" type="integer" ftype="select" label="Priority">
	  <criteria type="helper">{login_id},{type_id}</criteria>
	  <default>0</default>
	  <reference>priority.priority_id</reference>
	</column>
	<column name="bin_id" type="integer" ftype="select">
	  <criteria type="zenlist">bins</criteria>
	  <reference>bin.bin_id</reference>
	</column>
	<column name="type_id" type="integer" ftype="select">
	  <criteria type="zenlist">types</criteria>
	  <reference>type.type_id</reference>
	</column>
	<column name="system_id" type="integer" ftype="select">
	  <criteria type="zenlist">systems</criteria>
	  <reference>system.system_id</reference>
	</column>
	<column name="user_id" type="integer" ftype="searchbox">
	  <reference>user.user_id</reference>
	</column>
	<column name="creator_id" type="integer" ftype="immutable">
	  <reference>user.user_id</reference>
	</column>
      </columns>
      <customList>
        <column name="customer" type="string" ftype="text" label="Customer"/>
      </customList>
      <indexList>
        <index name="tckt_usr">user_id</index>
	<index name="tckt_bin">bin_id</index>
	<index name="tckt_name">name</index>
	<index name="tckt_sort1">ticket.name,bin.priority</index>
	<index name="tckt_sort2">ticket.name,priority.priority</index>
	<index name="tckt_sort3">ticket.name,type.priority</index>
	<index name="tckt_sort4">ticket.name,system.priority</index>
	<index name="tckt_sort5">ticket.name,bin.priority,type.priority,system.priority</index>
      </indexList>
    </table>    

    <table name="TRIGGER">
      <description>Trigger mechanisms and properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="trigger_id" type="primarykey" ftype="hidden"/>
      </columns>
      <indexList>
        <column name="trgr_sort">priority,name</column>
      </indexList>
    </table>

    <table name="TRIGGER_ACTIONS">
      <description>Actions trigger activates, and their params</description>
      <columns>
        <column name="trigger_id" type="integer">
	  <reference>trigger.trigger_id</reference>
	</column>
	<column name="action_id" type="integer" ftype="select" label="Action">
  	  <!-- this criteria will probably need to be updated when this is more prepared -->
	  <criteria type="helper">field:trigger_id,field:action_id</criteria>
	  <reference>action.action_id</reference>
	</column>
	<column name="priority" type="smallint" ftype="text" label="Order">
	  <description>Order that actions will take place</description>
	</column>
      </columns>
      <indexList>
        <index name="trgract_sort">priority</index>
      </indexList>
    </table>

    <table name="TRIGGER_FIELDS">
      <description>Fields and values that activate triggers</description>
      <inherit>ABSTRACT_FILTER_TYPE</inherit>
      <columns>
        <column name="trigger_id" type="integer">
	  <reference>trigger.trigger_id</reference>
	</column>
      </columns>
      <indexList>
        <index name="tgrfld_find">table_name,field_name</index>    
      </indexList>
    </table>

    <table name="TYPE">
      <description>Ticket types and their related fields</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="type_id" type="primarykey" ftype="hidden"/>
      </columns>
      <indexList>
        <index name="type_get">type_id,isactive</index>
	<index name="type_sort">priority,name</index>
      </indexList>
    </table>

    <table name="TYPE_STAGES">
      <description>The staging order for this ticket type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
	<column name="stage_id" type="integer" ftype="select" label="Stage">
	  <reference>stage.stage_id</reference>
	  <criteria type="zenlist">stages</criteria>
	</column>
	<column name="priority" type="smallint" ftype="text" label="Order">
	  <description>Lowest to highest</description>
	</column>
      </columns>
      <indexList>
        <index name="typeflw_sort">priority</index>
      </indexList>
    </table>

    <table name="TYPE_FIELDS">
      <description>fields used in this type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
	<column name="field_name" type="value" ftype="select" label="Field">
	  <criteria type="helper">ticket</criteria>
	</column>
	<column name="field_default" type="string" ftype="popselect" label="Default">
	  <criteria type="helper">field:type_id,field:field_name</criteria>
	</column>
      </columns>
    </table>

    <table name="TYPE_BINS">
      <description>Bins used by this type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
        <column name="bin_id" type="integer" ftype="select">
	  <reference>bin.bin_id</reference>
	  <criteria type="zenlist">bins</criteria>
	</column>      
      </columns>
    </table>

    <table name="TYPE_SYSTEMS">
      <description>Systems used by this type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
        <column name="system_id" type="integer" ftype="select">
	  <reference>system.system_id</reference>
	  <criteria type="zenlist">systems</criteria>
	</column>      
      </columns>
    </table>

    <table name="TYPE_PRIORITIES">
      <description>Priorities used by this type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
        <column name="priority_id" type="integer" ftype="select">
	  <reference>priority.priority_id</reference>
	  <criteria type="zenlist">priorities</criteria>
	</column>      
      </columns>
    </table>

    <table name="TYPE_ACTIONS">
      <description>Actions used by this type</description>
      <columns>
        <column name="type_id" type="integer">
	  <reference>type.type_id</reference>
	</column>
        <column name="action_id" type="integer" ftype="select">
	  <reference>action.action_id</reference>
	  <criteria type="zenlist">actions</criteria>
	</column>      
      </columns>
    </table>

    <table name="USER">
      <description>Users and their properties</description>
      <inherit>ABSTRACT_DATA_TYPE</inherit>
      <columns>
        <column name="user_id" type="primarykey" ftype="hidden"/>
	<column name="auth_type" type="byte" ftype="select" label="Auth Type">
	  <criteria type="list">[0]Normal,[1]LDAP,[2]Script</criteria>
	  <default>0</default>
	  <description>Currently this is ignored, but should be implemented soon</description>
	</column>
	<column name="login" value="value" ftype="text">
	  <unique>true</unique>
	  <notnull>true</notnull>
	</column>
	<column name="passphrase" value="value" ftype="skip">
	  <notnull>true</notnull>
	</column>
	<column name="lname" value="string" ftype="text" label="Last Name">
	  <size>40</size>
	</column>
	<column name="fname" value="string" ftype="text" label="First Name">
	  <size>40</size>
	</column>
	<column name="inits" value="string" ftype="text" label="Inits">
	  <size>5</size>
	</column>
	<column name="email" value="string" ftype="email" label="Email"/>
	<column name="homebin" value="integer" ftype="select" label="Home Bin">
	  <reference>bin.bin_id</reference>
	  <criteria type="helper"></criteria>
	  <notnull>true</notnull>
	  <default>0</default>
	</column>
      </columns>
      <customList>
	<column name="notes" value="string" ftype="text" label="Comments"/>
	<column name="phone" value="value" ftype="text" label="Phone"/>	
      </customList>
      <indexList>
        <index name="user_get">user_id,isactive</index>
	<index name="user_sort">lname,fname</index>
	<index name="user_auth">login,passphrase,isactive</index>
      </indexList>
    </table>

    <table name="USER_ROLES">
      <description>Define user roles</description>
      <columns>
        <column name="user_id" type="integer">
	  <reference>user.user_id</reference>
	</column>
	<column name="role_id" type="integer" ftype="select">
	  <criteria type="helper">field:user_id</criteria>
	  <reference>role.role_id</reference>
	</column>
      </columns>
      <indexList>
        <index name="usrrole_uid">user_id</index>
	<index name="usrrole_rid">role_id</index>
      </indexList>
    </table>

 </tables>
</database>
