diff -Naur zentrack_2-5-0-1/includes/ZenFieldMap.class zentrack_2-5-5-1/includes/ZenFieldMap.class
--- zentrack_2-5-0-1/includes/ZenFieldMap.class	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/ZenFieldMap.class	2005-05-08 07:41:02.000000000 -0700
@@ -0,0 +1,786 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+
+// define some constants for field types
+define("ZTFIELD_HIDDEN",0);
+define("ZTFIELD_LABEL",1);
+define("ZTFIELD_TEXT",2);
+define("ZTFIELD_MENU",3);
+define("ZTFIELD_SEARCHBOX",4);
+define("ZTFIELD_CHECKBOX",5);
+define("ZTFIELD_RADIO",6);
+define("ZTFIELD_DATE",7);
+define("ZTFIELD_SECTION",8);
+
+/** 
+ * Returns properties for a view
+ * <ul>
+ *  <li>disabled - (boolean)this view doesn't use field_map yet
+ *  <li>view_only - (boolean)this view does not have input fields, just text
+ *  <li>has_behaviors - (boolean)this view has behaviors
+ *  <li>admin_view - (boolean)this is an admin screen
+ *  <li>multiple - (boolean)this view allows multiple selections (overrides field->multiple)
+ *  <li>sections - (boolean)true if this view can support sections
+ * </ul>
+ *
+ * @param string $view if omitted, all views are returned
+ */
+function getFmViewProps( $view = null ) {
+  if( !$view ) {
+    // return the entire set
+    $set = array();
+    $list = array_keys($GLOBALS['zt_field_dependencies']['views']);
+    foreach($list as $l) {
+      $set[$l] = getFmViewProps($l);
+    }
+    return $set;
+  }
+  // fetch an individual view
+  $vals = $GLOBALS['zt_field_dependencies']['views'][$view];
+  if( !is_array($vals) ) { return false; }
+  $vars = array();
+  $indices = array("disabled", "view_only", "has_behaviors", "admin_view", "multiple", "sections");
+  for($i=0; $i < count($vals); $i++) {
+    $vars[ $indices[$i] ] = $vals[$i];
+  }
+  return $vars;
+}
+
+/**
+ * Returns properties for a field:
+ * <ul>
+ *  <li>searchable - (boolean)can be on search screens
+ *  <li>types - (array)valid field types (takes admin screens into account)
+ *  <li>multiple - (boolean)may have multiple entries (view can override this)
+ *  <li>always_required - (boolean)true if this field is required by system
+ *  <li>default - (boolean)true if this field can use default values
+    <li>data_type - (string) contains 'int', 'string', 'date', 'boolean', or 'float'
+ * </ul>
+ *
+ * @param string $view
+ * @param string $field if omitted, returns all fields formatted for a given view
+ */
+function getFmFieldProps( $view, $field = null ) {
+  $field = ZenFieldMap::fieldName($field);
+  if( !$field ) {
+    // return all fields for a view
+    $set = array();
+    $list = array_keys($GLOBALS['zt_field_dependencies']['fields']);
+    foreach($list as $l) {
+      $set[$l] = getFmFieldProps($view, $l);
+    }
+    return $set;
+  }
+  // return a single field
+  $vprops = getFmViewProps($view);
+  $vals = $GLOBALS['zt_field_dependencies']['fields'][$field];
+  if( !is_array($vals) ) { return false; }
+  $vars = array();
+  // the distance between "types" and "admin_view" is important for
+  // the details listed below
+  $indices = array("searchable", "types", "data_type", "admin_view", "multiple", "always_required", "default");
+  for($i=0; $i < count($indices); $i++) {
+    if( $indices[$i] == 'admin_view' ) { continue; }
+    else if( $indices[$i] == 'types' ) {
+      // convert integers to names
+      $set = array();
+      foreach($vals[$i] as $v) {
+        $set[] = ZenFieldMap::getTypeString($v);
+      }
+      if( $vprops['admin_view'] && $vals[$i+2] ) {
+        foreach($vals[$i+2] as $v) {
+          $set[] = ZenFieldMap::getTypeString($v);
+        }
+      }
+      $vars[ $indices[$i] ] = $set;
+    }
+    else if( $vprops['multiple'] && $indices[$i] == 'multiple' ) {
+      $vars[ $indices[$i] ] = true;
+    }
+    else {
+      $vars[ $indices[$i] ] = $vals[$i];
+    }
+  }
+  return $vars;   
+}
+ 
+/**
+ * Returns properties for a field_type
+ * <ul>
+ *   <li>has_choices - (boolean) true if this field type requires a list of choices
+ *   <li>multiple_rows - (boolean) true if this type allows multiple rows
+ * </ul>
+ *
+ * @param string $type if omitted, returns properties for all types
+ */
+function getFmTypeProps( $type = null ) {
+  if( !$type ) {
+    // return the entire set
+    $set = array();
+    $list = array_keys($GLOBALS['zt_field_dependencies']['types']);
+    foreach($list as $l) {
+      $set[$l] = getFmTypeProps($l);
+    }
+    return $set;    
+  }
+  // return a single type
+  $vals = $GLOBALS['zt_field_dependencies']['types'][$type];
+  if( !is_array($vals) ) { return false; }
+  $vars = array();
+  $indices = array("has_choices", "multiple");
+  for($i=0; $i < count($vals); $i++) {
+    $vars[ $indices[$i] ] = $vals[$i];
+  }
+  return $vars;   
+}
+
+// these can't be edited or the system will break
+// they define system dependancies and possible
+// layouts for various fields
+// this array is used by sorting.php directory (a little cheat)
+$ztf = array(
+  "fields" => array(//       searchable,  types                 , data_type,  admin_view, multiple, always_required, default
+    "id"              => array(   true,   array(1)              , 'int'    ,      null, false,  true,  false),
+    "title"           => array(   true,   array(1,2)            , 'text' ,        null, false,  true,   true),
+    "priority"        => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
+    "status"          => array(   true,   array(1,3,4,6)        , 'string' ,      null, false,  true,  false),
+    "description"     => array(   true,   array(1,2)            , 'text' ,        null, false,  false,  true),
+    "otime"           => array(   true,   array(1)              , 'date'   ,  array(7), false,  true,  false),
+    "ctime"           => array(   true,   array(1)              , 'date'   ,  array(7), false,  false,  false),
+    "bin_id"          => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
+    "type_id"         => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
+    "user_id"         => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  false,  true),
+    "system_id"       => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
+    "creator_id"      => array(  false,   array(1)              , 'int'    ,  array(4), false,  true,  false),
+    "tested"          => array(  false,   array(1,3,5,6)        , 'int'    ,      null, false,  false,  true),
+    "approved"        => array(  false,   array(1,3,5,6)        , 'int'    ,      null, false,  false,  true),
+    "relations"       => array(  false,   array(1,4)            , 'string' ,  array(2), true ,  false,  true),
+    "project_id"      => array(  false,   array(1,3,4)          , 'int'    ,  array(2), false,  false,  true),
+    "est_hours"       => array(  false,   array(1,2)            , 'float'  ,      null, false,  false,  true),
+    "deadline"        => array(  false,   array(1,7)            , 'date'   ,      null, false,  false,  true),
+    "start_date"      => array(  false,   array(1,7)            , 'date'   ,      null, false,  false,  true),
+    "wkd_hours"       => array(  false,   array(1,2)            , 'float'  ,      null, false,  false,  true),
+    "custom_string"   => array(   true,   array(1,2)            , 'text' ,        null, false,  false,  true),
+    "custom_number"   => array(   true,   array(1,2)            , 'int'    ,      null, false,  false,  true),
+    "custom_boolean"  => array(   true,   array(1,3,5,6)        , 'boolean',      null, false,  false,  true),
+    "custom_date"     => array(   true,   array(1,7)            , 'date'   ,      null, false,  false,  true),
+    "custom_menu"     => array(   true,   array(1,3,6)          , 'string' ,      null, false,  false,  true),
+    "custom_text"     => array(  false,   array(1,2)            , 'text'   ,      null, false,  false,  true),
+    "hours"           => array(  false,   array(2)              , 'int'    ,      null, false,  false,  true),
+    "comments"        => array(  false,   array(2)              , 'text'   ,      null, false,  false,  true)
+  ),
+  
+  "views" => array(//           disabled, view_only, has_behaviors, admin_view, multiple, sections
+    "ticket_create"   => array(    false,    false,      true, false, false, true  ), 
+    "project_create"  => array(    false,    false,      true, false, false, true  ),
+    "ticket_edit"     => array(    false,    false,      true,  true, false, true  ), 
+    "project_edit"    => array(    false,    false,      true,  true, false, true  ),
+    "ticket_list"     => array(    false,     true,     false, false, false, false ),
+    "project_list"    => array(    false,     true,     false, false, false, false ),
+    "search_form"     => array(    false,    false,      true,  true, true , false ),
+    "search_list"     => array(    false,     true,     false, false, false, false ),
+    "ticket_close"    => array(    false,    false,      true, false, false, true  ), 
+    "ticket_title"    => array(     true,     true,     false, false, false, false ),
+    "project_title"   => array(     true,     true,     false, false, false, false ),
+    "ticket_detail"   => array(     true,     true,     false, false, false, true  ),
+    "project_detail"  => array(     true,     true,     false, false, false, true  ),
+    "ticket_custom"   => array(     true,    false,      true, false, false, true  ),
+    "project_custom"  => array(     true,    false,      true, false, false, true  )
+  ),
+  
+  "types" => array(//   choices| multirows
+    "hidden"   => array(  false, false ),
+    "label"    => array(  false, false ),
+    "text"     => array(  false, true  ),
+    "menu"     => array(  true , true  ),
+    "searchbox"=> array(  false, true  ),
+    "checkbox" => array(  false, false ),
+    "radio"    => array(  true , false ),
+    "date"     => array(  false, false ),
+    "section"  => array(   true, false )
+  )
+
+);
+$GLOBALS['zt_field_dependencies'] = $ztf;
+
+/**
+ * Stores information about the fields and how they are rendered on different
+ * view.
+ */
+class ZenFieldMap {
+  
+  /**
+   * Construct a field map
+   *
+   * @param object $zen instance of zenTrack.class
+   */
+  function ZenFieldMap(&$zen) {
+    $this->_zen =& $zen;
+    $this->_session =& $zen->getSessionManager();
+    $this->_fieldVals = array();
+  }
+  
+  /**
+   * Consults the field map and constructs a list of (String)field_name which
+   * represents all of the fields which exist in this view. (note that some
+   * of these may be hidden fields
+   *
+   * @param string view corresponds to the which_view field in db
+   * @return array containing (string)field_name 
+   */
+   function listFieldsForView( $view ) {
+     if( !$view ) {
+       $this->_zen->addDebug('listFieldsForView', "Cannot retrieve field list without a view", 1);
+       return null;
+     }
+     $map = $this->getFieldMap($view);
+     $this->_zen->addDebug('listFieldsForView', "Found ".count($map)." entries for view '$view'", 3);
+     return array_keys($map);
+   }
+   
+   /**
+    * Returns a single field from the field map
+    *
+    * @param string $view the view to use (from which_view field)
+    * @param string $field_name the field to retrieve
+    * @return array all properties for this field
+    */
+    function getFieldFromMap($view, $field_name) {
+      $map = $this->getFieldMap();
+      return $map[$view][$field_name];
+    }
+    
+  /**
+   * Returns the label specified for the field in question
+   */
+/*old Function (wrong):
+  function getLabel( $view, $field_name ) {
+    $field = $this->getFieldFromMap($view,$field_name);
+    return $field['field_label']? $field['field_label'] : $field['field_name'];
+  }
+  new Function: */
+  function getLabel( $view, $field_name) {
+    $field = $this->getFieldFromMap($view,is_array($field_name)?$field_name['field_name']:$field_name);
+    return $field['field_label']? $field['field_label'] : $field['field_name'];
+  }
+  
+  /**
+   * Consults the field map and returns a string of suitable text to show
+   * to the user for a given field.  This text will be read only, and no
+   * hidden field will be rendered.  This is for display purposes only.
+   *
+   * The text will be truncated to the num_cols length specified in the database.
+   *
+   * @param string $view corresponds to the which_view field in db
+   * @param string $field_name corresponds to $field_name in db
+   * @return string of text to display
+   */
+  function getTextValue( $view, $field_name, $value ) {
+    $this->_zen->addDebug("getTextValue", "rendering $view, $field_name, $value", 3);
+    $field = $this->getFieldFromMap($view,$field_name);
+    if( strlen($value) && $field['is_visible'] && $field['field_type'] != 'hidden' ) {
+      switch($this->fieldName($field_name)) {
+        case "priority":
+        case "status":
+        case "bin_id":
+        case "type_id":
+        case "system_id":
+          $vals = $this->getChoices($view,$field_name);
+          if( isset($vals["$value"]) ) { return $this->_zen->ffv(tr($vals["$value"])); }
+          else {
+            $this->_zen->addDebug("getTextValue", "Unable to find choices for {$view}->{$field_name}", 1);
+            return $this->_zen->ffv($value, $field['num_cols']); 
+          }
+        case "user_id":
+        case "creator_id":
+          $name = $this->_zen->formatName($value,1);
+          return $this->_zen->ffv($name,$field['num_cols']);
+        case "tested":
+        case "approved":
+          $val = $value == 1? tr('No') : $value == 2? tr('Yes') : tr('n/a');
+          return $this->_zen->ffv($val,$field['num_cols']);
+        case "otime":
+        case "ctime":
+        case "deadline":
+        case "start_date":
+        case "custom_date":
+          if( preg_match('/[^0-9]/', $value) ) {
+            return $this->_zen->ffv($value,$field['num_cols']);
+          }
+          if( $value == 'NULL' ) { $value = ''; }
+          if( $value == 0 ) { $value = ""; }
+          return strlen($value)? $this->_zen->showDateTime($value) : '';
+        case "custom_boolean":
+          $val = $value == 1? tr('Yes') : tr('No');
+          return $this->_zen->ffv($val,$field['num_cols']);
+        case "details":
+        case "title":
+        case "custom_text":
+          return $this->_zen->ffvText($value);
+        default:
+          $val = $this->_zen->ffv($value, $field['num_cols']);
+          $this->_zen->addDebug("getTextValue", "rendering default: $val", 3);
+          return $this->_zen->ffv($value, $field['num_cols']);
+      }
+    }
+    // it's hidden, return nothing
+    return '';
+  }
+  
+  /**
+   * Consults the field map to determine what sort of field we have, loads
+   * this information, and renders the field to the screen appropriately.
+   *
+   * @param string $view corresponds to which_view field
+   * @param string $field_name the field's name
+   * @param mixed $value the field's current value
+   * @param $override_name if provided, will override the name=".." property of this input field 
+   * @return string containing html to render
+   */
+  function renderTicketField( $view, $form_name, $field_name, $value = null, $override_name = null ) {
+//    $this->_zen->addDebug("renderTicketField", "rendering $view, $form_name, $field_name, $value, $override_name", 1);//debug
+    global $templateDir;
+    global $rootUrl;
+    
+    // collect field properties
+    $field = $this->getFieldFromMap($view,$field_name);
+    $typeint = $this->getTypeInt($field['field_type']);
+    $typename = $field['field_type'];
+    
+    // don't waste time on spacers
+    if( $typeint == ZTFIELD_SECTION ) {
+      $vals = array('label'=>tr($field['field_label']));
+      return $this->_template($templateDir, $typename, $vals); 
+    }
+
+    // collect system properties
+    $fprops = getFmFieldProps($view, $field_name);
+    $vprops = getFmViewProps($view);
+    $tprops = getFmTypeProps($typename);
+    
+    // see if this is a 'viewonly' screen, if so, no form fields needed
+    if( $vprops["view_only"] ) { return $this->getTextValue($view,$field_name,$value); }
+    
+    // collect template props
+    $vals = array();
+    $vals["view"] = $view;
+    $vals["form_name"] = $form_name;
+    $vals["templateDir"] = $templateDir;
+    $vals["rooturl"] = $rootUrl;
+    $vals['date_format'] = $this->_zen->popupDateFormat();
+    $vals["field_name"] = $this->_zen->ffv(strlen($override_name)>0? $override_name : $field_name);
+    
+    if( !isset($value) && ($view=="ticket_create" || $view=="project_create"
+         || $view == 'search_form' )) {
+      // if there is no value and this is a create page or search page then we will
+      // retrieve a default value to use instead
+      $vals["field_value"] = $this->getDefaultValue($view,$field_name);
+    } else if( $typeint == ZTFIELD_DATE && !preg_match('/[^0-9]/', $value) ) {
+      // if it is a date and we have a numeric value, then we will parse it to
+      // a date right here
+      
+    } else {
+      $vals["field_value"] = $this->_zen->ffv($value);
+    }
+    $vals["field_label"] = $this->getTextValue($view,$field_name,$value);
+    $vals["field_max"] = $field['num_cols'];
+    if( $tprops["has_choices"] ) {
+      $vals["field_choices"] = $this->getChoices($view,$field_name);
+    }
+    
+    // deal with fields by checking 
+    // the row count to make sure it is reasonable
+    if( $field['num_rows'] == 1 ) { $vals['field_cols'] = $field['num_cols'] > 30? 30 : $field['num_cols']+2; }
+    else { $vals['field_cols'] = $field['num_cols'] > 50? 50 : $field['num_cols']; }
+    $vals['field_rows'] = $field['num_rows'];
+    
+    $vals['field_multiple'] = $view == 'search_form' && $typeint == ZTFIELD_MENU && $field['num_rows'] > 1? "multiple" : "";
+    if( $vals['field_multiple'] && $typename == 'menu' ) {
+      $vals['field_name'] .= "[]";
+    }
+
+    // set up special searchbox properties such as url and instructions
+    if( $typeint == ZTFIELD_SEARCHBOX ) {
+      if( $field_name == 'relations' ) { 
+        $vals['search_text'] = '<br>('.tr("Enter multiple ids, separated by a comma").')';
+      }
+      switch($field_name) {
+        case "project_id":
+          $s = 'project';
+          break;
+        case "id":
+        case "relations":
+          $s = 'ticket';
+           break;
+        case "user_id":
+        case "creator_id":
+          $s = 'user';
+          break;
+        case "type_id":
+        case "bin_id":
+        case "status":
+        case "priority":
+        case "system_id":
+          $s = 'datatype';
+          break;
+        default:
+          $this->_zen->addDebug("renderTicketField","The field $field_name cannot have a searchbox",1);
+          return $this->getTextValue($view,$field_name,$value);
+      }
+      $vals["search_url"] = $rootUrl."/helpers/{$s}Searchbox.php?"
+        ."return_form=$form_name&return_field={$vals['field_name']}";
+      if( !$fprops["multiple"] && !$vprops["multiple"] ) {
+        $vals['search_url'] .= "&onechoice=1";
+      }
+    }
+    
+    // deal with special custom field problems
+    if( strpos($field_name,'custom_')===0 ) {
+      $f = $this->_zen->getCustomField($field_name);
+      if( $f['js_validation'] ) {
+        $vals['field_events'] = "onblur='{$f['js_validation']}'";
+      }
+      if( strpos($field_name,'custom_date') === 0 ) {
+        if( $vals['field_value'] == 'NULL' ) { $vals['field_value'] = ''; }
+        if( $vals['field_value'] == 0 ) { $vals['field_value'] = ""; }
+      }
+    }
+    
+    // check for special cases, such as textarea
+    if( $typeint == ZTFIELD_TEXT && $field['num_rows'] > 1 ) {
+      $typename = 'textarea';
+    }
+    
+    // check field if it is a checkbox
+    if( $typeint == ZTFIELD_CHECKBOX && !$vals['field_value'] ) {
+      $vals['field_value'] = null;
+    }
+    
+    // hide any fields which are not visible
+    if( $field['is_visible'] < 1 ) {
+      $typename = 'hidden';
+      if( $field['is_required'] && !strlen($value) ) {
+        $value = $this->getDefaultValue($view, $field_name);
+        if( !strlen($value) ) {
+          $this->_zen->addDebug("renderTicketField", "Required field is hidden and has no value: $view, $field_name", 1);
+        }
+      }
+    }
+    
+    // parse and return 
+    return $this->_template($templateDir, $typename, $vals);
+  }
+  
+  /**
+   * Generate a template
+   */
+   function _template( $templateDir, $typename, $vals ) {
+     // render the template
+     $this->_zen->addDebug("_template", "Rendering $templateDir/fields/$typename.template", 3);
+     $templateFile = "$templateDir/fields/$typename.template";
+     $template = new zenTemplate($templateFile);
+     $template->values($vals);
+     return $template->process();     
+   }
+  
+  /**
+   * Returns field map, which explains how fields should be displayed, and which
+   * screens they will appear on.  This array is indexed first by view, and then
+   * by the field_name
+   *
+   * <p>This information is cached in the session.
+   *
+   * @param string $view if provided, only fields in this view will be returned,
+   *        otherwise an array of all views will be returned.
+   */
+  function getFieldMap($view = false) {
+    // try to retrieve from session
+    $map = $this->_session->getDataType('fieldmap');
+    if( $map && count($map) ) { return $view? $map[$view] : $map; }
+    
+    // retrieve from database
+    $query = "SELECT * FROM ".$this->_zen->table_field_map." ORDER BY sort_order, field_label";
+    $vals = $this->_zen->db_queryIndexed($query);
+    $set = array();
+    for($i=0; $i<count($vals); $i++) {
+      $v = $vals[$i];
+      if( !array_key_exists($v['which_view'], $set) ) { $set[ $v['which_view'] ] = array(); }
+      $set[ $v['which_view'] ] [ $v['field_name'] ] = $v;
+    }
+    $this->_zen->addDebug("getFieldMap", "Loaded $i rows into field_map from database",3);
+    
+    // store in session
+    $this->_session->storeDataType('fieldmap',$set);
+    
+    return $view? $set[$view] : $set;
+  }
+  
+  /**
+   * Updates the database and the session with new field map values
+   *
+   * @param array $newvals an array structured identical to getFieldMap() results
+   * @param array $newspacers array ( 'field_name' => array('field_label', 'is_visible', 'sort_order'), ... )
+   * @param array $oldspacers array ( 'field_name'=>field_map_id, ... )
+   * @return array(updates, attempts)
+   */
+  function updateFieldMap( $view, $newvals, $newspacers = null, $oldspacers = null ) {
+    $updateVals = array();
+    $fullMap = $this->getFieldMap();
+    foreach($fullMap[$view] as $k=>$v) {
+      if( $newvals[$k] && $newvals[$k] != $v ) {
+        $updateVals[] = $newvals[$k];
+      }
+    }
+    $i=0;
+    for($j=0; $j<count($updateVals); $j++) {
+      $v = $updateVals[$j];
+      $res = $this->_zen->db_update($this->_zen->table_field_map, 'field_map_id', $v['field_map_id'], $v);
+      $this->_zen->addDebug('updateFieldMap', "Updating {$v['which_view']}->{$v['field_name']}", 3);
+      if( $res ) { $i++; }
+    }
+    
+    foreach($newspacers as $k=>$v) {
+      $j++;
+      if( $this->addSection($view, $k, $v['field_label'], $v['is_visible'], $v['sort_order']) ) { $i++; }
+    }
+    foreach($oldspacers as $k=>$v) {
+      $j++;
+      if( $this->removeSection($view, $k, $v) ) { $i++; } 
+    }
+    
+    // clear cache so it reloads next time
+    $this->_session->clearDataType('fieldmap');
+    
+    return array($i,$j);
+  }
+  
+  /**
+   * Adds a new section into the field map
+   */
+   function addSection( $view, $name, $label, $visible, $sort_order ) {
+     $vals = array("which_view"  => $view, 
+                   "field_name"  => $name,
+                   "sort_order"  => $sort_order,
+                   "is_visible"  => $visible? 1 : 0,
+                   "field_label" => $label,
+                   "field_type"  => 'section',
+                   "num_cols"    => 100,
+                   "num_rows"    =>   1);
+     $res = $this->_zen->db_insert($this->_zen->table_field_map, $vals, 'field_map_id_seq');
+     $this->_zen->addDebug("addSection", "Section added[$res]: $view, '$label', $sort_order", 3);
+     return $res;
+   }
+   
+   /**
+    * Removes a section from the field map
+    */
+   function removeSection( $view, $field_name, $field_map_id ) {
+     $field = $this->getFieldFromMap($view, $field_name);
+     if( $field['field_type'] != 'section' ) {
+       $this->addDebug("removeSection", "Field is not a section: $view-$field_name", 1);
+       return false;
+     }
+     $id = $field['field_map_id'];
+     $res = $this->_zen->db_delete($this->_zen->table_field_map, 'field_map_id', $id);
+     $this->_zen->addDebug("removeSection", "Section deleted[$res]: $view, $field_name", 3);
+     return $res;
+   }
+  
+  /**
+   * Returns the default value for this field
+   */
+  function getDefaultValue( $view, $field_name ) {
+    $field = $this->getFieldFromMap($view,$field_name);
+    switch($this->fieldName($field_name)) {
+      case "creator_id":
+      case "user_id":
+        if( strlen($field['default_val']) && preg_match('/[^0-9]/', $field['default_val']) ) {
+          if( strpos($field['default_val'],'@') === false ) {
+            $val = $this->_zen->get_user_by_login($field['default_value']);
+            $this->_zen->addDebug("getDefaultValue", "Retrieved user id '$val' by login: {$view}->{$field_name}", 3);
+            return $val;
+          }
+          else {
+            $vals = $this->_zen->getUsersFromEmail($field['default_value']);
+            $this->_zen->addDebug("getDefaultValue", "Retrieved ".count($vals)." user ids by email: {$view}->{$field_name}", 3);
+            return $vals && count($vals)? $vals[0] : null; 
+          }
+        }
+        else { return $field['default_val']; }
+      case "custom_date":
+      case "otime":
+      case "ctime":
+      case "deadline":
+      case "start_date":
+        return strlen($field['default_val'])? $this->_zen->showDateTime($this->_zen->dateParse($field['default_val'])) : "";
+      default:
+        return $field['default_val'];
+    }
+  }
+  
+  /**
+   * Returns a list of valid choices for the given field in the format:
+   *  array( (string)value -> (string)label )
+   */
+  function getChoices( $view, $field_name ) {
+    if( isset($this->_fieldVals[$view]) && isset($this->_fieldVals[$view][$field_name]) ) 
+      { return $this->_fieldVals[$view][$field_name]; }
+      
+    $field = $this->getFieldFromMap($view, $field_name);
+    $fprops = getFmFieldProps($view, $field_name);
+    $vprops = getFmViewProps($view);
+    $bins = $this->_zen->getUsersBins($_SESSION['login_id']);
+    
+    switch( $this->fieldName($field_name) ) {
+      case "bin_id":
+        $vals = array();
+        for($i=0; $i<count($bins); $i++) {
+          $b = $bins[$i];
+          $vals["$b"] = $this->_zen->getBinName($b);
+        }
+        break;
+      case "status":
+        $vals = array('OPEN'=>"Open",'PENDING'=>"Pending",'CLOSED'=>"Closed");
+        break;
+      case "id":
+      case "title":
+      case "priority":
+      case "type_id":
+      case "user_id":
+      case "system_id":
+      case "creator_id":
+        $vals = $this->_zen->getValsForTicketField($field_name, $bins);
+        break;
+      case 'custom_boolean':
+        $vals = array('1'=>'Yes', '0'=>'No');
+        break;      
+      case "tested":
+      case "approved":
+        $vals = $vprops["admin_view"]?
+          array('0'=>'n/a', '2'=>'Yes', '1'=>'No') : array('1'=>'Yes', '2'=>'No');
+        break;
+      default:
+        if( strncmp("custom_menu",$this->fieldName($field_name),11)==0 ) {
+          $pts = explode("_", $view, 2);
+//          $vars = $this->_zen->getCustomField($field_name);
+//          $set = genDataGroupChoices($vars['field_value']);
+          $vars = $this->getFieldFromMap($view, $field_name);
+          $set = genDataGroupChoices($vars['default_val']);
+          $vals = array();
+          foreach($set as $s) {
+            $vals[ $s['field_value'] ] = $s['label'];
+          }
+        } else {
+          $vals = array();
+        }
+        break;
+    }
+    
+    $this->_zen->addDebug('_getChoices', "Generated ".count($vals)." choices for {$view}->{$field_name}", 3);
+    
+    if( $view == 'search_form' && $field['num_rows'] == 1 ) {
+      $vals = array(''=>'-any-') + $vals ;
+    }
+    if( !isset($this->_fieldVals[$view]) ) { $this->_fieldVals[$view] = array(); }
+    $this->_fieldVals[$view][$field_name] = $vals;
+    return $vals;
+  }
+  
+  /**
+   * Strip varfield numbers from field names for easier indexing
+   *
+   * @static
+   */
+   function fieldName( $name ) {
+     return strpos($name, 'custom_') === 0? 
+        preg_replace('/[0-9]+$/', '', $name) : $name;
+   }
+   
+  /**
+   * Returns a string representation of a field type
+   *
+   * This method is safe to call from a static context
+   *
+   * @param int $field_type
+   * @return string
+   */
+   function getTypeString( $field_type ) {
+     switch($field_type) {
+       case ZTFIELD_HIDDEN:
+         return "hidden";
+       case ZTFIELD_LABEL:
+         return "label";
+       case ZTFIELD_TEXT:
+         return "text";
+       case ZTFIELD_MENU:
+         return "menu";
+       case ZTFIELD_SEARCHBOX:
+         return "searchbox";
+       case ZTFIELD_CHECKBOX:
+         return "checkbox";
+       case ZTFIELD_RADIO:
+         return "radio";
+       case ZTFIELD_DATE:
+         return "date";
+       case ZTFIELD_SECTION:
+         return "section";
+       default:
+         if( isset($this) && isset($this->_zen) ) {       
+           $this->_zen->debug("getTypeString", "Invalid fieldMap type! $field_type", 1);
+         }
+         return null;
+     }
+   }
+   
+  /**
+   * Returns an integer representation of a field type
+   *
+   * This method is safe to call from a static context
+   *
+   * @param string $field_type
+   * @return int
+   */
+   function getTypeInt($field_type) {
+     switch(strtolower($field_type)) {
+       case "hidden":
+         return ZTFIELD_HIDDEN;
+       case "label":
+         return ZTFIELD_LABEL;
+       case "text":
+         return ZTFIELD_TEXT;
+       case "menu":
+         return ZTFIELD_MENU;
+       case "searchbox":
+         return ZTFIELD_SEARCHBOX;
+       case "checkbox":
+         return ZTFIELD_CHECKBOX;
+       case "radio":
+         return ZTFIELD_RADIO;
+       case "date":
+         return ZTFIELD_DATE;
+       case "section":
+         return ZTFIELD_SECTION;
+       default:
+         if( isset($this) && isset($this->_zen) ) {
+           $this->_zen->addDebug("getTypeInt", "Invalid fieldMap type! $field_type", 1);
+         }
+         return null;
+     }     
+   }
+  
+  /** @var array $_map an array of (string)view -> array( (string)field_name->(array)values... ) */
+  var $_map;
+  
+  /** @var array $_fieldVals contains valid entries for ticket field criteria */
+  var $_fieldVals;
+
+  /** @var ZenSessionManager $_session */
+  var $_session;
+  
+  /** @var zenTrack $_zen */
+  var $_zen;
+  
+}
+
+?>
diff -Naur zentrack_2-5-0-1/includes/ZenSessionManager.class zentrack_2-5-5-1/includes/ZenSessionManager.class
--- zentrack_2-5-0-1/includes/ZenSessionManager.class	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/ZenSessionManager.class	2005-05-01 23:59:35.000000000 -0700
@@ -0,0 +1,216 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+
+/**
+ * Manages session information for ZT
+ */
+ class ZenSessionManager {
+   
+   /** 
+    * Construct a session manager 
+    *
+    * @param zenTrack $zen
+    */
+   function ZenSessionManager(&$zen) { 
+     $this->_zen =& $zen;
+   }
+   
+   /**
+    * Returns data cached in the session, or null if the key is not found
+    */
+    function find( $key ) {
+      if( isset($_SESSION) ) {
+        if( isset($_SESSION['ztMiscCache']) && array_key_exists("$key", $_SESSION['ztMiscCache']) ) {
+          return $_SESSION['ztMiscCache']["$key"];
+        }
+      }
+      return null;
+    }
+   
+   /**
+    * Stores information in a cache array in the session
+    *
+    * @param string $key the index used to store values (if key exists it is replaced)
+    * @param mixed $value any valid session data
+    */
+    function store( $key, $value ) {
+      if( isset($_SESSION) ) {
+        if( !isset($_SESSION['ztMiscCache']) ) {
+          $_SESSION['ztMiscCache'] = array();
+        }
+        $_SESSION['ztMiscCache']["$key"] = $value;
+      }
+    }
+    
+   /**
+    * Clears information from the cache array in the session
+    *
+    * @param string $key if not provided, clears entire cache
+    */
+    function clear( $key = null ) {
+      if( isset($_SESSION) ) {
+        if( isset($_SESSION['ztMiscCache']) ) {
+          if( $key ) {
+            unset($_SESSION['ztMiscCache']["$key"]);
+          }
+          else {
+            $_SESSION['ztMiscCache'] = array();
+          }
+        }
+      }
+    }
+   
+   /**
+    * Store information about a data type in the session
+    *
+    * @param string $type
+    * @param mixed $vals
+    */
+   function storeDataType( $type, $vals ) {
+    if( isset($_SESSION) ) {
+      // store results in session for later use
+      if( !isset($_SESSION['ztDataTypes']) ) { $_SESSION['ztDataTypes'] = array(); }
+      $this->_zen->addDebug("storeDataType", "$type: stored",3);
+      $_SESSION['ztDataTypes'][$type] = $vals;
+      return true;
+    }    
+    return false;
+  }
+  
+  /**
+   * Retrieves a data type from the session
+   *
+   * @param string $type
+   * @return mixed array containing data type vals or false if not found
+   */
+  function getDataType( $type ) {
+    if( isset($_SESSION) && isset($_SESSION['ztDataTypes']) ) {
+      // check session before bothering with the lookup
+      if( isset($_SESSION['ztDataTypes'][$type]) ) {
+        $this->_zen->addDebug("getDataType","$type: retrieved "
+          .count($_SESSION['ztDataTypes'][$type])." from session",3);
+        return $_SESSION['ztDataTypes'][$type];
+      }
+    }
+    return false;
+  }
+  
+  /**
+   * Removes a data type from the session
+   *
+   * @param string $type
+   */
+  function clearDataType( $type ) {
+    if( isset($_SESSION) ) {
+      if( isset($_SESSION['ztDataTypes']) ) {
+        $this->_zen->addDebug("clearDataType", "$type: cleared");
+        unset($_SESSION['ztDataTypes'][$type]);
+      }
+    }
+  }
+  
+  /**
+   * Retrieves a value or set of values from the data cache
+   *
+   * @param string $type
+   * @param int $id
+   * @return mixed array for single row or array of rows, depending on value of $id, returns false if not found
+   */
+  function getDataCache( $type, $id = null ) {
+    if( isset($GLOBALS) && isset($GLOBALS['ztDataCache']) && isset($GLOBALS['ztDataCache'][$type]) ) {
+      if( isset($id) ) {
+        $this->_zen->addDebug("getDataCache", "$type-$id: retrieved");
+        return isset($GLOBALS['ztDataCache']["id$id"])? $GLOBALS['ztDataCache']["id$id"] : false;
+      }
+      $this->_zen->addDebug("getDataCache", "$type: retrieved");
+      return $GLOBALS['ztDataCache'][$type];
+    }
+    return false;
+  }
+  
+  /**
+   * Places a value into the data cache.  If this value already exists, it
+   * will be overwritten
+   *
+   * @param string $type
+   * @param int $id
+   * @param array $vals
+   */
+  function storeDataCache( $type, $id, $vals ) {
+    if( isset($GLOBALS) ) {
+      if( !isset($GLOBALS['ztDataCache']) ) { $GLOBALS['ztDataCache'] = array(); }
+      if( !isset($GLOBALS['ztDataCache'][$type]) ) { $GLOBALS['ztDataCache'][$type] = array(); }
+      if( !strlen($id) ) {
+        $this->_zen->addDebug("storeDataCache", "Storing cache for {$type}",3);
+        $GLOBALS['ztDataCache'][$type] = $vals; 
+      }
+      else {
+        $this->_zen->addDebug("storeDataCache", "Storing cache for {$type}->{$id}",3);
+        $GLOBALS['ztDataCache'][$type][$id] = $vals; 
+      }
+    }
+  }
+  
+  /**
+   * Removes an item from the data cache.  If $id is provided, it removes a
+   * specific item, otherwise it removes an entire group
+   *
+   * @param string $type
+   * @param int $id
+   */
+  function clearDataCache( $type, $id = null ) {
+    if( isset($GLOBALS) && isset($GLOBALS['ztDataCache']) ) {
+      if( $id ) {
+        $this->_zen->addDebug("clearDataCache", "Clearing cache for {$type}->{$id}",3);
+        unset($GLOBALS['ztDataCace'][$type]["id$id"]);
+      }
+      else {
+        $this->_zen->addDebug("clearDataCache", "Clearing cache for {$type}",3);
+        unset($GLOBALS['ztDataCache'][$type]);
+      }
+    }
+  }
+  
+  /** Stores custom field parms in the session for easy retrieval */
+  function storeCustomFields( $vals ) {
+    if( isset($_SESSION) ) {
+      $this->_zen->addDebug("storeCustomFields", "Storing ".count($vals)." vals", 3);
+      $_SESSION['ztVarfields'] = $vals;
+      return true;
+    }
+    return false;
+  }
+  
+  /** Retrieves custom field parms from the session */
+  function getCustomFields() {
+    if( isset($_SESSION) ) {
+      if( isset($_SESSION['ztVarfields']) ) {
+        $this->_zen->addDebug("getCustomFields", "Retrieving ".count($_SESSION['ztVarfields'])." vals", 3);
+        return $_SESSION['ztVarfields']; 
+      }
+    }
+    return false;
+  }
+  
+  
+  /** Clears custom field parms from the session */
+  function clearCustomFields() {
+    if( isset($_SESSION) ) {
+      $this->_zen->addDebug("clearCustomFields", "Clearing cache", 3);
+      $_SESSION['ztVarfields'] = false;
+    }
+  }
+  
+  /** Clears all session information which has been cached */
+  function clearAll() {
+    $_SESSION = array();
+    $GLOBALS = array();
+  }
+  
+  /** @var zenTrack $_zen */
+  var $_zen;
+
+ }
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-csvlib.inc.php zentrack_2-5-5-1/includes/adodb/adodb-csvlib.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-csvlib.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-csvlib.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -7,7 +7,8 @@
 $ADODB_INCLUDED_CSV = 1;
 
 /* 
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -66,10 +67,15 @@
 			$o =& $rs->FetchField($i);
 			$flds[] = $o;
 		}
-		
-		$rs =& new ADORecordSet_array();
-		$rs->InitArrayFields($rows,$flds);
-		return $line.serialize($rs);
+	
+		$savefetch = isset($rs->adodbFetchMode) ? $rs->adodbFetchMode : $rs->fetchMode;
+		$class = $rs->connection->arrayClass;
+		$rs2 =& new $class();
+		$rs2->sql = $rs->sql;
+		$rs2->oldProvider = $rs->dataProvider; 
+		$rs2->InitArrayFields($rows,$flds);
+		$rs2->fetchMode = $savefetch;
+		return $line.serialize($rs2);
 	}
 
 	
@@ -84,7 +90,7 @@
 *			error occurred in sql INSERT/UPDATE/DELETE, 
 *			empty recordset is returned
 */
-	function &csv2rs($url,&$err,$timeout=0)
+	function &csv2rs($url,&$err,$timeout=0, $rsclass='ADORecordSet_array')
 	{
 		$err = false;
 		$fp = @fopen($url,'rb');
@@ -121,11 +127,12 @@
 						$err = " Illegal Timeout $timeout ";
 						return false;
 					}
+					
+					$rs =& new $rsclass($val=true);
 					$rs->fields = array();
 					$rs->timeCreated = $meta[1];
-					$rs =& new ADORecordSet($val=true);
 					$rs->EOF = true;
-					$rs->_numOfFields=0;
+					$rs->_numOfFields = 0;
 					$rs->sql = urldecode($meta[2]);
 					$rs->affectedrows = (integer)$meta[3];
 					$rs->insertid = $meta[4];	
@@ -244,7 +251,7 @@
 			if (get_magic_quotes_runtime()) $err .= ". Magic Quotes Runtime should be disabled!";
 			return false;
 		}
-		$rs =& new ADORecordSet_array();
+		$rs =& new $rsclass();
 		$rs->timeCreated = $ttl;
 		$rs->InitArrayFields($arr,$flds);
 		return $rs;
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-datadict.inc.php zentrack_2-5-5-1/includes/adodb/adodb-datadict.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-datadict.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-datadict.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -22,7 +22,7 @@
 
 function Lens_ParseTest()
 {
-$str = "`zcol ACOL` NUMBER(32,2) DEFAULT 'The \"cow\" (and Jim''s dog) jumps over the moon' PRIMARY, INTI INT AUTO DEFAULT 0";
+$str = "`zcol ACOL` NUMBER(32,2) DEFAULT 'The \"cow\" (and Jim''s dog) jumps over the moon' PRIMARY, INTI INT AUTO DEFAULT 0, zcol2\"afs ds";
 print "<p>$str</p>";
 $a= Lens_ParseArgs($str);
 print "<pre>";
@@ -30,6 +30,7 @@
 print "</pre>";
 }
 
+
 if (!function_exists('ctype_alnum')) {
 	function ctype_alnum($text) {
 		return preg_match('/^[a-z0-9]*$/i', $text);
@@ -153,6 +154,7 @@
 		}
 		$pos += 1;
 	}
+	if ($intoken) $tokens[$stmtno][] = implode('',$tokarr);
 	
 	return $tokens;
 }
@@ -162,15 +164,18 @@
 	var $connection;
 	var $debug = false;
 	var $dropTable = 'DROP TABLE %s';
+	var $renameTable = 'RENAME TABLE %s TO %s'; 
 	var $dropIndex = 'DROP INDEX %s';
 	var $addCol = ' ADD';
 	var $alterCol = ' ALTER COLUMN';
 	var $dropCol = ' DROP COLUMN';
+	var $renameColumn = 'ALTER TABLE %s RENAME COLUMN %s TO %s';	// table, old-column, new-column, column-definitions (not used by default)
 	var $nameRegex = '\w';
 	var $schema = false;
 	var $serverInfo = array();
 	var $autoIncrement = false;
 	var $dataProvider;
+	var $invalidResizeTypes4 = array('CLOB','BLOB','TEXT','DATE','TIME'); // for changetablesql
 	var $blobSize = 100; 	/// any varchar/char field this size or greater is treated as a blob
 							/// in other words, we use a text area for editting.
 	
@@ -186,21 +191,25 @@
 	
 	function &MetaTables()
 	{
+		if (!$this->connection->IsConnected()) return array();
 		return $this->connection->MetaTables();
 	}
 	
 	function &MetaColumns($tab, $upper=true, $schema=false)
 	{
+		if (!$this->connection->IsConnected()) return array();
 		return $this->connection->MetaColumns($this->TableName($tab), $upper, $schema);
 	}
 	
 	function &MetaPrimaryKeys($tab,$owner=false,$intkey=false)
 	{
+		if (!$this->connection->IsConnected()) return array();
 		return $this->connection->MetaPrimaryKeys($this->TableName($tab), $owner, $intkey);
 	}
 	
 	function &MetaIndexes($table, $primary = false, $owner = false)
 	{
+		if (!$this->connection->IsConnected()) return array();
 		return $this->connection->MetaIndexes($this->TableName($table), $primary, $owner);
 	}
 	
@@ -338,7 +347,18 @@
 		return $sql;
 	}
 	
-	function AlterColumnSQL($tabname, $flds)
+	/**
+	 * Change the definition of one column
+	 *
+	 * As some DBM's can't do that on there own, you need to supply the complete defintion of the new table,
+	 * to allow, recreating the table and copying the content over to the new table
+	 * @param string $tabname table-name
+	 * @param string $flds column-name and type for the changed column
+	 * @param string $tableflds='' complete defintion of the new table, eg. for postgres, default ''
+	 * @param array/string $tableoptions='' options for the new table see CreateTableSQL, default ''
+	 * @return array with SQL strings
+	 */
+	function AlterColumnSQL($tabname, $flds, $tableflds='',$tableoptions='')
 	{
 		$tabname = $this->TableName ($tabname);
 		$sql = array();
@@ -350,7 +370,39 @@
 		return $sql;
 	}
 	
-	function DropColumnSQL($tabname, $flds)
+	/**
+	 * Rename one column
+	 *
+	 * Some DBM's can only do this together with changeing the type of the column (even if that stays the same, eg. mysql)
+	 * @param string $tabname table-name
+	 * @param string $oldcolumn column-name to be renamed
+	 * @param string $newcolumn new column-name
+	 * @param string $flds='' complete column-defintion-string like for AddColumnSQL, only used by mysql atm., default=''
+	 * @return array with SQL strings
+	 */
+	function RenameColumnSQL($tabname,$oldcolumn,$newcolumn,$flds='')
+	{
+		$tabname = $this->TableName ($tabname);
+		if ($flds) {
+			list($lines,$pkey) = $this->_GenFields($flds);
+			list(,$first) = each($lines);
+			list(,$column_def) = split("[\t ]+",$first,2);
+		}
+		return array(sprintf($this->renameColumn,$tabname,$this->NameQuote($oldcolumn),$this->NameQuote($newcolumn),$column_def));
+	}
+		
+	/**
+	 * Drop one column
+	 *
+	 * Some DBM's can't do that on there own, you need to supply the complete defintion of the new table,
+	 * to allow, recreating the table and copying the content over to the new table
+	 * @param string $tabname table-name
+	 * @param string $flds column-name and type for the changed column
+	 * @param string $tableflds='' complete defintion of the new table, eg. for postgres, default ''
+	 * @param array/string $tableoptions='' options for the new table see CreateTableSQL, default ''
+	 * @return array with SQL strings
+	 */
+	function DropColumnSQL($tabname, $flds, $tableflds='',$tableoptions='')
 	{
 		$tabname = $this->TableName ($tabname);
 		if (!is_array($flds)) $flds = explode(',',$flds);
@@ -367,6 +419,11 @@
 		return array (sprintf($this->dropTable, $this->TableName($tabname)));
 	}
 	
+	function RenameTableSQL($tabname,$newname)
+	{
+		return array (sprintf($this->renameTable, $this->TableName($tabname),$this->TableName($newname)));
+	}	
+	
 	/*
 	 Generate the SQL to create table. Returns an array of sql strings.
 	*/
@@ -374,7 +431,7 @@
 	{
 		if (!$tableoptions) $tableoptions = array();
 		
-		list($lines,$pkey) = $this->_GenFields($flds);
+		list($lines,$pkey) = $this->_GenFields($flds, true);
 		
 		$taboptions = $this->_Options($tableoptions);
 		$tabname = $this->TableName ($tabname);
@@ -386,7 +443,7 @@
 		return $sql;
 	}
 	
-	function _GenFields($flds)
+	function _GenFields($flds,$widespacing=false)
 	{
 		if (is_string($flds)) {
 			$padding = '     ';
@@ -517,7 +574,7 @@
 						$fdefault = $this->connection->qstr($fdefault);
 			$suffix = $this->_CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned);
 			
-			$fname = str_pad($fname,16);
+			if ($widespacing) $fname = str_pad($fname,24);
 			$lines[$fid] = $fname.' '.$ftype.$suffix;
 			
 			if ($fautoinc) $this->autoIncrement = true;
@@ -642,26 +699,69 @@
 	}
 	
 	/*
-	"Florian Buzin [ easywe ]" <florian.buzin@easywe.de>
+	"Florian Buzin [ easywe ]" <florian.buzin#easywe.de>
 	
 	This function changes/adds new fields to your table. You don't
 	have to know if the col is new or not. It will check on its own.
 	*/
 	function ChangeTableSQL($tablename, $flds, $tableoptions = false)
 	{
+	global $ADODB_FETCH_MODE;
+	
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+		if ($this->connection->fetchMode !== false) $savem = $this->connection->SetFetchMode(false);
+		
 		// check table exists
+		$save_handler = $this->connection->raiseErrorFn;
+		$this->connection->raiseErrorFn = '';
 		$cols = &$this->MetaColumns($tablename);
+		$this->connection->raiseErrorFn = $save_handler;
+		
+		if (isset($savem)) $this->connection->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
+		
 		if ( empty($cols)) { 
 			return $this->CreateTableSQL($tablename, $flds, $tableoptions);
 		}
 		
+		if (is_array($flds)) {
+		// Cycle through the update fields, comparing
+		// existing fields to fields to update.
+		// if the Metatype and size is exactly the
+		// same, ignore - by Mark Newham
+			$holdflds = array();
+			foreach($flds as $k=>$v) {
+				if ( isset($cols[$k]) && is_object($cols[$k]) ) {
+					$c = $cols[$k];
+					$ml = $c->max_length;
+					$mt = &$this->MetaType($c->type,$ml);
+					if ($ml == -1) $ml = '';
+					if ($mt == 'X') $ml = $v['SIZE'];
+					if (($mt != $v['TYPE']) ||  $ml != $v['SIZE']) {
+						$holdflds[$k] = $v;
+					}
+				} else {
+					$holdflds[$k] = $v;
+				}		
+			}
+			$flds = $holdflds;
+		}
+	
+
 		// already exists, alter table instead
 		list($lines,$pkey) = $this->_GenFields($flds);
 		$alter = 'ALTER TABLE ' . $this->TableName($tablename);
 		$sql = array();
-		
+
 		foreach ( $lines as $id => $v ) {
 			if ( isset($cols[$id]) && is_object($cols[$id]) ) {
+			
+				$flds = Lens_ParseArgs($v,',');
+				
+				//  We are trying to change the size of the field, if not allowed, simply ignore the request.
+				if ($flds && in_array(strtoupper(substr($flds[0][1],0,4)),$this->invalidResizeTypes4)) continue;	 
+	 		
 				$sql[] = $alter . $this->alterCol . ' ' . $v;
 			} else {
 				$sql[] = $alter . $this->addCol . ' ' . $v;
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-error.inc.php zentrack_2-5-5-1/includes/adodb/adodb-error.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-error.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-error.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -249,7 +249,8 @@
            1136 => DB_ERROR_VALUE_COUNT_ON_ROW,
            1146 => DB_ERROR_NOSUCHTABLE,
            1048 => DB_ERROR_CONSTRAINT,
-		    2002 => DB_ERROR_CONNECT_FAILED
+		    2002 => DB_ERROR_CONNECT_FAILED,
+			2005 => DB_ERROR_CONNECT_FAILED
        );
 	   
 	return $MAP;
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-errorhandler.inc.php zentrack_2-5-5-1/includes/adodb/adodb-errorhandler.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-errorhandler.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-errorhandler.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /**
- * @version V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license.
  * Whenever there is any discrepancy between the two licenses,
  * the BSD license will take precedence.
@@ -15,7 +15,7 @@
 // added Claudio Bustos  clbustos#entelchile.net
 if (!defined('ADODB_ERROR_HANDLER_TYPE')) define('ADODB_ERROR_HANDLER_TYPE',E_USER_ERROR); 
 
-define('ADODB_ERROR_HANDLER','ADODB_Error_Handler');
+if (!defined('ADODB_ERROR_HANDLER')) define('ADODB_ERROR_HANDLER','ADODB_Error_Handler');
 
 /**
 * Default Error Handler. This will be called with the following params
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-errorpear.inc.php zentrack_2-5-5-1/includes/adodb/adodb-errorpear.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-errorpear.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-errorpear.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -12,7 +12,7 @@
 */
 include_once('PEAR.php');
 
-define('ADODB_ERROR_HANDLER','ADODB_Error_PEAR');
+if (!defined('ADODB_ERROR_HANDLER')) define('ADODB_ERROR_HANDLER','ADODB_Error_PEAR');
 
 /*
 * Enabled the following if you want to terminate scripts when an error occurs
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-exceptions.inc.php zentrack_2-5-5-1/includes/adodb/adodb-exceptions.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-exceptions.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-exceptions.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
- * @version V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license.
  * Whenever there is any discrepancy between the two licenses,
  * the BSD license will take precedence.
@@ -69,7 +69,8 @@
 function adodb_throw($dbms, $fn, $errno, $errmsg, $p1, $p2, $thisConnection)
 {
 global $ADODB_EXCEPTION;
-
+	
+	if (error_reporting() == 0) return; // obey @ protocol
 	if (is_string($ADODB_EXCEPTION)) $errfn = $ADODB_EXCEPTION;
 	else $errfn = 'ADODB_EXCEPTION';
 	throw new $errfn($dbms, $fn, $errno, $errmsg, $p1, $p2, $thisConnection);
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-iterator.inc.php zentrack_2-5-5-1/includes/adodb/adodb-iterator.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-iterator.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-iterator.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -73,6 +73,7 @@
         return new ADODB_Iterator($this);
     }
 	
+	/* this is experimental - i don't really know what to return... */
 	function __toString()
 	{
 		include_once(ADODB_DIR.'/toexport.inc.php');
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-lib.inc.php zentrack_2-5-5-1/includes/adodb/adodb-lib.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-lib.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-lib.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -7,7 +7,7 @@
 $ADODB_INCLUDED_LIB = 1;
 
 /* 
- @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim\@natsoft.com.my). All rights reserved.
+ @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim\@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -22,6 +22,7 @@
 function _array_change_key_case($an_array)
 {
 	if (is_array($an_array)) {
+		$new_array = array();
 		foreach($an_array as $key=>$value)
 			$new_array[strtoupper($key)] = $value;
 
@@ -114,12 +115,12 @@
 
 	if ($multiple or is_array($defstr)) {
 		if ($size==0) $size=5;
-		$attr = " multiple size=$size";
+		$attr = ' multiple size="'.$size.'"';
 		if (!strpos($name,'[]')) $name .= '[]';
-	} else if ($size) $attr = " size=$size";
+	} else if ($size) $attr = ' size="'.$size.'"';
 	else $attr ='';
-
-	$s = "<select name=\"$name\"$attr $selectAttr>";
+	
+	$s = '<select name="'.$name.'"'.$attr.' '.$selectAttr.'>';
 	if ($blank1stItem) 
 		if (is_string($blank1stItem))  {
 			$barr = explode(':',$blank1stItem);
@@ -183,7 +184,12 @@
 		if ($zthis->dataProvider == 'oci8') {
 			
 			$rewritesql = preg_replace('/(\sORDER\s+BY\s.*)/is','',$sql);
-			$rewritesql = "SELECT COUNT(*) FROM ($rewritesql)"; 
+			
+			// Allow Oracle hints to be used for query optimization, Chris Wrye
+			if (preg_match('#/\\*+.*?\\*\\/#', $sql, $hint)) {
+				$rewritesql = "SELECT ".$hint[0]." COUNT(*) FROM (".$rewritesql.")"; 
+			} else
+				$rewritesql = "SELECT COUNT(*) FROM (".$rewritesql.")"; 
 			
 		} else if ( $zthis->databaseType == 'postgres' || $zthis->databaseType == 'postgres7')  {
 			
@@ -416,9 +422,9 @@
                 // is_null requires php 4.0.4
                 //********************************************************//
                 if (is_null($arrFields[$upperfname])
+					|| (empty($arrFields[$upperfname]) && strlen($arrFields[$upperfname]) == 0)
                     || $arrFields[$upperfname] === 'null'
-                    || $arrFields[$upperfname] === ''
-                    || empty($arrFields[$upperfname]))
+                    )
                 {
                     switch ($force) {
 
@@ -462,7 +468,8 @@
 		// If there were any modified fields then build the rest of the update query.
 		if ($fieldUpdatedCount > 0 || $forceUpdate) {
 					// Get the table name from the existing query.
-			preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName);
+			if (!empty($rs->tableName)) $tableName = $rs->tableName;
+			else preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName);
 	
 			// Get the full where clause excluding the word "WHERE" from
 			// the existing query.
@@ -472,7 +479,8 @@
 			// not a good hack, improvements?
 			if ($whereClause) {
 				if (preg_match('/\s(ORDER\s.*)/is', $whereClause[1], $discard));
-				else preg_match('/\s(LIMIT\s.*)/is', $whereClause[1], $discard);
+				else if (preg_match('/\s(LIMIT\s.*)/is', $whereClause[1], $discard));
+				else preg_match('/\s(FOR UPDATE.*)/is', $whereClause[1], $discard);
 			} else
 				$whereClause = array(false,false);
 				
@@ -512,6 +520,10 @@
  */
 function _adodb_getinsertsql(&$zthis,&$rs,$arrFields,$magicq=false,$force=2)
 {
+static $cacheRS = false;
+static $cacheSig = 0;
+static $cacheCols;
+
 	$tableName = '';
 	$values = '';
 	$fields = '';
@@ -530,11 +542,24 @@
 		$rsclass = $zthis->rsPrefix.$zthis->databaseType;
 		$recordSet =& new $rsclass(-1,$zthis->fetchMode);
 		$recordSet->connection = &$zthis;
-	
-		$columns = $zthis->MetaColumns( $tableName );
+		
+		if (is_string($cacheRS) && $cacheRS == $rs) {
+			$columns =& $cacheCols;
+		} else {
+			$columns = $zthis->MetaColumns( $tableName );
+			$cacheRS = $tableName;
+			$cacheCols = $columns;
+		}
 	} else if (is_subclass_of($rs, 'adorecordset')) {
-		for ($i=0, $max=$rs->FieldCount(); $i < $max; $i++) 
-			$columns[] = $rs->FetchField($i);
+		if (isset($rs->insertSig) && is_integer($cacheRS) && $cacheRS == $rs->insertSig) {
+			$columns =& $cacheCols;
+		} else {
+			for ($i=0, $max=$rs->FieldCount(); $i < $max; $i++) 
+				$columns[] = $rs->FetchField($i);
+			$cacheRS = $cacheSig;
+			$cacheCols = $columns;
+			$rs->insertSig = $cacheSig++;
+		}
 		$recordSet =& $rs;
 	
 	} else {
@@ -556,9 +581,9 @@
 			
             /********************************************************/
             if (is_null($arrFields[$upperfname])
+                || (empty($arrFields[$upperfname]) && strlen($arrFields[$upperfname]) == 0)
                 || $arrFields[$upperfname] === 'null'
-                || $arrFields[$upperfname] === ''
-                || empty($arrFields[$upperfname]))
+				)
                {
                     switch ($force) {
 
@@ -613,7 +638,8 @@
 	
 	// Get the table name from the existing query.
 	if (!$tableName) {
-		if (preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName))
+		if (!empty($rs->tableName)) $tableName = $rs->tableName;
+		else if (preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName))
 			$tableName = $tableName[1];
 		else 
 			return false;
@@ -724,57 +750,39 @@
 			
 		}
 	}
-	
-	$sql = '';
 		
 	switch($type) {
 		case "C":
 		case "X":
 		case 'B':
-			if ($action == 'I') {
-				$sql = $zthis->qstr($arrFields[$fname],$magicq) . ", ";
-			} else {
-				$sql .= $fnameq . "=" . $zthis->qstr($arrFields[$fname],$magicq) . ", ";
-			}
-		  break;
+			$val = $zthis->qstr($arrFields[$fname],$magicq);
+			break;
 
 		case "D":
-			if ($action == 'I') {
-				$sql = $zthis->DBDate($arrFields[$fname]) . ", ";
-			} else {
-				$sql .= $fnameq . "=" . $zthis->DBDate($arrFields[$fname]) . ", ";
-			}
+			$val = $zthis->DBDate($arrFields[$fname]);
 			break;
 
 		case "T":
-			if ($action == 'I') {
-				$sql = $zthis->DBTimeStamp($arrFields[$fname]) . ", ";
-			} else {
-				$sql .= $fnameq . "=" . $zthis->DBTimeStamp($arrFields[$fname]) . ", ";
-			}
+			$val = $zthis->DBTimeStamp($arrFields[$fname]);
 			break;
 
 		default:
 			$val = $arrFields[$fname];
 			if (empty($val)) $val = '0';
-
-
-			if ($action == 'I') {
-				$sql .= $val . ", ";
-			} else {
-				$sql .= $fnameq . "=" . $val  . ", ";
-			}
 			break;
 	}
 
-	return $sql;
+	if ($action == 'I') return $val . ", ";
+	
+	
+	return $fnameq . "=" . $val  . ", ";
+	
 }
 
 
 
 function _adodb_debug_execute(&$zthis, $sql, $inputarr)
 {
-global $HTTP_SERVER_VARS;
 
 	$ss = '';
 	if ($inputarr) {
@@ -787,18 +795,20 @@
 	$sqlTxt = str_replace(',',', ',is_array($sql) ? $sql[0] : $sql);
 
 	// check if running from browser or command-line
-	$inBrowser = isset($HTTP_SERVER_VARS['HTTP_USER_AGENT']);
+	$inBrowser = isset($_SERVER['HTTP_USER_AGENT']);
 	
+	$dbt = $zthis->databaseType;
+	if (isset($zthis->dsnType)) $dbt .= '-'.$zthis->dsnType;
 	if ($inBrowser) {
 		$ss = htmlspecialchars($ss);
 		if ($zthis->debug === -1)
-			ADOConnection::outp( "<br>\n($zthis->databaseType): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<br>\n",false);
+			ADOConnection::outp( "<br>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<br>\n",false);
 		else 
-			ADOConnection::outp( "<hr>\n($zthis->databaseType): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<hr>\n",false);
+			ADOConnection::outp( "<hr>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<hr>\n",false);
 	} else {
-		ADOConnection::outp("-----\n($zthis->databaseType): ".$sqlTxt."\n-----\n",false);
+		ADOConnection::outp("-----\n($dbt): ".$sqlTxt."\n-----\n",false);
 	}
-	
+
 	$qID = $zthis->_query($sql,$inputarr);
 	
 	/* 
@@ -825,7 +835,7 @@
 	$html =  (isset($_SERVER['HTTP_USER_AGENT']));
 	$fmt =  ($html) ? "</font><font color=#808080 size=-1> %% line %4d, file: <a href=\"file:/%s\">%s</a></font>" : "%% line %4d, file: %s";
 
-	$MAXSTRLEN = 64;
+	$MAXSTRLEN = 128;
 
 	$s = ($html) ? '<pre align=left>' : '';
 	
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-pager.inc.php zentrack_2-5-5-1/includes/adodb/adodb-pager.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-pager.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-pager.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-	V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+	V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
 	  Released under both BSD license and Lesser GPL library license. 
 	  Whenever there is any discrepancy between the two licenses, 
 	  the BSD license will take precedence. 
@@ -57,10 +57,10 @@
 	//
 	function ADODB_Pager(&$db,$sql,$id = 'adodb', $showPageLinks = false)
 	{
-	global $HTTP_SERVER_VARS,$PHP_SELF,$HTTP_SESSION_VARS,$HTTP_GET_VARS;
+	global $PHP_SELF;
 	
 		$curr_page = $id.'_curr_page';
-		if (empty($PHP_SELF)) $PHP_SELF = $HTTP_SERVER_VARS['PHP_SELF'];
+		if (empty($PHP_SELF)) $PHP_SELF = $_SERVER['PHP_SELF'];
 		
 		$this->sql = $sql;
 		$this->id = $id;
@@ -69,12 +69,12 @@
 		
 		$next_page = $id.'_next_page';	
 		
-		if (isset($HTTP_GET_VARS[$next_page])) {
-			$HTTP_SESSION_VARS[$curr_page] = $HTTP_GET_VARS[$next_page];
+		if (isset($_GET[$next_page])) {
+			$_SESSION[$curr_page] = $_GET[$next_page];
 		}
-		if (empty($HTTP_SESSION_VARS[$curr_page])) $HTTP_SESSION_VARS[$curr_page] = 1; ## at first page
+		if (empty($_SESSION[$curr_page])) $_SESSION[$curr_page] = 1; ## at first page
 		
-		$this->curr_page = $HTTP_SESSION_VARS[$curr_page];
+		$this->curr_page = $_SESSION[$curr_page];
 		
 	}
 	
@@ -242,6 +242,8 @@
 	
 		$this->rows = $rows;
 		
+		if ($this->db->dataProvider == 'informix') $this->db->cursorType = IFX_SCROLL;
+		
 		$savec = $ADODB_COUNTRECS;
 		if ($this->db->pageExecuteCountRows) $ADODB_COUNTRECS = true;
 		if ($this->cache)
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-pear.inc.php zentrack_2-5-5-1/includes/adodb/adodb-pear.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-pear.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-pear.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -51,6 +51,11 @@
 if (!defined('DB_OK')) {
 define("DB_OK",	1);
 define("DB_ERROR",-1);
+
+// autoExecute constants
+define('DB_AUTOQUERY_INSERT', 1);
+define('DB_AUTOQUERY_UPDATE', 2);
+
 /**
  * This is a special constant that tells DB the user hasn't specified
  * any particular get mode, so the default should be used.
@@ -160,6 +165,7 @@
 		if (is_array($options)) {
 			foreach($options as $k => $v) {
 				switch(strtolower($k)) {
+				case 'persist':
 				case 'persistent': 	$persist = $v; break;
 				#ibase
 				case 'dialect': 	$obj->dialect = $v; break;
@@ -204,9 +210,10 @@
 	 */
 	function isError($value)
 	{
-		return (is_object($value) &&
-				(get_class($value) == 'db_error' ||
-				 is_subclass_of($value, 'db_error')));
+		if (!is_object($value)) return false;
+		$class = get_class($value);
+		return $class == 'pear_error' || is_subclass_of($value, 'pear_error') || 
+				$class == 'db_error' || is_subclass_of($value, 'db_error');
 	}
 
 
@@ -221,9 +228,11 @@
 	 */
 	function isWarning($value)
 	{
+		return false;
+		/*
 		return is_object($value) &&
 			(get_class( $value ) == "db_warning" ||
-			 is_subclass_of($value, "db_warning"));
+			 is_subclass_of($value, "db_warning"));*/
 	}
 
 	/**
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-perf.inc.php zentrack_2-5-5-1/includes/adodb/adodb-perf.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-perf.inc.php	2004-09-08 17:31:45.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-perf.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -37,7 +37,6 @@
 /* sql code timing */
 function& adodb_log_sql(&$conn,$sql,$inputarr)
 {
-global $HTTP_SERVER_VARS;
 	
     $perf_table = adodb_perf::table();
 	$conn->fnExecute = false;
@@ -73,20 +72,26 @@
 			$conn->lastInsID = @$conn->Insert_ID();
 			$conn->debug = $dbg;
 		}
-		if (isset($HTTP_SERVER_VARS['HTTP_HOST'])) {
-			$tracer .= '<br>'.$HTTP_SERVER_VARS['HTTP_HOST'];
-			if (isset($HTTP_SERVER_VARS['PHP_SELF'])) $tracer .= $HTTP_SERVER_VARS['PHP_SELF'];
+		if (isset($_SERVER['HTTP_HOST'])) {
+			$tracer .= '<br>'.$_SERVER['HTTP_HOST'];
+			if (isset($_SERVER['PHP_SELF'])) $tracer .= $_SERVER['PHP_SELF'];
 		} else 
-			if (isset($HTTP_SERVER_VARS['PHP_SELF'])) $tracer .= '<br>'.$HTTP_SERVER_VARS['PHP_SELF'];
+			if (isset($_SERVER['PHP_SELF'])) $tracer .= '<br>'.$_SERVER['PHP_SELF'];
 		//$tracer .= (string) adodb_backtrace(false);
 		
-		$tracer = substr($tracer,0,500);
+		$tracer = (string) substr($tracer,0,500);
 		
 		if (is_array($inputarr)) {
 			if (is_array(reset($inputarr))) $params = 'Array sizeof='.sizeof($inputarr);
 			else {
-				$params = '';
-				$params = implode(', ',$inputarr);
+				// Quote string parameters so we can see them in the
+				// performance stats. This helps spot disabled indexes.
+				$xar_params = $inputarr;
+				foreach ($xar_params as $xar_param_key => $xar_param) {
+					if (gettype($xar_param) == 'string')
+					$xar_params[$xar_param_key] = '"' . $xar_param . '"';
+				}
+				$params = implode(', ', $xar_params);
 				if (strlen($params) >= 3000) $params = substr($params, 0, 3000);
 			}
 		} else {
@@ -100,8 +105,10 @@
 		$saved = $conn->debug;
 		$conn->debug = 0;
 		
+		$d = $conn->sysTimeStamp;
+		if (empty($d)) $d = date("'Y-m-d H:i:s'");
 		if ($conn->dataProvider == 'oci8' && $dbT != 'oci8po') {
-			$isql = "insert into $perf_table values($conn->sysTimeStamp,:b,:c,:d,:e,:f)";
+			$isql = "insert into $perf_table values($d,:b,:c,:d,:e,:f)";
 		} else if ($dbT == 'odbc_mssql' || $dbT == 'informix') {
 			$timer = $arr['f'];
 			if ($dbT == 'informix') $sql2 = substr($sql2,0,230);
@@ -111,12 +118,13 @@
 			$params = $conn->qstr($arr['d']);
 			$tracer = $conn->qstr($arr['e']);
 			
-			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values($conn->sysTimeStamp,$sql1,$sql2,$params,$tracer,$timer)";
+			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values($d,$sql1,$sql2,$params,$tracer,$timer)";
 			if ($dbT == 'informix') $isql = str_replace(chr(10),' ',$isql);
 			$arr = false;
 		} else {
-			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values( $conn->sysTimeStamp,?,?,?,?,?)";
+			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values( $d,?,?,?,?,?)";
 		}
+
 		$ok = $conn->Execute($isql,$arr);
 		$conn->debug = $saved;
 		
@@ -138,7 +146,7 @@
 				timer decimal(16,6))");
 			}
 			if (!$ok) {
-				ADOConnection::outp( "<b>LOGSQL Insert Failed</b>: $isql<br>$err2</br>");
+				ADOConnection::outp( "<p><b>LOGSQL Insert Failed</b>: $isql<br>$err2</p>");
 				$conn->_logsql = false;
 			}
 		}
@@ -208,6 +216,12 @@
 		// Algorithm is taken from
 		// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/example__obtaining_raw_performance_data.asp
 		if (strncmp(PHP_OS,'WIN',3)==0) {
+			if (PHP_VERSION == '5.0.0') return false;
+			if (PHP_VERSION == '5.0.1') return false;
+			if (PHP_VERSION == '5.0.2') return false;
+			if (PHP_VERSION == '5.0.3') return false;
+			if (PHP_VERSION == '4.3.10') return false; # see http://bugs.php.net/bug.php?id=31737
+			
 			@$c = new COM("WinMgmts:{impersonationLevel=impersonate}!Win32_PerfRawData_PerfOS_Processor.Name='_Total'");
 			if (!$c) return false;
 			
@@ -340,9 +354,8 @@
 	
 	function InvalidSQL($numsql = 10)
 	{
-	global $HTTP_GET_VARS;
 	
-		if (isset($HTTP_GET_VARS['sql'])) return;
+		if (isset($_GET['sql'])) return;
 		$s = '<h3>Invalid SQL</h3>';
 		$saveE = $this->conn->fnExecute;
 		$this->conn->fnExecute = false;
@@ -363,22 +376,23 @@
 	*/	
 	function _SuspiciousSQL($numsql = 10)
 	{
-		global $ADODB_FETCH_MODE,$HTTP_GET_VARS;
+		global $ADODB_FETCH_MODE;
 		
             $perf_table = adodb_perf::table();
 			$saveE = $this->conn->fnExecute;
 			$this->conn->fnExecute = false;
 			
-			if (isset($HTTP_GET_VARS['exps']) && isset($HTTP_GET_VARS['sql'])) {
-				$partial = !empty($HTTP_GET_VARS['part']);
-				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
+			if (isset($_GET['exps']) && isset($_GET['sql'])) {
+				$partial = !empty($_GET['part']);
+				echo "<a name=explain></a>".$this->Explain($_GET['sql'],$partial)."\n";
 			}
 			
-			if (isset($HTTP_GET_VARS['sql'])) return;
+			if (isset($_GET['sql'])) return;
 			$sql1 = $this->sql1;
 			
 			$save = $ADODB_FETCH_MODE;
 			$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+			if ($this->conn->fetchMode !== false) $savem = $this->conn->SetFetchMode(false);
 			//$this->conn->debug=1;
 			$rs =& $this->conn->SelectLimit(
 			"select avg(timer) as avg_timer,$sql1,count(*),max(timer) as max_timer,min(timer) as min_timer
@@ -387,6 +401,7 @@
 				and (tracer is null or tracer not like 'ERROR:%')
 				group by sql1
 				order by 1 desc",$numsql);
+			if (isset($savem)) $this->conn->SetFetchMode($savem);
 			$ADODB_FETCH_MODE = $save;
 			$this->conn->fnExecute = $saveE;
 			
@@ -440,22 +455,24 @@
 	*/
 	function _ExpensiveSQL($numsql = 10)
 	{
-		global $HTTP_GET_VARS,$ADODB_FETCH_MODE;
+		global $ADODB_FETCH_MODE;
 		
             $perf_table = adodb_perf::table();
 			$saveE = $this->conn->fnExecute;
 			$this->conn->fnExecute = false;
 			
-			if (isset($HTTP_GET_VARS['expe']) && isset($HTTP_GET_VARS['sql'])) {
-				$partial = !empty($HTTP_GET_VARS['part']);
-				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
+			if (isset($_GET['expe']) && isset($_GET['sql'])) {
+				$partial = !empty($_GET['part']);
+				echo "<a name=explain></a>".$this->Explain($_GET['sql'],$partial)."\n";
 			}
 			
-			if (isset($HTTP_GET_VARS['sql'])) return;
+			if (isset($_GET['sql'])) return;
 			
 			$sql1 = $this->sql1;
 			$save = $ADODB_FETCH_MODE;
 			$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+			if ($this->conn->fetchMode !== false) $savem = $this->conn->SetFetchMode(false);
+			
 			$rs =& $this->conn->SelectLimit(
 			"select sum(timer) as total,$sql1,count(*),max(timer) as max_timer,min(timer) as min_timer
 				from $perf_table
@@ -463,7 +480,7 @@
 				and (tracer is null or tracer not like 'ERROR:%')
 				group by sql1
 				order by 1 desc",$numsql);
-			
+			if (isset($savem)) $this->conn->SetFetchMode($savem);
 			$this->conn->fnExecute = $saveE;
 			$ADODB_FETCH_MODE = $save;
 			if (!$rs) return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
@@ -577,7 +594,6 @@
 	
 	function UI($pollsecs=5)
 	{
-	global $HTTP_GET_VARS,$HTTP_SERVER_VARS,$HTTP_POST_VARS;
 	
     $perf_table = adodb_perf::table();
 	$conn = $this->conn;
@@ -589,15 +605,15 @@
 	if ($app) $app .= ', ';
 	$savelog = $this->conn->LogSQL(false);	
 	$info = $conn->ServerInfo();
-	if (isset($HTTP_GET_VARS['clearsql'])) {
+	if (isset($_GET['clearsql'])) {
 		$this->conn->Execute("delete from $perf_table");
 	}
 	$this->conn->LogSQL($savelog);
 	
 	// magic quotes
 	
-	if (isset($HTTP_GET_VARS['sql']) && get_magic_quotes_gpc()) {
-		$_GET['sql'] = $HTTP_GET_VARS['sql'] = str_replace(array("\\'",'\"'),array("'",'"'),$HTTP_GET_VARS['sql']);
+	if (isset($_GET['sql']) && get_magic_quotes_gpc()) {
+		$_GET['sql'] = $_GET['sql'] = str_replace(array("\\'",'\"'),array("'",'"'),$_GET['sql']);
 	}
 	
 	if (!isset($_SESSION['ADODB_PERF_SQL'])) $nsql = $_SESSION['ADODB_PERF_SQL'] = 10;
@@ -606,13 +622,13 @@
 	$app .= $info['description'];
 	
 	
-	if (isset($HTTP_GET_VARS['do'])) $do = $HTTP_GET_VARS['do'];
-	else if (isset($HTTP_POST_VARS['do'])) $do = $HTTP_POST_VARS['do'];
-	 else if (isset($HTTP_GET_VARS['sql'])) $do = 'viewsql';
+	if (isset($_GET['do'])) $do = $_GET['do'];
+	else if (isset($_POST['do'])) $do = $_POST['do'];
+	 else if (isset($_GET['sql'])) $do = 'viewsql';
 	 else $do = 'stats';
 	 
-	if (isset($HTTP_GET_VARS['nsql'])) {
-		if ($HTTP_GET_VARS['nsql'] > 0) $nsql = $_SESSION['ADODB_PERF_SQL'] = (integer) $HTTP_GET_VARS['nsql'];
+	if (isset($_GET['nsql'])) {
+		if ($_GET['nsql'] > 0) $nsql = $_SESSION['ADODB_PERF_SQL'] = (integer) $_GET['nsql'];
 	}
 	echo "<title>ADOdb Performance Monitor on $app</title><body bgcolor=white>";
 	if ($do == 'viewsql') $form = "<td><form># SQL:<input type=hidden value=viewsql name=do> <input type=text size=4 name=nsql value=$nsql><input type=submit value=Go></td></form>";
@@ -620,7 +636,7 @@
 	
 	$allowsql = !defined('ADODB_PERF_NO_RUN_SQL');
 	
-	if  (empty($HTTP_GET_VARS['hidem']))
+	if  (empty($_GET['hidem']))
 	echo "<table border=1 width=100% bgcolor=lightyellow><tr><td colspan=2>
 	<b><a href=http://adodb.sourceforge.net/?perf=1>ADOdb</a> Performance Monitor</b> <font size=1>for $app</font></tr><tr><td>
 	<a href=?do=stats><b>Performance Stats</b></a> &nbsp; <a href=?do=viewsql><b>View SQL</b></a>
@@ -639,7 +655,7 @@
 			break;
 		case 'poll':
 			echo "<iframe width=720 height=80% 
-				src=\"{$HTTP_SERVER_VARS['PHP_SELF']}?do=poll2&hidem=1\"></iframe>";
+				src=\"{$_SERVER['PHP_SELF']}?do=poll2&hidem=1\"></iframe>";
 			break;
 		case 'poll2':
 			echo "<pre>";
@@ -652,7 +668,7 @@
 			$this->DoSQLForm();
 			break;
 		case 'viewsql':
-			if (empty($HTTP_GET_VARS['hidem']))
+			if (empty($_GET['hidem']))
 				echo "&nbsp; <a href=\"?do=viewsql&clearsql=1\">Clear SQL Log</a><br>";
 			echo($this->SuspiciousSQL($nsql));
 			echo($this->ExpensiveSQL($nsql));
@@ -679,6 +695,7 @@
 		set_time_limit(0);
 		sleep($secs);
 		while (1) {
+
 			$arr =& $this->PollParameters();
 			
 			$hits   = sprintf('%2.2f',$arr[0]);
@@ -699,6 +716,8 @@
 			echo date('H:i:s').'  '.$osval."$hits  $sess $reads $writes\n";
 			flush();
 			
+			if (connection_aborted()) return;
+			
 			sleep($secs);
 			$arro = $arr;
 		}
@@ -809,24 +828,22 @@
 	
 	function DoSQLForm()
 	{
-	global $HTTP_SERVER_VARS,$HTTP_GET_VARS,$HTTP_POST_VARS,$HTTP_SESSION_VARS;
 	
-		$HTTP_VARS = array_merge($HTTP_GET_VARS,$HTTP_POST_VARS);
 		
-		$PHP_SELF = $HTTP_SERVER_VARS['PHP_SELF'];
-		$sql = isset($HTTP_VARS['sql']) ? $HTTP_VARS['sql'] : '';
+		$PHP_SELF = $_SERVER['PHP_SELF'];
+		$sql = isset($_REQUEST['sql']) ? $_REQUEST['sql'] : '';
 
-		if (isset($HTTP_SESSION_VARS['phplens_sqlrows'])) $rows = $HTTP_SESSION_VARS['phplens_sqlrows'];
+		if (isset($_SESSION['phplens_sqlrows'])) $rows = $_SESSION['phplens_sqlrows'];
 		else $rows = 3;
 		
-		if (isset($HTTP_VARS['SMALLER'])) {
+		if (isset($_REQUEST['SMALLER'])) {
 			$rows /= 2;
 			if ($rows < 3) $rows = 3;
-			$HTTP_SESSION_VARS['phplens_sqlrows'] = $rows;
+			$_SESSION['phplens_sqlrows'] = $rows;
 		}
-		if (isset($HTTP_VARS['BIGGER'])) {
+		if (isset($_REQUEST['BIGGER'])) {
 			$rows *= 2;
-			$HTTP_SESSION_VARS['phplens_sqlrows'] = $rows;
+			$_SESSION['phplens_sqlrows'] = $rows;
 		}
 		
 ?>
@@ -846,7 +863,7 @@
 </form>
 
 <?php
-		if (!isset($HTTP_VARS['sql'])) return;
+		if (!isset($_REQUEST['sql'])) return;
 		
 		$sql = $this->undomq(trim($sql));
 		if (substr($sql,strlen($sql)-1) === ';') {
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-php4.inc.php zentrack_2-5-5-1/includes/adodb/adodb-php4.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-php4.inc.php	2004-09-08 17:31:45.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-php4.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-time.inc.php zentrack_2-5-5-1/includes/adodb/adodb-time.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-time.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-time.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -24,6 +24,8 @@
 	gmdate()   with  adodb_gmdate()
 	mktime()   with  adodb_mktime()
 	gmmktime() with  adodb_gmmktime()
+	strftime() with  adodb_strftime()
+	strftime() with  adodb_gmstrftime()
 </pre>
 	
 The parameters are identical, except that adodb_date() accepts a subset
@@ -55,8 +57,8 @@
 
 COPYRIGHT
 
-(c) 2003 John Lim and released under BSD-style license except for code by jackbbs,
-which includes adodb_mktime, adodb_get_gmt_diff, adodb_is_leap_year
+(c) 2003-2005 John Lim and released under BSD-style license except for code by 
+jackbbs, which includes adodb_mktime, adodb_get_gmt_diff, adodb_is_leap_year
 and originally found at http://www.php.net/manual/en/function.mktime.php
 
 =============================================================================
@@ -72,13 +74,14 @@
 FUNCTION DESCRIPTIONS
 
 
-FUNCTION adodb_getdate($date=false)
+** FUNCTION adodb_getdate($date=false)
 
 Returns an array containing date information, as getdate(), but supports
-dates greater than 1901 to 2038.
-
-
-FUNCTION adodb_date($fmt, $timestamp = false)
+dates greater than 1901 to 2038. The local date/time format is derived from a 
+heuristic the first time adodb_getdate is called. 
+	 
+	 
+** FUNCTION adodb_date($fmt, $timestamp = false)
 
 Convert a timestamp to a formatted local date. If $timestamp is not defined, the
 current timestamp is used. Unlike the function date(), it supports dates
@@ -87,72 +90,139 @@
 The format fields that adodb_date supports:
 
 <pre>
-a - "am" or "pm" 
-A - "AM" or "PM" 
-d - day of the month, 2 digits with leading zeros; i.e. "01" to "31" 
-D - day of the week, textual, 3 letters; e.g. "Fri" 
-F - month, textual, long; e.g. "January" 
-g - hour, 12-hour format without leading zeros; i.e. "1" to "12" 
-G - hour, 24-hour format without leading zeros; i.e. "0" to "23" 
-h - hour, 12-hour format; i.e. "01" to "12" 
-H - hour, 24-hour format; i.e. "00" to "23" 
-i - minutes; i.e. "00" to "59" 
-j - day of the month without leading zeros; i.e. "1" to "31" 
-l (lowercase 'L') - day of the week, textual, long; e.g. "Friday"  
-L - boolean for whether it is a leap year; i.e. "0" or "1" 
-m - month; i.e. "01" to "12" 
-M - month, textual, 3 letters; e.g. "Jan" 
-n - month without leading zeros; i.e. "1" to "12" 
-O - Difference to Greenwich time in hours; e.g. "+0200" 
-Q - Quarter, as in 1, 2, 3, 4 
-r - RFC 822 formatted date; e.g. "Thu, 21 Dec 2000 16:01:07 +0200" 
-s - seconds; i.e. "00" to "59" 
-S - English ordinal suffix for the day of the month, 2 characters; 
-   			i.e. "st", "nd", "rd" or "th" 
-t - number of days in the given month; i.e. "28" to "31"
-T - Timezone setting of this machine; e.g. "EST" or "MDT" 
-U - seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)  
-w - day of the week, numeric, i.e. "0" (Sunday) to "6" (Saturday) 
-Y - year, 4 digits; e.g. "1999" 
-y - year, 2 digits; e.g. "99" 
-z - day of the year; i.e. "0" to "365" 
-Z - timezone offset in seconds (i.e. "-43200" to "43200"). 
-   			The offset for timezones west of UTC is always negative, 
-			and for those east of UTC is always positive. 
+	a - "am" or "pm" 
+	A - "AM" or "PM" 
+	d - day of the month, 2 digits with leading zeros; i.e. "01" to "31" 
+	D - day of the week, textual, 3 letters; e.g. "Fri" 
+	F - month, textual, long; e.g. "January" 
+	g - hour, 12-hour format without leading zeros; i.e. "1" to "12" 
+	G - hour, 24-hour format without leading zeros; i.e. "0" to "23" 
+	h - hour, 12-hour format; i.e. "01" to "12" 
+	H - hour, 24-hour format; i.e. "00" to "23" 
+	i - minutes; i.e. "00" to "59" 
+	j - day of the month without leading zeros; i.e. "1" to "31" 
+	l (lowercase 'L') - day of the week, textual, long; e.g. "Friday"  
+	L - boolean for whether it is a leap year; i.e. "0" or "1" 
+	m - month; i.e. "01" to "12" 
+	M - month, textual, 3 letters; e.g. "Jan" 
+	n - month without leading zeros; i.e. "1" to "12" 
+	O - Difference to Greenwich time in hours; e.g. "+0200" 
+	Q - Quarter, as in 1, 2, 3, 4 
+	r - RFC 822 formatted date; e.g. "Thu, 21 Dec 2000 16:01:07 +0200" 
+	s - seconds; i.e. "00" to "59" 
+	S - English ordinal suffix for the day of the month, 2 characters; 
+	   			i.e. "st", "nd", "rd" or "th" 
+	t - number of days in the given month; i.e. "28" to "31"
+	T - Timezone setting of this machine; e.g. "EST" or "MDT" 
+	U - seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)  
+	w - day of the week, numeric, i.e. "0" (Sunday) to "6" (Saturday) 
+	Y - year, 4 digits; e.g. "1999" 
+	y - year, 2 digits; e.g. "99" 
+	z - day of the year; i.e. "0" to "365" 
+	Z - timezone offset in seconds (i.e. "-43200" to "43200"). 
+	   			The offset for timezones west of UTC is always negative, 
+				and for those east of UTC is always positive. 
 </pre>
 
 Unsupported:
 <pre>
-B - Swatch Internet time 
-I (capital i) - "1" if Daylight Savings Time, "0" otherwise.
-W - ISO-8601 week number of year, weeks starting on Monday 
+	B - Swatch Internet time 
+	I (capital i) - "1" if Daylight Savings Time, "0" otherwise.
+	W - ISO-8601 week number of year, weeks starting on Monday 
 
 </pre>
 
-FUNCTION adodb_date2($fmt, $isoDateString = false)
+
+** FUNCTION adodb_date2($fmt, $isoDateString = false)
 Same as adodb_date, but 2nd parameter accepts iso date, eg.
 
   adodb_date2('d-M-Y H:i','2003-12-25 13:01:34');
 
-FUNCTION adodb_gmdate($fmt, $timestamp = false)
+  
+** FUNCTION adodb_gmdate($fmt, $timestamp = false)
 
 Convert a timestamp to a formatted GMT date. If $timestamp is not defined, the
 current timestamp is used. Unlike the function date(), it supports dates
 outside the 1901 to 2038 range.
 
 
-FUNCTION adodb_mktime($hr, $min, $sec [, $month, $day, $year])
+** FUNCTION adodb_mktime($hr, $min, $sec[, $month, $day, $year])
 
 Converts a local date to a unix timestamp.  Unlike the function mktime(), it supports
-dates outside the 1901 to 2038 range. Differs from mktime() in that all parameters
-are currently compulsory.
+dates outside the 1901 to 2038 range. All parameters are optional.
+
 
-FUNCTION adodb_gmmktime($hr, $min, $sec [, $month, $day, $year])
+** FUNCTION adodb_gmmktime($hr, $min, $sec [, $month, $day, $year])
 
 Converts a gmt date to a unix timestamp.  Unlike the function gmmktime(), it supports
 dates outside the 1901 to 2038 range. Differs from gmmktime() in that all parameters
 are currently compulsory.
 
+** FUNCTION adodb_gmstrftime($fmt, $timestamp = false)
+Convert a timestamp to a formatted GMT date.
+
+** FUNCTION adodb_strftime($fmt, $timestamp = false)
+
+Convert a timestamp to a formatted local date. Internally converts $fmt into 
+adodb_date format, then echo result.
+
+For best results, you can define the local date format yourself. Define a global
+variable $ADODB_DATE_LOCALE which is an array, 1st element is date format using
+adodb_date syntax, and 2nd element is the time format, also in adodb_date syntax.
+
+    eg. $ADODB_DATE_LOCALE = array('d/m/Y','H:i:s');
+	
+	Supported format codes:
+
+<pre>
+	%a - abbreviated weekday name according to the current locale 
+	%A - full weekday name according to the current locale 
+	%b - abbreviated month name according to the current locale 
+	%B - full month name according to the current locale 
+	%c - preferred date and time representation for the current locale 
+	%d - day of the month as a decimal number (range 01 to 31) 
+	%D - same as %m/%d/%y 
+	%e - day of the month as a decimal number, a single digit is preceded by a space (range ' 1' to '31') 
+	%h - same as %b
+	%H - hour as a decimal number using a 24-hour clock (range 00 to 23) 
+	%I - hour as a decimal number using a 12-hour clock (range 01 to 12) 
+	%m - month as a decimal number (range 01 to 12) 
+	%M - minute as a decimal number 
+	%n - newline character 
+	%p - either `am' or `pm' according to the given time value, or the corresponding strings for the current locale 
+	%r - time in a.m. and p.m. notation 
+	%R - time in 24 hour notation 
+	%S - second as a decimal number 
+	%t - tab character 
+	%T - current time, equal to %H:%M:%S 
+	%x - preferred date representation for the current locale without the time 
+	%X - preferred time representation for the current locale without the date 
+	%y - year as a decimal number without a century (range 00 to 99) 
+	%Y - year as a decimal number including the century 
+	%Z - time zone or name or abbreviation 
+	%% - a literal `%' character 
+</pre>	
+
+	Unsupported codes:
+<pre>
+	%C - century number (the year divided by 100 and truncated to an integer, range 00 to 99) 
+	%g - like %G, but without the century. 
+	%G - The 4-digit year corresponding to the ISO week number (see %V). 
+	     This has the same format and value as %Y, except that if the ISO week number belongs 
+		 to the previous or next year, that year is used instead. 
+	%j - day of the year as a decimal number (range 001 to 366) 
+	%u - weekday as a decimal number [1,7], with 1 representing Monday 
+	%U - week number of the current year as a decimal number, starting 
+	    with the first Sunday as the first day of the first week 
+	%V - The ISO 8601:1988 week number of the current year as a decimal number, 
+	     range 01 to 53, where week 1 is the first week that has at least 4 days in the 
+		 current year, and with Monday as the first day of the week. (Use %G or %g for 
+		 the year component that corresponds to the week number for the specified timestamp.) 
+	%w - day of the week as a decimal, Sunday being 0 
+	%W - week number of the current year as a decimal number, starting with the 
+	     first Monday as the first day of the first week 
+</pre>
+
 =============================================================================
 
 NOTES
@@ -166,17 +236,27 @@
 (page 428, xttotm.c _Ttotm() function). Plauger's algorithm will not 
 work outside 32-bit signed range, so i decided not to implement it.
 
-b. Iterate over a block of years (say 12) when searching for the 
-correct year.
-
-c. Implement daylight savings, which looks awfully complicated, see
+b. Implement daylight savings, which looks awfully complicated, see
 	http://webexhibits.org/daylightsaving/
 
 
 CHANGELOG
+
+- 24 Feb 2005 0.20
+Added limited strftime/gmstrftime support. x10 improvement in performance of adodb_date().
+
+- 21 Dec 2004 0.17
+In adodb_getdate(), the timestamp was accidentally converted to gmt when $is_gmt is false. 
+Also adodb_mktime(0,0,0) did not work properly. Both fixed thx Mauro.
+
+- 17 Nov 2004 0.16
+Removed intval typecast in adodb_mktime() for secs, allowing:
+	 adodb_mktime(0,0,0 + 2236672153,1,1,1934);
+Suggested by Ryan.
+
 - 18 July 2004 0.15
-All params in adodb_mktime were formerly compulsory. Now only the hour, min, secs is compulsory. This
-brings it more in line with mktime (still not identical).
+All params in adodb_mktime were formerly compulsory. Now only the hour, min, secs is compulsory. 
+This brings it more in line with mktime (still not identical).
 
 - 23 June 2004 0.14
 
@@ -275,7 +355,7 @@
 /*
 	Version Number
 */
-define('ADODB_DATE_VERSION',0.15);
+define('ADODB_DATE_VERSION',0.17);
 
 /*
 	We check for Windows as only +ve ints are accepted as dates on Windows.
@@ -293,16 +373,28 @@
 
 if (!defined('ADODB_ALLOW_NEGATIVE_TS')) define('ADODB_NO_NEGATIVE_TS',1);
 
-function adodb_date_test_date($y1,$m)
+function adodb_date_test_date($y1,$m,$d=13)
 {
-	//print " $y1/$m ";
-	$t = adodb_mktime(0,0,0,$m,13,$y1);
-	if ("$y1-$m-13 00:00:00" != adodb_date('Y-n-d H:i:s',$t)) {
-		print "<b>$y1 error</b><br>";
+	$t = adodb_mktime(0,0,0,$m,$d,$y1);
+	$rez = adodb_date('Y-n-j H:i:s',$t);
+	if ("$y1-$m-$d 00:00:00" != $rez) {
+		print "<b>$y1 error, expected=$y1-$m-$d 00:00:00, adodb=$rez</b><br>";
 		return false;
 	}
 	return true;
 }
+
+function adodb_date_test_strftime($fmt)
+{
+	$s1 = strftime($fmt);
+	$s2 = adodb_strftime($fmt);
+	
+	if ($s1 == $s2) return true;
+	
+	echo "error for $fmt,  strftime=$s1, $adodb=$s2<br>";
+	return false;
+}
+
 /**
 	 Test Suite
 */
@@ -317,6 +409,10 @@
 	// This flag disables calling of PHP native functions, so we can properly test the code
 	if (!defined('ADODB_TEST_DATES')) define('ADODB_TEST_DATES',1);
 	
+	adodb_date_test_strftime('%Y %m %x %X');
+	adodb_date_test_strftime("%A %d %B %Y");
+	adodb_date_test_strftime("%H %M S");
+	
 	$t = adodb_mktime(0,0,0);
 	if (!(adodb_date('Y-m-d') == date('Y-m-d'))) print 'Error in '.adodb_mktime(0,0,0).'<br>';
 	
@@ -485,13 +581,13 @@
 	    $year--;
 	}
 	
-	$day =  ( floor((13 * $month - 1) / 5) +
+	$day =  floor((13 * $month - 1) / 5) +
 	        $day + ($year % 100) +
 	        floor(($year % 100) / 4) +
 	        floor(($year / 100) / 4) - 2 *
-	        floor($year / 100) + 77);
+	        floor($year / 100) + 77 + $greg_correction;
 	
-	return (($day - 7 * floor($day / 7))) + $greg_correction;
+	return $day - 7 * floor($day / 7);
 }
 
 
@@ -575,6 +671,26 @@
 	return _adodb_getdate($d);
 }
 
+/*
+// generate $YRS table for _adodb_getdate()
+function adodb_date_gentable($out=true)
+{
+
+	for ($i=1970; $i >= 1600; $i-=10) {
+		$s = adodb_gmmktime(0,0,0,1,1,$i);
+		echo "$i => $s,<br>";	
+	}
+}
+adodb_date_gentable();
+
+for ($i=1970; $i > 1500; $i--) {
+
+echo "<hr>$i ";
+	adodb_date_test_date($i,1,1);
+}
+
+*/
+
 /**
 	Low-level function that returns the getdate() array. We have a special
 	$fast flag, which if set to true, will return fewer array values,
@@ -582,6 +698,8 @@
 */
 function _adodb_getdate($origd=false,$fast=false,$is_gmt=false)
 {
+static $YRS;
+
 	$d =  $origd - ($is_gmt ? 0 : adodb_get_gmt_diff());
 	
 	$_day_power = 86400;
@@ -597,9 +715,57 @@
 	$d365 = $_day_power * 365;
 	
 	if ($d < 0) {
-		$origd = $d;
+		
+		if (empty($YRS)) $YRS = array(
+			1970 => 0,
+			1960 => -315619200,
+			1950 => -631152000,
+			1940 => -946771200,
+			1930 => -1262304000,
+			1920 => -1577923200,
+			1910 => -1893456000,
+			1900 => -2208988800,
+			1890 => -2524521600,
+			1880 => -2840140800,
+			1870 => -3155673600,
+			1860 => -3471292800,
+			1850 => -3786825600,
+			1840 => -4102444800,
+			1830 => -4417977600,
+			1820 => -4733596800,
+			1810 => -5049129600,
+			1800 => -5364662400,
+			1790 => -5680195200,
+			1780 => -5995814400,
+			1770 => -6311347200,
+			1760 => -6626966400,
+			1750 => -6942499200,
+			1740 => -7258118400,
+			1730 => -7573651200,
+			1720 => -7889270400,
+			1710 => -8204803200,
+			1700 => -8520336000,
+			1690 => -8835868800,
+			1680 => -9151488000,
+			1670 => -9467020800,
+			1660 => -9782640000,
+			1650 => -10098172800,
+			1640 => -10413792000,
+			1630 => -10729324800,
+			1620 => -11044944000,
+			1610 => -11360476800,
+			1600 => -11676096000);
+
+		if ($is_gmt) $origd = $d;
 		// The valid range of a 32bit signed timestamp is typically from 
 		// Fri, 13 Dec 1901 20:45:54 GMT to Tue, 19 Jan 2038 03:14:07 GMT
+		//
+		
+		# old algorithm iterates through all years. new algorithm does it in
+		# 10 year blocks
+		
+		/*
+		# old algo
 		for ($a = 1970 ; --$a >= 0;) {
 			$lastd = $d;
 			
@@ -611,6 +777,36 @@
 				break;
 			}
 		}
+		*/
+		
+		$lastsecs = 0;
+		$lastyear = 1970;
+		foreach($YRS as $year => $secs) {
+			if ($d >= $secs) {
+				$a = $lastyear;
+				break;
+			}
+			$lastsecs = $secs;
+			$lastyear = $year;
+		}
+		
+		$d -= $lastsecs;
+		if (!isset($a)) $a = $lastyear;
+		
+		//echo ' yr=',$a,' ', $d,'.';
+		
+		for (; --$a >= 0;) {
+			$lastd = $d;
+			
+			if ($leaf = _adodb_is_leap_year($a)) $d += $d366;
+			else $d += $d365;
+			
+			if ($d >= 0) {
+				$year = $a;
+				break;
+			}
+		}
+		/**/
 		
 		$secsInYear = 86400 * ($leaf ? 366 : 365) + $lastd;
 		
@@ -738,6 +934,7 @@
 	$_day_power = 86400;
 	
 	$arr = _adodb_getdate($d,true,$is_gmt);
+	
 	if (!isset($daylight)) $daylight = function_exists('adodb_daylight_sv');
 	if ($daylight) adodb_daylight_sv($arr, $is_gmt);
 	
@@ -877,22 +1074,31 @@
 function adodb_mktime($hr,$min,$sec,$mon=false,$day=false,$year=false,$is_dst=false,$is_gmt=false) 
 {
 	if (!defined('ADODB_TEST_DATES')) {
+
+		if ($mon === false) {
+			return $is_gmt? @gmmktime($hr,$min,$sec): @mktime($hr,$min,$sec);
+		}
+		
 		// for windows, we don't check 1970 because with timezone differences, 
 		// 1 Jan 1970 could generate negative timestamp, which is illegal
 		if (1971 < $year && $year < 2038
-			|| $mon === false
 			|| !defined('ADODB_NO_NEGATIVE_TS') && (1901 < $year && $year < 2038)
-			)
-				return $is_gmt?
+			) {
+				return $is_gmt ?
 					@gmmktime($hr,$min,$sec,$mon,$day,$year):
 					@mktime($hr,$min,$sec,$mon,$day,$year);
+			}
 	}
 	
 	$gmt_different = ($is_gmt) ? 0 : adodb_get_gmt_diff();
-	
+
+	/*
+	# disabled because some people place large values in $sec.
+	# however we need it for $mon because we use an array...
 	$hr = intval($hr);
 	$min = intval($min);
 	$sec = intval($sec);
+	*/
 	$mon = intval($mon);
 	$day = intval($day);
 	$year = intval($year);
@@ -964,4 +1170,108 @@
 	return $ret;
 }
 
+function adodb_gmstrftime($fmt, $ts=false)
+{
+	return adodb_strftime($fmt,$ts,true);
+}
+
+// hack - convert to adodb_date
+function adodb_strftime($fmt, $ts=false,$is_gmt=false)
+{
+global $ADODB_DATE_LOCALE;
+
+	if (!defined('ADODB_TEST_DATES')) {
+		if ((abs($ts) <= 0x7FFFFFFF)) { // check if number in 32-bit signed range
+			if (!defined('ADODB_NO_NEGATIVE_TS') || $ts >= 0) // if windows, must be +ve integer
+				return ($is_gmt)? @gmstrftime($fmt,$ts): @strftime($fmt,$ts);
+
+		}
+	}
+	
+	if (empty($ADODB_DATE_LOCALE)) {
+		$tstr = strtoupper(gmstrftime('%c',31366800)); // 30 Dec 1970, 1 am
+		$sep = substr($tstr,2,1);
+		$hasAM = strrpos($tstr,'M') !== false;
+		
+		$ADODB_DATE_LOCALE = array();
+		$ADODB_DATE_LOCALE[] =  strncmp($tstr,'30',2) == 0 ? 'd'.$sep.'m'.$sep.'y' : 'm'.$sep.'d'.$sep.'y';	
+		$ADODB_DATE_LOCALE[]  = ($hasAM) ? 'h:i:s a' : 'H:i:s';
+			
+	}
+	$inpct = false;
+	$fmtdate = '';
+	for ($i=0,$max = strlen($fmt); $i < $max; $i++) {
+		$ch = $fmt[$i];
+		if ($ch == '%') {
+			if ($inpct) {
+				$fmtdate .= '%';
+				$inpct = false;
+			} else
+				$inpct = true;
+		} else if ($inpct) {
+		
+			$inpct = false;
+			switch($ch) {
+			case '0':
+			case '1':
+			case '2':
+			case '3':
+			case '4':
+			case '5':
+			case '6':
+			case '7':
+			case '8':
+			case '9':
+			case 'E':
+			case 'O':
+				/* ignore format modifiers */
+				$inpct = true; 
+				break;
+				
+			case 'a': $fmtdate .= 'D'; break;
+			case 'A': $fmtdate .= 'l'; break;
+			case 'h':
+			case 'b': $fmtdate .= 'M'; break;
+			case 'B': $fmtdate .= 'F'; break;
+			case 'c': $fmtdate .= $ADODB_DATE_LOCALE[0].$ADODB_DATE_LOCALE[1]; break;
+			case 'C': $fmtdate .= '\C?'; break; // century
+			case 'd': $fmtdate .= 'd'; break;
+			case 'D': $fmtdate .= 'm/d/y'; break;
+			case 'e': $fmtdate .= 'j'; break;
+			case 'g': $fmtdate .= '\g?'; break; //?
+			case 'G': $fmtdate .= '\G?'; break; //?
+			case 'H': $fmtdate .= 'H'; break;
+			case 'I': $fmtdate .= 'h'; break;
+			case 'j': $fmtdate .= '?z'; $parsej = true; break; // wrong as j=1-based, z=0-basd
+			case 'm': $fmtdate .= 'm'; break;
+			case 'M': $fmtdate .= 'i'; break;
+			case 'n': $fmtdate .= "\n"; break;
+			case 'p': $fmtdate .= 'a'; break;
+			case 'r': $fmtdate .= 'h:i:s a'; break;
+			case 'R': $fmtdate .= 'H:i:s'; break;
+			case 'S': $fmtdate .= 's'; break;
+			case 't': $fmtdate .= "\t"; break;
+			case 'T': $fmtdate .= 'H:i:s'; break;
+			case 'u': $fmtdate .= '?u'; $parseu = true; break; // wrong strftime=1-based, date=0-basde
+			case 'U': $fmtdate .= '?U'; $parseU = true; break;// wrong strftime=1-based, date=0-based
+			case 'x': $fmtdate .= $ADODB_DATE_LOCALE[0]; break;
+			case 'X': $fmtdate .= $ADODB_DATE_LOCALE[1]; break;
+			case 'w': $fmtdate .= '?w'; $parseu = true; break; // wrong strftime=1-based, date=0-basde
+			case 'W': $fmtdate .= '?W'; $parseU = true; break;// wrong strftime=1-based, date=0-based
+			case 'y': $fmtdate .= 'y'; break;
+			case 'Y': $fmtdate .= 'Y'; break;
+			case 'Z': $fmtdate .= 'T'; break;
+			}
+		} else if (('A' <= ($ch) && ($ch) <= 'Z' ) || ('a' <= ($ch) && ($ch) <= 'z' ))
+			$fmtdate .= "\\".$ch;
+		else
+			$fmtdate .= $ch;
+	}
+	//echo "fmt=",$fmtdate,"<br>";
+	if ($ts === false) $ts = time();
+	$ret = adodb_date($fmtdate, $ts, $is_gmt);
+	return $ret;
+}
+
+
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb-xmlschema.inc.php zentrack_2-5-5-1/includes/adodb/adodb-xmlschema.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb-xmlschema.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb-xmlschema.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -12,7 +12,7 @@
  *
  * Last Editor: $Author: phpzen $
  * @author Richard Tango-Lowy & Dan Cech
- * @version $Revision: 1.2 $
+ * @version $Revision: 1.2 $
  *
  * @package axmls
  * @tutorial getting_started.pkg
@@ -1194,7 +1194,7 @@
 * @tutorial getting_started.pkg
 *
 * @author Richard Tango-Lowy & Dan Cech
-* @version $Revision: 1.2 $
+* @version $Revision: 1.2 $
 *
 * @package axmls
 */
@@ -1917,7 +1917,7 @@
 				$schema .= '	<table name="' . $table . '">' . "\n";
 				
 				// grab details from database
-				$rs = $this->db->Execute( 'SELECT * FROM ' . $table . ' WHERE -1' );
+				$rs = $this->db->Execute( 'SELECT * FROM ' . $table . ' WHERE 1=1' );
 				$fields = $this->db->MetaColumns( $table );
 				$indexes = $this->db->MetaIndexes( $table );
 				
@@ -1983,7 +1983,7 @@
 						
 						while( $row = $rs->FetchRow() ) {
 							foreach( $row as $key => $val ) {
-								$row[$key] = htmlentities($row);
+								$row[$key] = htmlentities($val);
 							}
 							
 							$schema .= '			<row><f>' . implode( '</f><f>', $row ) . '</f></row>' . "\n";
diff -Naur zentrack_2-5-0-1/includes/adodb/adodb.inc.php zentrack_2-5-5-1/includes/adodb/adodb.inc.php
--- zentrack_2-5-0-1/includes/adodb/adodb.inc.php	2004-09-08 01:22:39.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/adodb.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -14,7 +14,7 @@
 /**
 	\mainpage 	
 	
-	 @version V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim\@natsoft.com.my). All rights reserved.
+	 @version V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
 
 	Released under both BSD license and Lesser GPL library license. You can choose which license
 	you prefer.
@@ -26,8 +26,8 @@
 	We currently support MySQL, Oracle, Microsoft SQL Server, Sybase, Sybase SQL Anywhere, DB2,
 	Informix, PostgreSQL, FrontBase, Interbase (Firebird and Borland variants), Foxpro, Access,
 	ADO, SAP DB, SQLite and ODBC. We have had successful reports of connecting to Progress and
-	other databases via ODBC. 
-	 
+	other databases via ODBC.
+
 	Latest Download at http://php.weblogs.com/adodb<br>
 	Manual is at http://php.weblogs.com/adodb_manual
 	  
@@ -87,7 +87,7 @@
 		define('ADODB_BAD_RS','<p>Bad $rs in %s. Connection or SQL invalid. Try using $connection->debug=true;</p>');
 	
 	// allow [ ] @ ` " and . in table names
-		define('ADODB_TABLE_REGEX','([]0-9a-z_\"\`\.\@\[-]*)');
+		define('ADODB_TABLE_REGEX','([]0-9a-z_\:\"\`\.\@\[-]*)');
 	
 	// prefetching used by oracle
 		if (!defined('ADODB_PREFETCH_ROWS')) define('ADODB_PREFETCH_ROWS',10);
@@ -172,7 +172,7 @@
 		/**
 		 * ADODB version as a string.
 		 */
-		$ADODB_vers = 'V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved. Released BSD & LGPL.';
+		$ADODB_vers = 'V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved. Released BSD & LGPL.';
 	
 		/**
 		 * Determines whether recordset->RecordCount() is used. 
@@ -199,7 +199,7 @@
 		var $name = '';
 		var $max_length=0;
 		var $type="";
-
+/*
 		// additional fields by dannym... (danny_milo@yahoo.com)
 		var $not_null = false; 
 		// actually, this has already been built-in in the postgres, fbsql AND mysql module? ^-^
@@ -208,6 +208,7 @@
 		var $has_default = false; // this one I have done only in mysql and postgres for now ... 
 			// others to come (dannym)
 		var $default_value; // default, if any, and supported. Check has_default first.
+*/
 	}
 	
 
@@ -240,10 +241,10 @@
 	var $user = ''; 			/// The username which is used to connect to the database server. 
 	var $password = ''; 		/// Password for the username. For security, we no longer store it.
 	var $debug = false; 		/// if set to true will output sql statements
-	var $maxblobsize = 256000; 	/// maximum size of blobs or large text fields -- some databases die otherwise like foxpro
+	var $maxblobsize = 262144; 	/// maximum size of blobs or large text fields (262144 = 256K)-- some db's die otherwise like foxpro
 	var $concat_operator = '+'; /// default concat operator -- change to || for Oracle/Interbase	
 	var $substr = 'substr';		/// substring operator
-	var $length = 'length';		/// string length operator
+	var $length = 'length';		/// string length ofperator
 	var $random = 'rand()';		/// random function
 	var $upperCase = 'upper';		/// uppercase function
 	var $fmtDate = "'Y-m-d'";	/// used by DBDate() as the default date format used by the database
@@ -252,7 +253,7 @@
 	var $false = '0'; 			/// string that represents FALSE for a database
 	var $replaceQuote = "\\'"; 	/// string to use to replace quotes
 	var $nameQuote = '"';		/// string to use to quote identifiers and names
-	var $charSet=false; 		/// character set to use - only for interbase
+	var $charSet=false; 		/// character set to use - only for interbase, postgres and oci8
 	var $metaDatabasesSQL = '';
 	var $metaTablesSQL = '';
 	var $uniqueOrderBy = false; /// All order by columns have to be unique
@@ -343,6 +344,11 @@
 		return array('description' => '', 'version' => '');
 	}
 	
+	function IsConnected()
+	{
+    	return !empty($this->_connectionID);
+	}
+	
 	function _findvers($str)
 	{
 		if (preg_match('/([0-9]+\.([0-9\.])+)/',$str, $arr)) return $arr[1];
@@ -355,7 +361,7 @@
 	*/
 	function outp($msg,$newline=true)
 	{
-	global $HTTP_SERVER_VARS,$ADODB_FLUSH,$ADODB_OUTP;
+	global $ADODB_FLUSH,$ADODB_OUTP;
 	
 		if (defined('ADODB_OUTP')) {
 			$fn = ADODB_OUTP;
@@ -369,7 +375,7 @@
 		
 		if ($newline) $msg .= "<br>\n";
 		
-		if (isset($HTTP_SERVER_VARS['HTTP_USER_AGENT']) || !$newline) echo $msg;
+		if (isset($_SERVER['HTTP_USER_AGENT']) || !$newline) echo $msg;
 		else echo strip_tags($msg);
 	
 		
@@ -405,17 +411,25 @@
 		
 		$this->_isPersistentConnection = false;	
 		if ($forceNew) {
-			if ($this->_nconnect($this->host, $this->user, $this->password, $this->database)) return true;
+			if ($rez=$this->_nconnect($this->host, $this->user, $this->password, $this->database)) return true;
+		} else {
+			 if ($rez=$this->_connect($this->host, $this->user, $this->password, $this->database)) return true;
+		}
+		if (isset($rez)) {
+			$err = $this->ErrorMsg();
+			if (empty($err)) $err = "Connection error to server '$argHostname' with user '$argUsername'";
+			$ret = false;
 		} else {
-			 if ($this->_connect($this->host, $this->user, $this->password, $this->database)) return true;
+			$err = "Missing extension for ".$this->dataProvider;
+			$ret = 0;
 		}
-		$err = $this->ErrorMsg();
-		if (empty($err)) $err = "Connection error to server '$argHostname' with user '$argUsername'";
 		if ($fn = $this->raiseErrorFn) 
 			$fn($this->databaseType,'CONNECT',$this->ErrorNo(),$err,$this->host,$this->database,$this);
 		
+		
+		$this->_connectionID = false;
 		if ($this->debug) ADOConnection::outp( $this->host.': '.$err);
-		return false;
+		return $ret;
 	}	
 	
 	function _nconnect($argHostname, $argUsername, $argPassword, $argDatabaseName)
@@ -460,17 +474,22 @@
 		if ($argDatabaseName != "") $this->database = $argDatabaseName;		
 			
 		$this->_isPersistentConnection = true;	
-		if ($this->_pconnect($this->host, $this->user, $this->password, $this->database)) return true;
-		$err = $this->ErrorMsg();
-		if (empty($err)) {
-			$err = "Connection error to server '$argHostname' with user '$argUsername'";
-		}	
+		if ($rez = $this->_pconnect($this->host, $this->user, $this->password, $this->database)) return true;
+		if (isset($rez)) {
+			$err = $this->ErrorMsg();
+			if (empty($err)) $err = "Connection error to server '$argHostname' with user '$argUsername'";
+			$ret = false;
+		} else {
+			$err = "Missing extension for ".$this->dataProvider;
+			$ret = 0;
+		}
 		if ($fn = $this->raiseErrorFn) {
 			$fn($this->databaseType,'PCONNECT',$this->ErrorNo(),$err,$this->host,$this->database,$this);
 		}
 		
+		$this->_connectionID = false;
 		if ($this->debug) ADOConnection::outp( $this->host.': '.$err);
-		return false;
+		return $ret;
 	}
 
 	// Format date column in sql string given an input format that understands Y M D
@@ -499,7 +518,7 @@
 	{
 		return $sql;
 	}
-
+	
 	/**
 	 * Some databases, eg. mssql require a different function for preparing
 	 * stored procedures. So we cannot use Prepare().
@@ -792,20 +811,26 @@
 					$sql = ''; $i = 0;
 					foreach($arr as $v) {
 						$sql .= $sqlarr[$i];
-						// from Ron Baldwin <ron.baldwin@sourceprose.com>
+						// from Ron Baldwin <ron.baldwin#sourceprose.com>
 						// Only quote string types	
-						if (gettype($v) == 'string')
+						$typ = gettype($v);
+						if ($typ == 'string')
 							$sql .= $this->qstr($v);
+						else if ($typ == 'double')
+							$sql .= str_replace(',','.',$v); // locales fix so 1.1 does not get converted to 1,1
+						else if ($typ == 'boolean')
+							$sql = $v ? $this->true : $this->false;
 						else if ($v === null)
 							$sql .= 'NULL';
 						else
 							$sql .= $v;
 						$i += 1;
 					}
-					$sql .= $sqlarr[$i];
-					
-					if ($i+1 != sizeof($sqlarr))	
-						ADOConnection::outp( "Input Array does not match ?: ".htmlspecialchars($sql));
+					if (isset($sqlarr[$i])) {
+						$sql .= $sqlarr[$i];
+						if ($i+1 != sizeof($sqlarr)) ADOConnection::outp( "Input Array does not match ?: ".htmlspecialchars($sql));
+					} else if ($i != sizeof($sqlarr))	
+						ADOConnection::outp( "Input array does not match ?: ".htmlspecialchars($sql));
 		
 					$ret =& $this->_Execute($sql);
 					if (!$ret) return $ret;
@@ -829,7 +854,7 @@
 	}
 	
 	
-	function& _Execute($sql,$inputarr=false)
+	function &_Execute($sql,$inputarr=false)
 	{
 
 		if ($this->debug) {
@@ -850,8 +875,8 @@
 			if ($fn) {
 				$fn($this->databaseType,'EXECUTE',$this->ErrorNo(),$this->ErrorMsg(),$sql,$inputarr,$this);
 			} 
-				
-			return false;
+			$false = false;
+			return $false;
 		} 
 		
 		if ($this->_queryID === true) { // return simplified recordset for inserts/updates/deletes with lower overhead
@@ -885,7 +910,7 @@
 		return $this->Execute(sprintf($this->_genSeqSQL,$seqname,$startID));
 	}
 
-	function DropSequence($seqname)
+	function DropSequence($seqname='adodbseq')
 	{
 		if (empty($this->_dropSeqSQL)) return false;
 		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
@@ -908,7 +933,12 @@
 		$getnext = sprintf($this->_genIDSQL,$seqname);
 		
 		$holdtransOK = $this->_transOK;
-		$rs = @$this->Execute($getnext);
+		
+		$save_handler = $this->connection->raiseErrorFn;
+		$this->connection->raiseErrorFn = '';
+		@($rs = $this->Execute($getnext));
+		$this->connection->raiseErrorFn = $save_handler;
+		
 		if (!$rs) {
 			$this->_transOK = $holdtransOK; //if the status was ok before reset
 			$createseq = $this->Execute(sprintf($this->_genSeqSQL,$seqname,$startID));
@@ -923,12 +953,14 @@
 	}	
 
 	/**
+	 * @param $table string name of the table, not needed by all databases (eg. mysql), default ''
+	 * @param $column string name of the column, not needed by all databases (eg. mysql), default ''
 	 * @return  the last inserted ID. Not all databases support this.
 	 */ 
-	function Insert_ID()
+	function Insert_ID($table='',$column='')
 	{
 		if ($this->_logsql && $this->lastInsID) return $this->lastInsID;
-		if ($this->hasInsertID) return $this->_insertid();
+		if ($this->hasInsertID) return $this->_insertid($table,$column);
 		if ($this->debug) {
 			ADOConnection::outp( '<p>Insert_ID error</p>');
 			adodb_backtrace();
@@ -938,7 +970,7 @@
 
 
 	/**
-	 * Portable Insert ID. Pablo Roca <pabloroca@mvps.org>
+	 * Portable Insert ID. Pablo Roca <pabloroca#mvps.org>
 	 *
 	 * @return  the last inserted ID. All databases support this. But aware possible
 	 * problems in multiuser environments. Heavy test this before deploying.
@@ -946,7 +978,7 @@
 	function PO_Insert_ID($table="", $id="") 
 	{
 	   if ($this->hasInsertID){
-		   return $this->Insert_ID();
+		   return $this->Insert_ID($table,$id);
 	   } else {
 		   return $this->GetOne("SELECT MAX($id) FROM $table");
 	   }
@@ -1145,8 +1177,10 @@
 	*/
 	function &_rs2rs(&$rs,$nrows=-1,$offset=-1,$close=true)
 	{
-		if (! $rs) return false;
-		
+		if (! $rs) {
+			$false = false;
+			return $false;
+		}
 		$dbtype = $rs->databaseType;
 		if (!$dbtype) {
 			$rs = &$rs;  // required to prevent crashing in 4.2.1, but does not happen in 4.3.1 -- why ?
@@ -1173,6 +1207,7 @@
 		$rs2->sql = $rs->sql;
 		$rs2->dataProvider = $this->dataProvider;
 		$rs2->InitArrayFields($arr,$flds);
+		$rs2->fetchMode = isset($rs->adodbFetchMode) ? $rs->adodbFetchMode : $rs->fetchMode;
 		return $rs2;
 	}
 	
@@ -1188,8 +1223,10 @@
 	function &GetAssoc($sql, $inputarr=false,$force_array = false, $first2cols = false)
 	{
 		$rs =& $this->Execute($sql, $inputarr);
-		if (!$rs) return false;
-		
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
 		$arr =& $rs->GetAssoc($force_array,$first2cols);
 		return $arr;
 	}
@@ -1201,8 +1238,10 @@
 			$force_array = $inputarr;
 		}
 		$rs =& $this->CacheExecute($secs2cache, $sql, $inputarr);
-		if (!$rs) return false;
-		
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
 		$arr =& $rs->GetAssoc($force_array,$first2cols);
 		return $arr;
 	}
@@ -1222,7 +1261,7 @@
 		
 		$ret = false;
 		$rs = &$this->Execute($sql,$inputarr);
-		if ($rs) {		
+		if ($rs) {	
 			if (!$rs->EOF) $ret = reset($rs->fields);
 			$rs->Close();
 		}
@@ -1314,7 +1353,10 @@
 		$ADODB_COUNTRECS = $savec;
 		if (!$rs) 
 			if (defined('ADODB_PEAR')) return ADODB_PEAR_Error();
-			else return false;
+			else {
+				$false = false;
+				return $false;
+			}
 		$arr =& $rs->GetArray();
 		$rs->Close();
 		return $arr;
@@ -1336,8 +1378,10 @@
 		
 		if (!$rs) 
 			if (defined('ADODB_PEAR')) return ADODB_PEAR_Error();
-			else return false;
-		
+			else {
+				$false = false;
+				return $false;
+			}
 		$arr =& $rs->GetArray();
 		$rs->Close();
 		return $arr;
@@ -1367,7 +1411,8 @@
 			return $arr;
 		}
 		
-		return false;
+		$false = false;
+		return $false;
 	}
 	
 	function &CacheGetRow($secs2cache,$sql=false,$inputarr=false)
@@ -1379,7 +1424,8 @@
 			$rs->Close();
 			return $arr;
 		}
-		return false;
+		$false = false;
+		return $false;
 	}
 	
 	/**
@@ -1455,7 +1501,8 @@
 			if (strncmp(PHP_OS,'WIN',3) === 0) {
 				$cmd = 'del /s '.str_replace('/','\\',$ADODB_CACHE_DIR).'\adodb_*.cache';
 			} else {
-				$cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/??/adodb_*.cache'; 
+				//$cmd = 'find "'.$ADODB_CACHE_DIR.'" -type f -maxdepth 1 -print0 | xargs -0 rm -f';
+				$cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/[0-9a-f][0-9a-f]/'; 
 				// old version 'rm -f `find '.$ADODB_CACHE_DIR.' -name adodb_*.cache`';
 			}
 			if ($this->debug) {
@@ -1541,7 +1588,7 @@
 		$err = '';
 		
 		if ($secs2cache > 0){
-			$rs = &csv2rs($md5file,$err,$secs2cache);
+			$rs = &csv2rs($md5file,$err,$secs2cache,$this->arrayClass);
 			$this->numCacheHits += 1;
 		} else {
 			$err='Timeout 1';
@@ -1556,7 +1603,9 @@
 				}
 				if ($this->debug !== -1) ADOConnection::outp( " $md5file cache failure: $err (see sql below)");
 			}
+			
 			$rs = &$this->Execute($sql,$inputarr);
+
 			if ($rs) {
 				$eof = $rs->EOF;
 				$rs = &$this->_rs2rs($rs); // read entire recordset into memory immediately
@@ -1587,9 +1636,8 @@
 		// ok, set cached object found
 			$rs->connection = &$this; // Pablo suggestion
 			if ($this->debug){ 
-			global $HTTP_SERVER_VARS;
 					
-				$inBrowser = isset($HTTP_SERVER_VARS['HTTP_USER_AGENT']);
+				$inBrowser = isset($_SERVER['HTTP_USER_AGENT']);
 				$ttl = $rs->timeCreated + $secs2cache - time();
 				$s = is_array($sql) ? $sql[0] : $sql;
 				if ($inBrowser) $s = '<i>'.htmlspecialchars($s).'</i>';
@@ -1601,6 +1649,46 @@
 	}
 	
 	
+	/* 
+		Similar to PEAR DB's autoExecute(), except that 
+		$mode can be 'INSERT' or 'UPDATE' or DB_AUTOQUERY_INSERT or DB_AUTOQUERY_UPDATE
+		If $mode == 'UPDATE', then $where is compulsory as a safety measure.
+		
+		$forceUpdate means that even if the data has not changed, perform update.
+	 */
+	function& AutoExecute($table, $fields_values, $mode = 'INSERT', $where = FALSE, $forceUpdate=true, $magicq=false) 
+	{
+		//$flds = array_keys($fields_values);
+		//$fldstr = implode(', ',$flds);
+		$sql = 'SELECT * FROM '.$table;  
+		if ($where!==FALSE) $sql .= ' WHERE '.$where;
+		else if ($mode == 'UPDATE') {
+			ADOConnection::outp('AutoExecute: Illegal mode=UPDATE with empty WHERE clause');
+			return false;
+		}
+
+		$rs =& $this->SelectLimit($sql,1);
+		if (!$rs) return false; // table does not exist
+		
+		switch((string) $mode) {
+		case 'UPDATE':
+		case '2':
+			$sql = $this->GetUpdateSQL($rs, $fields_values, $forceUpdate, $magicq);
+			break;
+		case 'INSERT':
+		case '1':
+			$sql = $this->GetInsertSQL($rs, $fields_values, $magicq);
+			break;
+		default:
+			ADOConnection::outp("AutoExecute: Unknown mode=$mode");
+			return false;
+		}
+		$ret = false;
+		if ($sql) $ret = $this->Execute($sql);
+		return $ret;
+	}
+	
+	
 	/**
 	 * Generates an Update Query based on an existing recordset.
 	 * $arrFields is an associative array of fields with the value
@@ -1629,6 +1717,8 @@
 		return _adodb_getupdatesql($this,$rs,$arrFields,$forceUpdate,$magicq,$force);
 	}
 
+	
+	
 
 	/**
 	 * Generates an Insert Query based on an existing recordset.
@@ -1753,22 +1843,32 @@
 		$this->locale = $locale;
 		switch ($locale)
 		{
-			default:
 			case 'En':
-				$this->fmtDate="Y-m-d";
-				$this->fmtTimeStamp = "Y-m-d H:i:s";
+				$this->fmtDate="'Y-m-d'";
+				$this->fmtTimeStamp = "'Y-m-d H:i:s'";
 				break;
-	
+				
+			case 'Us':
+				$this->fmtDate = "'m-d-Y'";
+				$this->fmtTimeStamp = "'m-d-Y H:i:s'";
+				break;
+				
+			case 'Nl':
 			case 'Fr':
 			case 'Ro':
 			case 'It':
-				$this->fmtDate="d-m-Y";
-				$this->fmtTimeStamp = "d-m-Y H:i:s";
+				$this->fmtDate="'d-m-Y'";
+				$this->fmtTimeStamp = "'d-m-Y H:i:s'";
 				break;
 				
 			case 'Ge':
-				$this->fmtDate="d.m.Y";
-				$this->fmtTimeStamp = "d.m.Y H:i:s";
+				$this->fmtDate="'d.m.Y'";
+				$this->fmtTimeStamp = "'d.m.Y H:i:s'";
+				break;
+				
+			default:
+				$this->fmtDate="'Y-m-d'";
+				$this->fmtTimeStamp = "'Y-m-d H:i:s'";
 				break;
 		}
 	}
@@ -1777,14 +1877,11 @@
 	/**
 	 * Close Connection
 	 */
-	function Close() 
+	function Close()
 	{
-		return $this->_close();
-		
-		// "Simon Lee" <simon@mediaroad.com> reports that persistent connections need 
-		// to be closed too!
-		//if ($this->_isPersistentConnection != true) return $this->_close();
-		//else return true;	
+		$rez = $this->_close();
+		$this->_connectionID = false;
+		return $rez;
 	}
 	
 	/**
@@ -1855,10 +1952,12 @@
 	{
 	global $ADODB_FETCH_MODE;
 	
-		if ($mask) return false;
 		
+		$false = false;
+		if ($mask) {
+			return $false;
+		}
 		if ($this->metaTablesSQL) {
-			// complicated state saving by the need for backward compat
 			$save = $ADODB_FETCH_MODE; 
 			$ADODB_FETCH_MODE = ADODB_FETCH_NUM; 
 			
@@ -1868,7 +1967,7 @@
 			if (isset($savem)) $this->SetFetchMode($savem);
 			$ADODB_FETCH_MODE = $save; 
 			
-			if ($rs === false) return false;
+			if ($rs === false) return $false;
 			$arr =& $rs->GetArray();
 			$arr2 = array();
 			
@@ -1889,7 +1988,7 @@
 			$rs->Close();
 			return $arr2;
 		}
-		return false;
+		return $false;
 	}
 	
 	
@@ -1915,6 +2014,8 @@
 	{
 	global $ADODB_FETCH_MODE;
 		
+		$false = false;
+		
 		if (!empty($this->metaColumnsSQL)) {
 		
 			$schema = false;
@@ -1926,7 +2027,7 @@
 			$rs = $this->Execute(sprintf($this->metaColumnsSQL,($upper)?strtoupper($table):$table));
 			if (isset($savem)) $this->SetFetchMode($savem);
 			$ADODB_FETCH_MODE = $save;
-			if ($rs === false) return false;
+			if ($rs === false || $rs->EOF) return $false;
 
 			$retarr = array();
 			while (!$rs->EOF) { //print_r($rs->fields);
@@ -1947,19 +2048,31 @@
 			$rs->Close();
 			return $retarr;	
 		}
-		return false;
+		return $false;
 	}
 	
     /**
       * List indexes on a table as an array.
-      * @param table        table name to query
-      * @param primary include primary keys.
+      * @param table  table name to query
+      * @param primary true to only show primary keys. Not actually used for most databases
 	  *
-      * @return array of indexes on current table.
+      * @return array of indexes on current table. Each element represents an index, and is itself an associative array.
+	  
+		 Array (
+		    [name_of_index] => Array
+		      (
+	          [unique] => true or false
+	          [columns] => Array
+	          (
+	          	[0] => firstname
+		      	[1] => lastname
+	          )
+		)		
       */
      function &MetaIndexes($table, $primary = false, $owner = false)
      {
-             return FALSE;
+	 		$false = false;
+            return false;
      }
 
 	/**
@@ -1971,8 +2084,10 @@
 	function &MetaColumnNames($table, $numIndexes=false) 
 	{
 		$objarr =& $this->MetaColumns($table);
-		if (!is_array($objarr)) return false;
-		
+		if (!is_array($objarr)) {
+			$false = false;
+			return $false;
+		}
 		$arr = array();
 		if ($numIndexes) {
 			$i = 0;
@@ -2051,6 +2166,12 @@
 	 */
 	function UnixDate($v)
 	{
+		if (is_object($v)) {
+		// odbtp support
+		//( [year] => 2004 [month] => 9 [day] => 4 [hour] => 12 [minute] => 44 [second] => 8 [fraction] => 0 )
+			return adodb_mktime($v->hour,$v->minute,$v->second,$v->month,$v->day, $v->year);
+		}
+	
 		if (is_numeric($v) && strlen($v) !== 8) return $v;
 		if (!preg_match( "|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})|", 
 			($v), $rr)) return false;
@@ -2069,6 +2190,12 @@
 	 */
 	function UnixTimeStamp($v)
 	{
+		if (is_object($v)) {
+		// odbtp support
+		//( [year] => 2004 [month] => 9 [day] => 4 [hour] => 12 [minute] => 44 [second] => 8 [fraction] => 0 )
+			return adodb_mktime($v->hour,$v->minute,$v->second,$v->month,$v->day, $v->year);
+		}
+		
 		if (!preg_match( 
 			"|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})[ ,-]*(([0-9]{1,2}):?([0-9]{1,2}):?([0-9\.]{1,4}))?|", 
 			($v), $rr)) return false;
@@ -2123,6 +2250,11 @@
 		return ($gmt) ? adodb_gmdate($fmt,$tt) : adodb_date($fmt,$tt);
 	}
 	
+	function escape($s,$magic_quotes=false)
+	{
+		return $this->addq($s,$magic_quotes);
+	}
+	
 	/**
 	* Quotes a string, without prefixing nor appending quotes. 
 	*/
@@ -2508,7 +2640,8 @@
 	
 		$cols = $this->_numOfFields;
 		if ($cols < 2) {
-			return false;
+			$false = false;
+			return $false;
 		}
 		$numIndex = isset($this->fields[0]);
 		$results = array();
@@ -2622,14 +2755,7 @@
 	 */
 	function UnixDate($v)
 	{
-		if (is_numeric($v) && strlen($v) !== 8) return $v;
-		if (!preg_match( "|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})|", 
-			($v), $rr)) return false;
-			
-		if ($rr[1] <= TIMESTAMP_FIRST_YEAR || $rr[1] > 10000) return 0;
-		
-		// h-m-s-MM-DD-YY
-		return @adodb_mktime(0,0,0,$rr[2],$rr[3],$rr[1]);
+		return ADOConnection::UnixDate($v);
 	}
 	
 
@@ -2640,15 +2766,7 @@
 	 */
 	function UnixTimeStamp($v)
 	{
-		
-		if (!preg_match( 
-			"|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})[ ,-]*(([0-9]{1,2}):?([0-9]{1,2}):?([0-9\.]{1,4}))?|", 
-			($v), $rr)) return false;
-		if ($rr[1] <= TIMESTAMP_FIRST_YEAR && $rr[2]<= 1) return 0;
-	
-		// h-m-s-MM-DD-YY
-		if (!isset($rr[5])) return  adodb_mktime(0,0,0,$rr[2],$rr[3],$rr[1]);
-		return  @adodb_mktime($rr[5],$rr[6],$rr[7],$rr[2],$rr[3],$rr[1]);
+		return ADOConnection::UnixTimeStamp($v);
 	}
 	
 	
@@ -2686,7 +2804,10 @@
 	*/
 	function &FetchRow()
 	{
-		if ($this->EOF) return false;
+		if ($this->EOF) {
+			$false = false;
+			return $false;
+		}
 		$arr = $this->fields;
 		$this->_currentRow++;
 		if (!$this->_fetch()) $this->EOF = true;
@@ -3000,7 +3121,9 @@
 			}
 		}
 		$i = 0;
-		$o = &$this->_obj;
+		if (PHP_VERSION >= 5) $o = clone($this->_obj);
+		else $o = $this->_obj;
+	
 		for ($i=0; $i <$this->_numOfFields; $i++) {
 			$name = $this->_names[$i];
 			if ($isupper) $n = strtoupper($name);
@@ -3022,7 +3145,7 @@
 	*/
 	function &FetchNextObj()
 	{
-		$o = $this->FetchNextObject(false);
+		$o =& $this->FetchNextObject(false);
 		return $o;
 	}
 	
@@ -3132,6 +3255,9 @@
 		'INT IDENTITY' => 'R',
 		##
 		'INT' => 'I',
+		'INT2' => 'I',
+		'INT4' => 'I',
+		'INT8' => 'I',
 		'INTEGER' => 'I',
 		'INTEGER UNSIGNED' => 'I',
 		'SHORT' => 'I',
@@ -3172,7 +3298,7 @@
 		
 		$tmap = false;
 		$t = strtoupper($t);
-		$tmap = @$typeMap[$t];
+		$tmap = (isset($typeMap[$t])) ? $typeMap[$t] : 'N';
 		switch ($tmap) {
 		case 'C':
 		
@@ -3347,7 +3473,9 @@
 		/* Use associative array to get fields array */
 		function Fields($colname)
 		{
-			if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+			$mode = isset($this->adodbFetchMode) ? $this->adodbFetchMode : $this->fetchMode;
+	
+			if ($mode & ADODB_FETCH_ASSOC) {
 				if (!isset($this->fields[$colname])) $colname = strtolower($colname);
 				return $this->fields[$colname];
 			}
@@ -3449,19 +3577,26 @@
 		if (!$dbType) return false;
 		$db = strtolower($dbType);
 		switch ($db) {
+			case 'ado': 
+				if (PHP_VERSION >= 5) $db = 'ado5';
+				$class = 'ado'; 
+				break;
 			case 'ifx':
-			case 'maxsql': $db = 'mysqlt'; break;
+			case 'maxsql': $class = $db = 'mysqlt'; break;
 			case 'postgres':
-			case 'pgsql': $db = 'postgres7'; break;
+			case 'postgres8':
+			case 'pgsql': $class = $db = 'postgres7'; break;
+			default:
+				$class = $db; break;
 		}
-		@include_once(ADODB_DIR."/drivers/adodb-".$db.".inc.php");
-		$ADODB_LASTDB = $db;
-		
-		$ok = class_exists("ADODB_" . $db);
-		if ($ok) return $db;
 		
-		print_r(get_declared_classes());
 		$file = ADODB_DIR."/drivers/adodb-".$db.".inc.php";
+		@include_once($file);
+		$ADODB_LASTDB = $class;
+		
+		if (class_exists("ADODB_" . $db)) return $class;
+		
+		//ADOConnection::outp(adodb_pr(get_declared_classes(),true));
 		if (!file_exists($file)) ADOConnection::outp("Missing file: $file");
 		else ADOConnection::outp("Syntax error in file: $file");
 		return false;
@@ -3490,7 +3625,7 @@
 		
 		if (!defined('ADODB_ASSOC_CASE')) define('ADODB_ASSOC_CASE',2);
 		$errorfn = (defined('ADODB_ERROR_HANDLER')) ? ADODB_ERROR_HANDLER : false;
-		
+		$false = false;
 		if (strpos($db,'://')) {
 			$origdsn = $db;
 			$dsna = @parse_url($db);
@@ -3498,15 +3633,15 @@
 				// special handling of oracle, which might not have host
 				$db = str_replace('@/','@adodb-fakehost/',$db);
 				$dsna = parse_url($db);
-				if (!$dsna) return false;
+				if (!$dsna) return $false;
 				$dsna['host'] = '';
 			}
 			$db = @$dsna['scheme'];
-			if (!$db) return false;
+			if (!$db) return $false;
 			$dsna['host'] = isset($dsna['host']) ? rawurldecode($dsna['host']) : '';
 			$dsna['user'] = isset($dsna['user']) ? rawurldecode($dsna['user']) : '';
 			$dsna['pass'] = isset($dsna['pass']) ? rawurldecode($dsna['pass']) : '';
-			$dsna['path'] = isset($dsna['path']) ? rawurldecode(substr($dsna['path'],1)) : '';
+			$dsna['path'] = isset($dsna['path']) ? rawurldecode(substr($dsna['path'],1)) : ''; # strip off initial /
 			
 			if (isset($dsna['query'])) {
 				$opt1 = explode('&',$dsna['query']);
@@ -3547,13 +3682,13 @@
 				} else
 					 ADOConnection::outp( "<p>ADONewConnection: Unable to load database driver '$db'</p>",false);
 					
-				return false;
+				return $false;
 			}
 			
 			$cls = 'ADODB_'.$db;
 			if (!class_exists($cls)) {
 				adodb_backtrace();
-				return false;
+				return $false;
 			}
 			
 			$obj =& new $cls();
@@ -3570,6 +3705,7 @@
 					case 'persistent': 	$persist = $v; break;
 					case 'debug':		$obj->debug = (integer) $v; break;
 					#ibase
+					case 'role':		$obj->role = $v; break;
 					case 'dialect': 	$obj->dialect = (integer) $v; break;
 					case 'charset':		$obj->charset = $v; break;
 					case 'buffers':		$obj->buffers = $v; break;
@@ -3581,6 +3717,8 @@
 					#mysqli
 					case 'port': $obj->port = $v; break;
 					case 'socket': $obj->socket = $v; break;
+					#oci8
+					case 'nls_date_format': $obj->NLS_DATE_FORMAT = $v; break;
 					}
 				}
 				if (empty($persist))
@@ -3588,7 +3726,7 @@
 				else
 					$ok = $obj->PConnect($dsna['host'], $dsna['user'], $dsna['pass'], $dsna['path']);
 					
-				if (!$ok) return false;
+				if (!$ok) return $false;
 			}
 		}
 		return $obj;
@@ -3599,53 +3737,53 @@
 	// $perf == true means called by NewPerfMonitor()
 	function _adodb_getdriver($provider,$drivername,$perf=false)
 	{
-		if ($provider !== 'native' && $provider != 'odbc' && $provider != 'ado') 
-			$drivername = $provider;
-		else {
-			if (substr($drivername,0,5) == 'odbc_') $drivername = substr($drivername,5);
-			else if (substr($drivername,0,4) == 'ado_') $drivername = substr($drivername,4);
-			else 
-			switch($drivername) {
-			case 'oracle': $drivername = 'oci8';break;
-			//case 'sybase': $drivername = 'mssql';break;
-			case 'access': 
-						if ($perf) $drivername = '';
-						break;
-			case 'db2':	
-						break;
-			default:
-				$drivername = 'generic';
-				break;
-			}
+		switch ($provider) {
+		case 'odbtp':   if (strncmp('odbtp_',$drivername,6)==0) return substr($drivername,6); 
+		case 'odbc' :   if (strncmp('odbc_',$drivername,5)==0) return substr($drivername,5); 
+		case 'ado'  :   if (strncmp('ado_',$drivername,4)==0) return substr($drivername,4);
+		case 'native':  break;
+		default:
+			return $provider;
+		}
+		
+		switch($drivername) {
+		case 'oracle': $drivername = 'oci8'; break;
+		case 'access': if ($perf) $drivername = ''; break;
+		case 'db2'   : break;
+		case 'sapdb' : break;
+		default:
+			$drivername = 'generic';
+			break;
 		}
-		
 		return $drivername;
 	}
 	
 	function &NewPerfMonitor(&$conn)
 	{
+		$false = false;
 		$drivername = _adodb_getdriver($conn->dataProvider,$conn->databaseType,true);
-		if (!$drivername || $drivername == 'generic') return false;
+		if (!$drivername || $drivername == 'generic') return $false;
 		include_once(ADODB_DIR.'/adodb-perf.inc.php');
 		@include_once(ADODB_DIR."/perf/perf-$drivername.inc.php");
 		$class = "Perf_$drivername";
-		if (!class_exists($class)) return false;
+		if (!class_exists($class)) return $false;
 		$perf =& new $class($conn);
 		
 		return $perf;
 	}
 	
-	function &NewDataDictionary(&$conn)
+	function &NewDataDictionary(&$conn,$drivername=false)
 	{
-		$drivername = _adodb_getdriver($conn->dataProvider,$conn->databaseType);
-		
+		$false = false;
+		if (!$drivername) $drivername = _adodb_getdriver($conn->dataProvider,$conn->databaseType);
+
 		include_once(ADODB_DIR.'/adodb-lib.inc.php');
 		include_once(ADODB_DIR.'/adodb-datadict.inc.php');
 		$path = ADODB_DIR."/datadict/datadict-$drivername.inc.php";
 
 		if (!file_exists($path)) {
 			ADOConnection::outp("Database driver '$path' not available");
-			return false;
+			return $false;
 		}
 		include_once($path);
 		$class = "ADODB2_$drivername";
@@ -3665,12 +3803,20 @@
 	/*
 		Perform a print_r, with pre tags for better formatting.
 	*/
-	function adodb_pr($var)
+	function adodb_pr($var,$as_string=false)
 	{
+		if ($as_string) ob_start();
+		
 		if (isset($_SERVER['HTTP_USER_AGENT'])) { 
 			echo " <pre>\n";print_r($var);echo "</pre>\n";
 		} else
 			print_r($var);
+			
+		if ($as_string) {
+			$s = ob_get_contents();
+			ob_end_clean();
+			return $s;
+		}
 	}
 	
 	/*
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-access.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-access.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-access.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-access.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-db2.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-db2.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-db2.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-db2.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -16,29 +16,29 @@
 	
 	var $databaseType = 'db2';
 	var $seqField = false;
- 	
+	
  	function ActualType($meta)
 	{
 		switch($meta) {
 		case 'C': return 'VARCHAR';
 		case 'XL': return 'CLOB';
 		case 'X': return 'VARCHAR(3600)'; 
-		
+
 		case 'C2': return 'VARCHAR'; // up to 32K
 		case 'X2': return 'VARCHAR(3600)'; // up to 32000, but default page size too small
-		
+
 		case 'B': return 'BLOB';
-			
+
 		case 'D': return 'DATE';
 		case 'T': return 'TIMESTAMP';
-		
+
 		case 'L': return 'SMALLINT';
 		case 'I': return 'INTEGER';
 		case 'I1': return 'SMALLINT';
 		case 'I2': return 'SMALLINT';
 		case 'I4': return 'INTEGER';
 		case 'I8': return 'BIGINT';
-		
+
 		case 'F': return 'DOUBLE';
 		case 'N': return 'DECIMAL';
 		default:
@@ -70,6 +70,73 @@
 		return array();
 	}
 	
+	
+	function xChangeTableSQL($tablename, $flds, $tableoptions = false)
+	{
+		
+		/**
+		  Allow basic table changes to DB2 databases
+		  DB2 will fatally reject changes to non character columns 
+
+		*/
+		
+		$validTypes = array("CHAR","VARC");
+		$invalidTypes = array("BIGI","BLOB","CLOB","DATE", "DECI","DOUB", "INTE", "REAL","SMAL", "TIME");
+		// check table exists
+		$cols = &$this->MetaColumns($tablename);
+		if ( empty($cols)) { 
+			return $this->CreateTableSQL($tablename, $flds, $tableoptions);
+		}
+		
+		// already exists, alter table instead
+		list($lines,$pkey) = $this->_GenFields($flds);
+		$alter = 'ALTER TABLE ' . $this->TableName($tablename);
+		$sql = array();
+		
+		foreach ( $lines as $id => $v ) {
+			if ( isset($cols[$id]) && is_object($cols[$id]) ) {
+				/**
+				  If the first field of $v is the fieldname, and
+				  the second is the field type/size, we assume its an
+				  attempt to modify the column size, so check that it is allowed
+				  $v can have an indeterminate number of blanks between the
+				  fields, so account for that too
+				 */
+				$vargs = explode(' ' , $v);
+				// assume that $vargs[0] is the field name.
+				$i=0;
+				// Find the next non-blank value;
+				for ($i=1;$i<sizeof($vargs);$i++)
+					if ($vargs[$i] != '')
+						break;
+				
+				// if $vargs[$i] is one of the following, we are trying to change the
+				// size of the field, if not allowed, simply ignore the request.
+				if (in_array(substr($vargs[$i],0,4),$invalidTypes)) 
+					continue;
+				// insert the appropriate DB2 syntax
+				if (in_array(substr($vargs[$i],0,4),$validTypes)) {
+					array_splice($vargs,$i,0,array('SET','DATA','TYPE'));
+				}
+
+				// Now Look for the NOT NULL statement as this is not allowed in
+				// the ALTER table statement. If it is in there, remove it
+				if (in_array('NOT',$vargs) && in_array('NULL',$vargs)) {
+					for ($i=1;$i<sizeof($vargs);$i++)
+					if ($vargs[$i] == 'NOT')
+						break;
+					array_splice($vargs,$i,2,'');
+				}
+				$v = implode(' ',$vargs);	
+				$sql[] = $alter . $this->alterCol . ' ' . $v;
+			} else {
+				$sql[] = $alter . $this->addCol . ' ' . $v;
+			}
+		}
+		
+		return $sql;
+	}
+	
 }
 
 
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-firebird.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-firebird.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-firebird.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-firebird.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -21,7 +21,7 @@
 	{
 		switch($meta) {
 		case 'C': return 'VARCHAR';
-		case 'XL':
+		case 'XL': return 'VARCHAR(32000)'; 
 		case 'X': return 'VARCHAR(4000)'; 
 		
 		case 'C2': return 'VARCHAR'; // up to 32K
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-generic.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-generic.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-generic.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-generic.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-ibase.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-ibase.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-ibase.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-ibase.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-informix.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-informix.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-informix.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-informix.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-mssql.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-mssql.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-mssql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-mssql.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -15,8 +15,10 @@
 
 class ADODB2_mssql extends ADODB_DataDict {
 	var $databaseType = 'mssql';
-	
 	var $dropIndex = 'DROP INDEX %2$s.%1$s';
+	var $renameTable = "EXEC sp_rename '%s','%s'";
+	var $renameColumn = "EXEC sp_rename '%s.%s','%s'";
+	//var $alterCol = ' ALTER COLUMN ';
 	
 	function MetaType($t,$len=-1,$fieldobj=false)
 	{
@@ -28,7 +30,7 @@
 		
 		$len = -1; // mysql max_length is not accurate
 		switch (strtoupper($t)) {
-
+		case 'R':
 		case 'INT': 
 		case 'INTEGER': return  'I';
 		case 'BIT':
@@ -45,10 +47,10 @@
 	function ActualType($meta)
 	{
 		switch(strtoupper($meta)) {
+
 		case 'C': return 'VARCHAR';
-		case 'XL':
-		case 'X': return 'TEXT';
-		
+		case 'XL': return 'TEXT';
+		case 'X': return 'VARCHAR(4000)'; ## could be varchar(8000), but we want compat with oracle
 		case 'C2': return 'NVARCHAR';
 		case 'X2': return 'NTEXT';
 		
@@ -58,6 +60,7 @@
 		case 'T': return 'DATETIME';
 		case 'L': return 'BIT';
 		
+		case 'R':		
 		case 'I': return 'INT'; 
 		case 'I1': return 'TINYINT';
 		case 'I2': return 'SMALLINT';
@@ -81,7 +84,7 @@
 		foreach($lines as $v) {
 			$f[] = "\n $v";
 		}
-		$s .= implode(',',$f);
+		$s .= implode(', ',$f);
 		$sql[] = $s;
 		return $sql;
 	}
@@ -108,9 +111,9 @@
 		$f = array();
 		$s = 'ALTER TABLE ' . $tabname;
 		foreach($flds as $v) {
-			$f[] = "\n$this->dropCol $v";
+			$f[] = "\n$this->dropCol ".$this->NameQuote($v);
 		}
-		$s .= implode(',',$f);
+		$s .= implode(', ',$f);
 		$sql[] = $s;
 		return $sql;
 	}
@@ -239,12 +242,9 @@
 		case 'BIGINT':
 			return $ftype;
 		}
-		if (strlen($fsize) && $ty != 'X' && $ty != 'B' && strpos($ftype,'(') === false) {
-			$ftype .= "(".$fsize;
-			if (strlen($fprec)) $ftype .= ",".$fprec;
-			$ftype .= ')';
-		}
-		return $ftype;
+    	if ($ty == 'T') return $ftype;
+    	return parent::_GetSize($ftype, $ty, $fsize, $fprec);    
+
 	}
 }
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-mysql.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-mysql.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-mysql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-mysql.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -20,6 +20,7 @@
 	var $dropTable = 'DROP TABLE IF EXISTS %s'; // requires mysql 3.22 or later
 	
 	var $dropIndex = 'DROP INDEX %s ON %s';
+	var $renameColumn = 'ALTER TABLE %s CHANGE COLUMN %s %s %s';	// needs column-definition!
 	
 	function MetaType($t,$len=-1,$fieldobj=false)
 	{
@@ -28,6 +29,7 @@
 			$t = $fieldobj->type;
 			$len = $fieldobj->max_length;
 		}
+		$is_serial = is_object($fieldobj) && $fieldobj->primary_key && $fieldobj->auto_increment;
 		
 		$len = -1; // mysql max_length is not accurate
 		switch (strtoupper($t)) {
@@ -65,11 +67,11 @@
 			return 'F';
 			
 		case 'INT': 
-		case 'INTEGER': return (!empty($fieldobj->primary_key)) ? 'R' : 'I';
-		case 'TINYINT': return (!empty($fieldobj->primary_key)) ? 'R' : 'I1';
-		case 'SMALLINT': return (!empty($fieldobj->primary_key)) ? 'R' : 'I2';
-		case 'MEDIUMINT': return (!empty($fieldobj->primary_key)) ? 'R' : 'I4';
-		case 'BIGINT':  return (!empty($fieldobj->primary_key)) ? 'R' : 'I8';
+		case 'INTEGER': return $is_serial ? 'R' : 'I';
+		case 'TINYINT': return $is_serial ? 'R' : 'I1';
+		case 'SMALLINT': return $is_serial ? 'R' : 'I2';
+		case 'MEDIUMINT': return $is_serial ? 'R' : 'I4';
+		case 'BIGINT':  return $is_serial ? 'R' : 'I8';
 		default: return 'N';
 		}
 	}
@@ -78,8 +80,8 @@
 	{
 		switch(strtoupper($meta)) {
 		case 'C': return 'VARCHAR';
-		case 'XL':
-		case 'X': return 'LONGTEXT';
+		case 'XL':return 'LONGTEXT';
+		case 'X': return 'TEXT';
 		
 		case 'C2': return 'VARCHAR';
 		case 'X2': return 'LONGTEXT';
@@ -91,10 +93,10 @@
 		case 'L': return 'TINYINT';
 		
 		case 'R':
+		case 'I4':
 		case 'I': return 'INTEGER';
 		case 'I1': return 'TINYINT';
 		case 'I2': return 'SMALLINT';
-		case 'I4': return 'MEDIUMINT';
 		case 'I8': return 'BIGINT';
 		
 		case 'F': return 'DOUBLE';
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-oci8.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-oci8.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-oci8.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-oci8.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -20,6 +20,7 @@
 	var $seqPrefix = 'SEQ_';
 	var $dropTable = "DROP TABLE %s CASCADE CONSTRAINTS";
 	var $trigPrefix = 'TRIG_';
+	var $alterCol = ' MODIFY ';
 	
 	function MetaType($t,$len=-1)
 	{
@@ -113,7 +114,7 @@
 			$f[] = "\n $v";
 		}
 		
-		$s .= implode(',',$f).')';
+		$s .= implode(', ',$f).')';
 		$sql[] = $s;
 		return $sql;
 	}
@@ -126,7 +127,7 @@
 		foreach($lines as $v) {
 			$f[] = "\n $v";
 		}
-		$s .= implode(',',$f).')';
+		$s .= implode(', ',$f).')';
 		$sql[] = $s;
 		return $sql;
 	}
@@ -134,9 +135,11 @@
 	function DropColumnSQL($tabname, $flds)
 	{
 		if (!is_array($flds)) $flds = explode(',',$flds);
+		foreach ($flds as $k => $v) $flds[$k] = $this->NameQuote($v);
+		
 		$sql = array();
 		$s = "ALTER TABLE $tabname DROP(";
-		$s .= implode(',',$flds).') CASCADE COSTRAINTS';
+		$s .= implode(', ',$flds).') CASCADE CONSTRAINTS';
 		$sql[] = $s;
 		return $sql;
 	}
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-postgres.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-postgres.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-postgres.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-postgres.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -20,6 +20,7 @@
 	var $seqPrefix = 'SEQ_';
 	var $addCol = ' ADD COLUMN';
 	var $quote = '"';
+	var $renameTable = 'ALTER TABLE %s RENAME TO %s'; // at least since 7.1
 	
 	function MetaType($t,$len=-1,$fieldobj=false)
 	{
@@ -28,6 +29,9 @@
 			$t = $fieldobj->type;
 			$len = $fieldobj->max_length;
 		}
+		$is_serial = is_object($fieldobj) && $fieldobj->primary_key && $fieldobj->unique && 
+			$fieldobj->has_default && substr($fieldobj->default_value,0,8) == 'nextval(';
+		
 		switch (strtoupper($t)) {
 			case 'INTERVAL':
 			case 'CHAR':
@@ -60,12 +64,12 @@
 			case 'TIMESTAMPTZ':
 				return 'T';
 			
-			case 'INTEGER': return (empty($fieldobj->primary_key) && empty($fieldobj->unique))? 'I' : 'R';
+			case 'INTEGER': return !$is_serial ? 'I' : 'R';
 			case 'SMALLINT': 
-			case 'INT2': return (empty($fieldobj->primary_key) && empty($fieldobj->unique))? 'I2' : 'R';
-			case 'INT4': return (empty($fieldobj->primary_key) && empty($fieldobj->unique))? 'I4' : 'R';
+			case 'INT2': return !$is_serial ? 'I2' : 'R';
+			case 'INT4': return !$is_serial ? 'I4' : 'R';
 			case 'BIGINT': 
-			case 'INT8': return (empty($fieldobj->primary_key) && empty($fieldobj->unique))? 'I8' : 'R';
+			case 'INT8': return !$is_serial ? 'I8' : 'R';
 				
 			case 'OID':
 			case 'SERIAL':
@@ -111,23 +115,150 @@
 		}
 	}
 	
-	/* The following does not work in Pg 6.0 - does anyone want to contribute code? 
+	/**
+	 * Adding a new Column 
+	 *
+	 * reimplementation of the default function as postgres does NOT allow to set the default in the same statement
+	 *
+	 * @param string $tabname table-name
+	 * @param string $flds column-names and types for the changed columns
+	 * @return array with SQL strings
+	 */
+	function AddColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		$sql = array();
+		list($lines,$pkey) = $this->_GenFields($flds);
+		$alter = 'ALTER TABLE ' . $tabname . $this->addCol . ' ';
+		foreach($lines as $v) {
+			if (($not_null = preg_match('/NOT NULL/i',$v))) {
+				$v = preg_replace('/NOT NULL/i','',$v);
+			}
+			if (preg_match('/^([^ ]+) .*(DEFAULT [^ ]+)/',$v,$matches)) {
+				list(,$colname,$default) = $matches;
+				$sql[] = $alter . str_replace($default,'',$v);
+				$sql[] = 'ALTER TABLE '.$tabname.' ALTER COLUMN '.$colname.' SET ' . $default;
+			} else {				
+				$sql[] = $alter . $v;
+			}
+			if ($not_null) {
+				list($colname) = explode(' ',$v);
+				$sql[] = 'ALTER TABLE '.$tabname.' ALTER COLUMN '.$colname.' SET NOT NULL';
+			}
+		}
+		return $sql;
+	}
+	
+	/**
+	 * Change the definition of one column
+	 *
+	 * Postgres can't do that on it's own, you need to supply the complete defintion of the new table,
+	 * to allow, recreating the table and copying the content over to the new table
+	 * @param string $tabname table-name
+	 * @param string $flds column-name and type for the changed column
+	 * @param string $tableflds complete defintion of the new table, eg. for postgres, default ''
+	 * @param array/ $tableoptions options for the new table see CreateTableSQL, default ''
+	 * @return array with SQL strings
+	 */
+	function AlterColumnSQL($tabname, $flds, $tableflds='',$tableoptions='')
+	{
+		if (!$tableflds) {
+			if ($this->debug) ADOConnection::outp("AlterColumnSQL needs a complete table-definiton for PostgreSQL");
+			return array();
+		}
+		return $this->_recreate_copy_table($tabname,False,$tableflds,$tableoptions);
+	}
 	
-	//"ALTER TABLE table ALTER COLUMN column SET DEFAULT mydef" and
-	//"ALTER TABLE table ALTER COLUMN column DROP DEFAULT mydef"
-	//"ALTER TABLE table ALTER COLUMN column SET NOT NULL" and
-	//"ALTER TABLE table ALTER COLUMN column DROP NOT NULL"*/
-	function AlterColumnSQL($tabname, $flds)
+	/**
+	 * Drop one column
+	 *
+	 * Postgres < 7.3 can't do that on it's own, you need to supply the complete defintion of the new table,
+	 * to allow, recreating the table and copying the content over to the new table
+	 * @param string $tabname table-name
+	 * @param string $flds column-name and type for the changed column
+	 * @param string $tableflds complete defintion of the new table, eg. for postgres, default ''
+	 * @param array/ $tableoptions options for the new table see CreateTableSQL, default ''
+	 * @return array with SQL strings
+	 */
+	function DropColumnSQL($tabname, $flds, $tableflds='',$tableoptions='')
 	{
-		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported for PostgreSQL");
+		$has_drop_column = 7.3 <= (float) @$this->serverInfo['version'];
+		if (!$has_drop_column && !$tableflds) {
+			if ($this->debug) ADOConnection::outp("DropColumnSQL needs complete table-definiton for PostgreSQL < 7.3");
 		return array();
 	}
+		if ($has_drop_column) {
+			return ADODB_DataDict::DropColumnSQL($tabname, $flds);
+		}
+		return $this->_recreate_copy_table($tabname,$flds,$tableflds,$tableoptions);
+	}
 	
+	/**
+	 * Save the content into a temp. table, drop and recreate the original table and copy the content back in
+	 *
+	 * We also take care to set the values of the sequenz and recreate the indexes.
+	 * All this is done in a transaction, to not loose the content of the table, if something went wrong!
+	 * @internal
+	 * @param string $tabname table-name
+	 * @param string $dropflds column-names to drop
+	 * @param string $tableflds complete defintion of the new table, eg. for postgres
+	 * @param array/string $tableoptions options for the new table see CreateTableSQL, default ''
+	 * @return array with SQL strings
+	 */
+	function _recreate_copy_table($tabname,$dropflds,$tableflds,$tableoptions='')
+	{
+		if ($dropflds && !is_array($dropflds)) $dropflds = explode(',',$dropflds);
+		$copyflds = array();
+		foreach($this->MetaColumns($tabname) as $fld) {
+			if (!$dropflds || !in_array($fld->name,$dropflds)) {
+				// we need to explicit convert varchar to a number to be able to do an AlterColumn of a char column to a nummeric one
+				if (preg_match('/'.$fld->name.' (I|I2|I4|I8|N|F)/i',$tableflds,$matches) && 
+					in_array($fld->type,array('varchar','char','text','bytea'))) {
+					$copyflds[] = "to_number($fld->name,'S99D99')";
+				} else {
+					$copyflds[] = $fld->name;
+				}
+				// identify the sequence name and the fld its on
+				if ($fld->primary_key && $fld->has_default && 
+					preg_match("/nextval\('([^']+)'::text\)/",$fld->default_value,$matches)) {
+					$seq_name = $matches[1];
+					$seq_fld = $fld->name;
+				}
+			}
+		}
+		$copyflds = implode(', ',$copyflds);
+		
+		$tempname = $tabname.'_tmp';
+		$aSql[] = 'BEGIN';		// we use a transaction, to make sure not to loose the content of the table
+		$aSql[] = "SELECT * INTO TEMPORARY TABLE $tempname FROM $tabname";
+		$aSql = array_merge($aSql,$this->DropTableSQL($tabname));
+		$aSql = array_merge($aSql,$this->CreateTableSQL($tabname,$tableflds,$tableoptions));
+		$aSql[] = "INSERT INTO $tabname SELECT $copyflds FROM $tempname";
+		if ($seq_name && $seq_fld) {	// if we have a sequence we need to set it again
+			$seq_name = $tabname.'_'.$seq_fld.'_seq';	// has to be the name of the new implicit sequence
+			$aSql[] = "SELECT setval('$seq_name',MAX($seq_fld)) FROM $tabname";
+		}
+		$aSql[] = "DROP TABLE $tempname";
+		// recreate the indexes, if they not contain one of the droped columns
+		foreach($this->MetaIndexes($tabname) as $idx_name => $idx_data)
+		{
+			if (substr($idx_name,-5) != '_pkey' && (!$dropflds || !count(array_intersect($dropflds,$idx_data['columns'])))) {
+				$aSql = array_merge($aSql,$this->CreateIndexSQL($idx_name,$tabname,$idx_data['columns'],
+					$idx_data['unique'] ? array('UNIQUE') : False));
+			}
+		}
+		$aSql[] = 'COMMIT';
+		return $aSql;
+	}
 	
-	function DropColumnSQL($tabname, $flds)
+	function DropTableSQL($tabname)
 	{
-		if ($this->debug) ADOConnection::outp("DropColumnSQL only works with PostgreSQL 7.3+");
-		return ADODB_DataDict::DropColumnSQL($tabname, $flds)."/* only works for PostgreSQL 7.3+ */";
+		$sql = ADODB_DataDict::DropTableSQL($tabname);
+		
+		$drop_seq = $this->_DropAutoIncrement($tabname);
+		if ($drop_seq) $sql[] = $drop_seq;
+		
+		return $sql;
 	}
 
 	// return string must begin with space
@@ -144,9 +275,20 @@
 		return $suffix;
 	}
 	
-	function _DropAutoIncrement($t)
+	// search for a sequece for the given table (asumes the seqence-name contains the table-name!)
+	// if yes return sql to drop it
+	// this is still necessary if postgres < 7.3 or the SERIAL was created on an earlier version!!!
+	function _DropAutoIncrement($tabname)
 	{
-		return "drop sequence ".$t."_m_id_seq";
+		$tabname = $this->connection->quote('%'.$tabname.'%');
+
+		$seq = $this->connection->GetOne("SELECT relname FROM pg_class WHERE NOT relname ~ 'pg_.*' AND relname LIKE $tabname AND relkind='S'");
+
+		// check if a tables depends on the sequenz and it therefor cant and dont need to be droped separatly
+		if (!$seq || $this->connection->GetOne("SELECT relname FROM pg_class JOIN pg_depend ON pg_class.relfilenode=pg_depend.objid WHERE relname='$seq' AND relkind='S' AND deptype='i'")) {
+			return False;
+		}
+		return "DROP SEQUENCE ".$seq;
 	}
 	
 	/*
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-sapdb.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-sapdb.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-sapdb.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-sapdb.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -0,0 +1,121 @@
+<?php
+
+/**
+  V4.50 6 July 2004  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+	
+  Set tabs to 4 for best viewing.
+  
+  Modified from datadict-generic.inc.php for sapdb by RalfBecker-AT-outdoor-training.de
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+class ADODB2_sapdb extends ADODB_DataDict {
+	
+	var $databaseType = 'sapdb';
+	var $seqField = false;	
+	var $renameColumn = 'RENAME COLUMN %s.%s TO %s';
+ 	
+ 	function ActualType($meta)
+	{
+		switch($meta) {
+		case 'C': return 'VARCHAR';
+		case 'XL':
+		case 'X': return 'LONG';
+		
+		case 'C2': return 'VARCHAR UNICODE';
+		case 'X2': return 'LONG UNICODE';
+		
+		case 'B': return 'LONG';
+			
+		case 'D': return 'DATE';
+		case 'T': return 'TIMESTAMP';
+		
+		case 'L': return 'BOOLEAN';
+		case 'I': return 'INTEGER';
+		case 'I1': return 'FIXED(3)';
+		case 'I2': return 'SMALLINT';
+		case 'I4': return 'INTEGER';
+		case 'I8': return 'FIXED(20)';
+		
+		case 'F': return 'FLOAT(38)';
+		case 'N': return 'FIXED';
+		default:
+			return $meta;
+		}
+	}
+	
+	function MetaType($t,$len=-1,$fieldobj=false)
+	{
+		if (is_object($t)) {
+			$fieldobj = $t;
+			$t = $fieldobj->type;
+			$len = $fieldobj->max_length;
+		}
+		static $maxdb_type2adodb = array(
+			'VARCHAR'	=> 'C',
+			'CHARACTER'	=> 'C',
+			'LONG'		=> 'X',		// no way to differ between 'X' and 'B' :-(
+			'DATE'		=> 'D',
+			'TIMESTAMP'	=> 'T',
+			'BOOLEAN'	=> 'L',
+			'INTEGER'	=> 'I4',
+			'SMALLINT'	=> 'I2',
+			'FLOAT'		=> 'F',
+			'FIXED'		=> 'N',
+		);
+		$type = isset($maxdb_type2adodb[$t]) ? $maxdb_type2adodb[$t] : 'C';
+
+		// convert integer-types simulated with fixed back to integer
+		if ($t == 'FIXED' && !$fieldobj->scale && ($len == 20 || $len == 3)) {
+			$type = $len == 20 ? 'I8' : 'I1';
+		}
+		if ($fieldobj->auto_increment) $type = 'R';
+
+		return $type;
+	}
+	
+	// return string must begin with space
+	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	{	
+		$suffix = '';
+		if ($funsigned) $suffix .= ' UNSIGNED';
+		if ($fnotnull) $suffix .= ' NOT NULL';
+		if ($fautoinc) $suffix .= ' DEFAULT SERIAL';
+		elseif (strlen($fdefault)) $suffix .= " DEFAULT $fdefault";
+		if ($fconstraint) $suffix .= ' '.$fconstraint;
+		return $suffix;
+	}
+
+	function AddColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		$sql = array();
+		list($lines,$pkey) = $this->_GenFields($flds);
+		return array( 'ALTER TABLE ' . $tabname . ' ADD (' . implode(', ',$lines) . ')' );
+	}
+	
+	function AlterColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		$sql = array();
+		list($lines,$pkey) = $this->_GenFields($flds);
+		return array( 'ALTER TABLE ' . $tabname . ' MODIFY (' . implode(', ',$lines) . ')' );
+	}
+
+	function DropColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		if (!is_array($flds)) $flds = explode(',',$flds);
+		foreach($flds as $k => $v) {
+			$flds[$k] = $this->NameQuote($v);
+		}
+		return array( 'ALTER TABLE ' . $tabname . ' DROP (' . implode(', ',$flds) . ')' );
+	}	
+}
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/datadict/datadict-sybase.inc.php zentrack_2-5-5-1/includes/adodb/datadict/datadict-sybase.inc.php
--- zentrack_2-5-0-1/includes/adodb/datadict/datadict-sybase.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/datadict/datadict-sybase.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -81,7 +81,7 @@
 		foreach($lines as $v) {
 			$f[] = "\n $v";
 		}
-		$s .= implode(',',$f);
+		$s .= implode(', ',$f);
 		$sql[] = $s;
 		return $sql;
 	}
@@ -100,14 +100,14 @@
 	
 	function DropColumnSQL($tabname, $flds)
 	{
-		$tabname = $this->TableName ($tabname);
+		$tabname = $this->TableName($tabname);
 		if (!is_array($flds)) $flds = explode(',',$flds);
 		$f = array();
 		$s = "ALTER TABLE $tabname";
 		foreach($flds as $v) {
-			$f[] = "\n$this->dropCol $v";
+			$f[] = "\n$this->dropCol ".$this->NameQuote($v);
 		}
-		$s .= implode(',',$f);
+		$s .= implode(', ',$f);
 		$sql[] = $s;
 		return $sql;
 	}
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-access.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-access.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-access.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-access.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -172,7 +172,7 @@
 	function &MetaColumns($table)
 	{
 		$table = strtoupper($table);
-		$arr= array();
+		$arr = array();
 		$dbc = $this->_connectionID;
 		
 		$adors=@$dbc->OpenSchema(4);//tables
@@ -196,8 +196,8 @@
 			}
 			$adors->Close();
 		}
-		
-		return $arr;
+		$false = false;
+		return empty($arr) ? $false : $arr;
 	}
 	
 
@@ -208,6 +208,7 @@
 	{
 		
 		$dbc = $this->_connectionID;
+		$false = false;
 		
 	//	return rs	
 		if ($inputarr) {
@@ -230,21 +231,19 @@
 			$p = false;
 			$rs = $oCmd->Execute();
 			$e = $dbc->Errors;
-			if ($dbc->Errors->Count > 0) return false;
+			if ($dbc->Errors->Count > 0) return $false;
 			return $rs;
 		}
 		
 		$rs = @$dbc->Execute($sql,$this->_affectedRows, $this->_execute_option);
-		/*
-			$rs =  new COM('ADODB.Recordset');
-			if ($rs) {
-				$rs->Open ($sql, $dbc, $this->_cursor_type,$this->_lock_type, $this->_execute_option);							
-			}
-		*/
-		if ($dbc->Errors->Count > 0) return false;
-		if (! $rs) return false;
+
+		if ($dbc->Errors->Count > 0) return $false;
+		if (! $rs) return $false;
 		
-		if ($rs->State == 0) return true; // 0 = adStateClosed means no records returned
+		if ($rs->State == 0) {
+			$true = true;
+			return $true; // 0 = adStateClosed means no records returned
+		}
 		return $rs;
 	}
 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado5.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado5.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado5.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado5.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -0,0 +1,636 @@
+<?php
+/* 
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. 
+Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+	Microsoft ADO data driver. Requires ADO. Works only on MS Windows. PHP5 compat version.
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+	
+define("_ADODB_ADO_LAYER", 1 );
+/*--------------------------------------------------------------------------------------
+--------------------------------------------------------------------------------------*/
+
+	
+class ADODB_ado extends ADOConnection {
+	var $databaseType = "ado";	
+	var $_bindInputArray = false;
+	var $fmtDate = "'Y-m-d'";
+	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
+	var $replaceQuote = "''"; // string to use to replace quotes
+	var $dataProvider = "ado";	
+	var $hasAffectedRows = true;
+	var $adoParameterType = 201; // 201 = long varchar, 203=long wide varchar, 205 = long varbinary
+	var $_affectedRows = false;
+	var $_thisTransactions;
+	var $_cursor_type = 3; // 3=adOpenStatic,0=adOpenForwardOnly,1=adOpenKeyset,2=adOpenDynamic
+	var $_cursor_location = 3; // 2=adUseServer, 3 = adUseClient;
+	var $_lock_type = -1;
+	var $_execute_option = -1;
+	var $poorAffectedRows = true; 
+	var $charPage;
+		
+	function ADODB_ado() 
+	{ 	
+		$this->_affectedRows = new VARIANT;
+	}
+
+	function ServerInfo()
+	{
+		if (!empty($this->_connectionID)) $desc = $this->_connectionID->provider;
+		return array('description' => $desc, 'version' => '');
+	}
+	
+	function _affectedrows()
+	{
+		if (PHP_VERSION >= 5) return $this->_affectedRows;
+		
+		return $this->_affectedRows->value;
+	}
+	
+	// you can also pass a connection string like this:
+	//
+	// $DB->Connect('USER ID=sa;PASSWORD=pwd;SERVER=mangrove;DATABASE=ai',false,false,'SQLOLEDB');
+	function _connect($argHostname, $argUsername, $argPassword, $argProvider= 'MSDASQL')
+	{
+		try {
+		$u = 'UID';
+		$p = 'PWD';
+	
+		if (!empty($this->charPage))
+			$dbc = new COM('ADODB.Connection',null,$this->charPage);
+		else
+			$dbc = new COM('ADODB.Connection');
+			
+		if (! $dbc) return false;
+
+		/* special support if provider is mssql or access */
+		if ($argProvider=='mssql') {
+			$u = 'User Id';  //User parameter name for OLEDB
+			$p = 'Password'; 
+			$argProvider = "SQLOLEDB"; // SQL Server Provider
+			
+			// not yet
+			//if ($argDatabasename) $argHostname .= ";Initial Catalog=$argDatabasename";
+			
+			//use trusted conection for SQL if username not specified
+			if (!$argUsername) $argHostname .= ";Trusted_Connection=Yes";
+		} else if ($argProvider=='access')
+			$argProvider = "Microsoft.Jet.OLEDB.4.0"; // Microsoft Jet Provider
+		
+		if ($argProvider) $dbc->Provider = $argProvider;	
+		
+		if ($argUsername) $argHostname .= ";$u=$argUsername";
+		if ($argPassword)$argHostname .= ";$p=$argPassword";
+		
+		if ($this->debug) ADOConnection::outp( "Host=".$argHostname."<BR>\n version=$dbc->version");
+		// @ added below for php 4.0.1 and earlier
+		@$dbc->Open((string) $argHostname);
+		
+		$this->_connectionID = $dbc;
+		
+		$dbc->CursorLocation = $this->_cursor_location;
+		return  $dbc->State > 0;
+		} catch (exception $e) {
+		}
+		
+		return false;
+	}
+	
+	// returns true or false
+	function _pconnect($argHostname, $argUsername, $argPassword, $argProvider='MSDASQL')
+	{
+		return $this->_connect($argHostname,$argUsername,$argPassword,$argProvider);
+	}	
+	
+/*
+	adSchemaCatalogs	= 1,
+	adSchemaCharacterSets	= 2,
+	adSchemaCollations	= 3,
+	adSchemaColumns	= 4,
+	adSchemaCheckConstraints	= 5,
+	adSchemaConstraintColumnUsage	= 6,
+	adSchemaConstraintTableUsage	= 7,
+	adSchemaKeyColumnUsage	= 8,
+	adSchemaReferentialContraints	= 9,
+	adSchemaTableConstraints	= 10,
+	adSchemaColumnsDomainUsage	= 11,
+	adSchemaIndexes	= 12,
+	adSchemaColumnPrivileges	= 13,
+	adSchemaTablePrivileges	= 14,
+	adSchemaUsagePrivileges	= 15,
+	adSchemaProcedures	= 16,
+	adSchemaSchemata	= 17,
+	adSchemaSQLLanguages	= 18,
+	adSchemaStatistics	= 19,
+	adSchemaTables	= 20,
+	adSchemaTranslations	= 21,
+	adSchemaProviderTypes	= 22,
+	adSchemaViews	= 23,
+	adSchemaViewColumnUsage	= 24,
+	adSchemaViewTableUsage	= 25,
+	adSchemaProcedureParameters	= 26,
+	adSchemaForeignKeys	= 27,
+	adSchemaPrimaryKeys	= 28,
+	adSchemaProcedureColumns	= 29,
+	adSchemaDBInfoKeywords	= 30,
+	adSchemaDBInfoLiterals	= 31,
+	adSchemaCubes	= 32,
+	adSchemaDimensions	= 33,
+	adSchemaHierarchies	= 34,
+	adSchemaLevels	= 35,
+	adSchemaMeasures	= 36,
+	adSchemaProperties	= 37,
+	adSchemaMembers	= 38
+
+*/
+	
+	function &MetaTables()
+	{
+		$arr= array();
+		$dbc = $this->_connectionID;
+		
+		$adors=@$dbc->OpenSchema(20);//tables
+		if ($adors){
+			$f = $adors->Fields(2);//table/view name
+			$t = $adors->Fields(3);//table type
+			while (!$adors->EOF){
+				$tt=substr($t->value,0,6);
+				if ($tt!='SYSTEM' && $tt !='ACCESS')
+					$arr[]=$f->value;
+				//print $f->value . ' ' . $t->value.'<br>';
+				$adors->MoveNext();
+			}
+			$adors->Close();
+		}
+		
+		return $arr;
+	}
+	
+	function &MetaColumns($table)
+	{
+		$table = strtoupper($table);
+		$arr= array();
+		$dbc = $this->_connectionID;
+		
+		$adors=@$dbc->OpenSchema(4);//tables
+	
+		if ($adors){
+			$t = $adors->Fields(2);//table/view name
+			while (!$adors->EOF){
+				
+				
+				if (strtoupper($t->Value) == $table) {
+				
+					$fld = new ADOFieldObject();
+					$c = $adors->Fields(3);
+					$fld->name = $c->Value;
+					$fld->type = 'CHAR'; // cannot discover type in ADO!
+					$fld->max_length = -1;
+					$arr[strtoupper($fld->name)]=$fld;
+				}
+		
+				$adors->MoveNext();
+			}
+			$adors->Close();
+		}
+		
+		return $arr;
+	}
+	
+
+
+	
+	/* returns queryID or false */
+	function &_query($sql,$inputarr=false) 
+	{
+		try { // In PHP5, all COM errors are exceptions, so to maintain old behaviour...
+		
+		$dbc = $this->_connectionID;
+		
+	//	return rs	
+		if ($inputarr) {
+			
+			if (!empty($this->charPage))
+				$oCmd = new COM('ADODB.Command',null,$this->charPage);
+			else
+				$oCmd = new COM('ADODB.Command');
+			$oCmd->ActiveConnection = $dbc;
+			$oCmd->CommandText = $sql;
+			$oCmd->CommandType = 1;
+
+			foreach($inputarr as $val) {
+				// name, type, direction 1 = input, len,
+				$this->adoParameterType = 130;
+				$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,strlen($val),$val);
+				//print $p->Type.' '.$p->value;
+				$oCmd->Parameters->Append($p);
+			}
+			$p = false;
+			$rs = $oCmd->Execute();
+			$e = $dbc->Errors;
+			if ($dbc->Errors->Count > 0) return false;
+			return $rs;
+		}
+		
+		$rs = @$dbc->Execute($sql,$this->_affectedRows, $this->_execute_option);
+			
+		if ($dbc->Errors->Count > 0) return false;
+		if (! $rs) return false;
+		
+		if ($rs->State == 0) return true; // 0 = adStateClosed means no records returned
+		return $rs;
+		
+		} catch (exception $e) {
+			
+		}
+		return false;
+	}
+
+	
+	function BeginTrans() 
+	{ 
+		if ($this->transOff) return true;
+		
+		if (isset($this->_thisTransactions))
+			if (!$this->_thisTransactions) return false;
+		else {
+			$o = $this->_connectionID->Properties("Transaction DDL");
+			$this->_thisTransactions = $o ? true : false;
+			if (!$o) return false;
+		}
+		@$this->_connectionID->BeginTrans();
+		$this->transCnt += 1;
+		return true;
+	}
+	function CommitTrans($ok=true) 
+	{ 
+		if (!$ok) return $this->RollbackTrans();
+		if ($this->transOff) return true;
+		
+		@$this->_connectionID->CommitTrans();
+		if ($this->transCnt) @$this->transCnt -= 1;
+		return true;
+	}
+	function RollbackTrans() {
+		if ($this->transOff) return true;
+		@$this->_connectionID->RollbackTrans();
+		if ($this->transCnt) @$this->transCnt -= 1;
+		return true;
+	}
+	
+	/*	Returns: the last error message from previous database operation	*/	
+
+	function ErrorMsg() 
+	{
+		$errc = $this->_connectionID->Errors;
+		if ($errc->Count == 0) return '';
+		$err = $errc->Item($errc->Count-1);
+		return $err->Description;
+	}
+	
+	function ErrorNo() 
+	{
+		$errc = $this->_connectionID->Errors;
+		if ($errc->Count == 0) return 0;
+		$err = $errc->Item($errc->Count-1);
+		return $err->NativeError;
+	}
+
+	// returns true or false
+	function _close()
+	{
+		if ($this->_connectionID) $this->_connectionID->Close();
+		$this->_connectionID = false;
+		return true;
+	}
+	
+	
+}
+	
+/*--------------------------------------------------------------------------------------
+	 Class Name: Recordset
+--------------------------------------------------------------------------------------*/
+
+class ADORecordSet_ado extends ADORecordSet {	
+	
+	var $bind = false;
+	var $databaseType = "ado";	
+	var $dataProvider = "ado";	
+	var $_tarr = false; // caches the types
+	var $_flds; // and field objects
+	var $canSeek = true;
+  	var $hideErrors = true;
+		  
+	function ADORecordSet_ado($id,$mode=false)
+	{
+		if ($mode === false) { 
+			global $ADODB_FETCH_MODE;
+			$mode = $ADODB_FETCH_MODE;
+		}
+		$this->fetchMode = $mode;
+		return $this->ADORecordSet($id,$mode);
+	}
+
+
+	// returns the field object
+	function FetchField($fieldOffset = -1) {
+		$off=$fieldOffset+1; // offsets begin at 1
+		
+		$o= new ADOFieldObject();
+		$rs = $this->_queryID;
+		$f = $rs->Fields($fieldOffset);
+		$o->name = $f->Name;
+		$t = $f->Type;
+		$o->type = $this->MetaType($t);
+		$o->max_length = $f->DefinedSize;
+		$o->ado_type = $t;
+		
+
+		//print "off=$off name=$o->name type=$o->type len=$o->max_length<br>";
+		return $o;
+	}
+	
+	/* Use associative array to get fields array */
+	function Fields($colname)
+	{
+		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
+		if (!$this->bind) {
+			$this->bind = array();
+			for ($i=0; $i < $this->_numOfFields; $i++) {
+				$o = $this->FetchField($i);
+				$this->bind[strtoupper($o->name)] = $i;
+			}
+		}
+		
+		 return $this->fields[$this->bind[strtoupper($colname)]];
+	}
+
+		
+	function _initrs()
+	{
+		$rs = $this->_queryID;
+		$this->_numOfRows = $rs->RecordCount;
+		
+		$f = $rs->Fields;
+		$this->_numOfFields = $f->Count;
+	}
+	
+	
+	 // should only be used to move forward as we normally use forward-only cursors
+	function _seek($row)
+	{
+	   $rs = $this->_queryID; 
+		// absoluteposition doesn't work -- my maths is wrong ?
+		//	$rs->AbsolutePosition->$row-2;
+		//	return true;
+		if ($this->_currentRow > $row) return false;
+		@$rs->Move((integer)$row - $this->_currentRow-1); //adBookmarkFirst
+		return true;
+	}
+	
+/*
+	OLEDB types
+	
+	 enum DBTYPEENUM
+	{	DBTYPE_EMPTY	= 0,
+	DBTYPE_NULL	= 1,
+	DBTYPE_I2	= 2,
+	DBTYPE_I4	= 3,
+	DBTYPE_R4	= 4,
+	DBTYPE_R8	= 5,
+	DBTYPE_CY	= 6,
+	DBTYPE_DATE	= 7,
+	DBTYPE_BSTR	= 8,
+	DBTYPE_IDISPATCH	= 9,
+	DBTYPE_ERROR	= 10,
+	DBTYPE_BOOL	= 11,
+	DBTYPE_VARIANT	= 12,
+	DBTYPE_IUNKNOWN	= 13,
+	DBTYPE_DECIMAL	= 14,
+	DBTYPE_UI1	= 17,
+	DBTYPE_ARRAY	= 0x2000,
+	DBTYPE_BYREF	= 0x4000,
+	DBTYPE_I1	= 16,
+	DBTYPE_UI2	= 18,
+	DBTYPE_UI4	= 19,
+	DBTYPE_I8	= 20,
+	DBTYPE_UI8	= 21,
+	DBTYPE_GUID	= 72,
+	DBTYPE_VECTOR	= 0x1000,
+	DBTYPE_RESERVED	= 0x8000,
+	DBTYPE_BYTES	= 128,
+	DBTYPE_STR	= 129,
+	DBTYPE_WSTR	= 130,
+	DBTYPE_NUMERIC	= 131,
+	DBTYPE_UDT	= 132,
+	DBTYPE_DBDATE	= 133,
+	DBTYPE_DBTIME	= 134,
+	DBTYPE_DBTIMESTAMP	= 135
+	
+	ADO Types
+	
+   	adEmpty	= 0,
+	adTinyInt	= 16,
+	adSmallInt	= 2,
+	adInteger	= 3,
+	adBigInt	= 20,
+	adUnsignedTinyInt	= 17,
+	adUnsignedSmallInt	= 18,
+	adUnsignedInt	= 19,
+	adUnsignedBigInt	= 21,
+	adSingle	= 4,
+	adDouble	= 5,
+	adCurrency	= 6,
+	adDecimal	= 14,
+	adNumeric	= 131,
+	adBoolean	= 11,
+	adError	= 10,
+	adUserDefined	= 132,
+	adVariant	= 12,
+	adIDispatch	= 9,
+	adIUnknown	= 13,	
+	adGUID	= 72,
+	adDate	= 7,
+	adDBDate	= 133,
+	adDBTime	= 134,
+	adDBTimeStamp	= 135,
+	adBSTR	= 8,
+	adChar	= 129,
+	adVarChar	= 200,
+	adLongVarChar	= 201,
+	adWChar	= 130,
+	adVarWChar	= 202,
+	adLongVarWChar	= 203,
+	adBinary	= 128,
+	adVarBinary	= 204,
+	adLongVarBinary	= 205,
+	adChapter	= 136,
+	adFileTime	= 64,
+	adDBFileTime	= 137,
+	adPropVariant	= 138,
+	adVarNumeric	= 139
+*/
+	function MetaType($t,$len=-1,$fieldobj=false)
+	{
+		if (is_object($t)) {
+			$fieldobj = $t;
+			$t = $fieldobj->type;
+			$len = $fieldobj->max_length;
+		}
+		
+		if (!is_numeric($t)) return $t;
+		
+		switch ($t) {
+		case 0:
+		case 12: // variant
+		case 8: // bstr
+		case 129: //char
+		case 130: //wc
+		case 200: // varc
+		case 202:// varWC
+		case 128: // bin
+		case 204: // varBin
+		case 72: // guid
+			if ($len <= $this->blobSize) return 'C';
+		
+		case 201:
+		case 203:
+			return 'X';
+		case 128:
+		case 204:
+		case 205:
+			 return 'B';
+		case 7:
+		case 133: return 'D';
+		
+		case 134:
+		case 135: return 'T';
+		
+		case 11: return 'L';
+		
+		case 16://	adTinyInt	= 16,
+		case 2://adSmallInt	= 2,
+		case 3://adInteger	= 3,
+		case 4://adBigInt	= 20,
+		case 17://adUnsignedTinyInt	= 17,
+		case 18://adUnsignedSmallInt	= 18,
+		case 19://adUnsignedInt	= 19,
+		case 20://adUnsignedBigInt	= 21,
+			return 'I';
+		default: return 'N';
+		}
+	}
+	
+	// time stamp not supported yet
+	function _fetch()
+	{	
+		$rs = $this->_queryID;
+		if (!$rs or $rs->EOF) {
+			$this->fields = false;
+			return false;
+		}
+		$this->fields = array();
+	
+		if (!$this->_tarr) {
+			$tarr = array();
+			$flds = array();
+			for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
+				$f = $rs->Fields($i);
+				$flds[] = $f;
+				$tarr[] = $f->Type;
+			}
+			// bind types and flds only once
+			$this->_tarr = $tarr; 
+			$this->_flds = $flds;
+		}
+		$t = reset($this->_tarr);
+		$f = reset($this->_flds);
+		
+		if ($this->hideErrors)  $olde = error_reporting(E_ERROR|E_CORE_ERROR);// sometimes $f->value be null
+		for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
+			//echo "<p>",$t,' ';var_dump($f->value); echo '</p>';
+			switch($t) {
+			case 135: // timestamp
+				if (!strlen((string)$f->value)) $this->fields[] = false;
+				else {
+					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
+					else $val = $f->value;
+					$this->fields[] = adodb_date('Y-m-d H:i:s',$val);
+				}
+				break;			
+			case 133:// A date value (yyyymmdd) 
+				if ($val = $f->value) {
+					$this->fields[] = substr($val,0,4).'-'.substr($val,4,2).'-'.substr($val,6,2);
+				} else
+					$this->fields[] = false;
+				break;
+			case 7: // adDate
+				if (!strlen((string)$f->value)) $this->fields[] = false;
+				else {
+					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
+					else $val = $f->value;
+					
+					if (($val % 86400) == 0) $this->fields[] = adodb_date('Y-m-d',$val);
+					else $this->fields[] = adodb_date('Y-m-d H:i:s',$val);
+				}
+				break;
+			case 1: // null
+				$this->fields[] = false;
+				break;
+			case 6: // currency is not supported properly;
+				ADOConnection::outp( '<b>'.$f->Name.': currency type not supported by PHP</b>');
+				$this->fields[] = (float) $f->value;
+				break;
+			default:
+				$this->fields[] = $f->value; 
+				break;
+			}
+			//print " $f->value $t, ";
+			$f = next($this->_flds);
+			$t = next($this->_tarr);
+		} // for
+		if ($this->hideErrors) error_reporting($olde);
+		@$rs->MoveNext(); // @ needed for some versions of PHP!
+		
+		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+			$this->fields = &$this->GetRowAssoc(ADODB_ASSOC_CASE);
+		}
+		return true;
+	}
+	
+		function NextRecordSet()
+		{
+			$rs = $this->_queryID;
+			$this->_queryID = $rs->NextRecordSet();
+			//$this->_queryID = $this->_QueryId->NextRecordSet();
+			if ($this->_queryID == null) return false;
+			
+			$this->_currentRow = -1;
+			$this->_currentPage = -1;
+			$this->bind = false;
+			$this->fields = false;
+			$this->_flds = false;
+			$this->_tarr = false;
+			
+			$this->_inited = false;
+			$this->Init();
+			return true;
+		}
+
+	function _close() {
+		$this->_flds = false;
+		@$this->_queryID->Close();// by Pete Dishman (peterd@telephonetics.co.uk)
+		$this->_queryID = false;	
+	}
+
+}
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado_access.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado_access.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado_access.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado_access.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
 Released under both BSD license and Lesser GPL library license. 
 Whenever there is any discrepancy between the two licenses, 
 the BSD license will take precedence. See License.txt. 
@@ -15,7 +15,8 @@
 if (!defined('ADODB_DIR')) die();
 
 if (!defined('_ADODB_ADO_LAYER')) {
-	include(ADODB_DIR."/drivers/adodb-ado.inc.php");
+	if (PHP_VERSION >= 5) include(ADODB_DIR."/drivers/adodb-ado5.inc.php");
+	else include(ADODB_DIR."/drivers/adodb-ado.inc.php");
 }
 
 class  ADODB_ado_access extends ADODB_ado {	
@@ -33,6 +34,10 @@
 	}
 	
 	function BeginTrans() { return false;}
+	
+	function CommitTrans() { return false;}
+	
+	function RollbackTrans() { return false;}
 
 }
 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado_mssql.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado_mssql.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ado_mssql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ado_mssql.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -19,7 +19,8 @@
 if (!defined('ADODB_DIR')) die();
 
 if (!defined('_ADODB_ADO_LAYER')) {
-	include(ADODB_DIR."/drivers/adodb-ado.inc.php");
+	if (PHP_VERSION >= 5) include(ADODB_DIR."/drivers/adodb-ado5.inc.php");
+	else include(ADODB_DIR."/drivers/adodb-ado.inc.php");
 }
 
 
@@ -54,36 +55,37 @@
 	
 	function MetaColumns($table)
 	{
-	        $table = strtoupper($table);
-	        $arr= array();
-	        $dbc = $this->_connectionID;
-	        
-	        $osoptions = array();
-	        $osoptions[0] = null;
-	        $osoptions[1] = null;
-	        $osoptions[2] = $table;
-	        $osoptions[3] = null;
-	        
-	        $adors=@$dbc->OpenSchema(4, $osoptions);//tables
-	
-	        if ($adors){
-	                while (!$adors->EOF){
-	                        $fld = new ADOFieldObject();
-	                        $c = $adors->Fields(3);
-	                        $fld->name = $c->Value;
-	                        $fld->type = 'CHAR'; // cannot discover type in ADO!
-	                        $fld->max_length = -1;
-	                        $arr[strtoupper($fld->name)]=$fld;
-	        
-	                        $adors->MoveNext();
-	                }
-	                $adors->Close();
-	        }
-	        
-	        return $arr;
-	}
+        $table = strtoupper($table);
+        $arr= array();
+        $dbc = $this->_connectionID;
+        
+        $osoptions = array();
+        $osoptions[0] = null;
+        $osoptions[1] = null;
+        $osoptions[2] = $table;
+        $osoptions[3] = null;
+        
+        $adors=@$dbc->OpenSchema(4, $osoptions);//tables
+
+        if ($adors){
+                while (!$adors->EOF){
+                        $fld = new ADOFieldObject();
+                        $c = $adors->Fields(3);
+                        $fld->name = $c->Value;
+                        $fld->type = 'CHAR'; // cannot discover type in ADO!
+                        $fld->max_length = -1;
+                        $arr[strtoupper($fld->name)]=$fld;
+        
+                        $adors->MoveNext();
+                }
+                $adors->Close();
+        }
+        $false = false;
+		return empty($arr) ? $false : $arr;
 	}
 	
+	} // end class 
+	
 	class  ADORecordSet_ado_mssql extends ADORecordSet_ado {        
 	
 	var $databaseType = 'ado_mssql';
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-borland_ibase.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-borland_ibase.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-borland_ibase.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-borland_ibase.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-csv.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-csv.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-csv.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-csv.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-db2.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-db2.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-db2.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-db2.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -145,8 +145,10 @@
 		$rs = new ADORecordSet_odbc($qid);
 		
 		$ADODB_FETCH_MODE = $savem;
-		if (!$rs) return false;
-		
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
 		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
 		
 		$arr =& $rs->GetArray();
@@ -175,7 +177,45 @@
 		}
 		return $arr2;
 	}
-	
+
+	function &MetaIndexes ($table, $primary = FALSE, $owner=false)
+	{
+        // save old fetch mode
+        global $ADODB_FETCH_MODE;
+        $save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+               $savem = $this->SetFetchMode(FALSE);
+        }
+		$false = false;
+		// get index details
+		$table = strtoupper($table);
+		$SQL="SELECT NAME, UNIQUERULE, COLNAMES FROM SYSIBM.SYSINDEXES WHERE TBNAME='$table'";
+        if ($primary) 
+			$SQL.= " AND UNIQUERULE='P'";
+		$rs = $this->Execute($SQL);
+        if (!is_object($rs)) {
+			if (isset($savem)) 
+				$this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+            return $false;
+        }
+		$indexes = array ();
+        // parse index data into array
+        while ($row = $rs->FetchRow()) {
+			$indexes[$row[0]] = array(
+			   'unique' => ($row[1] == 'U' || $row[1] == 'P'),
+			   'columns' => array()
+			);
+			$cols = ltrim($row[2],'+');
+			$indexes[$row[0]]['columns'] = explode('+', $cols);
+        }
+		if (isset($savem)) { 
+            $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+		}
+        return $indexes;
+	}
 	
 	// Format date column in sql string given an input format that understands Y M D
 	function SQLDate($fmt, $col=false)
@@ -274,12 +314,14 @@
 		case 'VARCHAR':
 		case 'CHAR':
 		case 'CHARACTER':
+		case 'C':
 			if ($len <= $this->blobSize) return 'C';
 		
 		case 'LONGCHAR':
 		case 'TEXT':
 		case 'CLOB':
 		case 'DBCLOB': // double-byte
+		case 'X':
 			return 'X';
 		
 		case 'BLOB':
@@ -288,10 +330,12 @@
 			return 'B';
 			
 		case 'DATE':
+		case 'D':
 			return 'D';
 		
 		case 'TIME':
 		case 'TIMESTAMP':
+		case 'T':
 			return 'T';
 		
 		//case 'BOOLEAN': 
@@ -305,6 +349,7 @@
 		case 'INTEGER':
 		case 'BIGINT':
 		case 'SMALLINT':
+		case 'I':
 			return 'I';
 			
 		default: return 'N';
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-fbsql.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-fbsql.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-fbsql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-fbsql.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
- @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -170,9 +170,10 @@
 		}
 		switch ($mode) {
 		case ADODB_FETCH_NUM: $this->fetchMode = FBSQL_NUM; break;
-		default:
-		case ADODB_FETCH_BOTH: $this->fetchMode = FBSQL_BOTH; break;
 		case ADODB_FETCH_ASSOC: $this->fetchMode = FBSQL_ASSOC; break;
+		case ADODB_FETCH_BOTH: 
+		default:
+		$this->fetchMode = FBSQL_BOTH; break;
 		}
 		return $this->ADORecordSet($queryID);
 	}
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-firebird.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-firebird.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-firebird.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-firebird.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ibase.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ibase.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ibase.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ibase.inc.php	2005-05-04 14:39:17.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.  
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.  
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -52,6 +52,7 @@
 	var $hasAffectedRows = false;
 	var $poorAffectedRows = true;
 	var $blobEncodeType = 'C';
+	var $role = false;
 	
 	function ADODB_ibase() 
 	{
@@ -65,7 +66,11 @@
 		if (!function_exists('ibase_pconnect')) return null;
 		if ($argDatabasename) $argHostname .= ':'.$argDatabasename;
 		$fn = ($persist) ? 'ibase_pconnect':'ibase_connect';
-		$this->_connectionID = $fn($argHostname,$argUsername,$argPassword,
+		if ($this->role)
+			$this->_connectionID = $fn($argHostname,$argUsername,$argPassword,
+					$this->charSet,$this->buffers,$this->dialect,$this->role);
+		else	
+			$this->_connectionID = $fn($argHostname,$argUsername,$argPassword,
 					$this->charSet,$this->buffers,$this->dialect);
 		
 		if ($this->dialect != 1) { // http://www.ibphoenix.com/ibp_60_del_id_ds.html
@@ -475,61 +480,60 @@
 	{
 	global $ADODB_FETCH_MODE;
 		
-		if ($this->metaColumnsSQL) {
-		
-			$save = $ADODB_FETCH_MODE;
-			$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
-		
-			$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
-		
-			$ADODB_FETCH_MODE = $save;
-			if ($rs === false) return false;
-
-			$retarr = array();
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+	
+		$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
+	
+		$ADODB_FETCH_MODE = $save;
+		if ($rs === false) {
+			$false = false;
+			return $false;
+		}
+		
+		$retarr = array();
+		//OPN STUFF start
+		$dialect3 = ($this->dialect==3 ? true : false);
+		//OPN STUFF end
+		while (!$rs->EOF) { //print_r($rs->fields);
+			$fld = new ADOFieldObject();
+			$fld->name = trim($rs->fields[0]);
 			//OPN STUFF start
-			$dialect3 = ($this->dialect==3 ? true : false);
-			//OPN STUFF end
-			while (!$rs->EOF) { //print_r($rs->fields);
-				$fld = new ADOFieldObject();
-				$fld->name = trim($rs->fields[0]);
-				//OPN STUFF start
-				$this->_ConvertFieldType($fld, $rs->fields[7], $rs->fields[3], $rs->fields[4], $rs->fields[5], $rs->fields[6], $dialect3);
-				if (isset($rs->fields[1]) && $rs->fields[1]) {
-					$fld->not_null = true;
-				}				
-				if (isset($rs->fields[2])) {
-					
-					$fld->has_default = true;
-					$d = substr($rs->fields[2],strlen('default '));
-					switch ($fld->type)
-					{
-					case 'smallint':
-					case 'integer': $fld->default_value = (int) $d; break;
-					case 'char': 
-					case 'blob':
-					case 'text':
-					case 'varchar': $fld->default_value = (string) substr($d,1,strlen($d)-2); break;
-					case 'double':
-					case 'float': $fld->default_value = (float) $d; break;
-					default: $fld->default_value = $d; break;
-					}
-			//	case 35:$tt = 'TIMESTAMP'; break;
-				}
-				if ((isset($rs->fields[5])) && ($fld->type == 'blob')) {
-					$fld->sub_type = $rs->fields[5];
-				} else {
-					$fld->sub_type = null;
-				}
-				//OPN STUFF end
-				if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] = $fld;	
-				else $retarr[strtoupper($fld->name)] = $fld;
+			$this->_ConvertFieldType($fld, $rs->fields[7], $rs->fields[3], $rs->fields[4], $rs->fields[5], $rs->fields[6], $dialect3);
+			if (isset($rs->fields[1]) && $rs->fields[1]) {
+				$fld->not_null = true;
+			}				
+			if (isset($rs->fields[2])) {
 				
-				$rs->MoveNext();
+				$fld->has_default = true;
+				$d = substr($rs->fields[2],strlen('default '));
+				switch ($fld->type)
+				{
+				case 'smallint':
+				case 'integer': $fld->default_value = (int) $d; break;
+				case 'char': 
+				case 'blob':
+				case 'text':
+				case 'varchar': $fld->default_value = (string) substr($d,1,strlen($d)-2); break;
+				case 'double':
+				case 'float': $fld->default_value = (float) $d; break;
+				default: $fld->default_value = $d; break;
+				}
+		//	case 35:$tt = 'TIMESTAMP'; break;
 			}
-			$rs->Close();
-			return $retarr;	
+			if ((isset($rs->fields[5])) && ($fld->type == 'blob')) {
+				$fld->sub_type = $rs->fields[5];
+			} else {
+				$fld->sub_type = null;
+			}
+			//OPN STUFF end
+			if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] = $fld;	
+			else $retarr[strtoupper($fld->name)] = $fld;
+			
+			$rs->MoveNext();
 		}
-		return false;
+		$rs->Close();
+		return empty($retarr) ? false : $retarr;	
 	}
 	
 	function BlobEncode( $blob ) 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-informix.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-informix.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-informix.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-informix.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /**
-* @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+* @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
 * Released under both BSD license and Lesser GPL library license.
 * Whenever there is any discrepancy between the two licenses,
 * the BSD license will take precedence.
@@ -26,6 +26,7 @@
 
 class ADORecordset_informix extends ADORecordset_informix72 {
 	var $databaseType = "informix";
+	
 	function ADORecordset_informix($id,$mode=false)
 	{
 		$this->ADORecordset_informix72($id,$mode);
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-informix72.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-informix72.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-informix72.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-informix72.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim. All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence.
@@ -28,7 +28,7 @@
 	var $hasInsertID = true;
 	var $hasAffectedRows = true;
     var $substr = 'substr';
-	var $metaTablesSQL="select tabname from systables where tabtype!=' ' and owner!='informix'"; //Don't get informix tables and pseudo-tables
+	var $metaTablesSQL="select tabname,tabtype from systables where tabtype in ('T','V') and owner!='informix'"; //Don't get informix tables and pseudo-tables
 
 
 	var $metaColumnsSQL = 
@@ -74,7 +74,7 @@
 	    if (isset($this->version)) return $this->version;
 	
 	    $arr['description'] = $this->GetOne("select DBINFO('version','full') from systables where tabid = 1");
-	    $arr['version'] = $this->GetOne("select DBINFO('version','major')||"."||DBINFO('version','minor') from systables where tabid = 1");
+	    $arr['version'] = $this->GetOne("select DBINFO('version','major') || DBINFO('version','minor') from systables where tabid = 1");
 	    $this->version = $arr;
 	    return $arr;
 	}
@@ -141,7 +141,7 @@
 
 	function ErrorNo()
 	{
-		preg_match("/.*SQLCODE=([^\]]*)/",ifx_error(),$parse); //!EOS
+		preg_match("/.*SQLCODE=([^\]]*)/",ifx_error(),$parse);
 		if (is_array($parse) && isset($parse[1])) return (int)$parse[1]; 
 		return 0;
 	}
@@ -165,9 +165,20 @@
 			while (!$rs->EOF) { //print_r($rs->fields);
 				$fld = new ADOFieldObject();
 				$fld->name = $rs->fields[0];
+/*  //!eos.
+						$rs->fields[1] is not the correct adodb type
+						$rs->fields[2] is not correct max_length, because can include not-null bit
+
 				$fld->type = $rs->fields[1];
 				$fld->primary_key=$rspkey->fields && array_search($rs->fields[4],$rspkey->fields); //Added to set primary key flag
-				$fld->max_length = $rs->fields[2];
+				$fld->max_length = $rs->fields[2];*/
+				$pr=ifx_props($rs->fields[1],$rs->fields[2]); //!eos
+				$fld->type = $pr[0] ;//!eos
+				$fld->primary_key=$rspkey->fields && array_search($rs->fields[4],$rspkey->fields);
+				$fld->max_length = $pr[1]; //!eos
+				$fld->precision = $pr[2] ;//!eos
+				$fld->not_null = $pr[3]=="N"; //!eos
+
 				if (trim($rs->fields[3]) != "AAAAAA 0") {
 	                    		$fld->has_default = 1;
 	                    		$fld->default_value = $rs->fields[3];
@@ -180,6 +191,7 @@
 			}
 
 			$rs->Close();
+			$rspKey->Close(); //!eos
 			return $retarr;	
 		}
 
@@ -191,6 +203,38 @@
 		return ADOConnection::MetaColumns($table,false);
    }
 
+	 function MetaForeignKeys($table, $owner=false, $upper=false) //!Eos
+	{
+		$sql = "
+			select tr.tabname,updrule,delrule,
+			i.part1 o1,i2.part1 d1,i.part2 o2,i2.part2 d2,i.part3 o3,i2.part3 d3,i.part4 o4,i2.part4 d4,
+			i.part5 o5,i2.part5 d5,i.part6 o6,i2.part6 d6,i.part7 o7,i2.part7 d7,i.part8 o8,i2.part8 d8
+			from systables t,sysconstraints s,sysindexes i,
+			sysreferences r,systables tr,sysconstraints s2,sysindexes i2
+			where t.tabname='$table'
+			and s.tabid=t.tabid and s.constrtype='R' and r.constrid=s.constrid
+			and i.idxname=s.idxname and tr.tabid=r.ptabid
+			and s2.constrid=r.primary and i2.idxname=s2.idxname";
+
+		$rs = $this->Execute($sql);
+		if (!$rs || $rs->EOF)  return false;
+		$arr =& $rs->GetArray();
+		$a = array();
+		foreach($arr as $v) {
+			$coldest=$this->metaColumnNames($v["tabname"]);
+			$colorig=$this->metaColumnNames($table);
+			$colnames=array();
+			for($i=1;$i<=8 && $v["o$i"] ;$i++) {
+				$colnames[]=$coldest[$v["d$i"]-1]."=".$colorig[$v["o$i"]-1];
+			}
+			if($upper)
+				$a[strtoupper($v["tabname"])] =  $colnames;
+			else
+				$a[$v["tabname"]] =  $colnames;
+		}
+		return $a;
+	 }
+
    function UpdateBlob($table, $column, $val, $where, $blobtype = 'BLOB')
    {
    		$type = ($blobtype == 'TEXT') ? 1 : 0;
@@ -342,7 +386,7 @@
 
 	function _seek($row)
 	{
-		return @ifx_fetch_row($this->_queryID, $row);
+		return @ifx_fetch_row($this->_queryID, (int) $row);
 	}
 
    function MoveLast()
@@ -401,4 +445,29 @@
 	}
 
 }
+/** !Eos
+* Auxiliar function to Parse coltype,collength. Used by Metacolumns
+* return: array ($mtype,$length,$precision,$nullable) (similar to ifx_fieldpropierties)
+*/
+function ifx_props($coltype,$collength){
+	$itype=fmod($coltype+1,256);
+	$nullable=floor(($coltype+1) /256) ?"N":"Y";
+	$mtype=substr(" CIIFFNNDN TBXCC     ",$itype,1);
+	switch ($itype){
+		case 2:
+			$length=4;
+		case 6:
+		case 9:
+		case 14:
+			$length=floor($collength/256);
+			$precision=fmod($collength,256);
+			break;
+		default:
+			$precision=0;
+			$length=$collength;
+	}
+	return array($mtype,$length,$precision,$nullable);
+}
+
+
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-ldap.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-ldap.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-ldap.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-ldap.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,11 +1,15 @@
 <?php
 /*
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
    Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
   Set tabs to 8.
   
+  Revision 1: (02/25/2005) Updated codebase to include the _inject_bind_options function. This allows
+  users to access the options in the ldap_set_option function appropriately. Most importantly
+  LDAP Version 3 is now supported. See the examples for more information. Also fixed some minor
+  bugs that surfaced when PHP error levels were set high.
   
   Joshua Eldridge (joshuae74#hotmail.com)
 */ 
@@ -13,6 +17,12 @@
 // security - hide paths
 if (!defined('ADODB_DIR')) die();
 
+if (!defined('LDAP_ASSOC')) {
+	 define('LDAP_ASSOC',ADODB_FETCH_ASSOC);
+	 define('LDAP_NUM',ADODB_FETCH_NUM);
+	 define('LDAP_BOTH',ADODB_FETCH_BOTH);
+}
+
 class ADODB_ldap extends ADOConnection {
     var $databaseType = 'ldap';
 	var $dataProvider = 'ldap';
@@ -24,7 +34,10 @@
     # Used during searches
     var $filter;
     var $dn;
+	var $version;
 
+	# Options configuration information
+	var $LDAP_CONNECT_OPTIONS;
 
 	function ADODB_ldap() 
 	{		
@@ -36,6 +49,8 @@
 	function _connect( $host, $username, $password, $ldapbase )
 	{
 
+	global $LDAP_CONNECT_OPTIONS;
+
 	   if ( !function_exists( 'ldap_connect' ) ) return null;
 	   
 	   $conn_info = array( $host );
@@ -46,6 +61,11 @@
 
 	   $this->_connectionID = ldap_connect( $conn_info[0], $conn_info[1] ) 
 	       or die( 'Could not connect to ' . $this->_connectionID );
+
+	   if( count( $LDAP_CONNECT_OPTIONS ) > 0 ) {
+			$this->_inject_bind_options( $LDAP_CONNECT_OPTIONS );
+		}
+
 	   if ($username && $password) {
 	       $bind = ldap_bind( $this->_connectionID, $username, $password ) 
 	           or die( 'Could not bind to ' . $this->_connectionID . ' with $username & $password');
@@ -53,9 +73,68 @@
 	       $bind = ldap_bind( $this->_connectionID ) 
 	           or die( 'Could not bind anonymously to ' . $this->_connectionID );
 	   }
+	   $this->database = $ldapbase;
 	   return $this->_connectionID;
     }
     
+/*
+	Valid Domain Values for LDAP Options:
+
+	LDAP_OPT_DEREF (integer)
+	LDAP_OPT_SIZELIMIT (integer)
+	LDAP_OPT_TIMELIMIT (integer)
+	LDAP_OPT_PROTOCOL_VERSION (integer)
+	LDAP_OPT_ERROR_NUMBER (integer)
+	LDAP_OPT_REFERRALS (boolean)
+	LDAP_OPT_RESTART (boolean)
+	LDAP_OPT_HOST_NAME (string)
+	LDAP_OPT_ERROR_STRING (string)
+	LDAP_OPT_MATCHED_DN (string)
+	LDAP_OPT_SERVER_CONTROLS (array)
+	LDAP_OPT_CLIENT_CONTROLS (array)
+
+	Make sure to set this BEFORE calling Connect()
+
+	Example:
+
+	$LDAP_CONNECT_OPTIONS = Array(
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_DEREF,
+			"OPTION_VALUE"=>2
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_SIZELIMIT,
+			"OPTION_VALUE"=>100
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_TIMELIMIT,
+			"OPTION_VALUE"=>30
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_PROTOCOL_VERSION,
+			"OPTION_VALUE"=>3
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_ERROR_NUMBER,
+			"OPTION_VALUE"=>13
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_REFERRALS,
+			"OPTION_VALUE"=>FALSE
+		),
+		Array (
+			"OPTION_NAME"=>LDAP_OPT_RESTART,
+			"OPTION_VALUE"=>FALSE
+		)
+	);
+*/
+
+	function _inject_bind_options( $options ) {
+		foreach( $options as $option ) {
+			ldap_set_option( $this->_connectionID, $option["OPTION_NAME"], $option["OPTION_VALUE"] )
+				or die( "Unable to set server option: " . $option["OPTION_NAME"] );
+		}
+	}
 	
 	/* returns _queryID or false */
 	function _query($sql,$inputarr)
@@ -72,9 +151,14 @@
 		$this->_connectionID = false;
 	}
     
+	function SelectDB($db) {
+		$this->database = $db;
+		return true;
+	} // SelectDB
+
     function ServerInfo()
     {
-        if( is_array( $this->version ) ) return $this->version;
+        if( !empty( $this->version ) ) return $this->version;
         $version = array();
         /*
         Determines how aliases are handled during search. 
@@ -160,8 +244,8 @@
         }
         /* The host name (or list of hosts) for the primary LDAP server. */
         ldap_get_option( $this->_connectionID, LDAP_OPT_HOST_NAME, $version['LDAP_OPT_HOST_NAME'] ); 
-        ldap_get_option( $this->_connectionID, OPT_ERROR_NUMBER, $version['OPT_ERROR_NUMBER'] ); 
-        ldap_get_option( $this->_connectionID, OPT_ERROR_STRING, $version['OPT_ERROR_STRING'] ); 
+        ldap_get_option( $this->_connectionID, LDAP_OPT_ERROR_NUMBER, $version['LDAP_OPT_ERROR_NUMBER'] ); 
+        ldap_get_option( $this->_connectionID, LDAP_OPT_ERROR_STRING, $version['LDAP_OPT_ERROR_STRING'] ); 
         ldap_get_option( $this->_connectionID, LDAP_OPT_MATCHED_DN, $version['LDAP_OPT_MATCHED_DN'] ); 
         
         return $this->version = $version;
@@ -193,9 +277,9 @@
 		case ADODB_FETCH_ASSOC: 
 		  $this->fetchMode = LDAP_ASSOC; 
 		break;
-		default:
 		case ADODB_FETCH_DEFAULT:
 		case ADODB_FETCH_BOTH: 
+		default:
 		  $this->fetchMode = LDAP_BOTH; 
 		break;
 		}
@@ -292,11 +376,12 @@
             break;
             
             case LDAP_NUM:
-            $this->fields = $this->GetRowNums();
+			$this->fields = array_merge($this->GetRowNums(),$this->GetRowAssoc());
             break;
             
             case LDAP_BOTH:
             default:
+			$this->fields = $this->GetRowNums();
             break;
         }
         return ( is_array( $this->fields ) );        
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-mssql.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-mssql.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-mssql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-mssql.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -312,6 +312,47 @@
 		return $this->GetOne("select top 1 null as ignore from $tables with (ROWLOCK,HOLDLOCK) where $where");
 	}
 	
+	
+	function &MetaIndexes($table,$primary=false)
+	{
+		$table = $this->qstr($table);
+
+		$sql = "SELECT i.name AS ind_name, C.name AS col_name, USER_NAME(O.uid) AS Owner, c.colid, k.Keyno, 
+			CASE WHEN I.indid BETWEEN 1 AND 254 AND (I.status & 2048 = 2048 OR I.Status = 16402 AND O.XType = 'V') THEN 1 ELSE 0 END AS IsPK,
+			CASE WHEN I.status & 2 = 2 THEN 1 ELSE 0 END AS IsUnique
+			FROM dbo.sysobjects o INNER JOIN dbo.sysindexes I ON o.id = i.id 
+			INNER JOIN dbo.sysindexkeys K ON I.id = K.id AND I.Indid = K.Indid 
+			INNER JOIN dbo.syscolumns c ON K.id = C.id AND K.colid = C.Colid
+			WHERE LEFT(i.name, 8) <> '_WA_Sys_' AND o.status >= 0 AND O.Name LIKE $table
+			ORDER BY O.name, I.Name, K.keyno";
+
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+        	$savem = $this->SetFetchMode(FALSE);
+        }
+        
+        $rs = $this->Execute($sql);
+        if (isset($savem)) {
+        	$this->SetFetchMode($savem);
+        }
+        $ADODB_FETCH_MODE = $save;
+
+        if (!is_object($rs)) {
+        	return FALSE;
+        }
+
+		$indexes = array();
+		while ($row = $rs->FetchRow()) {
+			if (!$primary && $row[5]) continue;
+			
+            $indexes[$row[0]]['unique'] = $row[6];
+            $indexes[$row[0]]['columns'][] = $row[1];
+    	}
+        return $indexes;
+	}
+	
 	function MetaForeignKeys($table, $owner=false, $upper=false)
 	{
 	global $ADODB_FETCH_MODE;
@@ -494,6 +535,30 @@
 		return array($sql,$stmt);
 	}
 	
+	// returns concatenated string
+    // MSSQL requires integers to be cast as strings
+    // automatically cast every datatype to VARCHAR(255)
+    // @author David Rogers (introspectshun)
+    function Concat()
+    {
+            $s = "";
+            $arr = func_get_args();
+
+            // Split single record on commas, if possible
+            if (sizeof($arr) == 1) {
+                foreach ($arr as $arg) {
+                    $args = explode(',', $arg);
+                }
+                $arr = $args;
+            }
+
+            array_walk($arr, create_function('&$v', '$v = "CAST(" . $v . " AS VARCHAR(255))";'));
+            $s = implode('+',$arr);
+            if (sizeof($arr) > 0) return "$s";
+            
+			return '';
+    }
+	
 	/* 
 	Usage:
 		$stmt = $db->PrepareSP('SP_RUNSOMETHING'); -- takes 2 params, @myid and @group
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-mssqlpo.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-mssqlpo.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-mssqlpo.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-mssqlpo.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /**
-* @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+* @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
 * Released under both BSD license and Lesser GPL library license.
 * Whenever there is any discrepancy between the two licenses,
 * the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysql.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysql.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysql.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysql.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -79,6 +79,7 @@
         // save old fetch mode
         global $ADODB_FETCH_MODE;
         
+		$false = false;
         $save = $ADODB_FETCH_MODE;
         $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
         if ($this->fetchMode !== FALSE) {
@@ -95,7 +96,7 @@
         $ADODB_FETCH_MODE = $save;
         
         if (!is_object($rs)) {
-                return FALSE;
+                return $false;
         }
         
         $indexes = array ();
@@ -148,7 +149,8 @@
 	
 	function _insertid()
 	{
-		return mysql_insert_id($this->_connectionID);
+		return ADOConnection::GetOne('SELECT LAST_INSERT_ID()');
+		//return mysql_insert_id($this->_connectionID);
 	}
 	
 	function GetOne($sql,$inputarr=false)
@@ -302,7 +304,13 @@
 				$s .= '%p';
 				break;
 				
-
+			case 'w':
+				$s .= '%w';
+				break;
+				
+			case 'l':
+				$s .= '%W';
+				break;
 			}
 		}
 		$s.="')";
@@ -368,72 +376,67 @@
 	
  	function &MetaColumns($table) 
 	{
-	
-		if ($this->metaColumnsSQL) {
 		global $ADODB_FETCH_MODE;
-		
-			$save = $ADODB_FETCH_MODE;
-			$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
-			if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
-			
-			$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
-			
-			if (isset($savem)) $this->SetFetchMode($savem);
-			$ADODB_FETCH_MODE = $save;
-			
-			if ($rs === false) return false;
-			
-			$retarr = array();
-			while (!$rs->EOF){
-				$fld = new ADOFieldObject();
-				$fld->name = $rs->fields[0];
-				$type = $rs->fields[1];
-				
-				
-				// split type into type(length):
-				$fld->scale = null;
-				if (strpos($type,',') && preg_match("/^(.+)\((\d+),(\d+)/", $type, $query_array)) {
-					$fld->type = $query_array[1];
-					$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
-					$fld->scale = is_numeric($query_array[3]) ? $query_array[3] : -1;
-				} elseif (preg_match("/^(.+)\((\d+)/", $type, $query_array)) {
-					$fld->type = $query_array[1];
-					$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
-				} else {
-					$fld->max_length = -1;
-					$fld->type = $type;
-				}
-				/*
-				// split type into type(length):
-				if (preg_match("/^(.+)\((\d+)/", $type, $query_array)) {
-					$fld->type = $query_array[1];
-					$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
+		$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
+		if (isset($savem)) $this->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
+		if (!is_object($rs)) {
+			$false = false;
+			return $false;
+		}
+			
+		$retarr = array();
+		while (!$rs->EOF){
+			$fld = new ADOFieldObject();
+			$fld->name = $rs->fields[0];
+			$type = $rs->fields[1];
+			
+			// split type into type(length):
+			$fld->scale = null;
+			if (preg_match("/^(.+)\((\d+),(\d+)/", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
+				$fld->scale = is_numeric($query_array[3]) ? $query_array[3] : -1;
+			} elseif (preg_match("/^(.+)\((\d+)/", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
+			} elseif (preg_match("/^(enum)\((.*)\)$/i", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = max(array_map("strlen",explode(",",$query_array[2]))) - 2; // PHP >= 4.0.6
+				$fld->max_length = ($fld->max_length == 0 ? 1 : $fld->max_length);
+			} else {
+				$fld->type = $type;
+				$fld->max_length = -1;
+			}
+			$fld->not_null = ($rs->fields[2] != 'YES');
+			$fld->primary_key = ($rs->fields[3] == 'PRI');
+			$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
+			$fld->binary = (strpos($type,'blob') !== false);
+			$fld->unsigned = (strpos($type,'unsigned') !== false);
+				
+			if (!$fld->binary) {
+				$d = $rs->fields[4];
+				if ($d != '' && $d != 'NULL') {
+					$fld->has_default = true;
+					$fld->default_value = $d;
 				} else {
-					$fld->max_length = -1;
-					$fld->type = $type;
-				}*/
-				$fld->not_null = ($rs->fields[2] != 'YES');
-				$fld->primary_key = ($rs->fields[3] == 'PRI');
-				$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
-				$fld->binary = (strpos($fld->type,'blob') !== false);
-				
-				if (!$fld->binary) {
-					$d = $rs->fields[4];
-					if ($d != "" && $d != "NULL") {
-						$fld->has_default = true;
-						$fld->default_value = $d;
-					} else {
-						$fld->has_default = false;
-					}
+					$fld->has_default = false;
 				}
-				if ($save == ADODB_FETCH_NUM) $retarr[] = $fld;	
-				else $retarr[strtoupper($fld->name)] = $fld;
+			}
+			
+			if ($save == ADODB_FETCH_NUM) {
+				$retarr[] = $fld;
+			} else {
+				$retarr[strtoupper($fld->name)] = $fld;
+			}
 				$rs->MoveNext();
 			}
+		
 			$rs->Close();
 			return $retarr;	
-		}
-		return false;
 	}
 		
 	// returns true or false
@@ -533,11 +536,12 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
-		default:
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default:
+			$this->fetchMode = MYSQL_BOTH; break;
 		}
-	
+		$this->adodbFetchMode = $mode;
 		$this->ADORecordSet($queryID);	
 	}
 	
@@ -688,17 +692,18 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
-		default:
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default:
+		$this->fetchMode = MYSQL_BOTH; break;
 		}
-	
-		$this->ADORecordSet($queryID);	
+		$this->adodbFetchMode = $mode;
+		$this->ADORecordSet($queryID);
 	}
 	
 	function MoveNext()
 	{
-		return adodb_movenext($this);
+		return @adodb_movenext($this);
 	}
 }
 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysqli.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysqli.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysqli.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysqli.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -19,6 +19,11 @@
 if (! defined("_ADODB_MYSQLI_LAYER")) {
  define("_ADODB_MYSQLI_LAYER", 1 );
  
+ if (!defined('MYSQLI_READ_DEFAULT_GROUP')) define('MYSQLI_READ_DEFAULT_GROUP',1);
+
+ // disable adodb extension - currently incompatible.
+ global $ADODB_EXTENSION; $ADODB_EXTENSION = false;
+
 class ADODB_mysqli extends ADOConnection {
 	var $databaseType = 'mysqli';
 	var $dataProvider = 'native';
@@ -33,7 +38,7 @@
 	var $isoDates = true; // accepts dates in ISO format
 	var $sysDate = 'CURDATE()';
 	var $sysTimeStamp = 'NOW()';
-	var $hasTransactions = false;
+	var $hasTransactions = true;
 	var $forceNewConnect = false;
 	var $poorAffectedRows = true;
 	var $clientFlags = 0;
@@ -42,11 +47,12 @@
 	var $socket = false;
 	var $_bindInputArray = false;
 	var $nameQuote = '`';		/// string to use to quote identifiers and names
+	var $optionFlags = array(array(MYSQLI_READ_DEFAULT_GROUP,0));
 	
 	function ADODB_mysqli() 
 	{			
-	  if(!extension_loaded("mysqli"))
-	      trigger_error("You must have the MySQLi extension.", E_USER_ERROR);
+	 // if(!extension_loaded("mysqli"))
+	      ;//trigger_error("You must have the mysqli extension installed.", E_USER_ERROR);
 	    
 	}
 	
@@ -59,6 +65,9 @@
 			  $argPassword = NULL, 
 			  $argDatabasename = NULL, $persist=false)
 	  {
+	  	 if(!extension_loaded("mysqli")) {
+			return null;
+		 }
 	    $this->_connectionID = @mysqli_init();
 	    
 	    if (is_null($this->_connectionID)) {
@@ -67,9 +76,15 @@
 				ADOConnection::outp("mysqli_init() failed : "  . $this->ErrorMsg());
 	      return false;
 	    }
-	    // Set connection options
-	    // Not implemented now
-	    // mysqli_options($this->_connection,,);
+		/*
+		I suggest a simple fix which would enable adodb and mysqli driver to
+		read connection options from the standard mysql configuration file
+		/etc/my.cnf - "Bastien Duclaux" <bduclaux#yahoo.com>
+		*/
+		foreach($this->optionFlags as $arr) {	
+			mysqli_options($this->_connectionID,$arr[0],$arr[1]);
+		}
+		
  	    if (mysqli_real_connect($this->_connectionID,
  				    $argHostname,
  				    $argUsername,
@@ -104,7 +119,7 @@
 	function _nconnect($argHostname, $argUsername, $argPassword, $argDatabasename)
 	  {
 	    $this->forceNewConnect = true;
-	    $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
+	    return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
 	  }
 	
 	function IfNull( $field, $ifNull ) 
@@ -176,7 +191,6 @@
 	
 	function _insertid()
 	{
-//	  $this->_connectionID = $this->mysqli_resolve_link($this->_connectionID);
 	  $result = @mysqli_insert_id($this->_connectionID);
 	  if ($result == -1){
 	      if ($this->debug) ADOConnection::outp("mysqli_insert_id() failed : "  . $this->ErrorMsg());
@@ -187,7 +201,6 @@
 	// Only works for INSERT, UPDATE and DELETE query's
 	function _affectedrows()
 	{
-	//  $this->_connectionID = $this->mysqli_resolve_link($this->_connectionID);
 	  $result =  @mysqli_affected_rows($this->_connectionID);
 	  if ($result == -1) {
 	      if ($this->debug) ADOConnection::outp("mysqli_affected_rows() failed : "  . $this->ErrorMsg());
@@ -235,62 +248,62 @@
 	}
 	
   	function &MetaDatabases()
-	  {
-	    $query = "SHOW DATABASES";
-	    $ret =& $this->Execute($query);
+	{
+		$query = "SHOW DATABASES";
+		$ret =& $this->Execute($query);
 		return $ret;
-	  }
+	}
 
 	  
 	function &MetaIndexes ($table, $primary = FALSE)
 	{
-	        // save old fetch mode
-	        global $ADODB_FETCH_MODE;
-	        
-	        $save = $ADODB_FETCH_MODE;
-	        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
-	        if ($this->fetchMode !== FALSE) {
-	               $savem = $this->SetFetchMode(FALSE);
-	        }
-	        
-	        // get index details
-	        $rs = $this->Execute(sprintf('SHOW INDEXES FROM %s',$table));
-	        
-	        // restore fetchmode
-	        if (isset($savem)) {
-	                $this->SetFetchMode($savem);
-	        }
-	        $ADODB_FETCH_MODE = $save;
-	        
-	        if (!is_object($rs)) {
-	                return FALSE;
-	        }
-	        
-	        $indexes = array ();
-	        
-	        // parse index data into array
-	        while ($row = $rs->FetchRow()) {
-	                if ($primary == FALSE AND $row[2] == 'PRIMARY') {
-	                        continue;
-	                }
-	                
-	                if (!isset($indexes[$row[2]])) {
-	                        $indexes[$row[2]] = array(
-	                                'unique' => ($row[1] == 0),
-	                                'columns' => array()
-	                        );
-	                }
-	                
-	                $indexes[$row[2]]['columns'][$row[3] - 1] = $row[4];
-	        }
-	        
-	        // sort columns by order in the index
-	        foreach ( array_keys ($indexes) as $index )
-	        {
-	                ksort ($indexes[$index]['columns']);
-	        }
-	        
-	        return $indexes;
+		// save old fetch mode
+		global $ADODB_FETCH_MODE;
+		
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== FALSE) {
+		       $savem = $this->SetFetchMode(FALSE);
+		}
+		
+		// get index details
+		$rs = $this->Execute(sprintf('SHOW INDEXES FROM %s',$table));
+		
+		// restore fetchmode
+		if (isset($savem)) {
+		        $this->SetFetchMode($savem);
+		}
+		$ADODB_FETCH_MODE = $save;
+		
+		if (!is_object($rs)) {
+		        return FALSE;
+		}
+		
+		$indexes = array ();
+		
+		// parse index data into array
+		while ($row = $rs->FetchRow()) {
+		        if ($primary == FALSE AND $row[2] == 'PRIMARY') {
+		                continue;
+		        }
+		        
+		        if (!isset($indexes[$row[2]])) {
+		                $indexes[$row[2]] = array(
+		                        'unique' => ($row[1] == 0),
+		                        'columns' => array()
+		                );
+		        }
+		        
+		        $indexes[$row[2]]['columns'][$row[3] - 1] = $row[4];
+		}
+		
+		// sort columns by order in the index
+		foreach ( array_keys ($indexes) as $index )
+		{
+		        ksort ($indexes[$index]['columns']);
+		}
+		
+		return $indexes;
 	}
 
 	
@@ -385,112 +398,88 @@
 		return "from_unixtime(unix_timestamp($date)+($dayFraction)*24*3600)";
 	}
 	
+	function &MetaTables($ttype=false,$showSchema=false,$mask=false) 
+	{	
+		$save = $this->metaTablesSQL;
+		if ($showSchema && is_string($showSchema)) {
+			$this->metaTablesSQL .= " from $showSchema";
+		}
+		
+		if ($mask) {
+			$mask = $this->qstr($mask);
+			$this->metaTablesSQL .= " like $mask";
+		}
+		$ret =& ADOConnection::MetaTables($ttype,$showSchema);
+		
+		$this->metaTablesSQL = $save;
+		return $ret;
+	}
 	
  	function &MetaColumns($table) 
 	{
-	  if ($this->metaColumnsSQL) {
-	    global $ADODB_FETCH_MODE;
-	    $save = $ADODB_FETCH_MODE;
-	    $rs = false;
-	    switch($ADODB_FETCH_MODE)
-	      {
-	      case ADODB_FETCH_NUM:
-		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
-		$rs = $this->Execute(sprintf($this->metaColumnsSQL,
-					     $table));
+		if (!$this->metaColumnsSQL)
+			return false;
 		
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== false)
+			$savem = $this->SetFetchMode(false);
+		$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
+		if (isset($savem)) $this->SetFetchMode($savem);
 		$ADODB_FETCH_MODE = $save;
-		if ($rs === false) break;
+		if (!is_object($rs))
+			return false;
+		
 		$retarr = array();
-		while (!$rs->EOF){
-		  $fld = new ADOFieldObject();
-		  $fld->name = $rs->fields[0];
-		  $fld->type = $rs->fields[1];
-		  // split type into type(length):
-		  if (preg_match("/^(.+)\((\d+)\)$/", $fld->type, $query_array))
-		    {
-		      $fld->type = $query_array[1];
-		      $fld->max_length = $query_array[2];
-		    }
-		  else
-		    {
-		      $fld->max_length = -1;
-		    }
-		  $fld->not_null = ($rs->fields[2] != 'YES');
-		  $fld->primary_key = ($rs->fields[3] == 'PRI');
-		  $fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
-		  $fld->binary = (strpos($fld->type,'blob') !== false);
-		  if (!$fld->binary) 
-		    {
-		      $d = $rs->fields[4];
-		      $d = $rs->fields['Default'];
-		      if ($d != "" && $d != "NULL")
-			{
-			  $fld->has_default = true;
-			  $fld->default_value = $d;
-			} 
-		      else 
-			{
-			  $fld->has_default = false;
+		while (!$rs->EOF) {
+			$fld = new ADOFieldObject();
+			$fld->name = $rs->fields[0];
+			$type = $rs->fields[1];
+			
+			// split type into type(length):
+			$fld->scale = null;
+			if (preg_match("/^(.+)\((\d+),(\d+)/", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
+				$fld->scale = is_numeric($query_array[3]) ? $query_array[3] : -1;
+			} elseif (preg_match("/^(.+)\((\d+)/", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
+			} elseif (preg_match("/^(enum)\((.*)\)$/i", $type, $query_array)) {
+				$fld->type = $query_array[1];
+				$fld->max_length = max(array_map("strlen",explode(",",$query_array[2]))) - 2; // PHP >= 4.0.6
+				$fld->max_length = ($fld->max_length == 0 ? 1 : $fld->max_length);
+			} else {
+				$fld->type = $type;
+				$fld->max_length = -1;
 			}
-		    }
-		  $retarr[strtoupper($fld->name)] = $fld;	
-		  $rs->MoveNext();
-		}
-		break;
-	      case ADODB_FETCH_ASSOC:
-	      case ADODB_FETCH_DEFAULT:
-	      case ADODB_FETCH_BOTH:
-		$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
-		$rs = $this->Execute(sprintf($this->metaColumnsSQL,
-					     $table));
-		$ADODB_FETCH_MODE = $save;
-		if ($rs === false) break;
-		$retarr = array();
-		while (!$rs->EOF){
-		  $fld = new ADOFieldObject();
-		  $fld->name = $rs->fields['Field'];
-		  $fld->type = $rs->fields['Type'];
-				
-		  // split type into type(length):
-		  if (preg_match("/^(.+)\((\d+)\)$/", $fld->type, $query_array))
-		    {
-		      $fld->type = $query_array[1];
-		      $fld->max_length = $query_array[2];
-		    }
-		  else
-		    {
-		      $fld->max_length = -1;
-		    }
-		  $fld->not_null = ($rs->fields['Null'] != 'YES');
-		  $fld->primary_key = ($rs->fields['Key'] == 'PRI');
-		  $fld->auto_increment = (strpos($rs->fields['Extra'], 'auto_increment') !== false);
-		  $fld->binary = (strpos($fld->type,'blob') !== false);
-		  if (!$fld->binary) 
-		    {
-		      $d = $rs->fields['Default'];
-		      if ($d != "" && $d != "NULL")
-			{
-			  $fld->has_default = true;
-			  $fld->default_value = $d;
-			} 
-		      else 
-			{
-			  $fld->has_default = false;
+			$fld->not_null = ($rs->fields[2] != 'YES');
+			$fld->primary_key = ($rs->fields[3] == 'PRI');
+			$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
+			$fld->binary = (strpos($type,'blob') !== false);
+			$fld->unsigned = (strpos($type,'unsigned') !== false);
+
+			if (!$fld->binary) {
+				$d = $rs->fields[4];
+				if ($d != '' && $d != 'NULL') {
+					$fld->has_default = true;
+					$fld->default_value = $d;
+				} else {
+					$fld->has_default = false;
+				}
+			}
+			
+			if ($save == ADODB_FETCH_NUM) {
+				$retarr[] = $fld;
+			} else {
+				$retarr[strtoupper($fld->name)] = $fld;
 			}
-		    }
-		  $retarr[strtoupper($fld->name)] = $fld;	
-		  $rs->MoveNext();
+			$rs->MoveNext();
 		}
-		break;
-	      default:
-	      }
-	    
-	    if ($rs === false) return false;
-	    $rs->Close();
-	    return $retarr;	
-	  }
-	  return false;
+		
+		$rs->Close();
+		return $retarr;
 	}
 		
 	// returns true or false
@@ -572,7 +561,7 @@
 	function ErrorMsg() 
 	  {
 	    if (empty($this->_connectionID)) 
-	      $this->_errorMsg = @mysqli_error();
+	      $this->_errorMsg = @mysqli_connect_error();
 	    else 
 	      $this->_errorMsg = @mysqli_error($this->_connectionID);
 	    return $this->_errorMsg;
@@ -582,7 +571,7 @@
 	function ErrorNo() 
 	  {
 	    if (empty($this->_connectionID))  
-	      return @mysqli_errno();
+	      return @mysqli_connect_errno();
 	    else 
 	      return @mysqli_errno($this->_connectionID);
 	  }
@@ -644,7 +633,7 @@
 	      $this->fetchMode = MYSQLI_BOTH; 
 	      break;
 	    }
-	  
+	  $this->adodbFetchMode = $mode;
 	  $this->ADORecordSet($queryID);	
 	}
 	
@@ -710,7 +699,7 @@
 	{
 		if ($this->EOF) return false;
 		$this->_currentRow++;
-		$this->fields = mysqli_fetch_array($this->_queryID,$this->fetchMode);
+		$this->fields = @mysqli_fetch_array($this->_queryID,$this->fetchMode);
 		
 		if (is_array($this->fields)) return true;
 		$this->EOF = true;
@@ -729,70 +718,132 @@
 	  	$this->_queryID = false;	
 	}
 	
+/*
+
+0 = MYSQLI_TYPE_DECIMAL
+1 = MYSQLI_TYPE_CHAR
+1 = MYSQLI_TYPE_TINY
+2 = MYSQLI_TYPE_SHORT
+3 = MYSQLI_TYPE_LONG
+4 = MYSQLI_TYPE_FLOAT
+5 = MYSQLI_TYPE_DOUBLE
+6 = MYSQLI_TYPE_NULL
+7 = MYSQLI_TYPE_TIMESTAMP
+8 = MYSQLI_TYPE_LONGLONG
+9 = MYSQLI_TYPE_INT24
+10 = MYSQLI_TYPE_DATE
+11 = MYSQLI_TYPE_TIME
+12 = MYSQLI_TYPE_DATETIME
+13 = MYSQLI_TYPE_YEAR
+14 = MYSQLI_TYPE_NEWDATE
+247 = MYSQLI_TYPE_ENUM
+248 = MYSQLI_TYPE_SET
+249 = MYSQLI_TYPE_TINY_BLOB
+250 = MYSQLI_TYPE_MEDIUM_BLOB
+251 = MYSQLI_TYPE_LONG_BLOB
+252 = MYSQLI_TYPE_BLOB
+253 = MYSQLI_TYPE_VAR_STRING
+254 = MYSQLI_TYPE_STRING
+255 = MYSQLI_TYPE_GEOMETRY
+*/
+
 	function MetaType($t, $len = -1, $fieldobj = false)
 	{
-	  if (is_object($t)) 
-	    {
-	      $fieldobj = $t;
-	      $t = $fieldobj->type;
-	      $len = $fieldobj->max_length;
-	    }
+		if (is_object($t)) {
+		    $fieldobj = $t;
+		    $t = $fieldobj->type;
+		    $len = $fieldobj->max_length;
+		}
 		
-	  $len = -1; // mysql max_length is not accurate
-	  switch (strtoupper($t)) {
-	  case 'STRING': 
-	  case 'CHAR':
-	  case 'VARCHAR': 
-	  case 'TINYBLOB': 
-	  case 'TINYTEXT': 
-	  case 'ENUM': 
-	  case 'SET': 
-	    if ($len <= $this->blobSize) return 'C';
-	    
-	  case 'TEXT':
-	  case 'LONGTEXT': 
-	  case 'MEDIUMTEXT':
-	    return 'X';
-			
-	    // php_mysql extension always returns 'blob' even if 'text'
-	    // so we have to check whether binary...
-	  case 'IMAGE':
-	  case 'LONGBLOB': 
-	  case 'BLOB':
-	  case 'MEDIUMBLOB':
-	    return !empty($fieldobj->binary) ? 'B' : 'X';
-	  case 'YEAR':
-	  case 'DATE': 
-	    return 'D';
-		
-	  case 'TIME':
-	  case 'DATETIME':
-	  case 'TIMESTAMP': return 'T';
-		
-	  case 'INT': 
-	  case 'INTEGER':
-	  case 'BIGINT':
-	  case 'TINYINT':
-	  case 'MEDIUMINT':
-	  case 'SMALLINT': 
-			
-	    if (!empty($fieldobj->primary_key)) return 'R';
-	    else return 'I';
-	    // Added floating-point types
-	    // Maybe not necessery.
-	  case 'FLOAT':
-	  case 'DOUBLE':
-	    //		case 'DOUBLE PRECISION':
-	  case 'DECIMAL':
-	  case 'DEC':
-	  case 'FIXED':
-	  default: 
-	    return 'N';
-	  }
-	}
+		
+		 $len = -1; // mysql max_length is not accurate
+		 switch (strtoupper($t)) {
+		 case 'STRING': 
+		 case 'CHAR':
+		 case 'VARCHAR': 
+		 case 'TINYBLOB': 
+		 case 'TINYTEXT': 
+		 case 'ENUM': 
+		 case 'SET': 
+		
+		case MYSQLI_TYPE_TINY_BLOB :
+		case MYSQLI_TYPE_CHAR :
+		case MYSQLI_TYPE_STRING :
+		case MYSQLI_TYPE_ENUM :
+		case MYSQLI_TYPE_SET :
+		case 253 :
+		   if ($len <= $this->blobSize) return 'C';
+		   
+		case 'TEXT':
+		case 'LONGTEXT': 
+		case 'MEDIUMTEXT':
+		   return 'X';
+		
+		
+		   // php_mysql extension always returns 'blob' even if 'text'
+		   // so we have to check whether binary...
+		case 'IMAGE':
+		case 'LONGBLOB': 
+		case 'BLOB':
+		case 'MEDIUMBLOB':
+		
+		case MYSQLI_TYPE_BLOB :
+		case MYSQLI_TYPE_LONG_BLOB :
+		case MYSQLI_TYPE_MEDIUM_BLOB :
+		
+		   return !empty($fieldobj->binary) ? 'B' : 'X';
+		case 'YEAR':
+		case 'DATE': 
+		case MYSQLI_TYPE_DATE :
+		case MYSQLI_TYPE_YEAR :
+		
+		   return 'D';
+		
+		case 'TIME':
+		case 'DATETIME':
+		case 'TIMESTAMP':
+		
+		case MYSQLI_TYPE_DATETIME :
+		case MYSQLI_TYPE_NEWDATE :
+		case MYSQLI_TYPE_TIME :
+		case MYSQLI_TYPE_TIMESTAMP :
+		
+			return 'T';
+		
+		case 'INT': 
+		case 'INTEGER':
+		case 'BIGINT':
+		case 'TINYINT':
+		case 'MEDIUMINT':
+		case 'SMALLINT': 
+		
+		case MYSQLI_TYPE_INT24 :
+		case MYSQLI_TYPE_LONG :
+		case MYSQLI_TYPE_LONGLONG :
+		case MYSQLI_TYPE_SHORT :
+		case MYSQLI_TYPE_TINY :
+		
+		   if (!empty($fieldobj->primary_key)) return 'R';
+		   
+		   return 'I';
+		
+		
+		   // Added floating-point types
+		   // Maybe not necessery.
+		 case 'FLOAT':
+		 case 'DOUBLE':
+		   //		case 'DOUBLE PRECISION':
+		 case 'DECIMAL':
+		 case 'DEC':
+		 case 'FIXED':
+		 default:
+		 	//if (!is_numeric($t)) echo "<p>--- Error in type matching $t -----</p>"; 
+		 	return 'N';
+		}
+	} // function
 	
 
-}
+} // rs class
  
 }
 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysqlt.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysqlt.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-mysqlt.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-mysqlt.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -74,11 +74,13 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
-		default:
+		
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default: $this->fetchMode = MYSQL_BOTH; break;
 		}
 	
+		$this->adodbFetchMode = $mode;
 		$this->ADORecordSet($queryID);	
 	}
 	
@@ -108,9 +110,11 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
-		default:
+		
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default: 
+			$this->fetchMode = MYSQL_BOTH; break;
 		}
 	
 		$this->ADORecordSet($queryID);	
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-netezza.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-netezza.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-netezza.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-netezza.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
  
   First cut at the Netezza Driver by Josh Eldridge joshuae74#hotmail.com
  Based on the previous postgres drivers.
@@ -149,10 +149,12 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = PGSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = PGSQL_ASSOC; break;
-		default:
+		
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = PGSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default: $this->fetchMode = PGSQL_BOTH; break;
 		}
+		$this->adodbFetchMode = $mode;
 		$this->ADORecordSet($queryID);
 	}
 	
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci8.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci8.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci8.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci8.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 /*
 
-  version V4.50 6 July 2004 (c) 2000-2004 John Lim. All rights reserved.
+  version V4.62 2 Apr 2005 (c) 2000-2005 John Lim. All rights reserved.
 
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
@@ -99,6 +99,7 @@
 	{
 	global $ADODB_FETCH_MODE;
 	
+		$false = false;
 		$save = $ADODB_FETCH_MODE;
 		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
 		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
@@ -107,7 +108,9 @@
 		
 		if (isset($savem)) $this->SetFetchMode($savem);
 		$ADODB_FETCH_MODE = $save;
-		if (!$rs) return false;
+		if (!$rs) {
+			return $false;
+		}
 		$retarr = array();
 		while (!$rs->EOF) { //print_r($rs->fields);
 			$fld = new ADOFieldObject();
@@ -128,7 +131,7 @@
 			$rs->MoveNext();
 		}
 		$rs->Close();
-		return $retarr;
+		return (empty($retarr)) ? $false : $retarr;
 	}
 	
 	function Time()
@@ -203,12 +206,23 @@
 				
  		//if ($argHostname) print "<p>Connect: 1st argument should be left blank for $this->databaseType</p>";
 		if ($mode==1) {
-			$this->_connectionID = OCIPLogon($argUsername,$argPassword, $argDatabasename);
+			$this->_connectionID = ($this->charSet) ? 
+				OCIPLogon($argUsername,$argPassword, $argDatabasename)
+				:
+				OCIPLogon($argUsername,$argPassword, $argDatabasename, $this->charSet)
+				;
 			if ($this->_connectionID && $this->autoRollback)  OCIrollback($this->_connectionID);
 		} else if ($mode==2) {
-			$this->_connectionID = OCINLogon($argUsername,$argPassword, $argDatabasename);
+			$this->_connectionID = ($this->charSet) ? 
+				OCINLogon($argUsername,$argPassword, $argDatabasename)
+				:
+				OCINLogon($argUsername,$argPassword, $argDatabasename, $this->charSet);
+				
 		} else {
-			$this->_connectionID = OCILogon($argUsername,$argPassword, $argDatabasename);
+			$this->_connectionID = ($this->charSet) ? 
+				OCILogon($argUsername,$argPassword, $argDatabasename)
+				:
+				OCILogon($argUsername,$argPassword, $argDatabasename,$this->charSet);
 		}
 		if ($this->_connectionID === false) return false;
 		if ($this->_initdate) {
@@ -291,6 +305,73 @@
 		return $ret;
 	}
 	
+	// Mark Newnham 
+	function &MetaIndexes ($table, $primary = FALSE, $owner=false)
+	{
+        // save old fetch mode
+        global $ADODB_FETCH_MODE;
+
+        $save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+
+        if ($this->fetchMode !== FALSE) {
+               $savem = $this->SetFetchMode(FALSE);
+        }
+
+		// get index details
+		$table = strtoupper($table);
+
+		// get Primary index
+		$primary_key = '';
+
+		$false = false;
+		$rs = $this->Execute(sprintf("SELECT * FROM ALL_CONSTRAINTS WHERE UPPER(TABLE_NAME)='%s' AND CONSTRAINT_TYPE='P'",$table));
+		if ($row = $rs->FetchRow())
+		   $primary_key = $row[1]; //constraint_name
+
+		if ($primary==TRUE && $primary_key=='') {
+			 if (isset($savem)) 
+                $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+			return $false; //There is no primary key
+		}
+
+        $rs = $this->Execute(sprintf("SELECT ALL_INDEXES.INDEX_NAME, ALL_INDEXES.UNIQUENESS, ALL_IND_COLUMNS.COLUMN_POSITION, ALL_IND_COLUMNS.COLUMN_NAME FROM ALL_INDEXES,ALL_IND_COLUMNS WHERE UPPER(ALL_INDEXES.TABLE_NAME)='%s' AND ALL_IND_COLUMNS.INDEX_NAME=ALL_INDEXES.INDEX_NAME",$table));
+
+		
+        if (!is_object($rs)) {
+			if (isset($savem)) 
+				$this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+            return $false;
+        }
+
+		$indexes = array ();
+        // parse index data into array
+
+        while ($row = $rs->FetchRow()) {
+			if ($primary && $row[0] != $primary_key) continue;
+            if (!isset($indexes[$row[0]])) {
+				$indexes[$row[0]] = array(
+				   'unique' => ($row[1] == 'UNIQUE'),
+				   'columns' => array()
+				);
+            }
+            $indexes[$row[0]]['columns'][$row[2] - 1] = $row[3];
+        }
+
+        // sort columns by order in the index
+        foreach ( array_keys ($indexes) as $index ) {
+            ksort ($indexes[$index]['columns']);
+        }
+
+		if (isset($savem)) { 
+            $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+		}
+        return $indexes;
+	}
+	
 	function BeginTrans()
 	{	
 		if ($this->transOff) return true;
@@ -412,6 +493,14 @@
 				$s .= 'AM';
 				break;
 				
+			case 'w':
+				$s .= 'D';
+				break;
+				
+			case 'l':
+				$s .= 'DAY';
+				break;
+				
 			default:
 			// handle escape characters...
 				if ($ch == '\\') {
@@ -457,9 +546,9 @@
 				if ($offset > 0) $nrows += $offset;
 				//$inputarr['adodb_rownum'] = $nrows;
 				if ($this->databaseType == 'oci8po') {
-					$sql = "select * from ($sql) where rownum <= ?";
+					$sql = "select * from (".$sql.") where rownum <= ?";
 				} else {
-					$sql = "select * from ($sql) where rownum <= :adodb_offset";
+					$sql = "select * from (".$sql.") where rownum <= :adodb_offset";
 				} 
 				$inputarr['adodb_offset'] = $nrows;
 				$nrows = -1;
@@ -473,10 +562,13 @@
 			 // Algorithm by Tomas V V Cox, from PEAR DB oci8.php
 			
 			 // Let Oracle return the name of the columns
-			 $q_fields = "SELECT * FROM ($sql) WHERE NULL = NULL";
-			 if (!$stmt = OCIParse($this->_connectionID, $q_fields)) {
-				 return false;
-			 }
+			$q_fields = "SELECT * FROM (".$sql.") WHERE NULL = NULL";
+			 
+			$false = false;
+			if (! $stmt_arr = $this->Prepare($q_fields)) {
+				return $false;
+			}
+			$stmt = $stmt_arr[1];
 			 
 			 if (is_array($inputarr)) {
 			 	foreach($inputarr as $k => $v) {
@@ -499,7 +591,7 @@
 			
 			 if (!OCIExecute($stmt, OCI_DEFAULT)) {
 				 OCIFreeStatement($stmt); 
-				 return false;
+				 return $false;
 			 }
 			 
 			 $ncols = OCINumCols($stmt);
@@ -633,14 +725,12 @@
 		$sttype = @OCIStatementType($stmt);
 		if ($sttype == 'BEGIN' || $sttype == 'DECLARE') {
 			return array($sql,$stmt,0,$BINDNUM, ($cursor) ? OCINewCursor($this->_connectionID) : false);
-		} 
-		
+		}
 		return array($sql,$stmt,0,$BINDNUM);
 	}
 	
 	/*
-		Call an oracle stored procedure and return a cursor variable. 
-		Convert the cursor variable into a recordset. 
+		Call an oracle stored procedure and returns a cursor variable as a recordset. 
 		Concept by Robert Tuttle robert@ud.com
 		
 		Example:
@@ -655,17 +745,24 @@
 	*/
 	function &ExecuteCursor($sql,$cursorName='rs',$params=false)
 	{
-		$stmt = ADODB_oci8::Prepare($sql,true); # true to allocate OCINewCursor
-			
+		if (is_array($sql)) $stmt = $sql;
+		else $stmt = ADODB_oci8::Prepare($sql,true); # true to allocate OCINewCursor
+	
 		if (is_array($stmt) && sizeof($stmt) >= 5) {
+			$hasref = true;
 			$this->Parameter($stmt, $ignoreCur, $cursorName, false, -1, OCI_B_CURSOR);
 			if ($params) {
 				foreach($params as $k => $v) {
 					$this->Parameter($stmt,$params[$k], $k);
 				}
 			}
-		}
-		return $this->Execute($stmt);
+		} else
+			$hasref = false;
+			
+		$rs =& $this->Execute($stmt);
+		if ($rs->databaseType == 'array') OCIFreeCursor($stmt[4]);
+		else if ($hasref) $rs->_refcursor = $stmt[4];
+		return $rs;
 	}
 	
 	/*
@@ -716,25 +813,26 @@
 				ADOConnection::outp("<b>Bind</b>: name = $name");
 			}
             //we have to create a new Descriptor here
-			$numlob = count($this -> _refLOBs);
-        	$this -> _refLOBs[$numlob]['LOB'] = OCINewDescriptor($this->_connectionID, oci_lob_desc($type));
-			$this -> _refLOBs[$numlob]['TYPE'] = $isOutput;
+			$numlob = count($this->_refLOBs);
+        	$this->_refLOBs[$numlob]['LOB'] = OCINewDescriptor($this->_connectionID, oci_lob_desc($type));
+			$this->_refLOBs[$numlob]['TYPE'] = $isOutput;
 			
-			$tmp = &$this -> _refLOBs[$numlob]['LOB'];
+			$tmp = &$this->_refLOBs[$numlob]['LOB'];
 	        $rez = OCIBindByName($stmt[1], ":".$name, $tmp, -1, $type);
 			if ($this->debug) {
-				ADOConnection::outp("<b>Bind</b>: descriptor has been allocated, var binded");
+				ADOConnection::outp("<b>Bind</b>: descriptor has been allocated, var (".$name.") binded");
 			}
 			
 			// if type is input then write data to lob now
 			if ($isOutput == false) {
-				$var = $this -> BlobEncode($var);
-				$tmp -> WriteTemporary($var);
+				$var = $this->BlobEncode($var);
+				$tmp->WriteTemporary($var);
+				$this->_refLOBs[$numlob]['VAR'] = &$var;
 				if ($this->debug) {
 					ADOConnection::outp("<b>Bind</b>: LOB has been written to temp");
 				}
 			} else {
-				$this -> _refLOBs[$numlob]['VAR'] = &$var;
+				$this->_refLOBs[$numlob]['VAR'] = &$var;
 			}
 			$rez = $tmp;
 		} else {
@@ -791,7 +889,7 @@
 	   3. $db->execute('insert into table (a,b,c) values (:a,:b,:c)',array('a'=>1,'b'=>2,'c'=>3));
 	   
 	   4. $db->prepare('insert into table (a,b,c) values (:0,:1,:2)');
-		  $db->$bind($stmt,1); $db->bind($stmt,2); $db->bind($stmt,3); 
+		  $db->bind($stmt,1); $db->bind($stmt,2); $db->bind($stmt,3); 
 		  $db->execute($stmt);
 	*/ 
 	function _query($sql,$inputarr)
@@ -812,7 +910,7 @@
 					$bindarr = array();
 					foreach($inputarr as $k => $v) {
 						$bindarr[$k] = $v;
-						OCIBindByName($stmt,":$k",$bindarr[$k],4000);
+						OCIBindByName($stmt,":$k",$bindarr[$k],is_string($v) && strlen($v)>4000 ? -1 : 4000);
 					}
 					$this->_bind[$bindpos] = &$bindarr;
 				}
@@ -861,9 +959,14 @@
 						}
 						//$_GLOBALS[$this -> _refLOBs[$key]['VAR']] = $tmp;
 						$this -> _refLOBs[$key]['VAR'] = $tmp;
-					}
-					$this -> _refLOBs[$key]['LOB'] -> free();
-					unset($this -> _refLOBs[$key]);
+					} else {
+                        $this->_refLOBs[$key]['LOB']->save($this->_refLOBs[$key]['VAR']);
+						$this -> _refLOBs[$key]['LOB']->free();
+						unset($this -> _refLOBs[$key]);
+                        if ($this->debug) {
+							ADOConnection::outp("<b>IN LOB</b>: LOB has been saved. <br>");
+						}
+                    }					
 				}
 			}
 		
@@ -902,10 +1005,10 @@
 		if (!$this->_connectionID) return;
 		
 		if (!$this->autoCommit) OCIRollback($this->_connectionID);
-		if (count($this -> _refLOBs) > 0) {
-			foreach ($this -> _refLOBs as $key => $value) {
-				$this -> _refLOBs[$key] -> free();
-				unset($this -> _refLOBs[$key]);
+		if (count($this->_refLOBs) > 0) {
+			foreach ($this ->_refLOBs as $key => $value) {
+				$this->_refLOBs[$key]['LOB']->free();
+				unset($this->_refLOBs[$key]);
 			}
 		}
 		OCILogoff($this->_connectionID);
@@ -1040,6 +1143,7 @@
 	var $databaseType = 'oci8';
 	var $bind=false;
 	var $_fieldobjs;
+	
 	//var $_arr = false;
 		
 	function ADORecordset_oci8($queryID,$mode=false)
@@ -1050,13 +1154,15 @@
 		}
 		switch ($mode)
 		{
-		default:
-		case ADODB_FETCH_NUM: $this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		case ADODB_FETCH_DEFAULT:
 		case ADODB_FETCH_BOTH:$this->fetchMode = OCI_NUM+OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
+		case ADODB_FETCH_NUM: 
+		default:
+		$this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		}
-
+		
+		$this->adodbFetchMode = $mode;
 		$this->_queryID = $queryID;
 	}
 
@@ -1215,7 +1321,11 @@
 	function _close() 
 	{
 		if ($this->connection->_stmt === $this->_queryID) $this->connection->_stmt = false;
-		OCIFreeStatement($this->_queryID);
+		if (!empty($this->_refcursor)) {
+			OCIFreeCursor($this->_refcursor);
+			$this->_refcursor = false;
+		}
+		@OCIFreeStatement($this->_queryID);
  		$this->_queryID = false;
 		
 	}
@@ -1274,13 +1384,13 @@
 		}
 		switch ($mode)
 		{
-		default:
-		case ADODB_FETCH_NUM: $this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		case ADODB_FETCH_DEFAULT:
 		case ADODB_FETCH_BOTH:$this->fetchMode = OCI_NUM+OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
+		case ADODB_FETCH_NUM: 
+		default: $this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
 		}
-
+		$this->adodbFetchMode = $mode;
 		$this->_queryID = $queryID;
 	}
 	
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci805.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci805.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci805.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci805.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci8po.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci8po.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-oci8po.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-oci8po.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim. All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -45,6 +45,49 @@
 		$this->_has_stupid_odbc_fetch_api_change = ADODB_PHPVER >= 0x4200;
 	}
 	
+		// returns true or false
+	function _connect($argDSN, $argUsername, $argPassword, $argDatabasename)
+	{
+	global $php_errormsg;
+		
+		if (!function_exists('odbc_connect')) return null;
+		
+		if ($this->debug && $argDatabasename && $this->databaseType != 'vfp') {
+			ADOConnection::outp("For odbc Connect(), $argDatabasename is not used. Place dsn in 1st parameter.");
+		}
+		if (isset($php_errormsg)) $php_errormsg = '';
+		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
+		else $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword,$this->curmode);
+		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
+		
+		return $this->_connectionID != false;
+	}
+	
+	// returns true or false
+	function _pconnect($argDSN, $argUsername, $argPassword, $argDatabasename)
+	{
+	global $php_errormsg;
+	
+		if (!function_exists('odbc_connect')) return null;
+		
+		if (isset($php_errormsg)) $php_errormsg = '';
+		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+		if ($this->debug && $argDatabasename) {
+			ADOConnection::outp("For odbc PConnect(), $argDatabasename is not used. Place dsn in 1st parameter.");
+		}
+	//	print "dsn=$argDSN u=$argUsername p=$argPassword<br>"; flush();
+		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
+		else $this->_connectionID = odbc_pconnect($argDSN,$argUsername,$argPassword,$this->curmode);
+		
+		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+		if ($this->_connectionID && $this->autoRollback) @odbc_rollback($this->_connectionID);
+		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
+		
+		return $this->_connectionID != false;
+	}
+
+	
 	function ServerInfo()
 	{
 	
@@ -156,48 +199,6 @@
 	}
 	
 	
-	// returns true or false
-	function _connect($argDSN, $argUsername, $argPassword, $argDatabasename)
-	{
-	global $php_errormsg;
-		
-		if (!function_exists('odbc_connect')) return null;
-		
-		if ($this->debug && $argDatabasename && $this->databaseType != 'vfp') {
-			ADOConnection::outp("For odbc Connect(), $argDatabasename is not used. Place dsn in 1st parameter.");
-		}
-		if (isset($php_errormsg)) $php_errormsg = '';
-		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
-		else $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword,$this->curmode);
-		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
-		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
-		
-		//if ($this->_connectionID) odbc_autocommit($this->_connectionID,true);
-		return $this->_connectionID != false;
-	}
-	
-	// returns true or false
-	function _pconnect($argDSN, $argUsername, $argPassword, $argDatabasename)
-	{
-	global $php_errormsg;
-	
-		if (!function_exists('odbc_connect')) return null;
-		
-		if (isset($php_errormsg)) $php_errormsg = '';
-		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
-		if ($this->debug && $argDatabasename) {
-			ADOConnection::outp("For odbc PConnect(), $argDatabasename is not used. Place dsn in 1st parameter.");
-		}
-	//	print "dsn=$argDSN u=$argUsername p=$argPassword<br>"; flush();
-		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
-		else $this->_connectionID = odbc_pconnect($argDSN,$argUsername,$argPassword,$this->curmode);
-		
-		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
-		if ($this->_connectionID && $this->autoRollback) @odbc_rollback($this->_connectionID);
-		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
-		
-		return $this->_connectionID != false;
-	}
 
 	function BeginTrans()
 	{	
@@ -274,8 +275,10 @@
 		$rs = new ADORecordSet_odbc($qid);
 		
 		$ADODB_FETCH_MODE = $savem;
-		if (!$rs) return false;
-		
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
 		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
 		
 		$arr =& $rs->GetArray();
@@ -300,6 +303,7 @@
 	}
 	
 /*
+See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcdatetime_data_type_changes.asp
 / SQL data type codes /
 #define	SQL_UNKNOWN_TYPE	0
 #define SQL_CHAR			1
@@ -315,6 +319,7 @@
 #endif
 #define SQL_VARCHAR		12
 
+
 / One-parameter shortcuts for date/time data types /
 #if (ODBCVER >= 0x0300)
 #define SQL_TYPE_DATE	  91
@@ -340,13 +345,16 @@
 		case -4: //image
 			return 'B';
 				
+		case 9:	
 		case 91:
-		case 11:
 			return 'D';
-			
+		
+		case 10:
+		case 11:
 		case 92:
 		case 93:
-		case 9:	return 'T';
+			return 'T';
+			
 		case 4:
 		case 5:
 		case -6:
@@ -366,6 +374,7 @@
 	{
 	global $ADODB_FETCH_MODE;
 	
+		$false = false;
 		if ($this->uCaseTables) $table = strtoupper($table);
 		$schema = '';
 		$this->_findschema($table,$schema);
@@ -411,15 +420,15 @@
 			if (empty($qid)) $qid = odbc_columns($this->_connectionID);
 			break;
 		}
-		if (empty($qid)) return false;
+		if (empty($qid)) return $false;
 		
-		$rs = new ADORecordSet_odbc($qid);
+		$rs =& new ADORecordSet_odbc($qid);
 		$ADODB_FETCH_MODE = $savem;
 		
-		if (!$rs) return false;
-		
+		if (!$rs) return $false;
 		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
 		$rs->_fetch();
+		
 		$retarr = array();
 		
 		/*
@@ -438,8 +447,8 @@
 		11 REMARKS
 		*/
 		while (!$rs->EOF) {
-			//adodb_pr($rs->fields);
-			if (strtoupper($rs->fields[2]) == $table && (!$schema || strtoupper($rs->fields[1]) == $schema)) {
+		//	adodb_pr($rs->fields);
+			if (strtoupper(trim($rs->fields[2])) == $table && (!$schema || strtoupper($rs->fields[1]) == $schema)) {
 				$fld = new ADOFieldObject();
 				$fld->name = $rs->fields[3];
 				$fld->type = $this->ODBCTypes($rs->fields[4]);
@@ -464,7 +473,7 @@
 		}
 		$rs->Close(); //-- crashes 4.03pl1 -- why?
 		
-		return $retarr;
+		return empty($retarr) ? $false : $retarr;
 	}
 	
 	function Prepare($sql)
@@ -681,11 +690,13 @@
 	{
 		if ($this->_numOfRows != 0 && !$this->EOF) {		
 			$this->_currentRow++;
-			$row = 0;
+			
 			if ($this->_has_stupid_odbc_fetch_api_change)
 				$rez = @odbc_fetch_into($this->_queryID,$this->fields);
-			else 
+			else {
+				$row = 0;
 				$rez = @odbc_fetch_into($this->_queryID,$row,$this->fields);
+			}
 			if ($rez) {
 				if ($this->fetchMode & ADODB_FETCH_ASSOC) {
 					$this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
@@ -700,12 +711,13 @@
 	
 	function _fetch()
 	{
-		$row = 0;
+		
 		if ($this->_has_stupid_odbc_fetch_api_change)
 			$rez = @odbc_fetch_into($this->_queryID,$this->fields,$row);
-		else 
+		else {
+			$row = 0;
 			$rez = @odbc_fetch_into($this->_queryID,$row,$this->fields);
-		
+		}
 		if ($rez) {
 			if ($this->fetchMode & ADODB_FETCH_ASSOC) {
 				$this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc_mssql.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc_mssql.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc_mssql.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc_mssql.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -43,7 +43,7 @@
 	function ADODB_odbc_mssql()
 	{
 		$this->ADODB_odbc();
-		$this->curmode = SQL_CUR_USE_ODBC;	
+		//$this->curmode = SQL_CUR_USE_ODBC;	
 	}
 
 	// crashes php...
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc_oracle.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc_oracle.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbc_oracle.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbc_oracle.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -38,44 +38,41 @@
 		
 	function &MetaTables() 
 	{
-		if ($this->metaTablesSQL) {
-			$rs = $this->Execute($this->metaTablesSQL);
-			if ($rs === false) return false;
-			$arr = $rs->GetArray();
-			$arr2 = array();
-			for ($i=0; $i < sizeof($arr); $i++) {
-				$arr2[] = $arr[$i][0];
-			}
-			$rs->Close();
-			return $arr2;
+		$false = false;
+		$rs = $this->Execute($this->metaTablesSQL);
+		if ($rs === false) return $false;
+		$arr = $rs->GetArray();
+		$arr2 = array();
+		for ($i=0; $i < sizeof($arr); $i++) {
+			$arr2[] = $arr[$i][0];
 		}
-		return false;
+		$rs->Close();
+		return $arr2;
 	}
 	
 	function &MetaColumns($table) 
 	{
-		if (!empty($this->metaColumnsSQL)) {
 		
-			$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
-			if ($rs === false) return false;
-
-			$retarr = array();
-			while (!$rs->EOF) { //print_r($rs->fields);
-				$fld = new ADOFieldObject();
-				$fld->name = $rs->fields[0];
-				$fld->type = $rs->fields[1];
-				$fld->max_length = $rs->fields[2];
-				
-				
-				if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] = $fld;	
-				else $retarr[strtoupper($fld->name)] = $fld;
-				
-				$rs->MoveNext();
-			}
-			$rs->Close();
-			return $retarr;	
+		$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
+		if ($rs === false) {	
+			$false = false;
+			return $false;
+		}
+		$retarr = array();
+		while (!$rs->EOF) { //print_r($rs->fields);
+			$fld = new ADOFieldObject();
+			$fld->name = $rs->fields[0];
+			$fld->type = $rs->fields[1];
+			$fld->max_length = $rs->fields[2];
+			
+			
+			if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] = $fld;	
+			else $retarr[strtoupper($fld->name)] = $fld;
+			
+			$rs->MoveNext();
 		}
-		return false;
+		$rs->Close();
+		return $retarr;	
 	}
 
 	// returns true or false
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbtp.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbtp.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbtp.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbtp.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence. See License.txt.
@@ -28,10 +28,10 @@
 
 	var $_genSeqSQL = "create table %s (seq_name char(30) not null unique , seq_value integer not null)";
 	var $_dropSeqSQL = "delete from adodb_seq where seq_name = '%s'";
-	var $_autocommit = true;
 	var $_bindInputArray = false;
 	var $_useUnicodeSQL = false;
 	var $_canPrepareSP = false;
+	var $_dontPoolDBC = true;
 
 	function ADODB_odbtp()
 	{
@@ -106,7 +106,7 @@
 	function GenID($seq='adodbseq',$start=1)
 	{
 		$seqtab='adodb_seq';
-		if( $this->odbc_driver == ODB_DRIVER_FOXPRO ) {
+		if( $this->odbc_driver == ODB_DRIVER_FOXPRO) {
 			$path = @odbtp_get_attr( ODB_ATTR_DATABASENAME, $this->_connectionID );
 			//if using vfp dbc file
 			if( !strcasecmp(strrchr($path, '.'), '.dbc') )
@@ -150,16 +150,31 @@
     function _connect($HostOrInterface, $UserOrDSN='', $argPassword='', $argDatabase='')
 	{
 		$this->_connectionID = @odbtp_connect($HostOrInterface,$UserOrDSN,$argPassword,$argDatabase);
-		if ($this->_connectionID === false)
-		{
+		if ($this->_connectionID === false) {
 			$this->_errorMsg = $this->ErrorMsg() ;
 			return false;
 		}
+		if ($this->_dontPoolDBC) {
+			if (function_exists('odbtp_dont_pool_dbc'))
+				@odbtp_dont_pool_dbc($this->_connectionID);
+		}
+		else {
+			$this->_dontPoolDBC = true;
+		}
 		$this->odbc_driver = @odbtp_get_attr(ODB_ATTR_DRIVER, $this->_connectionID);
-
-		// Set driver specific attributes
-		switch( $this->odbc_driver ) {
-			case ODB_DRIVER_MSSQL:
+		$dbms = strtolower(@odbtp_get_attr(ODB_ATTR_DBMSNAME, $this->_connectionID));
+		$this->odbc_name = $dbms;
+		
+		// Account for inconsistent DBMS names
+		if( $this->odbc_driver == ODB_DRIVER_ORACLE )
+			$dbms = 'oracle';
+		else if( $this->odbc_driver == ODB_DRIVER_SYBASE )
+			$dbms = 'sybase';
+
+		// Set DBMS specific attributes
+		switch( $dbms ) {
+			case 'microsoft sql server':
+				$this->databaseType = 'odbtp_mssql';
 				$this->fmtDate = "'Y-m-d'";
 				$this->fmtTimeStamp = "'Y-m-d h:i:sA'";
 				$this->sysDate = 'convert(datetime,convert(char,GetDate(),102),102)';
@@ -176,8 +191,10 @@
 				$this->length = 'len';
 				$this->identitySQL = 'select @@IDENTITY';
 				$this->metaDatabasesSQL = "select name from master..sysdatabases where name <> 'master'";
+				$this->_canPrepareSP = true;
 				break;
-			case ODB_DRIVER_JET:
+			case 'access':
+				$this->databaseType = 'odbtp_access';
 				$this->fmtDate = "#Y-m-d#";
 				$this->fmtTimeStamp = "#Y-m-d h:i:sA#";
 				$this->sysDate = "FORMAT(NOW,'yyyy-mm-dd')";
@@ -185,24 +202,22 @@
                 $this->hasTop = 'top';
 				$this->hasTransactions = false;
 				$this->_canPrepareSP = true;  // For MS Access only.
-
-				// Can't rebind ODB_CHAR to ODB_WCHAR if row cache enabled.
-				if ($this->_useUnicodeSQL)
-					odbtp_use_row_cache($this->_connectionID, FALSE, 0);
 				break;
-			case ODB_DRIVER_FOXPRO:
+			case 'visual foxpro':
+				$this->databaseType = 'odbtp_vfp';
 				$this->fmtDate = "{^Y-m-d}";
 				$this->fmtTimeStamp = "{^Y-m-d, h:i:sA}";
 				$this->sysDate = 'date()';
 				$this->sysTimeStamp = 'datetime()';
 				$this->ansiOuter = true;
                 $this->hasTop = 'top';
-			$this->hasTransactions = false;
+				$this->hasTransactions = false;
 				$this->replaceQuote = "'+chr(39)+'";
 				$this->true = '.T.';
 				$this->false = '.F.';
 				break;
-			case ODB_DRIVER_ORACLE:
+			case 'oracle':
+				$this->databaseType = 'odbtp_oci8';
 				$this->fmtDate = "'Y-m-d 00:00:00'";
 				$this->fmtTimeStamp = "'Y-m-d h:i:sA'";
 				$this->sysDate = 'TRUNC(SYSDATE)';
@@ -211,7 +226,8 @@
 				$this->_bindInputArray = true;
 				$this->concat_operator = '||';
 				break;
-			case ODB_DRIVER_SYBASE:
+			case 'sybase':
+				$this->databaseType = 'odbtp_sybase';
 				$this->fmtDate = "'Y-m-d'";
 				$this->fmtTimeStamp = "'Y-m-d H:i:s'";
 				$this->sysDate = 'GetDate()';
@@ -223,22 +239,26 @@
 				$this->identitySQL = 'select @@IDENTITY';
 				break;
 			default:
+				$this->databaseType = 'odbtp';
 				if( @odbtp_get_attr(ODB_ATTR_TXNCAPABLE, $this->_connectionID) )
-			$this->hasTransactions = true;
+					$this->hasTransactions = true;
 				else
 					$this->hasTransactions = false;
 		}
         @odbtp_set_attr(ODB_ATTR_FULLCOLINFO, TRUE, $this->_connectionID );
+
 		if ($this->_useUnicodeSQL )
 			@odbtp_set_attr(ODB_ATTR_UNICODESQL, TRUE, $this->_connectionID);
+
         return true;
 	}
-	
+
 	function _pconnect($HostOrInterface, $UserOrDSN='', $argPassword='', $argDatabase='')
 	{
+		$this->_dontPoolDBC = false;
   		return $this->_connect($HostOrInterface, $UserOrDSN, $argPassword, $argDatabase);
 	}
-	
+
 	function SelectDB($dbName)
 	{
 		if (!@odbtp_select_db($dbName, $this->_connectionID)) {
@@ -254,7 +274,11 @@
 
 		$savem = $ADODB_FETCH_MODE;
 		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== false) $savefm = $this->SetFetchMode(false);
+		
 		$arr =& $this->GetArray("||SQLTables||||$ttype");
+		
+		if (isset($savefm)) $this->SetFetchMode($savefm);
 		$ADODB_FETCH_MODE = $savem;
 
 		$arr2 = array();
@@ -276,11 +300,17 @@
 
 		$savem = $ADODB_FETCH_MODE;
 		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== false) $savefm = $this->SetFetchMode(false);
+		
 		$rs = $this->Execute( "||SQLColumns||$schema|$table" );
+		
+		if (isset($savefm)) $this->SetFetchMode($savefm);
 		$ADODB_FETCH_MODE = $savem;
 
-		if (!$rs) return false;
-		
+		if (!$rs || $rs->EOF) {
+			$false = false;
+			return $false;
+		}
 		while (!$rs->EOF) {
 			//print_r($rs->fields);
 			if (strtoupper($rs->fields[2]) == $table) {
@@ -299,7 +329,7 @@
 				break;
 			$rs->MoveNext();
 		}
-		$rs->Close(); 
+		$rs->Close();
 
 		return $retarr;
 	}
@@ -335,8 +365,11 @@
 			//print_r($constr);
 			$arr[$constr[11]][$constr[2]][] = $constr[7].'='.$constr[3];
 		}
-		if (!$arr) return false;
-
+		if (!$arr) {
+			$false = false;
+			return $false;
+		}
+		
 		$arr2 = array();
 
 		foreach($arr as $k => $v) {
@@ -353,10 +386,14 @@
 		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true;
 		$this->transCnt += 1;
-		$this->_autocommit = false;
-		$rs = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS,ODB_TXN_READUNCOMMITTED,$this->_connectionID);
+		$this->autoCommit = false;
+		if (defined('ODB_TXN_DEFAULT'))
+			$txn = ODB_TXN_DEFAULT;
+		else
+			$txn = ODB_TXN_READUNCOMMITTED;
+		$rs = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS,$txn,$this->_connectionID);
 		if(!$rs) return false;
-		else return true;
+		return true;
 	}
 
 	function CommitTrans($ok=true)
@@ -364,8 +401,8 @@
 		if ($this->transOff) return true;
 		if (!$ok) return $this->RollbackTrans();
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->_autocommit = true;
-		if( ($ret = odbtp_commit($this->_connectionID)) )
+		$this->autoCommit = true;
+		if( ($ret = @odbtp_commit($this->_connectionID)) )
 			$ret = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS, ODB_TXN_NONE, $this->_connectionID);//set transaction off
 		return $ret;
 	}
@@ -374,8 +411,8 @@
 	{
 		if ($this->transOff) return true;
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->_autocommit = true;
-		if( ($ret = odbtp_rollback($this->_connectionID)) )
+		$this->autoCommit = true;
+		if( ($ret = @odbtp_rollback($this->_connectionID)) )
 			$ret = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS, ODB_TXN_NONE, $this->_connectionID);//set transaction off
 		return $ret;
 	}
@@ -392,7 +429,7 @@
 	function Prepare($sql)
 	{
 		if (! $this->_bindInputArray) return $sql; // no binding
-		$stmt = odbtp_prepare($sql,$this->_connectionID);
+		$stmt = @odbtp_prepare($sql,$this->_connectionID);
 		if (!$stmt) {
 		//	print "Prepare Error for ($sql) ".$this->ErrorMsg()."<br>";
 			return $sql;
@@ -404,7 +441,7 @@
 	{
 		if (!$this->_canPrepareSP) return $sql; // Can't prepare procedures
 
-		$stmt = odbtp_prepare_proc($sql,$this->_connectionID);
+		$stmt = @odbtp_prepare_proc($sql,$this->_connectionID);
 		if (!$stmt) return false;
 		return array($sql,$stmt);
 	}
@@ -441,7 +478,7 @@
 		else {
 			$name = '@'.$name;
 		}
-		return odbtp_attach_param($stmt[1], $name, $var, $type, $maxLen);
+		return @odbtp_attach_param($stmt[1], $name, $var, $type, $maxLen);
 	}
 
 	/*
@@ -457,13 +494,13 @@
 	function UpdateBlob($table,$column,$val,$where,$blobtype='image')
 	{
 		$sql = "UPDATE $table SET $column = ? WHERE $where";
-		if( !($stmt = odbtp_prepare($sql, $this->_connectionID)) )
+		if( !($stmt = @odbtp_prepare($sql, $this->_connectionID)) )
 			return false;
-		if( !odbtp_input( $stmt, 1, ODB_BINARY, 1000000, $blobtype ) )
+		if( !@odbtp_input( $stmt, 1, ODB_BINARY, 1000000, $blobtype ) )
 			return false;
-		if( !odbtp_set( $stmt, 1, $val ) )
+		if( !@odbtp_set( $stmt, 1, $val ) )
 			return false;
-		return odbtp_execute( $stmt ) != false;
+		return @odbtp_execute( $stmt ) != false;
 	}
 
 	function IfNull( $field, $ifNull )
@@ -483,23 +520,23 @@
 			if (is_array($sql)) {
 				$stmtid = $sql[1];
 			} else {
-				$stmtid = odbtp_prepare($sql,$this->_connectionID);
+				$stmtid = @odbtp_prepare($sql,$this->_connectionID);
 				if ($stmtid == false) {
 					$this->_errorMsg = $php_errormsg;
 					return false;
 				}
 			}
-			$num_params = odbtp_num_params( $stmtid );
+			$num_params = @odbtp_num_params( $stmtid );
 			for( $param = 1; $param <= $num_params; $param++ ) {
 				@odbtp_input( $stmtid, $param );
 				@odbtp_set( $stmtid, $param, $inputarr[$param-1] );
 			}
-			if (! odbtp_execute($stmtid) ) {
+			if (!@odbtp_execute($stmtid) ) {
 				return false;
 			}
 		} else if (is_array($sql)) {
 			$stmtid = $sql[1];
-			if (!odbtp_execute($stmtid)) {
+			if (!@odbtp_execute($stmtid)) {
 				return false;
 			}
 		} else {
@@ -540,6 +577,19 @@
 		$this->_numOfFields = @odbtp_num_fields($this->_queryID);
 		if (!($this->_numOfRows = @odbtp_num_rows($this->_queryID)))
 			$this->_numOfRows = -1;
+
+		if (!$this->connection->_useUnicodeSQL) return;
+
+		if ($this->connection->odbc_driver == ODB_DRIVER_JET) {
+			if (!@odbtp_get_attr(ODB_ATTR_MAPCHARTOWCHAR,
+			                     $this->connection->_connectionID))
+			{
+				for ($f = 0; $f < $this->_numOfFields; $f++) {
+					if (@odbtp_field_bindtype($this->_queryID, $f) == ODB_CHAR)
+						@odbtp_bind_field($this->_queryID, $f, ODB_WCHAR);
+				}
+			}
+		}
 	}
 
 	function &FetchField($fieldOffset = 0)
@@ -570,7 +620,7 @@
 				$this->bind[strtoupper($name)] = $i;
 			}
 		}
-		 return $this->fields[$this->bind[strtoupper($colname)]];
+		return $this->fields[$this->bind[strtoupper($colname)]];
 	}
 
 	function _fetch_odbtp($type=0)
@@ -597,18 +647,18 @@
 	{
 		if (!$this->_fetch_odbtp(ODB_FETCH_FIRST)) return false;
 		$this->EOF = false;
-	  $this->_currentRow = 0;
-	  return true;
+		$this->_currentRow = 0;
+		return true;
     }
 
-    function MoveLast()
-   {
+	function MoveLast()
+	{
 		if (!$this->_fetch_odbtp(ODB_FETCH_LAST)) return false;
 		$this->EOF = false;
 		$this->_currentRow = $this->_numOfRows - 1;
-	  return true;
-    }
-    
+		return true;
+	}
+
 	function NextRecordSet()
 	{
 		if (!@odbtp_next_result($this->_queryID)) return false;
@@ -625,4 +675,53 @@
 	}
 }
 
-?>
\ No newline at end of file
+class ADORecordSet_odbtp_mssql extends ADORecordSet_odbtp {
+
+	var $databaseType = 'odbtp_mssql';
+
+	function ADORecordSet_odbtp_mssql($id,$mode=false)
+	{
+		return $this->ADORecordSet_odbtp($id,$mode);
+	}
+}
+
+class ADORecordSet_odbtp_access extends ADORecordSet_odbtp {
+
+	var $databaseType = 'odbtp_access';
+
+	function ADORecordSet_odbtp_access($id,$mode=false)
+	{
+		return $this->ADORecordSet_odbtp($id,$mode);
+	}
+}
+
+class ADORecordSet_odbtp_vfp extends ADORecordSet_odbtp {
+
+	var $databaseType = 'odbtp_vfp';
+
+	function ADORecordSet_odbtp_vfp($id,$mode=false)
+	{
+		return $this->ADORecordSet_odbtp($id,$mode);
+	}
+}
+
+class ADORecordSet_odbtp_oci8 extends ADORecordSet_odbtp {
+
+	var $databaseType = 'odbtp_oci8';
+
+	function ADORecordSet_odbtp_oci8($id,$mode=false)
+	{
+		return $this->ADORecordSet_odbtp($id,$mode);
+	}
+}
+
+class ADORecordSet_odbtp_sybase extends ADORecordSet_odbtp {
+
+	var $databaseType = 'odbtp_sybase';
+
+	function ADORecordSet_odbtp_sybase($id,$mode=false)
+	{
+		return $this->ADORecordSet_odbtp($id,$mode);
+	}
+}
+?>
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbtp_unicode.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbtp_unicode.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-odbtp_unicode.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-odbtp_unicode.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+	V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence. See License.txt.
@@ -28,7 +28,7 @@
 }
 
 class ADODB_odbtp_unicode extends ADODB_odbtp {
-	var $databaseType = "odbtp_unicode";
+	var $databaseType = 'odbtp';
 	var $_useUnicodeSQL = true;
 
 	function ADODB_odbtp_unicode()
@@ -36,27 +36,4 @@
 		$this->ADODB_odbtp();
 	}
 }
-
-class ADORecordSet_odbtp_unicode extends ADORecordSet_odbtp {
-	var $databaseType = 'odbtp_unicode';
-
-	function ADORecordSet_odbtp_unicode($queryID,$mode=false)
-	{
-		$this->ADORecordSet_odbtp($queryID, $mode);
-	}
-
-	function _initrs()
-	{
-		$this->_numOfFields = @odbtp_num_fields($this->_queryID);
-		if (!($this->_numOfRows = @odbtp_num_rows($this->_queryID)))
-			$this->_numOfRows = -1;
-
-		if ($this->connection->odbc_driver == ODB_DRIVER_JET) {
-			for ($f = 0; $f < $this->_numOfFields; $f++) {
-				if (odbtp_field_bindtype($this->_queryID, $f) == ODB_CHAR)
-					odbtp_bind_field($this->_queryID, $f, ODB_WCHAR);
-			}
-		}
-	}
-}
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-oracle.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-oracle.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-oracle.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-oracle.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-pdo.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-pdo.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-pdo.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-pdo.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -9,14 +9,290 @@
   Latest version is available at http://adodb.sourceforge.net
   
   Requires ODBC. Works on Windows and Unix.
+
+	Problems: 
+		Where is float/decimal type in pdo_param_type
+		LOB handling for CLOB/BLOB differs significantly
 */
 // security - hide paths
 if (!defined('ADODB_DIR')) die();
+
+
+/*
+enum pdo_param_type {
+PDO_PARAM_NULL, 0
+
+/* int as in long (the php native int type).
+ * If you mark a column as an int, PDO expects get_col to return
+ * a pointer to a long 
+PDO_PARAM_INT, 1
+
+/* get_col ptr should point to start of the string buffer 
+PDO_PARAM_STR, 2
+
+/* get_col: when len is 0 ptr should point to a php_stream *,
+ * otherwise it should behave like a string. Indicate a NULL field
+ * value by setting the ptr to NULL 
+PDO_PARAM_LOB, 3
+
+/* get_col: will expect the ptr to point to a new PDOStatement object handle,
+ * but this isn't wired up yet 
+PDO_PARAM_STMT, 4 /* hierarchical result set 
+
+/* get_col ptr should point to a zend_bool 
+PDO_PARAM_BOOL, 5
+
+
+/* magic flag to denote a parameter as being input/output 
+PDO_PARAM_INPUT_OUTPUT = 0x80000000
+};
+*/
+	
+function adodb_pdo_type($t)
+{
+	switch($t) {
+	case 2: return 'VARCHAR';
+	case 3: return 'BLOB';
+	default: return 'NUMERIC';
+	}
+}
 	 
 /*--------------------------------------------------------------------------------------
 --------------------------------------------------------------------------------------*/
 
 
+class ADODB_pdo_pgsql extends ADODB_pdo {
+var $metaDatabasesSQL = "select datname from pg_database where datname not in ('template0','template1') order by 1";
+    var $metaTablesSQL = "select tablename,'T' from pg_tables where tablename not like 'pg\_%'
+	and tablename not in ('sql_features', 'sql_implementation_info', 'sql_languages',
+	 'sql_packages', 'sql_sizing', 'sql_sizing_profiles') 
+	union 
+        select viewname,'V' from pg_views where viewname not like 'pg\_%'";
+	//"select tablename from pg_tables where tablename not like 'pg_%' order by 1";
+	var $isoDates = true; // accepts dates in ISO format
+	var $sysDate = "CURRENT_DATE";
+	var $sysTimeStamp = "CURRENT_TIMESTAMP";
+	var $blobEncodeType = 'C';
+	var $metaColumnsSQL = "SELECT a.attname,t.typname,a.attlen,a.atttypmod,a.attnotnull,a.atthasdef,a.attnum 
+		FROM pg_class c, pg_attribute a,pg_type t 
+		WHERE relkind in ('r','v') AND (c.relname='%s' or c.relname = lower('%s')) and a.attname not like '....%%'
+AND a.attnum > 0 AND a.atttypid = t.oid AND a.attrelid = c.oid ORDER BY a.attnum";
+
+	// used when schema defined
+	var $metaColumnsSQL1 = "SELECT a.attname, t.typname, a.attlen, a.atttypmod, a.attnotnull, a.atthasdef, a.attnum 
+FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n 
+WHERE relkind in ('r','v') AND (c.relname='%s' or c.relname = lower('%s'))
+ and c.relnamespace=n.oid and n.nspname='%s' 
+	and a.attname not like '....%%' AND a.attnum > 0 
+	AND a.atttypid = t.oid AND a.attrelid = c.oid ORDER BY a.attnum";
+	
+	// get primary key etc -- from Freek Dijkstra
+	var $metaKeySQL = "SELECT ic.relname AS index_name, a.attname AS column_name,i.indisunique AS unique_key, i.indisprimary AS primary_key 
+	FROM pg_class bc, pg_class ic, pg_index i, pg_attribute a WHERE bc.oid = i.indrelid AND ic.oid = i.indexrelid AND (i.indkey[0] = a.attnum OR i.indkey[1] = a.attnum OR i.indkey[2] = a.attnum OR i.indkey[3] = a.attnum OR i.indkey[4] = a.attnum OR i.indkey[5] = a.attnum OR i.indkey[6] = a.attnum OR i.indkey[7] = a.attnum) AND a.attrelid = bc.oid AND bc.relname = '%s'";
+	
+	var $hasAffectedRows = true;
+	var $hasLimit = false;	// set to true for pgsql 7 only. support pgsql/mysql SELECT * FROM TABLE LIMIT 10
+	// below suggested by Freek Dijkstra 
+	var $true = 't';		// string that represents TRUE for a database
+	var $false = 'f';		// string that represents FALSE for a database
+	var $fmtDate = "'Y-m-d'";	// used by DBDate() as the default date format used by the database
+	var $fmtTimeStamp = "'Y-m-d G:i:s'"; // used by DBTimeStamp as the default timestamp fmt.
+	var $hasMoveFirst = true;
+	var $hasGenID = true;
+	var $_genIDSQL = "SELECT NEXTVAL('%s')";
+	var $_genSeqSQL = "CREATE SEQUENCE %s START %s";
+	var $_dropSeqSQL = "DROP SEQUENCE %s";
+	var $metaDefaultsSQL = "SELECT d.adnum as num, d.adsrc as def from pg_attrdef d, pg_class c where d.adrelid=c.oid and c.relname='%s' order by d.adnum";
+	var $random = 'random()';		/// random function
+	var $concat_operator='||';
+	 
+	function ServerInfo()
+	{
+		$arr['description'] = ADOConnection::GetOne("select version()");
+		$arr['version'] = ADOConnection::_findvers($arr['description']);
+		return $arr;
+	}
+	
+	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
+	{
+		 $offsetStr = ($offset >= 0) ? " OFFSET $offset" : '';
+		 $limitStr  = ($nrows >= 0)  ? " LIMIT $nrows" : '';
+		 if ($secs2cache)
+		  	$rs =& $this->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
+		 else
+		  	$rs =& $this->Execute($sql."$limitStr$offsetStr",$inputarr);
+		
+		return $rs;
+	}
+	
+	function &MetaTables($ttype=false,$showSchema=false,$mask=false) 
+	{
+		$info = $this->ServerInfo();
+		if ($info['version'] >= 7.3) {
+	    	$this->metaTablesSQL = "select tablename,'T' from pg_tables where tablename not like 'pg\_%'
+			  and schemaname  not in ( 'pg_catalog','information_schema')
+	union 
+        select viewname,'V' from pg_views where viewname not like 'pg\_%'  and schemaname  not in ( 'pg_catalog','information_schema') ";
+		}
+		if ($mask) {
+			$save = $this->metaTablesSQL;
+			$mask = $this->qstr(strtolower($mask));
+			if ($info['version']>=7.3)
+				$this->metaTablesSQL = "
+select tablename,'T' from pg_tables where tablename like $mask and schemaname not in ( 'pg_catalog','information_schema')  
+ union 
+select viewname,'V' from pg_views where viewname like $mask and schemaname  not in ( 'pg_catalog','information_schema')  ";
+			else
+				$this->metaTablesSQL = "
+select tablename,'T' from pg_tables where tablename like $mask 
+ union 
+select viewname,'V' from pg_views where viewname like $mask";
+		}
+		$ret =& ADOConnection::MetaTables($ttype,$showSchema);
+		
+		if ($mask) {
+			$this->metaTablesSQL = $save;
+		}
+		return $ret;
+	}
+	
+function &MetaColumns($table,$normalize=true) 
+	{
+	global $ADODB_FETCH_MODE;
+	
+		$schema = false;
+		$this->_findschema($table,$schema);
+		
+		if ($normalize) $table = strtolower($table);
+
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
+		
+		if ($schema) $rs =& $this->Execute(sprintf($this->metaColumnsSQL1,$table,$table,$schema));
+		else $rs =& $this->Execute(sprintf($this->metaColumnsSQL,$table,$table));
+		if (isset($savem)) $this->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
+		
+		if ($rs === false) {
+			$false = false;
+			return $false;
+		}
+		if (!empty($this->metaKeySQL)) {
+			// If we want the primary keys, we have to issue a separate query
+			// Of course, a modified version of the metaColumnsSQL query using a 
+			// LEFT JOIN would have been much more elegant, but postgres does 
+			// not support OUTER JOINS. So here is the clumsy way.
+			
+			$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+			
+			$rskey = $this->Execute(sprintf($this->metaKeySQL,($table)));
+			// fetch all result in once for performance.
+			$keys =& $rskey->GetArray();
+			if (isset($savem)) $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+			
+			$rskey->Close();
+			unset($rskey);
+		}
+
+		$rsdefa = array();
+		if (!empty($this->metaDefaultsSQL)) {
+			$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+			$sql = sprintf($this->metaDefaultsSQL, ($table));
+			$rsdef = $this->Execute($sql);
+			if (isset($savem)) $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+			
+			if ($rsdef) {
+				while (!$rsdef->EOF) {
+					$num = $rsdef->fields['num'];
+					$s = $rsdef->fields['def'];
+					if (strpos($s,'::')===false && substr($s, 0, 1) == "'") { /* quoted strings hack... for now... fixme */
+						$s = substr($s, 1);
+						$s = substr($s, 0, strlen($s) - 1);
+					}
+
+					$rsdefa[$num] = $s;
+					$rsdef->MoveNext();
+				}
+			} else {
+				ADOConnection::outp( "==> SQL => " . $sql);
+			}
+			unset($rsdef);
+		}
+	
+		$retarr = array();
+		while (!$rs->EOF) { 	
+			$fld = new ADOFieldObject();
+			$fld->name = $rs->fields[0];
+			$fld->type = $rs->fields[1];
+			$fld->max_length = $rs->fields[2];
+			if ($fld->max_length <= 0) $fld->max_length = $rs->fields[3]-4;
+			if ($fld->max_length <= 0) $fld->max_length = -1;
+			if ($fld->type == 'numeric') {
+				$fld->scale = $fld->max_length & 0xFFFF;
+				$fld->max_length >>= 16;
+			}
+			// dannym
+			// 5 hasdefault; 6 num-of-column
+			$fld->has_default = ($rs->fields[5] == 't');
+			if ($fld->has_default) {
+				$fld->default_value = $rsdefa[$rs->fields[6]];
+			}
+
+			//Freek
+			if ($rs->fields[4] == $this->true) {
+				$fld->not_null = true;
+			}
+			
+			// Freek
+			if (is_array($keys)) {
+				foreach($keys as $key) {
+					if ($fld->name == $key['column_name'] AND $key['primary_key'] == $this->true) 
+						$fld->primary_key = true;
+					if ($fld->name == $key['column_name'] AND $key['unique_key'] == $this->true) 
+						$fld->unique = true; // What name is more compatible?
+				}
+			}
+			
+			if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] = $fld;	
+			else $retarr[($normalize) ? strtoupper($fld->name) : $fld->name] = $fld;
+			
+			$rs->MoveNext();
+		}
+		$rs->Close();
+		return empty($retarr) ? false : $retarr;	
+		
+	}
+
+}
+
+class ADODB_pdo_base extends ADODB_pdo {
+
+	function ServerInfo()
+	{
+		return ADOConnection::ServerInfo();
+	}
+	
+	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0)
+	{
+		$ret = ADOConnection::SelectLimit($sql,$nrows,$offset,$inputarr,$secs2cache);
+		return $ret;
+	}
+	
+	function MetaTables()
+	{
+		return false;
+	}
+	
+	function MetaColumns()
+	{
+		return false;
+	}
+}
+
+
 class ADODB_pdo extends ADOConnection {
 	var $databaseType = "pdo";	
 	var $dataProvider = "pdo";
@@ -30,16 +306,36 @@
 	var $_haserrorfunctions = true;
 	var $_lastAffectedRows = 0;
 	
+	var $dsnType = '';
 	var $stmt = false;
 	
-	function ADODB_pdo() 
+	function ADODB_pdo()
 	{
 	}
 	
-
+	function _UpdatePDO()
+	{
+		$d = &$this->_driver;
+		$this->fmtDate = $d->fmtDate;
+		$this->fmtTimeStamp = $d->fmtTimeStamp;
+		$this->replaceQuote = $d->replaceQuote;
+		$this->sysDate = $d->sysDate;
+		$this->sysTimeStamp = $d->sysTimeStamp;
+		$this->random = $d->random;
+		$this->concat_operator = $d->concat_operator;
+	}
+	
+	function Time()
+	{
+		return false;
+	}
+	
 	// returns true or false
 	function _connect($argDSN, $argUsername, $argPassword, $argDatabasename, $persist=false)
 	{
+		$at = strpos($argDSN,':');
+		$this->dsnType = substr($argDSN,0,$at);
+
 		$this->_connectionID = new PDO($argDSN, $argUsername, $argPassword);
 		if ($this->_connectionID) {
 			switch(ADODB_ASSOC_CASE){
@@ -52,10 +348,18 @@
 			//$this->_connectionID->setAttribute(PDO_ATTR_ERRMODE,PDO_ERRMODE_SILENT );
 			$this->_connectionID->setAttribute(PDO_ATTR_CASE,$m);
 			
+			$class = 'ADODB_pdo_'.$this->dsnType;
 			//$this->_connectionID->setAttribute(PDO_ATTR_AUTOCOMMIT,true);
+			if (class_exists($class))
+				$this->_driver = new $class();
+			else
+				$this->_driver = new ADODB_pdo_base();
 			
+			$this->_driver->_connectionID = $this->_connectionID;
+			$this->_UpdatePDO();
 			return true;
 		}
+		$this->_driver = new ADODB_pdo_base();
 		return false;
 	}
 	
@@ -65,13 +369,41 @@
 		return $this->_connect($argDSN, $argUsername, $argPassword, $argDatabasename, true);
 	}
 	
+	/*------------------------------------------------------------------------------*/
+	
+	
+	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
+	{	
+		$save = $this->_driver->fetchMode;
+		$this->_driver->fetchMode = $this->fetchMode;
+		$ret = $this->_driver->SelectLimit($sql,$nrows,$offset,$inputarr,$secs2cache);
+		$this->_driver->fetchMode = $save;
+		return $ret;
+	}
+	
+	
+	function ServerInfo()
+	{
+		return $this->_driver->ServerInfo();
+	}
+	
+	function MetaTables($ttype=false,$showSchema=false,$mask=false)
+	{
+		return $this->_driver->MetaTables($ttype,$showSchema,$mask);
+	}
+	
+	function MetaColumns($table,$normalize=true)
+	{
+		return $this->_driver->MetaColumns($table,$normalize);
+	}
+	
 	function ErrorMsg()
 	{
 		if ($this->_stmt) $arr = $this->_stmt->errorInfo();
 		else $arr = $this->_connectionID->errorInfo();
 		
 		if ($arr) {
-			if ($arr[0]) return $arr[2];
+			if ((integer)$arr[0]) return $arr[2];
 			else return '';
 		} else return '-1';
 	}
@@ -85,9 +417,14 @@
 	
 	function ErrorNo()
 	{
-		
-		if ($this->_stmt) return $this->_stmt->errorCode();
-		else return $this->_connectionID->errorInfo();
+		if ($this->_stmt) $err = $this->_stmt->errorCode();
+		else {
+			$arr = $this->_connectionID->errorInfo();
+			if (isset($arr[0])) $err = $arr[0];
+			else $err = -1;
+		}
+		if ($err == '00000') return 0; // allows empty check
+		return $err;
 	}
 
 	function BeginTrans()
@@ -102,6 +439,7 @@
 	
 	function CommitTrans($ok=true) 
 	{ 
+		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true; 
 		if (!$ok) return $this->RollbackTrans();
 		if ($this->transCnt) $this->transCnt -= 1;
@@ -114,6 +452,7 @@
 	
 	function RollbackTrans()
 	{
+		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true; 
 		if ($this->transCnt) $this->transCnt -= 1;
 		$this->_autocommit = true;
@@ -145,14 +484,17 @@
 		if (is_array($sql)) {
 			$stmt = $sql[1];
 		} else {
-			$stmt = $this->_connectionID->prepare($sql);		
+			$stmt = $this->_connectionID->prepare($sql);
 		}
 		if ($stmt) {
-			if ($inputarr) $stmt->execute($inputarr);
-			else $stmt->execute();
+			if ($inputarr) $ok = $stmt->execute($inputarr);
+			else $ok = $stmt->execute();
 		}
-		$this->_stmt = $stmt;
-		return $stmt;
+		if ($ok) {
+			$this->_stmt = $stmt;
+			return $stmt;
+		} 
+		return false;
 	}
 
 	// returns true or false
@@ -211,12 +553,17 @@
 		if ($this->_stmt) $arr = $this->_stmt->errorInfo();
 		else $arr = $this->_connectionID->errorInfo();
 		print_r($arr);
-		if ($arr) {
-			if ($arr[0]) return $arr[2];
+		if (is_array($arr)) {
+			if ((integer) $arr[0] && isset($arr[2])) return $arr[2];
 			else return '';
 		} else return '-1';
 	}
 	
+	function NumCols()
+	{
+		return ($this->_stmt) ? $this->_stmt->columnCount() : 0;
+	}
+	
 	function ErrorNo()
 	{
 		if ($this->_stmt) return $this->_stmt->errorCode();
@@ -240,11 +587,13 @@
 			global $ADODB_FETCH_MODE;
 			$mode = $ADODB_FETCH_MODE;
 		}
+		$this->adodbFetchMode = $mode;
 		switch($mode) {
-		default:
-		case ADODB_FETCH_BOTH: $mode = PDO_FETCH_BOTH; break;
 		case ADODB_FETCH_NUM: $mode = PDO_FETCH_NUM; break;
 		case ADODB_FETCH_ASSOC:  $mode = PDO_FETCH_ASSOC; break;
+		
+		case ADODB_FETCH_BOTH: 
+		default: $mode = PDO_FETCH_BOTH; break;
 		}
 		$this->fetchMode = $mode;
 		
@@ -252,21 +601,6 @@
 		$this->ADORecordSet($id);
 	}
 
-
-	// returns the field object
-	function &FetchField($fieldOffset = -1) 
-	{
-		
-		$off=$fieldOffset+1; // offsets begin at 1
-		
-		$o= new ADOFieldObject();
-		$o->name = @odbc_field_name($this->_queryID,$off);
-		$o->type = @odbc_field_type($this->_queryID,$off);
-		$o->max_length = @odbc_field_len($this->_queryID,$off);
-		if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
-		else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
-		return $o;
-	}
 	
 	function Init()
 	{
@@ -282,21 +616,40 @@
 			if ($this->EOF = ($this->_fetch() === false)) {
 				$this->_numOfRows = 0; // _numOfRows could be -1
 			}
-			$this->_numOfFields = sizeof($this->fields);
 		} else {
 			$this->EOF = true;
 		}
 	}
 	
-		
 	function _initrs()
 	{
 	global $ADODB_COUNTRECS;
 	
 		$this->_numOfRows = ($ADODB_COUNTRECS) ? @$this->_queryID->rowCount() : -1;
 		if (!$this->_numOfRows) $this->_numOfRows = -1;
-		$this->_numOfFields =0;
-	}	
+		$this->_numOfFields = $this->_queryID->columnCount();
+	}
+
+	// returns the field object
+	function &FetchField($fieldOffset = -1) 
+	{
+		$off=$fieldOffset+1; // offsets begin at 1
+		
+		$o= new ADOFieldObject();
+		$arr = $this->_queryID->getColumnMeta($fieldOffset);
+		if (!$arr) return false;
+
+		//adodb_pr($arr);
+		$o->name = $arr['name'];
+		if (isset($arr['native_type'])) $o->type = $arr['native_type'];
+		else $o->type = adodb_pdo_type($arr['pdo_type']);
+		$o->max_length = $arr['len'];
+		$o->precision = $arr['precision'];
+		
+		if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
+		else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
+		return $o;
+	}
 	
 	function _seek($row)
 	{
@@ -305,6 +658,8 @@
 	
 	function _fetch()
 	{
+		if (!$this->_queryID) return false;
+		
 		$this->fields = $this->_queryID->fetch($this->fetchMode);
 		return !empty($this->fields);
 	}
@@ -313,6 +668,20 @@
 	{
 		$this->_queryID = false;
 	}
+	
+	function Fields($colname)
+	{
+		if ($this->adodbFetchMode != ADODB_FETCH_NUM) return @$this->fields[$colname];
+		
+		if (!$this->bind) {
+			$this->bind = array();
+			for ($i=0; $i < $this->_numOfFields; $i++) {
+				$o = $this->FetchField($i);
+				$this->bind[strtoupper($o->name)] = $i;
+			}
+		}
+		 return $this->fields[$this->bind[strtoupper($colname)]];
+	}
 
 }
 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
- V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres64.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres64.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres64.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres64.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
- V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -73,12 +73,13 @@
 	var $blobEncodeType = 'C';
 	var $metaColumnsSQL = "SELECT a.attname,t.typname,a.attlen,a.atttypmod,a.attnotnull,a.atthasdef,a.attnum 
 		FROM pg_class c, pg_attribute a,pg_type t 
-		WHERE relkind = 'r' AND (c.relname='%s' or c.relname = lower('%s')) and a.attname not like '....%%'
+		WHERE relkind in ('r','v') AND (c.relname='%s' or c.relname = lower('%s')) and a.attname not like '....%%'
 AND a.attnum > 0 AND a.atttypid = t.oid AND a.attrelid = c.oid ORDER BY a.attnum";
 
+	// used when schema defined
 	var $metaColumnsSQL1 = "SELECT a.attname, t.typname, a.attlen, a.atttypmod, a.attnotnull, a.atthasdef, a.attnum 
 FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n 
-WHERE relkind = 'r' AND (c.relname='%s' or c.relname = lower('%s'))
+WHERE relkind in ('r','v') AND (c.relname='%s' or c.relname = lower('%s'))
  and c.relnamespace=n.oid and n.nspname='%s' 
 	and a.attname not like '....%%' AND a.attnum > 0 
 	AND a.atttypid = t.oid AND a.attrelid = c.oid ORDER BY a.attnum";
@@ -101,10 +102,11 @@
 	var $_dropSeqSQL = "DROP SEQUENCE %s";
 	var $metaDefaultsSQL = "SELECT d.adnum as num, d.adsrc as def from pg_attrdef d, pg_class c where d.adrelid=c.oid and c.relname='%s' order by d.adnum";
 	var $random = 'random()';		/// random function
-	var $autoRollback = true; // apparently pgsql does not autorollback properly before 4.3.4
+	var $autoRollback = true; // apparently pgsql does not autorollback properly before php 4.3.4
 							// http://bugs.php.net/bug.php?id=25404
 							
 	var $_bindInputArray = false; // requires postgresql 7.3+ and ability to modify database
+	var $disableBlobs = false; // set to true to disable blob checking, resulting in 2-5% improvement in performance.
 	
 	// The last (fmtTimeStamp is not entirely correct: 
 	// PostgreSQL also has support for time zones, 
@@ -128,12 +130,12 @@
 		$this->version = $arr;
 		return $arr;
 	}
-/*
+
 	function IfNull( $field, $ifNull ) 
 	{
-		return " NULLIF($field, $ifNull) "; // if PGSQL
+		return " coalesce($field, $ifNull) "; 
 	}
-*/
+
 	// get the last id - never tested
 	function pg_insert_id($tablename,$fieldname)
 	{
@@ -150,10 +152,12 @@
 Using a OID as a unique identifier is not generally wise. 
 Unless you are very careful, you might end up with a tuple having 
 a different OID if a database must be reloaded. */
-	function _insertid()
+	function _insertid($table,$column)
 	{
 		if (!is_resource($this->_resultid) || get_resource_type($this->_resultid) !== 'pgsql result') return false;
-	   	return pg_getlastoid($this->_resultid);
+		$oid = pg_getlastoid($this->_resultid);
+		// to really return the id, we need the table and column-name, else we can only return the oid != id
+		return empty($table) || empty($column) ? $oid : $this->GetOne("SELECT $column FROM $table WHERE oid=".(int)$oid);
 	}
 
 // I get this error with PHP before 4.0.6 - jlim
@@ -198,12 +202,26 @@
 	}
 	
 	function &MetaTables($ttype=false,$showSchema=false,$mask=false) 
-	{	
+	{
+		$info = $this->ServerInfo();
+		if ($info['version'] >= 7.3) {
+	    	$this->metaTablesSQL = "select tablename,'T' from pg_tables where tablename not like 'pg\_%'
+			  and schemaname  not in ( 'pg_catalog','information_schema')
+	union 
+        select viewname,'V' from pg_views where viewname not like 'pg\_%'  and schemaname  not in ( 'pg_catalog','information_schema') ";
+		}
 		if ($mask) {
 			$save = $this->metaTablesSQL;
 			$mask = $this->qstr(strtolower($mask));
-			$this->metaTablesSQL = "
-select tablename,'T' from pg_tables where tablename like $mask union 
+			if ($info['version']>=7.3)
+				$this->metaTablesSQL = "
+select tablename,'T' from pg_tables where tablename like $mask and schemaname not in ( 'pg_catalog','information_schema')  
+ union 
+select viewname,'V' from pg_views where viewname like $mask and schemaname  not in ( 'pg_catalog','information_schema')  ";
+			else
+				$this->metaTablesSQL = "
+select tablename,'T' from pg_tables where tablename like $mask 
+ union 
 select viewname,'V' from pg_views where viewname like $mask";
 		}
 		$ret =& ADOConnection::MetaTables($ttype,$showSchema);
@@ -287,6 +305,14 @@
 				$s .= 'AM';
 				break;
 				
+			case 'w':
+				$s .= 'D';
+				break;
+			
+			case 'l':
+				$s .= 'DAY';
+				break;
+				
 			default:
 			// handle escape characters...
 				if ($ch == '\\') {
@@ -331,6 +357,15 @@
 		return $rez; 
 	} 
 	
+	/*
+		Hueristic - not guaranteed to work.
+	*/
+	function GuessOID($oid)
+	{
+		if (strlen($oid)>16) return false;
+		return is_numeric($oid);
+	}
+	
 	/* 
 	* If an OID is detected, then we use pg_lo_* to open the oid file and read the
 	* real blob from the db using the oid supplied as a parameter. If you are storing
@@ -339,20 +374,24 @@
 	* contributed by Mattia Rossi mattia@technologist.com
 	*
 	* see http://www.postgresql.org/idocs/index.php?largeobjects.html
+	*
+	* Since adodb 4.54, this returns the blob, instead of sending it to stdout. Also
+	* added maxsize parameter, which defaults to $db->maxblobsize if not defined.
 	*/ 
-	function BlobDecode( $blob) 
-	{ 
-		if (strlen($blob) > 24) return $blob;
+	function BlobDecode($blob,$maxsize=false,$hastrans=true) 
+	{
+		if (!$this->GuessOID($blob)) return $blob;
 		
-		@pg_exec($this->_connectionID,"begin"); 
+		if ($hastrans) @pg_exec($this->_connectionID,"begin"); 
 		$fd = @pg_lo_open($this->_connectionID,$blob,"r");
 		if ($fd === false) {
-			@pg_exec($this->_connectionID,"commit");
+			if ($hastrans) @pg_exec($this->_connectionID,"commit");
 			return $blob;
 		}
-		$realblob = @pg_loreadall($fd); 
+		if (!$maxsize) $maxsize = $this->maxblobsize;
+		$realblob = @pg_loread($fd,$maxsize); 
 		@pg_loclose($fd); 
-		@pg_exec($this->_connectionID,"commit"); 
+		if ($hastrans) @pg_exec($this->_connectionID,"commit"); 
 		return $realblob;
 	} 
 	
@@ -375,8 +414,13 @@
 		// note that there is a pg_escape_bytea function only for php 4.2.0 or later
 	}
 	
+	// assumes bytea for blob, and varchar for clob
 	function UpdateBlob($table,$column,$val,$where,$blobtype='BLOB')
 	{
+	
+		if ($blobtype == 'CLOB') {
+    		return $this->Execute("UPDATE $table SET $column=" . $this->qstr($val) . " WHERE $where");
+		}
 		// do not use bind params which uses qstr(), as blobencode() already quotes data
 		return $this->Execute("UPDATE $table SET $column='".$this->BlobEncode($val)."'::bytea WHERE $where");
 	}
@@ -408,8 +452,10 @@
 		if (isset($savem)) $this->SetFetchMode($savem);
 		$ADODB_FETCH_MODE = $save;
 		
-		if ($rs === false) return false;
-		
+		if ($rs === false) {
+			$false = false;
+			return $false;
+		}
 		if (!empty($this->metaKeySQL)) {
 			// If we want the primary keys, we have to issue a separate query
 			// Of course, a modified version of the metaColumnsSQL query using a 
@@ -462,7 +508,10 @@
 			$fld->max_length = $rs->fields[2];
 			if ($fld->max_length <= 0) $fld->max_length = $rs->fields[3]-4;
 			if ($fld->max_length <= 0) $fld->max_length = -1;
-			
+			if ($fld->type == 'numeric') {
+				$fld->scale = $fld->max_length & 0xFFFF;
+				$fld->max_length >>= 16;
+			}
 			// dannym
 			// 5 hasdefault; 6 num-of-column
 			$fld->has_default = ($rs->fields[5] == 't');
@@ -491,7 +540,7 @@
 			$rs->MoveNext();
 		}
 		$rs->Close();
-		return $retarr;	
+		return empty($retarr) ? false : $retarr;	
 		
 	}
 
@@ -536,7 +585,8 @@
                 $ADODB_FETCH_MODE = $save;
 
                 if (!is_object($rs)) {
-                	return FALSE;
+                	$false = false;
+					return $false;
                 }
 				
                 $col_names = $this->MetaColumnNames($table,true);
@@ -779,10 +829,12 @@
 		{
 		case ADODB_FETCH_NUM: $this->fetchMode = PGSQL_NUM; break;
 		case ADODB_FETCH_ASSOC:$this->fetchMode = PGSQL_ASSOC; break;
-		default:
+		
 		case ADODB_FETCH_DEFAULT:
-		case ADODB_FETCH_BOTH:$this->fetchMode = PGSQL_BOTH; break;
+		case ADODB_FETCH_BOTH:
+		default: $this->fetchMode = PGSQL_BOTH; break;
 		}
+		$this->adodbFetchMode = $mode;
 		$this->ADORecordSet($queryID);
 	}
 	
@@ -801,6 +853,8 @@
 		$this->_numOfFields = @pg_numfields($qid);
 		
 		// cache types for blob decode check
+		// apparently pg_fieldtype actually performs an sql query on the database to get the type.
+		if (empty($this->connection->noBlobs))
 		for ($i=0, $max = $this->_numOfFields; $i < $max; $i++) {  
 			if (pg_fieldtype($qid,$i) == 'bytea') {
 				$this->_blobArr[$i] = pg_fieldname($qid,$i);
@@ -885,7 +939,7 @@
 
 		$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
 		
-	if ($this->fields && isset($this->_blobArr)) $this->_fixblobs();
+		if ($this->fields && isset($this->_blobArr)) $this->_fixblobs();
 			
 		return (is_array($this->fields));
 	}
@@ -911,6 +965,7 @@
 				case 'NAME':
 		   		case 'BPCHAR':
 				case '_VARCHAR':
+				case 'INET':
 					if ($len <= $this->blobSize) return 'C';
 				
 				case 'TEXT':
@@ -955,4 +1010,4 @@
 	}
 
 }
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres7.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres7.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres7.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres7.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
- V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim#natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -90,41 +90,6 @@
 }
 
 
-
-    function xMetaForeignKeys($table, $owner=false, $upper=false)
-	{
-
-        $sql = '
-SELECT t.tgargs as args
-   FROM pg_trigger t,
-        pg_class c,
-        pg_class c2,
-        pg_proc f
-   WHERE t.tgenabled
-   AND t.tgrelid=c.oid
-   AND t.tgconstrrelid=c2.oid
-   AND t.tgfoid=f.oid
-   AND f.proname ~ \'^RI_FKey_check_ins\'
-   AND t.tgargs like \'$1\\\000'.strtolower($table).'%\'
-   ORDER BY t.tgrelid';
-
-        $rs = $this->Execute($sql);
-		if ($rs && !$rs->EOF) {
-			$arr =& $rs->GetArray();
-			$a = array();
-			foreach($arr as $v) {
-                $data = explode(chr(0), $v['args']);
-                if ($upper) {
-                    $a[] = array(strtoupper($data[2]) => strtoupper($data[4].'='.$data[5]));
-                } else {
-                    $a[] = array($data[2] => $data[4].'='.$data[5]);
-                }
-                
-			}
-			return $a;
-		}
-		else return false;
-    }
 	
  	 // this is a set of functions for managing client encoding - very important if the encodings
 	// of your database and your output target (i.e. HTML) don't match
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres8.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres8.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-postgres8.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-postgres8.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -0,0 +1,12 @@
+<?php
+/*
+ V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+  Set tabs to 4.
+  
+  NOTE: The "postgres8" driver is remapped to "postgres7". 
+*/
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-proxy.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-proxy.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-proxy.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-proxy.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sapdb.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sapdb.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sapdb.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sapdb.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -26,8 +26,10 @@
 	var $concat_operator = '||';
 	var $sysDate = 'DATE';
 	var $sysTimeStamp = 'TIMESTAMP';
-	var $fmtDate = "\\D\\A\\T\\E('Y-m-d')";	/// used by DBDate() as the default date format used by the database
-	var $fmtTimeStamp = "\\T\\I\\M\\E\\S\\T\\A\\M\\P('Y-m-d','H:i:s')"; /// used by DBTimeStamp as the default timestamp fmt.
+	var $fmtDate = "'Y-m-d'";	/// used by DBDate() as the default date format used by the database
+	var $fmtTimeStamp = "'Y-m-d H:i:s'"; /// used by DBTimeStamp as the default timestamp fmt.
+	var $hasInsertId = true;
+	var $_bindInputArray = true;
 	
 	function ADODB_SAPDB()
 	{
@@ -35,6 +37,122 @@
 		$this->ADODB_odbc();
 	}
 	
+	function ServerInfo()
+	{
+		$info = ADODB_odbc::ServerInfo();
+		if (!$info['version'] && preg_match('/([0-9.]+)/',$info['description'],$matches)) {
+			$info['version'] = $matches[1];
+		}
+		return $info;
+	}
+
+	function MetaPrimaryKeys($table)
+	{
+		$table = $this->Quote(strtoupper($table));
+
+		return $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table AND mode='KEY' ORDER BY pos");
+	}
+		
+ 	function &MetaIndexes ($table, $primary = FALSE)
+	{
+		$table = $this->Quote(strtoupper($table));
+
+		$sql = "SELECT INDEXNAME,TYPE,COLUMNNAME FROM INDEXCOLUMNS ".
+			" WHERE TABLENAME=$table".
+			" ORDER BY INDEXNAME,COLUMNNO";
+
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+        	$savem = $this->SetFetchMode(FALSE);
+        }
+        
+        $rs = $this->Execute($sql);
+        if (isset($savem)) {
+        	$this->SetFetchMode($savem);
+        }
+        $ADODB_FETCH_MODE = $save;
+
+        if (!is_object($rs)) {
+        	return FALSE;
+        }
+
+		$indexes = array();
+		while ($row = $rs->FetchRow()) {
+            $indexes[$row[0]]['unique'] = $row[1] == 'UNIQUE';
+            $indexes[$row[0]]['columns'][] = $row[2];
+    	}
+		if ($primary) {
+			$indexes['SYSPRIMARYKEYINDEX'] = array(
+					'unique' => True,	// by definition
+					'columns' => $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table AND mode='KEY' ORDER BY pos"),
+				);
+		}
+        return $indexes;
+	}
+	
+ 	function &MetaColumns ($table)
+	{
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+        	$savem = $this->SetFetchMode(FALSE);
+        }
+		$table = $this->Quote(strtoupper($table));
+		
+		$retarr = array();
+		foreach($this->GetAll("SELECT COLUMNNAME,DATATYPE,LEN,DEC,NULLABLE,MODE,\"DEFAULT\",CASE WHEN \"DEFAULT\" IS NULL THEN 0 ELSE 1 END AS HAS_DEFAULT FROM COLUMNS WHERE tablename=$table ORDER BY pos") as $column)
+		{
+			$fld = new ADOFieldObject();
+			$fld->name = $column[0];
+			$fld->type = $column[1];
+			$fld->max_length = $fld->type == 'LONG' ? 2147483647 : $column[2];
+			$fld->scale = $column[3];
+			$fld->not_null = $column[4] == 'NO';
+			$fld->primary_key = $column[5] == 'KEY';
+			if ($fld->has_default = $column[7]) {
+				if ($fld->primary_key && $column[6] == 'DEFAULT SERIAL (1)') {
+					$fld->auto_increment = true;
+					$fld->has_default = false;
+				} else {
+					$fld->default_value = $column[6];
+					switch($fld->type) {
+						case 'VARCHAR':
+						case 'CHARACTER':
+						case 'LONG':
+							$fld->default_value = $column[6];
+							break;
+						default:
+							$fld->default_value = trim($column[6]);
+							break;
+					}
+				}
+			}
+			$retarr[$fld->name] = $fld;	
+		}
+        if (isset($savem)) {
+        	$this->SetFetchMode($savem);
+        }
+        $ADODB_FETCH_MODE = $save;
+
+		return $retarr;
+	}
+	
+	function MetaColumnNames($table)
+	{
+		$table = $this->Quote(strtoupper($table));
+
+		return $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table ORDER BY pos");
+	}
+	
+	// unlike it seems, this depends on the db-session and works in a multiuser environment
+	function _insertid($table,$column)
+	{
+		return empty($table) ? False : $this->GetOne("SELECT $table.CURRVAL FROM DUAL");
+	}
+
 	/*
 		SelectLimit implementation problems:
 	
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlanywhere.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlanywhere.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlanywhere.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlanywhere.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-version V4.50 6 July 2004 (c) 2000-2004  John Lim (jlim@natsoft.com.my). All rights
+version V4.62 2 Apr 2005 (c) 2000-2005  John Lim (jlim@natsoft.com.my).  All rights
 reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlite.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlite.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlite.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlite.inc.php	2005-05-04 14:39:18.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -109,7 +109,10 @@
 	global $ADODB_FETCH_MODE;
 	
 		$rs = $this->Execute("select * from $tab limit 1");
-		if (!$rs) return false;
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
 		$arr = array();
 		for ($i=0,$max=$rs->_numOfFields; $i < $max; $i++) {
 			$fld =& $rs->FetchField($i);
@@ -187,7 +190,7 @@
 		$MAXLOOPS = 100;
 		//$this->debug=1;
 		while (--$MAXLOOPS>=0) {
-			$num = $this->GetOne("select id from $seq");
+			@($num = $this->GetOne("select id from $seq"));
 			if ($num === false) {
 				$this->Execute(sprintf($this->_genSeqSQL ,$seq));	
 				$start -= 1;
@@ -231,6 +234,51 @@
 		return @sqlite_close($this->_connectionID);
 	}
 
+	function &MetaIndexes ($table, $primary = FALSE, $owner=false)
+	{
+		$false = false;
+		// save old fetch mode
+        global $ADODB_FETCH_MODE;
+        $save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+               $savem = $this->SetFetchMode(FALSE);
+        }
+		$SQL=sprintf("SELECT name,sql FROM sqlite_master WHERE type='index' AND tbl_name='%s'", strtolower($table));
+        $rs = $this->Execute($SQL);
+        if (!is_object($rs)) {
+			if (isset($savem)) 
+				$this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+            return $false;
+        }
+
+		$indexes = array ();
+		while ($row = $rs->FetchRow()) {
+			if ($primary && preg_match("/primary/i",$row[1]) == 0) continue;
+            if (!isset($indexes[$row[0]])) {
+
+			$indexes[$row[0]] = array(
+				   'unique' => preg_match("/unique/i",$row[1]),
+				   'columns' => array());
+			}
+			/**
+			  * There must be a more elegant way of doing this,
+			  * the index elements appear in the SQL statement
+			  * in cols[1] between parentheses
+			  * e.g CREATE UNIQUE INDEX ware_0 ON warehouse (org,warehouse)
+			  */
+			$cols = explode("(",$row[1]);
+			$cols = explode(")",$cols[1]);
+			array_pop($cols);
+			$indexes[$row[0]]['columns'] = $cols;
+		}
+		if (isset($savem)) { 
+            $this->SetFetchMode($savem);
+			$ADODB_FETCH_MODE = $save;
+		}
+        return $indexes;
+	}
 
 }
 
@@ -255,6 +303,7 @@
 		case ADODB_FETCH_ASSOC: $this->fetchMode = SQLITE_ASSOC; break;
 		default: $this->fetchMode = SQLITE_BOTH; break;
 		}
+		$this->adodbFetchMode = $mode;
 		
 		$this->_queryID = $queryID;
 	
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlite.inc.php.bak zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlite.inc.php.bak
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlite.inc.php.bak	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlite.inc.php.bak	2005-05-04 14:39:18.000000000 -0700
@@ -0,0 +1,326 @@
+<?php
+/*
+V4.53 14 Sept 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+
+  Latest version is available at http://adodb.sourceforge.net
+  
+  SQLite info: http://www.hwaci.com/sw/sqlite/
+    
+  Install Instructions:
+  ====================
+  1. Place this in adodb/drivers
+  2. Rename the file, remove the .txt prefix.
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+class ADODB_sqlite extends ADOConnection {
+	var $databaseType = "sqlite";
+	var $replaceQuote = "''"; // string to use to replace quotes
+	var $concat_operator='||';
+	var $_errorNo = 0;
+	var $hasLimit = true;	
+	var $hasInsertID = true; 		/// supports autoincrement ID?
+	var $hasAffectedRows = true; 	/// supports affected rows for update/delete?
+	var $metaTablesSQL = "SELECT name FROM sqlite_master WHERE type='table' ORDER BY name";
+	var $sysDate = "adodb_date('Y-m-d')";
+	var $sysTimeStamp = "adodb_date('Y-m-d H:i:s')";
+	var $fmtTimeStamp = "'Y-m-d H:i:s'";
+	
+	function ADODB_sqlite() 
+	{
+	}
+	
+/*
+  function __get($name) 
+  {
+  	switch($name) {
+	case 'sysDate': return "'".date($this->fmtDate)."'";
+	case 'sysTimeStamp' : return "'".date($this->sysTimeStamp)."'";
+	}
+  }*/
+	
+	function ServerInfo()
+	{
+		$arr['version'] = sqlite_libversion();
+		$arr['description'] = 'SQLite ';
+		$arr['encoding'] = sqlite_libencoding();
+		return $arr;
+	}
+	
+	function BeginTrans()
+	{	  
+		 if ($this->transOff) return true; 
+		 $ret = $this->Execute("BEGIN TRANSACTION");
+		 $this->transCnt += 1;
+		 return true;
+	}
+	
+	function CommitTrans($ok=true) 
+	{ 
+		if ($this->transOff) return true; 
+		if (!$ok) return $this->RollbackTrans();
+		$ret = $this->Execute("COMMIT");
+		if ($this->transCnt>0)$this->transCnt -= 1;
+		return !empty($ret);
+	}
+	
+	function RollbackTrans()
+	{
+		if ($this->transOff) return true; 
+		$ret = $this->Execute("ROLLBACK");
+		if ($this->transCnt>0)$this->transCnt -= 1;
+		return !empty($ret);
+	}
+
+	function _insertid()
+	{
+		return sqlite_last_insert_rowid($this->_connectionID);
+	}
+	
+	function _affectedrows()
+	{
+        return sqlite_changes($this->_connectionID);
+    }
+	
+	function ErrorMsg() 
+ 	{
+		if ($this->_logsql) return $this->_errorMsg;
+		return ($this->_errorNo) ? sqlite_error_string($this->_errorNo) : '';
+	}
+ 
+	function ErrorNo() 
+	{
+		return $this->_errorNo;
+	}
+	
+	function SQLDate($fmt, $col=false)
+	{
+		$fmt = $this->qstr($fmt);
+		return ($col) ? "adodb_date2($fmt,$col)" : "adodb_date($fmt)";
+	}
+	
+	function &MetaColumns($tab)
+	{
+	global $ADODB_FETCH_MODE;
+	
+		$rs = $this->Execute("select * from $tab limit 1");
+		if (!$rs) return false;
+		$arr = array();
+		for ($i=0,$max=$rs->_numOfFields; $i < $max; $i++) {
+			$fld =& $rs->FetchField($i);
+			if ($ADODB_FETCH_MODE == ADODB_FETCH_NUM) $retarr[] =& $fld;	
+			else $arr[strtoupper($fld->name)] =& $fld;
+		}
+		$rs->Close();
+		return $arr;
+	}
+	
+	function _createFunctions()
+	{
+		@sqlite_create_function($this->_connectionID, 'adodb_date', 'adodb_date', 1);
+		@sqlite_create_function($this->_connectionID, 'adodb_date2', 'adodb_date2', 2);
+	}
+	
+
+	// returns true or false
+	function _connect($argHostname, $argUsername, $argPassword, $argDatabasename)
+	{
+		if (!function_exists('sqlite_open')) return null;
+		
+		$this->_connectionID = sqlite_open($argHostname);
+		if ($this->_connectionID === false) return false;
+		$this->_createFunctions();
+		return true;
+	}
+	
+	// returns true or false
+	function _pconnect($argHostname, $argUsername, $argPassword, $argDatabasename)
+	{
+		if (!function_exists('sqlite_open')) return null;
+		
+		$this->_connectionID = sqlite_popen($argHostname);
+		if ($this->_connectionID === false) return false;
+		$this->_createFunctions();
+		return true;
+	}
+
+	// returns query ID if successful, otherwise false
+	function _query($sql,$inputarr=false)
+	{
+		$rez = sqlite_query($sql,$this->_connectionID);
+		if (!$rez) {
+			$this->_errorNo = sqlite_last_error($this->_connectionID);
+		}
+		
+		return $rez;
+	}
+	
+	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
+	{
+		$offsetStr = ($offset >= 0) ? " OFFSET $offset" : '';
+		$limitStr  = ($nrows >= 0)  ? " LIMIT $nrows" : ($offset >= 0 ? ' LIMIT 999999999' : '');
+	  	if ($secs2cache)
+	   		$rs =& $this->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
+	  	else
+	   		$rs =& $this->Execute($sql."$limitStr$offsetStr",$inputarr);
+			
+		return $rs;
+	}
+	
+	/*
+		This algorithm is not very efficient, but works even if table locking
+		is not available.
+		
+		Will return false if unable to generate an ID after $MAXLOOPS attempts.
+	*/
+	var $_genSeqSQL = "create table %s (id integer)";
+	
+	function GenID($seq='adodbseq',$start=1)
+	{	
+		// if you have to modify the parameter below, your database is overloaded,
+		// or you need to implement generation of id's yourself!
+		$MAXLOOPS = 100;
+		//$this->debug=1;
+		while (--$MAXLOOPS>=0) {
+<<<<<<< adodb-sqlite.inc.php
+			$num = @$this->GetOne("select id from $seq");
+=======
+			@($num = $this->GetOne("select id from $seq"));
+>>>>>>> 1.42
+			if ($num === false) {
+				$this->Execute(sprintf($this->_genSeqSQL ,$seq));	
+				$start -= 1;
+				$num = '0';
+				$ok = $this->Execute("insert into $seq values($start)");
+				if (!$ok) return false;
+			} 
+			$this->Execute("update $seq set id=id+1 where id=$num");
+			
+			if ($this->affected_rows() > 0) {
+				$num += 1;
+				$this->genID = $num;
+				return $num;
+			}
+		}
+		if ($fn = $this->raiseErrorFn) {
+			$fn($this->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
+		}
+		return false;
+	}
+
+	function CreateSequence($seqname='adodbseq',$start=1)
+	{
+		if (empty($this->_genSeqSQL)) return false;
+		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
+		if (!$ok) return false;
+		$start -= 1;
+		return $this->Execute("insert into $seqname values($start)");
+	}
+	
+	var $_dropSeqSQL = 'drop table %s';
+	function DropSequence($seqname)
+	{
+		if (empty($this->_dropSeqSQL)) return false;
+		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
+	}
+	
+	// returns true or false
+	function _close()
+	{
+		return @sqlite_close($this->_connectionID);
+	}
+
+
+}
+
+/*--------------------------------------------------------------------------------------
+		 Class Name: Recordset
+--------------------------------------------------------------------------------------*/
+
+class ADORecordset_sqlite extends ADORecordSet {
+
+	var $databaseType = "sqlite";
+	var $bind = false;
+
+	function ADORecordset_sqlite($queryID,$mode=false)
+	{
+		
+		if ($mode === false) { 
+			global $ADODB_FETCH_MODE;
+			$mode = $ADODB_FETCH_MODE;
+		}
+		switch($mode) {
+		case ADODB_FETCH_NUM: $this->fetchMode = SQLITE_NUM; break;
+		case ADODB_FETCH_ASSOC: $this->fetchMode = SQLITE_ASSOC; break;
+		default: $this->fetchMode = SQLITE_BOTH; break;
+		}
+		
+		$this->_queryID = $queryID;
+	
+		$this->_inited = true;
+		$this->fields = array();
+		if ($queryID) {
+			$this->_currentRow = 0;
+			$this->EOF = !$this->_fetch();
+			@$this->_initrs();
+		} else {
+			$this->_numOfRows = 0;
+			$this->_numOfFields = 0;
+			$this->EOF = true;
+		}
+		
+		return $this->_queryID;
+	}
+
+
+	function &FetchField($fieldOffset = -1)
+	{
+		$fld = new ADOFieldObject;
+		$fld->name = sqlite_field_name($this->_queryID, $fieldOffset);
+		$fld->type = 'VARCHAR';
+		$fld->max_length = -1;
+		return $fld;
+	}
+	
+   function _initrs()
+   {
+		$this->_numOfRows = @sqlite_num_rows($this->_queryID);
+		$this->_numOfFields = @sqlite_num_fields($this->_queryID);
+   }
+
+	function Fields($colname)
+	{
+		if ($this->fetchMode != SQLITE_NUM) return $this->fields[$colname];
+		if (!$this->bind) {
+			$this->bind = array();
+			for ($i=0; $i < $this->_numOfFields; $i++) {
+				$o = $this->FetchField($i);
+				$this->bind[strtoupper($o->name)] = $i;
+			}
+		}
+		
+		 return $this->fields[$this->bind[strtoupper($colname)]];
+	}
+	
+   function _seek($row)
+   {
+   		return sqlite_seek($this->_queryID, $row);
+   }
+
+	function _fetch($ignore_fields=false) 
+	{
+		$this->fields = @sqlite_fetch_array($this->_queryID,$this->fetchMode);
+		return !empty($this->fields);
+	}
+	
+	function _close() 
+	{
+	}
+
+}
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlitepo.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlitepo.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sqlitepo.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sqlitepo.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sybase.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sybase.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sybase.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sybase.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim. All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -20,7 +20,7 @@
 
 class ADODB_sybase extends ADOConnection {
 	var $databaseType = "sybase";	
-	//var $dataProvider = 'sybase';
+	var $dataProvider = 'sybase';
 	var $replaceQuote = "''"; // string to use to replace quotes
 	var $fmtDate = "'Y-m-d'";
 	var $fmtTimeStamp = "'Y-m-d H:i:s'";
@@ -94,7 +94,8 @@
 		
 	}	
 		
-	function SelectDB($dbName) {
+	function SelectDB($dbName) 
+	{
 		$this->databaseName = $dbName;
 		if ($this->_connectionID) {
 			return @sybase_select_db($dbName);		
@@ -105,10 +106,14 @@
 	/*	Returns: the last error message from previous database operation
 		Note: This function is NOT available for Microsoft SQL Server.	*/	
 
-	function ErrorMsg() 
+	
+	function ErrorMsg()
 	{
 		if ($this->_logsql) return $this->_errorMsg;
-		$this->_errorMsg = sybase_get_last_message();
+		if (function_exists('sybase_get_last_message'))
+			$this->_errorMsg = sybase_get_last_message();
+		else
+			$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : 'SYBASE error messages not supported on this platform';
 		return $this->_errorMsg;
 	}
 
@@ -151,12 +156,12 @@
 			$rs =& ADOConnection::SelectLimit($sql,$nrows,$offset,$inputarr,$secs2cache);
 			return $rs;
 		}
-		$cnt = ($nrows > 0) ? $nrows : 0;
+		$cnt = ($nrows >= 0) ? $nrows : 999999999;
 		if ($offset > 0 && $cnt) $cnt += $offset;
 		
 		$this->Execute("set rowcount $cnt"); 
 		$rs =& ADOConnection::SelectLimit($sql,$nrows,$offset,$inputarr,0);
-		$this->Execute("set rowcount 0"); 
+		$this->Execute("set rowcount 0");
 		
 		return $rs;
 	}
@@ -283,7 +288,7 @@
 		}
 		if (!$mode) $this->fetchMode = ADODB_FETCH_ASSOC;
 		else $this->fetchMode = $mode;
-		return $this->ADORecordSet($id,$mode);
+		$this->ADORecordSet($id,$mode);
 	}
 	
 	/*	Returns: an object containing field information. 
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-sybase_ase.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-sybase_ase.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-sybase_ase.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-sybase_ase.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,114 @@
+<?php
+/*
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+  
+  Set tabs to 4.
+  
+  Contributed by Interakt Online. Thx Cristian MARIN cristic#interaktonline.com
+*/
+class ADODB_sybase_ase extends ADODB_sybase {
+ 	var $databaseType = "sybase_ase";
+	
+	 var $metaTablesSQL="SELECT sysobjects.name FROM sysobjects, sysusers WHERE sysobjects.type='U' AND sysobjects.uid = sysusers.uid";
+	 var $metaColumnsSQL = "SELECT syscolumns.name AS field_name, systypes.name AS type, systypes.length AS width FROM sysobjects, syscolumns, systypes WHERE sysobjects.name='%s' AND syscolumns.id = sysobjects.id AND systypes.type=syscolumns.type";
+	 var $metaDatabasesSQL ="SELECT a.name FROM master.dbo.sysdatabases a, master.dbo.syslogins b WHERE a.suid = b.suid and a.name like '%' and a.name != 'tempdb' and a.status3 != 256  order by 1";
+
+	function ADODB_sybase_ase()
+	{
+	}
+	
+	// split the Views, Tables and procedures.
+	function &MetaTables($ttype=false,$showSchema=false,$mask=false)
+	{
+		if ($this->metaTablesSQL) {
+			// complicated state saving by the need for backward compat
+			
+			if ($ttype == 'VIEWS'){
+						$sql = str_replace('U', 'V', $this->metaTablesSQL);
+			}elseif (false === $ttype){
+						$sql = str_replace('U',"U' OR type='V", $this->metaTablesSQL);
+			}else{ // TABLES OR ANY OTHER 
+						$sql = $this->metaTablesSQL;
+			}
+			$rs = $this->Execute($sql);
+			
+			if ($rs === false || !method_exists($rs, 'GetArray')){
+					return false;
+			}
+			$arr =& $rs->GetArray();
+
+			$arr2 = array();
+			foreach($arr as $key=>$value){
+					$arr2[] = trim($value['name']);
+			}
+			return $arr2;
+		}
+		return false;
+	}
+
+	function MetaDatabases()
+	{
+			$arr = array();
+			if ($this->metaDatabasesSQL!='') {
+				$rs = $this->Execute($this->metaDatabasesSQL);
+				if ($rs && !$rs->EOF){
+					while (!$rs->EOF){
+						$arr[] = $rs->Fields('name');
+						$rs->MoveNext();
+					}
+					return $arr;
+				}
+			}
+			return false;
+	}
+
+	// fix a bug which prevent the metaColumns query to be executed for Sybase ASE
+	function &MetaColumns($table,$upper=false) 
+	{
+		$false = false;
+		if (!empty($this->metaColumnsSQL)) {
+		
+			$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
+			if ($rs === false) return $false;
+
+			$retarr = array();
+			while (!$rs->EOF) {
+				$fld =& new ADOFieldObject();
+				$fld->name = $rs->Fields('field_name');
+				$fld->type = $rs->Fields('type');
+				$fld->max_length = $rs->Fields('width');
+				$retarr[strtoupper($fld->name)] = $fld;
+				$rs->MoveNext();
+			}
+			$rs->Close();
+			return $retarr;	
+		}
+		return $false;
+	}
+	
+	function getProcedureList($schema)
+	{
+			return false;
+	}
+
+	function ErrorMsg()
+	{
+		if (!function_exists('sybase_connect')){
+				return 'Your PHP doesn\'t contain the Sybase connection module!';
+		}
+		return parent::ErrorMsg();	
+	}
+}
+
+class adorecordset_sybase_ase extends ADORecordset_sybase {
+var $databaseType = "sybase_ase";
+function ADORecordset_sybase_ase($id,$mode=false)
+	{
+		$this->ADORecordSet_sybase($id,$mode);
+	}
+	
+}
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/drivers/adodb-vfp.inc.php zentrack_2-5-5-1/includes/adodb/drivers/adodb-vfp.inc.php
--- zentrack_2-5-0-1/includes/adodb/drivers/adodb-vfp.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/drivers/adodb-vfp.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -32,7 +32,7 @@
 	var $sysDate = 'date()';
 	var $ansiOuter = true;
 	var $hasTransactions = false;
-	var $curmode = SQL_CUR_USE_ODBC ; // See sqlext.h, SQL_CUR_DEFAULT == SQL_CUR_USE_DRIVER == 2L
+	var $curmode = false ; // See sqlext.h, SQL_CUR_DEFAULT == SQL_CUR_USE_DRIVER == 2L
 	
 	function ADODB_vfp()
 	{
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-ar.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-ar.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-ar.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-ar.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,34 @@
+<?php
+// by "El-Shamaa, Khaled" <k.el-shamaa#cgiar.org>
+$ADODB_LANG_ARRAY = array (
+			'LANG'			    => 'ar',
+	    DB_ERROR			=> '  ',
+	    DB_ERROR_ALREADY_EXISTS	=> ' ',
+	    DB_ERROR_CANNOT_CREATE	=> '  ',
+	    DB_ERROR_CANNOT_DELETE	=> '  ',
+	    DB_ERROR_CANNOT_DROP	=> '  ',
+	    DB_ERROR_CONSTRAINT 	=> '  ',
+	    DB_ERROR_DIVZERO		=> '   ',
+	    DB_ERROR_INVALID		=> ' ',
+	    DB_ERROR_INVALID_DATE	=> '     ',
+	    DB_ERROR_INVALID_NUMBER	=> '   ',
+	    DB_ERROR_MISMATCH		=> ' ',
+	    DB_ERROR_NODBSELECTED	=> '     ',
+	    DB_ERROR_NOSUCHFIELD	=> '    ',
+	    DB_ERROR_NOSUCHTABLE	=> '    ',
+	    DB_ERROR_NOT_CAPABLE	=> '     ',
+	    DB_ERROR_NOT_FOUND		=> '  ',
+	    DB_ERROR_NOT_LOCKED 	=> ' ',
+	    DB_ERROR_SYNTAX		=> '  ',
+	    DB_ERROR_UNSUPPORTED	=> ' ',
+	    DB_ERROR_VALUE_COUNT_ON_ROW => '   ',
+	    DB_ERROR_INVALID_DSN	=> 'DNS  ',
+	    DB_ERROR_CONNECT_FAILED	=> '  ',
+	    0			       => '  ', // DB_OK
+	    DB_ERROR_NEED_MORE_DATA	=> '   ',
+	    DB_ERROR_EXTENSION_NOT_FOUND=> '    ',
+	    DB_ERROR_NOSUCHDB		=> '     ',
+	    DB_ERROR_ACCESS_VIOLATION	=> '  '
+);
+?>
+		
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-da.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-da.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-da.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-da.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,33 @@
+<?php
+// Arne Eckmann bananstat#users.sourceforge.net
+$ADODB_LANG_ARRAY = array (
+  	    'LANG'                      => 'da',
+            DB_ERROR                    => 'ukendt fejl',
+            DB_ERROR_ALREADY_EXISTS     => 'eksisterer allerede',
+            DB_ERROR_CANNOT_CREATE      => 'kan ikke oprette',
+            DB_ERROR_CANNOT_DELETE      => 'kan ikke slette',
+            DB_ERROR_CANNOT_DROP        => 'kan ikke droppe',
+            DB_ERROR_CONSTRAINT         => 'begr&aelig;nsning kr&aelig;nket',
+            DB_ERROR_DIVZERO            => 'division med nul',
+            DB_ERROR_INVALID            => 'ugyldig',
+            DB_ERROR_INVALID_DATE       => 'ugyldig dato eller klokkeslet',
+            DB_ERROR_INVALID_NUMBER     => 'ugyldigt tal',
+            DB_ERROR_MISMATCH           => 'mismatch',
+            DB_ERROR_NODBSELECTED       => 'ingen database valgt',
+            DB_ERROR_NOSUCHFIELD        => 'felt findes ikke',
+            DB_ERROR_NOSUCHTABLE        => 'tabel findes ikke',
+            DB_ERROR_NOT_CAPABLE        => 'DB backend opgav',
+            DB_ERROR_NOT_FOUND          => 'ikke fundet',
+            DB_ERROR_NOT_LOCKED         => 'ikke l&aring;st',
+            DB_ERROR_SYNTAX             => 'syntaksfejl',
+            DB_ERROR_UNSUPPORTED        => 'ikke underst&oslash;ttet',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'resulterende antal felter svarer ikke til foresp&oslash;rgslens antal felter',
+            DB_ERROR_INVALID_DSN        => 'ugyldig DSN',
+            DB_ERROR_CONNECT_FAILED     => 'tilslutning mislykkedes',
+            0	                        => 'ingen fejl', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'utilstr&aelig;kkelige data angivet',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'udvidelse ikke fundet',
+            DB_ERROR_NOSUCHDB           => 'database ikke fundet',
+            DB_ERROR_ACCESS_VIOLATION   => 'utilstr&aelig;kkelige rettigheder'
+);
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-es.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-es.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-es.inc.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-es.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -22,8 +22,7 @@
             DB_ERROR_SYNTAX             => 'error de sintaxis',
             DB_ERROR_UNSUPPORTED        => 'no soportado',
             DB_ERROR_VALUE_COUNT_ON_ROW => 'la cantidad de columnas no corresponden a la cantidad de valores',
-            DB_ERROR_INVALID_DSN
-        => 'DSN invalido',
+            DB_ERROR_INVALID_DSN        => 'DSN invalido',
             DB_ERROR_CONNECT_FAILED     => 'fallo la conexion',
             0	                       => 'sin error', // DB_OK
             DB_ERROR_NEED_MORE_DATA     => 'insuficientes datos',
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-esperanto.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-esperanto.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-esperanto.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-esperanto.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,35 @@
+<?php
+// Vivu Esperanto cxiam! 
+// Traduko fare de Antono Vasiljev (anders[#]brainactive.org)
+
+$ADODB_LANG_ARRAY = array (
+             'LANG'                      => 'eo',
+            DB_ERROR                    => 'nekonata eraro',
+            DB_ERROR_ALREADY_EXISTS     => 'jam ekzistas',
+            DB_ERROR_CANNOT_CREATE      => 'maleblas krei',
+            DB_ERROR_CANNOT_DELETE      => 'maleblas elimini',
+            DB_ERROR_CANNOT_DROP        => 'maleblas elimini (drop)',
+            DB_ERROR_CONSTRAINT         => 'rompo de kondicxoj de provo',
+            DB_ERROR_DIVZERO            => 'divido per 0 (nul)',
+            DB_ERROR_INVALID            => 'malregule',
+            DB_ERROR_INVALID_DATE       => 'malregula dato kaj tempo',
+            DB_ERROR_INVALID_NUMBER     => 'malregula nombro',
+            DB_ERROR_MISMATCH           => 'eraro',
+            DB_ERROR_NODBSELECTED       => 'datumbazo ne elektita',
+            DB_ERROR_NOSUCHFIELD        => 'ne ekzistas kampo',
+            DB_ERROR_NOSUCHTABLE        => 'ne ekzistas tabelo',
+            DB_ERROR_NOT_CAPABLE        => 'DBMS ne povas',
+            DB_ERROR_NOT_FOUND          => 'ne trovita',
+            DB_ERROR_NOT_LOCKED         => 'ne blokita',
+            DB_ERROR_SYNTAX             => 'sintaksa eraro',
+            DB_ERROR_UNSUPPORTED        => 'ne apogata',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'nombrilo de valoroj en linio',
+            DB_ERROR_INVALID_DSN        => 'malregula DSN-o',
+            DB_ERROR_CONNECT_FAILED     => 'konekto malsukcesa',
+            0                               => 'cxio bone', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'ne suficxe da datumo',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'etendo ne trovita',
+            DB_ERROR_NOSUCHDB           => 'datumbazo ne ekzistas',
+            DB_ERROR_ACCESS_VIOLATION   => 'ne suficxe da rajto por atingo'
+);
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-hu.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-hu.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-hu.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-hu.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,34 @@
+<?php
+# Hungarian language, encoding by ISO 8859-2 charset (Iso Latin-2)
+# Halszvri Gbor <g.halaszvari#portmax.hu>
+$ADODB_LANG_ARRAY = array (
+			'LANG'                      => 'hu',
+            DB_ERROR                    => 'ismeretlen hiba',
+            DB_ERROR_ALREADY_EXISTS     => 'mr ltezik',
+            DB_ERROR_CANNOT_CREATE      => 'nem sikerlt ltrehozni',
+            DB_ERROR_CANNOT_DELETE      => 'nem sikerlt trlni',
+            DB_ERROR_CANNOT_DROP        => 'nem sikerlt eldobni',
+            DB_ERROR_CONSTRAINT         => 'szablyok megszegse',
+            DB_ERROR_DIVZERO            => 'oszts nullval',
+            DB_ERROR_INVALID            => 'rvnytelen',
+            DB_ERROR_INVALID_DATE       => 'rvnytelen dtum vagy id',
+            DB_ERROR_INVALID_NUMBER     => 'rvnytelen szm',
+            DB_ERROR_MISMATCH           => 'nem megfelel',
+            DB_ERROR_NODBSELECTED       => 'nincs kivlasztott adatbzis',
+            DB_ERROR_NOSUCHFIELD        => 'nincs ilyen mez',
+            DB_ERROR_NOSUCHTABLE        => 'nincs ilyen tbla',
+            DB_ERROR_NOT_CAPABLE        => 'DB backend nem tmogatja',
+            DB_ERROR_NOT_FOUND          => 'nem tallhat',
+            DB_ERROR_NOT_LOCKED         => 'nincs lezrva',
+            DB_ERROR_SYNTAX             => 'szintaktikai hiba',
+            DB_ERROR_UNSUPPORTED        => 'nem tmogatott',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'soron vgzett rtk szmlls',
+            DB_ERROR_INVALID_DSN        => 'hibs DSN',
+            DB_ERROR_CONNECT_FAILED     => 'sikertelen csatlakozs',
+            0	                       => 'nincs hiba', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'tl kevs az adat',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'bvtmny nem tallhat',
+            DB_ERROR_NOSUCHDB           => 'nincs ilyen adatbzis',
+            DB_ERROR_ACCESS_VIOLATION   => 'nincs jogosultsg'
+);
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/adodb/lang/adodb-uk1251.inc.php zentrack_2-5-5-1/includes/adodb/lang/adodb-uk1251.inc.php
--- zentrack_2-5-0-1/includes/adodb/lang/adodb-uk1251.inc.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/adodb/lang/adodb-uk1251.inc.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,35 @@
+<?php
+
+// Ukrainian language file contributed by  Alex Rootoff rootoff{AT}pisem.net.
+
+$ADODB_LANG_ARRAY = array (
+             'LANG'                      => 'uk1251',
+            DB_ERROR                    => ' ',
+            DB_ERROR_ALREADY_EXISTS     => ' ',
+            DB_ERROR_CANNOT_CREATE      => ' ',
+            DB_ERROR_CANNOT_DELETE      => ' ',
+            DB_ERROR_CANNOT_DROP        => '  (drop)',
+            DB_ERROR_CONSTRAINT         => '  ',
+            DB_ERROR_DIVZERO            => '  0',
+            DB_ERROR_INVALID            => '',
+            DB_ERROR_INVALID_DATE       => '   ',
+            DB_ERROR_INVALID_NUMBER     => ' ',
+            DB_ERROR_MISMATCH           => '',
+            DB_ERROR_NODBSELECTED       => '  ',
+            DB_ERROR_NOSUCHFIELD        => '  ',
+            DB_ERROR_NOSUCHTABLE        => '  ',
+            DB_ERROR_NOT_CAPABLE        => '   ',
+            DB_ERROR_NOT_FOUND          => ' ',
+            DB_ERROR_NOT_LOCKED         => ' ',
+            DB_ERROR_SYNTAX             => ' ',
+            DB_ERROR_UNSUPPORTED        => ' ',
+            DB_ERROR_VALUE_COUNT_ON_ROW => '   ',
+            DB_ERROR_INVALID_DSN        => ' DSN',
+            DB_ERROR_CONNECT_FAILED     => '\' ',
+            0                               => ' ', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => '  ',
+            DB_ERROR_EXTENSION_NOT_FOUND=> '  ',
+            DB_ERROR_NOSUCHDB           => '  ',
+            DB_ERROR_ACCESS_VIOLATION   => '  '
+);
+?>
diff -Naur zentrack_2-5-0-1/includes/adodb/pivottable.inc.php zentrack_2-5-5-1/includes/adodb/pivottable.inc.php
--- zentrack_2-5-0-1/includes/adodb/pivottable.inc.php	2004-09-08 01:22:40.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/pivottable.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.50 6 July 2004 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -37,6 +37,8 @@
 	if ($aggfield) $hidecnt = true;
 	else $hidecnt = false;
 	
+	$iif = strpos($db->databaseType,'access') !== false; 
+		// note - vfp still doesn' work even with IIF enabled || $db->databaseType == 'vfp';
 	
 	//$hidecnt = false;
 	
@@ -47,20 +49,39 @@
 	$sel = "$rowfields, ";
 	if (is_array($colfield)) {
 		foreach ($colfield as $k => $v) {
-			if (!$hidecnt) $sel .= "\n\t$aggfn(CASE WHEN $v THEN 1 ELSE 0 END) AS \"$k\", ";
-			if ($aggfield)
-				$sel .= "\n\t$aggfn(CASE WHEN $v THEN $aggfield ELSE 0 END) AS \"$sumlabel$k\", ";
+			$k = trim($k);
+			if (!$hidecnt) {
+				$sel .= $iif ? 
+					"\n\t$aggfn(IIF($v,1,0)) AS \"$k\", "
+					:
+					"\n\t$aggfn(CASE WHEN $v THEN 1 ELSE 0 END) AS \"$k\", ";
+			}
+			if ($aggfield) {
+				$sel .= $iif ?
+					"\n\t$aggfn(IIF($v,$aggfield,0)) AS \"$sumlabel$k\", "
+					:
+					"\n\t$aggfn(CASE WHEN $v THEN $aggfield ELSE 0 END) AS \"$sumlabel$k\", ";
+			}
 		} 
 	} else {
 		foreach ($colarr as $v) {
 			if (!is_numeric($v)) $vq = $db->qstr($v);
 			else $vq = $v;
+			$v = trim($v);
 			if (strlen($v) == 0	) $v = 'null';
-			if (!$hidecnt) $sel .= "\n\t$aggfn(CASE WHEN $colfield=$vq THEN 1 ELSE 0 END) AS \"$v\", ";
+			if (!$hidecnt) {
+				$sel .= $iif ?
+					"\n\t$aggfn(IIF($colfield=$vq,1,0)) AS \"$v\", "
+					:
+					"\n\t$aggfn(CASE WHEN $colfield=$vq THEN 1 ELSE 0 END) AS \"$v\", ";
+			}
 			if ($aggfield) {
 				if ($hidecnt) $label = $v;
 				else $label = "{$v}_$aggfield";
-				$sel .= "\n\t$aggfn(CASE WHEN $colfield=$vq THEN $aggfield ELSE 0 END) AS \"$label\", ";
+				$sel .= $iif ?
+					"\n\t$aggfn(IIF($colfield=$vq,$aggfield,0)) AS \"$label\", "
+					:
+					"\n\t$aggfn(CASE WHEN $colfield=$vq THEN $aggfield ELSE 0 END) AS \"$label\", ";
 			}
 		}
 	}
@@ -123,7 +144,7 @@
 #
 # Query the main "product" table
 # Set the rows to CompanyName and QuantityPerUnit
-# and the columns to the UnitsInStock for different ranges
+# and the columns to the UnitsInStock for diiferent ranges
 # and define the joins to link to lookup tables 
 # "categories" and "suppliers"
 #
diff -Naur zentrack_2-5-0-1/includes/adodb/rsfilter.inc.php zentrack_2-5-5-1/includes/adodb/rsfilter.inc.php
--- zentrack_2-5-0-1/includes/adodb/rsfilter.inc.php	2004-09-08 01:22:40.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/rsfilter.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -42,7 +42,14 @@
 	}
 	$rows = $rs->RecordCount();
 	for ($i=0; $i < $rows; $i++) {
-		$fn($rs->_array[$i],$rs);
+		if (is_array ($fn)) {
+        	$obj = $fn[0];
+        	$method = $fn[1];
+        	$obj->$method ($rs->_array[$i],$rs);
+      } else {
+			$fn($rs->_array[$i],$rs);
+      }
+	  
 	}
 	if (!$rs->EOF) {
 		$rs->_currentRow = 0;
diff -Naur zentrack_2-5-0-1/includes/adodb/server.php zentrack_2-5-5-1/includes/adodb/server.php
--- zentrack_2-5-0-1/includes/adodb/server.php	2004-09-08 01:22:40.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/server.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -65,9 +65,9 @@
 ///////////////////////////////////////// DEFINITIONS
 
 
-$remote = $HTTP_SERVER_VARS["REMOTE_ADDR"]; 
+$remote = $_SERVER["REMOTE_ADDR"]; 
  
-if (empty($HTTP_GET_VARS['sql'])) err('No SQL');
+if (empty($_GET['sql'])) err('No SQL');
 
 if (!empty($ACCEPTIP))
  if ($remote != '127.0.0.1' && $remote != $ACCEPTIP) 
@@ -77,14 +77,14 @@
 $conn = &ADONewConnection($driver);
 
 if (!$conn->Connect($host,$uid,$pwd,$database)) err($conn->ErrorNo(). $sep . $conn->ErrorMsg());
-$sql = undomq($HTTP_GET_VARS['sql']);
+$sql = undomq($_GET['sql']);
 
-if (isset($HTTP_GET_VARS['fetch']))
-	$ADODB_FETCH_MODE = $HTTP_GET_VARS['fetch'];
+if (isset($_GET['fetch']))
+	$ADODB_FETCH_MODE = $_GET['fetch'];
 	
-if (isset($HTTP_GET_VARS['nrows'])) {
-	$nrows = $HTTP_GET_VARS['nrows'];
-	$offset = isset($HTTP_GET_VARS['offset']) ? $HTTP_GET_VARS['offset'] : -1;
+if (isset($_GET['nrows'])) {
+	$nrows = $_GET['nrows'];
+	$offset = isset($_GET['offset']) ? $_GET['offset'] : -1;
 	$rs = $conn->SelectLimit($sql,$nrows,$offset);
 } else 
 	$rs = $conn->Execute($sql);
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-compress-bzip2.php zentrack_2-5-5-1/includes/adodb/session/adodb-compress-bzip2.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-compress-bzip2.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-compress-bzip2.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-compress-gzip.php zentrack_2-5-5-1/includes/adodb/session/adodb-compress-gzip.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-compress-gzip.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-compress-gzip.php	2005-05-04 14:39:36.000000000 -0700
@@ -2,7 +2,7 @@
 
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-cryptsession.php zentrack_2-5-5-1/includes/adodb/session/adodb-cryptsession.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-cryptsession.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-cryptsession.php	2005-05-04 14:39:36.000000000 -0700
@@ -2,7 +2,7 @@
 
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-mcrypt.php zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-mcrypt.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-mcrypt.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-mcrypt.php	2005-05-04 14:39:36.000000000 -0700
@@ -2,7 +2,7 @@
 
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-md5.php zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-md5.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-md5.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-md5.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-secret.php zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-secret.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-encrypt-secret.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-encrypt-secret.php	2005-05-04 14:39:36.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-session-clob.php zentrack_2-5-5-1/includes/adodb/session/adodb-session-clob.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-session-clob.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-session-clob.php	2005-05-04 14:39:36.000000000 -0700
@@ -2,7 +2,7 @@
 
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff -Naur zentrack_2-5-0-1/includes/adodb/session/adodb-session.php zentrack_2-5-5-1/includes/adodb/session/adodb-session.php
--- zentrack_2-5-0-1/includes/adodb/session/adodb-session.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/session/adodb-session.php	2005-05-04 14:39:36.000000000 -0700
@@ -2,7 +2,7 @@
 
 
 /*
-V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
@@ -33,6 +33,58 @@
 
 define('ADODB_SESSION', dirname(__FILE__));
 
+
+/* 
+	Unserialize session data manually. See http://phplens.com/lens/lensforum/msgs.php?id=9821 
+	
+	From Kerr Schere, to unserialize session data stored via ADOdb. 
+	1. Pull the session data from the db and loop through it. 
+	2. Inside the loop, you will need to urldecode the data column. 
+	3. After urldecode, run the serialized string through this function:
+
+*/
+function adodb_unserialize( $serialized_string ) 
+{
+	$variables = array( );
+	$a = preg_split( "/(\w+)\|/", $serialized_string, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE );
+	for( $i = 0; $i < count( $a ); $i = $i+2 ) {
+		$variables[$a[$i]] = unserialize( $a[$i+1] );
+	}
+	return( $variables );
+}
+
+/*
+	Thanks Joe Li. See http://phplens.com/lens/lensforum/msgs.php?id=11487&x=1
+	Since adodb 4.61.
+*/
+function adodb_session_regenerate_id() 
+{
+	$conn =& ADODB_Session::_conn();
+	if (!$conn) return false;
+
+	$old_id = session_id();
+	if (function_exists('session_regenerate_id')) {
+		session_regenerate_id();
+	} else {
+		session_id(md5(uniqid(rand(), true)));
+		$ck = session_get_cookie_params();
+		setcookie(session_name(), session_id(), false, $ck['path'], $ck['domain'], $ck['secure']);
+		//@session_start();
+	}
+	$new_id = session_id();
+	$ok =& $conn->Execute('UPDATE '. ADODB_Session::table(). ' SET sesskey='. $conn->qstr($new_id). ' WHERE sesskey='.$conn->qstr($old_id));
+	
+	/* it is possible that the update statement fails due to a collision */
+	if (!$ok) {
+		session_id($old_id);
+		if (empty($ck)) $ck = session_get_cookie_params();
+		setcookie(session_name(), session_id(), false, $ck['path'], $ck['domain'], $ck['secure']);
+		return false;
+	}
+	
+	return true;
+}
+
 /*!
 	\static
 */
@@ -138,7 +190,8 @@
 
 	/*!
 	*/
-	function persist($persist = null) {
+	function persist($persist = null) 
+	{
 		static $_persist = true;
 
 		if (!is_null($persist)) {
@@ -431,7 +484,6 @@
 		$user		= ADODB_Session::user();
 
 		if (!is_null($persist)) {
-			$persist = (bool) $persist;
 			ADODB_Session::persist($persist);
 		} else {
 			$persist = ADODB_Session::persist();
@@ -443,7 +495,7 @@
 #		assert('$host');
 
 		// cannot use =& below - do not know why...
-		$conn = ADONewConnection($driver);
+		$conn =& ADONewConnection($driver);
 
 		if ($debug) {
 			$conn->debug = true;
@@ -451,7 +503,12 @@
 		}
 
 		if ($persist) {
-			$ok = $conn->PConnect($host, $user, $password, $database);
+			switch($persist) {
+			default:
+			case 'P': $ok = $conn->PConnect($host, $user, $password, $database); break;
+			case 'C': $ok = $conn->Connect($host, $user, $password, $database); break;
+			case 'N': $ok = $conn->NConnect($host, $user, $password, $database); break;
+			}
 		} else {
 			$ok = $conn->Connect($host, $user, $password, $database);
 		}
@@ -468,12 +525,10 @@
 		Close the connection
 	*/
 	function close() {
+/*
 		$conn =& ADODB_Session::_conn();
-
-		if ($conn) {
-			$conn->Close();
-		}
-
+		if ($conn) $conn->Close();
+*/
 		return true;
 	}
 
@@ -537,16 +592,16 @@
 		$filter			= ADODB_Session::filter();
 		$lifetime		= ADODB_Session::lifetime();
 		$table			= ADODB_Session::table();
-
+	
 		if (!$conn) {
 			return false;
 		}
-
+		$qkey = $conn->qstr($key);
+	
 		assert('$table');
 
 		$expiry = time() + $lifetime;
 
-		$qkey = $conn->quote($key);
 		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
 
 		// crc32 optimization since adodb 2.1
@@ -555,8 +610,8 @@
 			if ($debug) {
 				echo '<p>Session: Only updating date - crc32 not changed</p>';
 			}
-			$sql = "UPDATE $table SET expiry = $expiry WHERE $binary sesskey = $qkey AND expiry >= " . time();
-			$rs =& $conn->Execute($sql);
+			$sql = "UPDATE $table SET expiry = ".$conn->Param('0')." WHERE $binary sesskey = ".$conn->Param('1')." AND expiry >= ".$conn->Param('2');
+			$rs =& $conn->Execute($sql,array($expiry,$key,time()));
 			ADODB_Session::_dumprs($rs);
 			if ($rs) {
 				$rs->Close();
@@ -599,7 +654,7 @@
 					$lob_value = 'null';
 					break;
 			}
-
+			
 			// do we insert or update? => as for sesskey
 			$rs =& $conn->Execute("SELECT COUNT(*) AS cnt FROM $table WHERE $binary sesskey = $qkey");
 			ADODB_Session::_dumprs($rs);
@@ -783,10 +838,9 @@
 				$t = time();
 
 				if (abs($dbt - $t) >= $sync_seconds) {
-					global $HTTP_SERVER_VARS;
 					$msg = __FILE__ .
-						": Server time for webserver {$HTTP_SERVER_VARS['HTTP_HOST']} not in synch with database: " .
-						" database=$dbt ($dbts), webserver=$t (diff=". (abs($dbt - $t) / 3600) . ' hours)';
+						": Server time for webserver {$_SERVER['HTTP_HOST']} not in synch with database: " .
+						" database=$dbt ($dbts), webserver=$t (diff=". (abs($dbt - $t) / 60) . ' minutes)';
 					error_log($msg);
 					if ($debug) {
 						ADOConnection::outp("<p>$msg</p>");
@@ -797,7 +851,6 @@
 
 		return true;
 	}
-
 }
 
 ADODB_Session::_init();
diff -Naur zentrack_2-5-0-1/includes/adodb/toexport.inc.php zentrack_2-5-5-1/includes/adodb/toexport.inc.php
--- zentrack_2-5-0-1/includes/adodb/toexport.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/toexport.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+ * @version V4.62 2 Apr 2005 (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -77,7 +77,7 @@
 			
 			$v = $o->name;
 			if ($escquote) $v = str_replace($quote,$escquotequote,$v);
-			$v = strip_tags(str_replace("\n",$replaceNewLine,str_replace($sep,$sepreplace,$v)));
+			$v = strip_tags(str_replace("\n", $replaceNewLine, str_replace("\r\n",$replaceNewLine,str_replace($sep,$sepreplace,$v))));
 			$elements[] = $v;
 			
 		}
@@ -94,9 +94,11 @@
 		
 		if ($hasNumIndex) {
 			for ($j=0; $j < $max; $j++) {
-				$v = trim($rs->fields[$j]);
+				$v = $rs->fields[$j];
+				if (!is_object($v)) $v = trim($v);
+				else $v = 'Object';
 				if ($escquote) $v = str_replace($quote,$escquotequote,$v);
-				$v = strip_tags(str_replace("\n",$replaceNewLine,str_replace($sep,$sepreplace,$v)));
+				$v = strip_tags(str_replace("\n", $replaceNewLine, str_replace("\r\n",$replaceNewLine,str_replace($sep,$sepreplace,$v))));
 				
 				if (strpos($v,$sep) !== false || strpos($v,$quote) !== false) $elements[] = "$quote$v$quote";
 				else $elements[] = $v;
@@ -104,7 +106,7 @@
 		} else { // ASSOCIATIVE ARRAY
 			foreach($rs->fields as $v) {
 				if ($escquote) $v = str_replace($quote,$escquotequote,trim($v));
-				$v = strip_tags(str_replace("\n",$replaceNewLine,str_replace($sep,$sepreplace,$v)));
+				$v = strip_tags(str_replace("\n", $replaceNewLine, str_replace("\r\n",$replaceNewLine,str_replace($sep,$sepreplace,$v))));
 				
 				if (strpos($v,$sep) !== false || strpos($v,$quote) !== false) $elements[] = "$quote$v$quote";
 				else $elements[] = $v;
diff -Naur zentrack_2-5-0-1/includes/adodb/tohtml.inc.php zentrack_2-5-5-1/includes/adodb/tohtml.inc.php
--- zentrack_2-5-0-1/includes/adodb/tohtml.inc.php	2004-09-08 01:22:41.000000000 -0700
+++ zentrack_2-5-5-1/includes/adodb/tohtml.inc.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,6 +1,6 @@
 <?php 
 /*
-  V4.52 10 Aug 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
+  V4.62 2 Apr 2005  (c) 2000-2005 John Lim (jlim@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff -Naur zentrack_2-5-0-1/includes/configVars.php zentrack_2-5-5-1/includes/configVars.php
--- zentrack_2-5-0-1/includes/configVars.php	2005-05-08 13:03:30.663334400 -0700
+++ zentrack_2-5-5-1/includes/configVars.php	2005-05-08 13:58:09.548139200 -0700
@@ -1,5 +1,6 @@
 <?{
-
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  
   /*
   **  ZENTRACK CONFIGURATION SETTINGS
   **
@@ -20,10 +21,10 @@
    global $Db_Instance;
    global $Db_Login;
    global $Db_Pass;
-   
 
    $this->demo_mode = $Demo_Mode; 
-   $this->debug = $Debug_Mode;  
+   $this->debug = $Debug_Mode;
+   //$this->sql_debug = true;  //uncommenting this will break everything and produce tons of garbage
    
    $this->database_type      = $Db_Type;
    $this->database_instance  = $Db_Instance;
@@ -34,6 +35,7 @@
    $this->table_access           = 'ZENTRACK_ACCESS';           //access table
    $this->table_attachments      = 'ZENTRACK_ATTACHMENTS';      //attachments index
    $this->table_bins             = 'ZENTRACK_BINS';             //ticket bins
+   $this->table_field_map        = 'ZENTRACK_FIELD_MAP';        //map of screen->field->properties
    $this->table_logs             = 'ZENTRACK_LOGS';             //log table
    $this->table_logs_archived    = 'ZENTRACK_LOGS_ARCHIVED';    //archived log table
    $this->table_preferences      = 'ZENTRACK_PREFERENCES';      //preferences for users
@@ -109,4 +111,9 @@
   // email address of the logged-in user)
   $this->fromuser   = "me@domain.com";
 
-}?>
+  // address to put in from field for bug reports
+  $this->bugFrom = 'bot@'.$_SERVER['HTTP_HOST'];
+  
+  // address to put in to field for bug reports
+  $this->bugTo = 'bugs@zentrack.net';
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/db.class zentrack_2-5-5-1/includes/db.class
--- zentrack_2-5-0-1/includes/db.class	2004-10-12 22:49:07.000000000 -0700
+++ zentrack_2-5-5-1/includes/db.class	2005-05-08 07:41:02.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 include_once("$libDir/adodb/adodb.inc.php");
 
@@ -112,17 +114,18 @@
   }
   
   function db_update( $table, $key, $val, $columns ) {
+    unset($columns[$key]);
     $set = $this->makeInsertVals( $columns, 1 );
     $query = "UPDATE $table SET $set WHERE $key = '$val'";
     $r = $this->db_result($query);
-    $this->addDebug("db_update", $query, 3);
+    $this->addDebug("db_update", "[$r]".$query, 3);
     return $r;
   }
   
   function db_delete( $table, $key, $val ) {
     $query = "DELETE FROM $table WHERE $key = '$val'";
     $r = $this->db_result($query);
-    $this->addDebug("db_delete", $query, 3);
+    $this->addDebug("db_delete", "[$r]".$query, 3);
     return $r;
   }
   
@@ -145,32 +148,45 @@
     // .. in mysql, there is no SELECT nextval()
     // so it is easieast to run the query, then return
     // the mysql function mysql_insert_id()
-    if( $this->database_type != 'mysql' ) {
+    if( !Zen::inString('mysql',$this->database_type) ) {
       if( !$sequence ) {
         $sequence = ereg_replace("zentrack_", "", strtolower($table));
         $sequence .= "_id_seq";
       }
       $id = $this->db_insertID($sequence);
-      $fields = $this->db_get_fields($table);
-      $id_field = $fields[0];
-      if( !$id_field ) { $id_field = ZenTrack::getTableId($table); }
+      $id_field = ZenTrack::getTableId($table);
+      if( !$id_field ) {
+        $fields = $this->db_get_fields($table);
+        $id_field = $fields[0];
+      }
       $params["$id_field"] = $id;
     }
-    // this allows us to insert the generated id in sql server
-    // see http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_set-set_7zas.asp
-    // if( !(strpos($this->database_type, 'mssql') === false) ) {
-      // $query = "SET IDENTITY_INSERT $table ON";
-      // $this->db_result($query);
-    // }
     list($cols,$vals) = $this->makeInsertVals($params);
     $query = "INSERT INTO $table ($cols) VALUES($vals)";
-    $this->addDebug("db_insert",$query,3);
     $res = $this->db_link->Execute($query);
-    // if( !(strpos($this->database_type, 'mssql') === false) ) {
-      // $query = "SET IDENTITY_INSERT $table OFF";
-      // $this->db_result($query);
-    // }
-    if( $res && $this->database_type == "mysql" ) {
+    $this->addDebug("db_insert","[$res]".$query,3);
+    if( !$res && strpos($this->database_type,"mssql")===0 ) {
+      // deal with sql server id issues by automagically
+      // incrementing the counter when a problem occurs
+      $query = "SELECT max($id_field) FROM $table";
+      $max = $this->db_get($query);
+      $this->addDebug("db_insert", "Checking $id vs max ($max)", 3);
+      if( $max >= $id ) {
+        $this->addDebug("db_insert", "Max id ($max) greater than current sequence ($id), will auto increment (this should only happen immediately after an install or upgrade)", 1);
+        // oops, we have a bad sequence set (this should only happen immediately
+        // after an install) so go ahead and increment until it works
+        while( $max >= $id ) {
+          $id = $this->db_insertID($sequence);
+        }
+        $this->addDebug("db_insert", "Sequence incremented to $id", 1);
+        // now try our query again
+        $params["$id_field"] = $id;
+        list($cols,$vals) = $this->makeInsertVals($params);
+        $query = "INSERT INTO $table ($cols) VALUES($vals)";
+        $res = $this->db_link->Execute($query);
+      }
+    }
+    if( $res && Zen::inString('mysql',$this->database_type) ) {
       $id = $this->db_insertID();
     }
     if( $res ) {
@@ -196,15 +212,17 @@
     
     $this->switchQueryMode(0);
     $recordSet = &$this->db_link->Execute($query);
+    $this->addDebug('db_list','['.$recordSet.'] '.$query,3);
+    $vals = array();
     if( $recordSet ) {
       $vars = $recordSet->getArray();
       if( is_array($vars) && count($vars) > 0 ) {
         foreach($vars as $v) {
           $vals[] = $v[0];
         }
-        return($vals);
       }
     }
+    return($vals);
   }
   
   function db_listIndexed( $query ) {
@@ -212,16 +230,15 @@
     // by the [0] column and containing the [1] column
     $this->switchQueryMode(0);
     $recordSet = &$this->db_link->Execute($query);
+    $vals = array();
     if( $recordSet ) {
       $vars = $recordSet->getArray();
-      if( is_array($vars) && count($vars) > 0 ) {
-        foreach($vars as $v) {
-          $k = $v[0];
-          $vals["$k"] = $v[1];
-        }
-        return($vals);
+      for($i=0; $i<count($vars); $i++) {
+        $v = $vars[$i];
+        $vals["{$v[0]}"] = $v[1];
       }
-    }     
+    }
+    return($vals);
   }
   
   /*
@@ -238,12 +255,15 @@
     // insert id for the INSERT statement about to take place... don't
     // forget to manually add the id with the insert statement in 
     // this case!
-    if( $this->database_type == 'mysql' ) {
+    if( $this->database_type == 'mysqli' ) {
+      $id = mysqli_insert_id();
+    }
+    else if( Zen::inString('mysql',$this->database_type) ) {
       $id = mysql_insert_id();
     } else {
       $id = $this->db_link->genID($sequence);
     }
-    $this->addDebug("db_insertID", "created: $id", 3);
+    $this->addDebug("db_insertID", "created id '$id' for sequence '$sequence'", 3);
     return $id;
   }
   
@@ -276,7 +296,7 @@
       $vals = "";
       foreach($params as $k=>$v) {
         $cols .= ($cols)? ", $k" : "$k";
-        if( ereg("^(NULL|FALSE|TRUE|[0-9]+)$", $v) ) {
+        if( ereg("^(NULL|FALSE|TRUE)$", $v) ) {
           $vals .= strlen($vals)? ", $v" : "$v"; 
         } else {
           $vals .= strlen($vals)? ", ".$this->checkSlashes($v) : $this->checkSlashes($v);
@@ -287,7 +307,7 @@
       $cols = "";
       $vals = "";
       foreach($params as $k=>$v) {
-        if( ereg("^(NULL|FALSE|TRUE|[0-9]+)$", $v) ) {
+        if( ereg("^(NULL|FALSE|TRUE)$", $v) ) {
           $vals .= strlen($vals)? ", $k = $v" : "$k = $v"; 
         } else {
           $vals .= strlen($vals)? ", $k = ".$this->checkSlashes($v) : "$k = ".$this->checkSlashes($v);
@@ -462,8 +482,8 @@
         }
         $p[2] = $this->checkSlashes($p[2]);
         if( !$p[3] && ereg("[a-zA-Z]",$p[2]) ) {
-          if( !Zen::inString('mysql',$this->db_type) 
-            && !Zen::inString('mssql',$this->db_type) ) {
+          if( !Zen::inString('mysql',$this->database_type) 
+            && !Zen::inString('mssql',$this->database_type) ) {
             $p[0] = "lower($p[0])";
             $p[2] = strtolower($p[2]);
           }
@@ -493,6 +513,13 @@
     if( $database and $this->db_link ) {
       $this->dbName = $database;
     }
+    
+    if( $this->db_link ) {
+      $this->addDebug('db_connect', "Connected successfully to database", 3);
+    }
+    else {
+      $this->addDebug('db_connect', "Could not connect to $user@$host:$database", 1);
+    }
     return( $this->db_link );      
   }
   
diff -Naur zentrack_2-5-0-1/includes/editAgreementSubmit.php zentrack_2-5-5-1/includes/editAgreementSubmit.php
--- zentrack_2-5-0-1/includes/editAgreementSubmit.php	2004-09-03 08:41:48.000000000 -0700
+++ zentrack_2-5-5-1/includes/editAgreementSubmit.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/includes/editContactSubmit.php zentrack_2-5-5-1/includes/editContactSubmit.php
--- zentrack_2-5-0-1/includes/editContactSubmit.php	2004-09-08 01:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/editContactSubmit.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/includes/editContacteSubmit.php zentrack_2-5-5-1/includes/editContacteSubmit.php
--- zentrack_2-5-0-1/includes/editContacteSubmit.php	2004-09-08 01:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/editContacteSubmit.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/includes/editCustomSubmit.php zentrack_2-5-5-1/includes/editCustomSubmit.php
--- zentrack_2-5-0-1/includes/editCustomSubmit.php	2004-08-09 01:10:04.000000000 -0700
+++ zentrack_2-5-5-1/includes/editCustomSubmit.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,23 +1,20 @@
 <?
-//if( !$zen->checkAccess($login_id,$ticket["bin_id"],"edit_custom") ) {
-//  $errs[] = tr("You cannot edit a ticket's custom fields in this bin ");
-//} else if( !$zen->actionApplicable($id,"edit_custom",$login_id) ) {
-//  $errs[] = $zen->ptrans("Ticket #? cannot be edited in its current status",array($id));
-//}
-  $page_tile = tr("Ticket #$id: Save Custom Fields");
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  
+  $page_title = tr("Ticket #?: Save Custom Fields", array($id));
   $fields = array();
   $required = array();
   // the TODO is saved, even if the save failed
   $TODO = 'SAVED';
                                 
-  if( !$errs ) {
-    $customFieldsArray = $zen->getCustomFields(0,$page_type, 'Custom Tab');
-    include("$libDir/parseVarfields.php");
-  }
+  include("$libDir/validateFields.php");
 
   if( !$errs ) {
-    // update the ticket info
-    $res = $zen->updateVarfieldVals($id,$varfield_params);
+    if( count($varfield_params) ) {
+      // update the ticket info
+      $res = $zen->updateVarfieldVals($id,$varfield_params);
+    }
+
     // check for errors
     if( !$res ) {
       $errs[] = tr("System Error").": ".tr("Ticket could not be edited.")." ".$zen->db_error;
@@ -43,4 +40,4 @@
        include("$templateDir/ticketView.php");
      include("$libDir/footer.php");
   }
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/includes/editTicketSubmit.php zentrack_2-5-5-1/includes/editTicketSubmit.php
--- zentrack_2-5-0-1/includes/editTicketSubmit.php	2004-09-08 01:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/editTicketSubmit.php	2005-05-08 07:41:02.000000000 -0700
@@ -1,12 +1,13 @@
 <?
-
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  
   if( !$zen->checkAccess($login_id,$ticket["bin_id"],"edit") ) {
     $errs[] = tr("You cannot edit a ticket in this bin ");
   } else if( !$zen->actionApplicable($id,"edit",$login_id) ) {
     $errs[] = $zen->ptrans("Ticket #? cannot be edited in its current status",array($id));
   }
 
-  $page_tile = tr("Commit Edited Ticket");
+  $page_title = tr("Commit Edited Ticket");
   $expand_admin = 1;
 
   // initiate default values
@@ -20,42 +21,14 @@
      $tested = 0;
   if( !$approved )
      $approved = 0;
-  if( $type == "project" && !$type_id )
+  if( $type == "project" )
      $type_id = $zen->projectTypeID();
 
   $is_project = $type == 'project' || $zen->inProjectTypeIds($type_id);
+  $view = $is_project? 'project_edit' : 'ticket_edit';
 
-  $fields = array(
-        "title"       => "text",
-        "priority"    => "int",
-        "description" => "html",
-        "bin_id"       => "int",
-        "type_id"      => "int",
-        "user_id"      => "int",
-        "system_id"    => "int",
-        "tested"      => "int",
-        "approved"    => "int",
-        "relations"   => "text",
-        "project_id"   => "int",
-        "est_hours"   => "num",
-        "deadline"    => "int",
-        "start_date"  => "int"
-        );
- $required = array(
-         "title",
-         "priority",
-         "description",
-         "bin_id",
-         "type_id",
-         "system_id"
-         );
-  $zen->cleanInput($fields);
-  // check for required fields
-  foreach($required as $r) {
-     if( !$$r ) {
-   $errs[] = ucfirst($r)." ".tr("is a required field");
-     }
-  }
+  include("$libDir/validateFields.php");
+  
   if( !$errs ) {
      $params = array();
      // create an array of existing fields
@@ -63,30 +36,15 @@
        $params["$f"] = $$f;
      }
      // update the ticket info
-     $res = $zen->edit_ticket($id,$login_id,$params);
+     $res = $zen->edit_ticket($id,$login_id,$params,$edit_reason);
      // check for errors
      if( !$res ) {
        $errs[] = tr("System Error").": ".tr("Ticket could not be edited.")." ".$zen->db_error;
      }
-     else {
-       // parse variable fields which appear in new ticket screen, 
-       // store them in $varfield_params
-       // insure that all requirements are met before proceeding
-       // with the ticket save process
-       $customFieldsArray = false;
-       $x = $is_project? 'Project' : 'Ticket';
-       if( !$errs ) {
-         $customFieldsArray = $zen->getCustomFields(0, $x, 'New');
-         if( $customFieldsArray && count($customFieldsArray) ) {
-           include("$libDir/parseVarfields.php");
-         }
-       }
-       
-       if( $customFieldsArray && count($varfield_params) ) {
-         $res = $zen->updateVarfieldVals($id, $varfield_params, $login_id, $bin_id);
-         if( !$res ) {
-           $errs[] = tr("? updated, but variable fields could not be saved", tr($x));
-         }
+     else if( $varfields && count($varfield_params) ) {
+       $res = $zen->updateVarfieldVals($id, $varfield_params, $login_id, $bin_id);
+       if( !$res ) {
+         $errs[] = tr("? updated, but variable fields could not be saved", array(tr($x)));
        }
      }
   }
@@ -107,11 +65,12 @@
     $zen->print_errors($errs);
     $TODO = 'EDIT';
     if( $is_project ) {
-      include("$templateDir/newProjectForm.php");
+      $view = "project_edit";
     }
     else {
-       include("$templateDir/newTicketForm.php");
-     }
-     include("$libDir/footer.php");
+      $view = "ticket_edit";
+    }
+    include("$templateDir/newTicketForm.php");
+    include("$libDir/footer.php");
   }
 ?>
diff -Naur zentrack_2-5-0-1/includes/egate_config.php zentrack_2-5-5-1/includes/egate_config.php
--- zentrack_2-5-0-1/includes/egate_config.php	2005-05-08 13:03:30.713406400 -0700
+++ zentrack_2-5-5-1/includes/egate_config.php	2005-05-08 13:58:09.608225600 -0700
@@ -1,4 +1,5 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
 
   /*
   **  EGATE CONFIGURATION
@@ -14,7 +15,7 @@
   //    1 - on high level errors only
   //    2 - on any warning
   //    3 - on any information
-  $egate_notify_level = 3;
+  $egate_notify_level = 2;
 
   // the log level determines what we will
   // place within the log
@@ -83,4 +84,45 @@
   // $smtp_string = "{".$smtp_host.":".$smtp_port."/pop3/notls}INBOX";
   // $smtp_string = "{".$smtp_host.":".$smtp_port."/notls}INBOX";
 
+
+  /**
+   * You probably don't need to change this, unless you specifically want to disallow some fields
+   * from being settable.
+   */
+  
+  // allows users to customize the ticket properties by putting 'field:value' at the beginning of the email
+  // this is only used by the egate_create script (not the admin script)
+  $egate_create_overrides = 1;
+
+  // if $egate_create_overrides is on, this will determine which fields can be set
+  // this list also includes valid aliases.
+  //
+  // YOU CANNOT ADD ITEMS TO THIS ARRAY, and you should probably never edit it, 
+  // other than to comment out fields which you do not want the user to override
+  $egate_create_fields = array(
+			      "parent",
+			      "project",                //project name or id
+			      "bin",                    //bin name or id
+			      "priority",               //priority name or id
+			      "type",                   //type name or id
+                              "system",                 //system name or id
+			      "owner",                  //owner name, email, or id
+			      "start",
+			      "start date",
+			      "start_date",             //start date (any date format)
+			      "deadline",               //deadline for completion (any date format)
+			      "worked", 
+			      "wd_hours", 
+			      "hours worked",           //the number of hours worked so far (integer)
+			      "est_hours", 
+			      "estimated hours",
+			      "estimated",              //estimated hours (integer)
+			      "testing",
+			      "testing required",
+			      "testing_required",       //is testing required (1=yes)
+			      "approval",
+			      "approval required",
+			      "approval_required"       //is approval required (1=yes)
+  );
+
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/egate_utils.php zentrack_2-5-5-1/includes/egate_utils.php
--- zentrack_2-5-0-1/includes/egate_utils.php	2004-10-12 22:55:20.000000000 -0700
+++ zentrack_2-5-5-1/includes/egate_utils.php	2005-05-04 09:01:07.000000000 -0700
@@ -1,5 +1,6 @@
 <?{
-
+  define("ZT_DEFINED",true);
+  
   /*
   **  EGATE UTILS
   **  
@@ -52,7 +53,7 @@
     // check for this fatal error, which isn't really an error
     if( preg_match("@mailbox is empty@i", $text) ) {
       $text = "Mailbox was empty";
-      $egate_log[] = array($text,$lvl);
+      $egate_log[] = array($text,3);
     }
     else {
       $egate_log[] = array($text,$lvl);
@@ -516,6 +517,7 @@
       $v = trim($v);
       switch(strtolower($k)) {
       case "parent":
+      case "project":
 	if( strlen($v) ) 
 	  $vals["project_id"] = get_ticket_id($v);
 	break;
@@ -531,15 +533,38 @@
       case "owner":
 	{
 	  if( strtolower($v) == "me" || strtolower($v) == "myself" ) {
-	    $vals["user_id"] = find_user_id($name,$email);
+	    $vals["user_id"] = $user_id;
 	  }
 	  else if( preg_match("/^[0-9]+$/", $v) ) {
 	    $user = $zen->get_user($v);
-	    $vals["user_id"] = $id;
+	    if( $user ) {
+	      egate_log("created owner from id '$v': ".($user?$user['user_id']:'<null>'), 3);
+	      $vals["user_id"] = $user['user_id'];
+	    }
+	    else {
+	      egate_log("could not locate owner by id '$v', skipped",2);
+	    }
+	  }
+	  else if( strpos('@', $v) > 0 ) {
+	    $user = find_user_id('',$v);
+	    if( $user ) {
+	      $vals['user_id'] = $user['user_id'];
+	      egate_log("created owner from email '$v': ".($vals['user_id']?$vals['user_id']:'<null>'), 3);
+	    }
+	    else {
+	      egate_log("could not create owner from email '$email', skipped",2);
+	    }
 	  }
 	  else if( strlen($v) ) {
-	    $vals["user_id"] = find_user_id('',$email);
-	  }	  
+	    $user = find_user_id('','',$v);
+	    if( $user ) {
+	      $vals['user_id'] = $user['user_id'];
+	      egate_log("created owner by login '$v': ".($vals['user_id']?$vals['user_id']:'<null>'), 3);
+	    }
+	    else {
+	      egate_log("could not create owner from login '$login', skipped", 3);
+	    }
+	  }
 	}
 	break;
       case "bin":
@@ -548,6 +573,8 @@
       case "priority":
 	$vals["priority"] = get_type_id("priorities",$v);
 	break;
+      case "start":
+      case "start_date":
       case "start date":
 	if( strlen($v) ) {
 	  $vals["start_date"] = strtotime($v);
@@ -558,7 +585,22 @@
 	  $vals["deadline"] = strtotime($v);
 	}
 	break;
+      case "worked":
+      case "wkd_hours":
+      case "hours worked":
+	if( strlen($v) ) {
+	  $vals['wkd_hours'] = $zen->checkNum($v);
+	}
+	break;
+      case "est_hours":
+      case "estimated hours":
+      case "estimated":
+	if( strlen($v) ) {
+	  $vals['est_hours'] = $zen->checkNum($v);
+	}
+      case "testing":
       case "testing required":
+      case "testing_required":
 	{
 	  if( $v == 1 )
 	    $vals["tested"] = 1;
@@ -567,6 +609,8 @@
 	}
 	break;
       case "approval required":
+      case "approval_required":
+      case "approval":
 	{
 	  if( $v == 1 )
 	    $vals["approved"] = 1;
@@ -632,39 +676,55 @@
    * @param string $email is the users email
    * @return integer user_id to use, returns egate_user id if no id found
    */
-  function find_user_id($name,$email) {
+  function find_user_id($name,$email,$login = '') {
     global $zen;
     global $egate_user;
     // find out what user_id to apply
     // by trying to find this user in
-    // the system    
-    $users_by_email = $zen->get_users_by_email($email);
-    if( is_array($users_by_email) ) {
-      // if we got more than one user for this email address
-      // then try looking at the name
-      if( count($users_by_email) > 1 && strlen($name) ) {
-	$vals = array();
-	$users_by_name = $zen->get_users_by_name($name);
-	if( is_array($users_by_name) ) {
-	  // foreach name found, see if this user_id also
-	  // has the correct email, if so, it's a possible match
-	  foreach($users_by_name as $u) {
-	    if( in_array($u,$users_by_email) ) {
-	      $vals[] = $u;
+    // the system 
+    $users_by_email = '';
+    if( $login ) {
+      $user_id = $zen->get_user_by_login($login);
+      if( $user_id ) {
+	egate_log("found user by login  '$login': $user_id",3);
+      }
+      else {
+	egate_log("invalid login name ignored: $login",2);
+      }
+    }
+    if( !$user_id && $email ) {
+      egate_log("locating user by email '$email'", 3);
+      $users_by_email = $zen->get_users_by_email($email);
+      if( is_array($users_by_email) ) {
+	// if we got more than one user for this email address
+	// then try looking at the name
+	if( count($users_by_email) > 1 && strlen($name) ) {
+	  $vals = array();
+	  $users_by_name = $zen->get_users_by_name($name);
+	  if( is_array($users_by_name) ) {
+	    // foreach name found, see if this user_id also
+	    // has the correct email, if so, it's a possible match
+	    foreach($users_by_name as $u) {
+	      if( in_array($u,$users_by_email) ) {
+		$vals[] = $u;
+	      }
 	    }
 	  }
+	  // if there are more than one, we can't be sure, so skip
+	  if( count($vals) == 1 ) {
+	    $user_id = $vals[0];
+	  }
+	  egate_log("multiple users have address '$email', tried to select by name '$name': $user_id",2);
+	}
+	else if( count($users_by_email) == 1 ) {
+	  // we only found one, so that must be it
+	  $user_id = $users_by_email[0];
+	  egate_log("selected user by email '$email': $user_id",3);
 	}
-	// if there are more than one, we can't be sure, so skip
-	if( count($vals) == 1 ) {
-	  $user_id = $vals[0];
-	}
-      }
-      else if( count($users_by_email) == 1 ) {
-	// we only found one, so that must be it
-	$user_id = $users_by_email[0];
       }
     }
     if( !$user_id ) {
+      egate_log("selected default user (egate account): $user_id",3);
       $user_id = $egate_user["user_id"];
     }
     return $user_id;
@@ -1212,6 +1272,8 @@
     global $zen;
     global $egate_user;
     global $egate_default_options;
+    global $egate_create_fields;
+    global $egate_create_overrides;
 
     // decode the data
     $params = decode_contents($input);
@@ -1224,6 +1286,21 @@
     $body["title"] = $params->headers["subject"];
     $body["details"] = trim($params->body);
     $body["creator_id"] = $egate_user["user_id"];
+
+    // add in overrides, if the user has specified any by putting
+    // 'field:value' entries at the top of the message body
+    if( $egate_create_overrides == 1 && count($egate_create_fields) > 0 ) {
+      $i=0;
+      $match = '/^ *('.join('|',$egate_create_fields).') *: *(.+)/i';
+      while( preg_match( $match, $body['details'], $matches) && $i < 1000 ) {
+	$body["{$matches[1]}"] = trim($matches[2]);
+	$body['details'] = trim(preg_replace($match, '', $body['details']));
+	$i++;
+      }
+    }
+
+    // determine who sent the email and make sure it has
+    // a return address
     list($name,$email) = get_name_and_email($params);
     $user_id = find_user_id($name,$email);
 
@@ -1373,6 +1450,7 @@
     global $libDir;
     global $egate_user;
     global $zen;
+    global $egate_bcc_address;
     
     // get the messages
     $messages = egate_fetch_messages($egate_notify_level);
@@ -1442,10 +1520,11 @@
       // send messages
       $i=0;
       $from = $egate_user["email"];
+      $bcc = $egate_bcc_address? "Bcc:$egate_bcc_address\r\n" : "";
       foreach($recipients as $r) {
 	if( is_array($r) && count($r) && $r["email"] != $egate_user["email"] ) {
 	  $to = ($r["name"])? "\"{$r['name']}\" <{$r['email']}>" : $r['email'];
-	  $res = mail($to,$subject,$txt,"From:$from\r\nReply-to:$from\r\n");
+	  $res = mail($to,$subject,$txt,"From:$from\r\nReply-to:$from\r\n$bcc");
 	  if( $res )
 	    $i++;
 	}
@@ -1459,4 +1538,4 @@
     return 0;
   }
 
-}?>
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/footer.php zentrack_2-5-5-1/includes/footer.php
--- zentrack_2-5-0-1/includes/footer.php	2004-09-27 22:24:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/footer.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
    
 
@@ -13,7 +14,8 @@
 </table>
 
 <br clear="all">
-  
+
+<!--
 <p>&nbsp;</p>
 <p align="left">
    <A href="http://sourceforge.net" target="_new">
@@ -21,6 +23,7 @@
          width="88" height="31" border="0" alt="SourceForge Logo">
    </A>
 </p>
+-->
 
 <?
 
@@ -31,27 +34,40 @@
   **  This is the debugging section... please keep this intact, as
   **  we use it extensively for support questions
   */
-  if( $Debug_Overview ) {
+  if( $Debug_Mode > 0 ) {
+      if( $zen->debug ) {
+        $debug_text .= "<tr><td class='mainContent'>\n";
+        $debug_text .= "<p><b>MESSAGES</b></p>\n";
+         $debug_text .= "<span class='note'>\n";
+         ob_start();
+         $zen->printDebugMessages();
+         $debug_text .= ob_get_contents();
+         ob_clean();
+         $debug_text .= "</span>\n";
+         $debug_text .= "</td></tr>\n";
+      }
+  
+     $debug_text .= "<tr><td class='mainContent'>\n";
+     $debug_text .= "<p><b>SETTINGS / SYSTEM INFO</b></p>\n";
+     if( preg_match('@'.strtolower(Zen::cleanPath($_SERVER['DOCUMENT_ROOT'])).'@', strtolower(Zen::cleanPath($libDir))) ) {
+       $debug_text .= "<b><span class='error'>\$libDir should not be a www viewable directory!</span></b><br>\n";
+     }
      $debug_text .= "<span class='note'>\n";
-     $debug_text .= "<p>&nbsp;------DEBUG OVERVIEW-------&nbsp;</p>\n";
-     $debug_text .= "<i>To disable this output, set \$Debug_Overview in header.php to 0.</i><br>\n";
-     $debug_text .= "<a href='$rootUrl/phpinfo.php'>click here to view phpinfo</a><br>\n";
-     $debug_text .= "<a href='$SCRIPT_NAME?clear_session_cache=1'>click here to clear session cache</a><br>\n";
      $debug_text .= "HTTP_USER_AGENT: $HTTP_USER_AGENT<br>\n";
      $debug_text .= "SCRIPT_NAME: $SCRIPT_NAME<br>\n";
-     $debug_text .= "HTTP_HOST: $HTTP_HOST<br>\n";
+     $debug_text .= "HTTP_HOST: (".(preg_match("/$HTTP_HOST/",$rootUrl)? 'matches rootUrl' : 
+        '<b><span class="error">DOES NOT MATCH $rootUrl!!!</span></b>').")<br>\n";
      $debug_text .= "HTTP_COOKIE: $HTTP_COOKIE<br>\n";
      $debug_text .= "SERVER_SOFTWARE: {$_SERVER['SERVER_SOFTWARE']}<br>\n";
-     $debug_text .= "SERVER_NAME: $SERVER_NAME<br>\n";
      $debug_text .= "PHP Version: ".phpversion()."<br>\n";
      $debug_text .= "zenTrack Version: ".$zen->settings["version_xx"]."<br>\n";
      $debug_text .= "rootUrl: $rootUrl<br>\n";
      $debug_text .= "database: ".$zen->database_type."/".$zen->database_host."<br>\n";
      $debug_text .= "settings count: ".count($zen->settings)."<br>\n";
-     $debug_text .= "bins: ".join(",",$zen->bins)."<br>\n";
-     $debug_text .= "types: ".join(",",$zen->types)."<br>\n";
-     $debug_text .= "priorities: ".join(",",$zen->priorities)."<br>\n";
-     $debug_text .= "systems: ".join(",",$zen->systems)."<br>\n";
+     $debug_text .= "bins: ".(count($zen->bins)? join(",",$zen->bins) : 'NO BINS FOUND, DID YOU RUN THE SEED_YOURDB.SQL SCRIPT?')."<br>\n";
+     $debug_text .= "types: ".(count($zen->types)? join(",",$zen->types) : 'NO TYPES FOUND, DID YOU RUN THE SEED_YOURDB.SQL SCRIPT?')."<br>\n";
+     $debug_text .= "priorities: ".(count($zen->priorities)? join(",",$zen->priorities) : 'NO PRIORITIES FOUND, DID YOU RUN THE SEED_YOURDB.SQL SCRIPT?')."<br>\n";
+     $debug_text .= "systems: ".(count($zen->systems)? join(",",$zen->systems) : 'NO SYSTEMS FOUND, DID YOU RUN THE SEED_YOURDB.SQL SCRIPT?')."<br>\n";
      $debug_text .= "login_language: $login_language<br>\n";
      if( $login_id ) {
        $debug_text .= "login_id: $login_id<br>\n";
@@ -73,40 +89,47 @@
      else {
        $debug_text .= "gd_info not available<br>\n";
      }
-     $debug_text .= "<p>&nbsp;------/DEBUG OVERVIEW-------&nbsp;</p>\n";
-     $debug_text .= "</span>\n";
-  }
-  
-  if( $zen->debug ) {
-     $debug_text .= "<span class='note'>\n";
-     ob_start();
-     $zen->printDebugMessages();
-     $debug_text .= ob_get_contents();
-     ob_clean();
      $debug_text .= "</span>\n";
-  }
-  
-  if( $Debug_Overview ) {
-    $user = $zen->getUser($login_id);
+     $debug_text .= "</td></tr>\n";
+
+     $user = $zen->getUser($login_id);
     ?>
+    <table cellspacing='2' cellpadding='4' width='500' align='center'>
+    <tr><td class='mainContent' align='center'><b>DEBUG LOG</b></td></tr>
+    <tr><td class='mainContent'>
+    <p class='error'>To disable this output, set $Debug_Mode in header.php to 0.  Never leave this on in a production environment!</p>
     <form action='<?=$rootUrl?>/help/bugs.php' method='post'>
-    <input type='submit' value='Report A Bug' name='reportButton' class='submit'>
+    Report bugs by clicking here: <input type='submit' value='Report A Bug' name='reportButton' class='submit'>
     <input type='hidden' name='name' value='<?=$zen->ffv($login_name)?>'>
     <input type='hidden' name='email' value='<?=$zen->ffv($user['email'])?>'>
     <input type='hidden' name='debug_output' value='<?=urlencode($debug_text)?>'>
     <input type='hidden' name='user_info' value='<?=$zen->ffv($_SERVER['HTTP_USER_AGENT'])?>'>
     </form>
     <p>Please send us <a href='http://www.zentrack.net/feedback/?name=<?=$zen->ffv($login_name)?>&email=<?=$user['email']?>&subject=Feedback'>Feedback</a>!</p>
+    <p><a href='<?=$rootUrl?>/phpinfo.php'>click here to view phpinfo</a></p>
+    <p><a href='<?=$SCRIPT_NAME?>?clear_session_cache=1'>click here to clear session cache</a></p>
+    </td></tr>
     <?
-  }
-  
-  print $debug_text;
-
-  if( $Debug_Mode ) { 
+    // for extra security, make sure we don't pass anything sensitive out to
+    // the public
+    $debug_text = preg_replace('/password=[^"\' ]+/', 'password=xxxx', $debug_text);
+    $debug_text = preg_replace('/Db_Pass=[^"\' ]+/', 'Db_Pass=xxxx', $debug_text);
+    $debug_text = preg_replace('/database_password=[^"\' ]+/', 'database_password=xxxx', $debug_text);
+    $debug_text = preg_replace('/[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+[.][a-zA-Z0-9_.-]+/', 'xxxx@xxxx.xxx',$debug_text);
+    $debug_text = preg_replace('@(https?://|www[.])[a-zA-Z0-9_-]+[.]([a-zA-Z]{2,4})@', '\\1xxxx.\\2', $debug_text);
+    print $debug_text;
+    
     // used by behavior_js.php
-    print "<div id='behaviorDebugDiv'></div>\n";
+    ?>
+      <tr><td class='mainContent'>
+      <div id='behaviorDebugDiv'></div>
+      </td></tr></table>
+    <?
   }
   
+  //Zen::printArray($_SERVER,'_SERVER');
+  //Zen::printArray($_ENV,'_ENV');
+  
   //if( is_array($ticket) ) {
   //  Zen::printArray($ticket, "Ticket Contents");
   //}
diff -Naur zentrack_2-5-0-1/includes/headerInc.php zentrack_2-5-5-1/includes/headerInc.php
--- zentrack_2-5-0-1/includes/headerInc.php	2004-10-13 20:39:14.000000000 -0700
+++ zentrack_2-5-5-1/includes/headerInc.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?{
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /*
   ** headerInc.php
   **
@@ -63,9 +65,11 @@
   // in egate_utils.php as well!
   include_once("$libDir/translator.class");
   include_once("$libDir/zenTrack.class");
+  include_once("$libDir/ZenFieldMap.class");
   include_once("$libDir/zenTemplate.class");
   
   $zen = new zenTrack( $configFile );
+  $map =& new ZenFieldMap($zen);
   
   /**
   * Translator Object Initialization (mlively)
@@ -88,7 +92,19 @@
   unset($translator_init);
   
   function uptr($string, $vals = '') {
-    return strtoupper(tr($string,$vals));
+    $specials = array(
+    '&AACUTE;' => '&Aacute;',
+    '&EACUTE;' => '&Eacute;',
+    '&IACUTE;' => '&Iacute;',
+    '&OACUTE;' => '&Oacute;',
+    '&OACUTE;' => '&Uacute;',
+    '&NTILDE;' => '&Ntilde;'
+    );
+    $trad=strtoupper(tr($string,$vals));
+    foreach ($specials as $k => $v) {
+      $trad=str_replace($k,$v,$trad);
+    }
+    return $trad;
   }
   
   /*
@@ -164,8 +180,9 @@
   
   function getVarfieldDataType( $varfieldName ) {
     $varfieldName = strtolower($varfieldName);
-    preg_match('/^custom_([a-z]+)[0-9]+$/', $varfieldName, $matches);
-    return isset($matches[1])? $matches[1] : null;
+    if( preg_match('/^custom_([a-z]+)[0-9]+$/', $varfieldName, $matches) ) {
+      return isset($matches[1])? $matches[1] : null;
+    }
   }
   
   function genVarfield( $formName, $varfield, $value = '' ) {
@@ -187,6 +204,9 @@
     
     $key = $varfield['field_name'];
     
+    $zen->addDebug('headerInc', "genVarfield( '$formName', "
+       +"'$varfield', '$value' ) using type=$type and key=$key", 3);
+    
     switch( $type ) {
       case "boolean":
         $inp = "<input type='checkbox' name='{$key}' "
@@ -210,11 +230,12 @@
         }
         // create input field and date picker
         $inp = "<input type='text' name='{$key}' "
-          ." value='{$value}' size='20' maxlength='250'{$onblur}>\n"
+          ." value='{$value}' size='20' maxlength='250'{$onblur} "
+          ." hascalendar='".$varfield['field_name']."-calendar_icon'>\n"
           ." <img name='date_button' src='{$rootUrl}/images/cal.gif' "
           ."  onClick=\"popUpCalendar(this, document.{$formName}.{$varfield['field_name']}, '"
           .$zen->popupDateFormat()." 00:00')\"\n"
-          ."  alt='".tr("Select a Date")."'>\n";
+          ."  alt='".tr("Select a Date")."' id='".$varfield['field_name']."-calendar_icon'>\n";
           break;
       case "number":
         if( $value == 'NULL' ) { $value = ''; }
@@ -285,7 +306,7 @@
   }
   
   // used to set table cell padding (since netscape cant handle padding-top/bottom)
-  $height_num = $zen->settings["font_size"]+4;
+  $height_num = $zen->settings["font_size"] + 4;
   
   // function to retrieve the available languages from the translations/ dir  
   function get_languages_available() { 
@@ -347,11 +368,13 @@
     ."onmouseover=\"mOvr(this,'"
     .$zen->settings["color_highlight"]."', '');\"";
   
-  $nav_rollover_text = " onclick=\"mClk(this);\" onmouseout=\"mOut(this,'"
+  $nav_rollover_eff = " onmouseout=\"mOut(this,'"
     .$zen->settings["color_title_background"]."','"
     .$zen->settings["color_title_txt"]."');\" onmouseover=\"mOvr(this,'"
     .$zen->settings["color_alt_background"]."','"
-    .$zen->settings["color_alt_text"]."');\"";
+    .$zen->settings["color_alt_text"]."');\" ";
+    
+  $nav_rollover_text = " onclick=\"mClk(this);\" ".$nav_rollover_eff;
   
   
   /*
@@ -392,7 +415,5 @@
   $helpUrl = "$helpBase/$helpLang";
   $helpDir = "$rootWWW/help/$helpLang";
   
-  
   // you can't have any spaces after this closing tag!
-  
-}?>
\ No newline at end of file
+}?>
diff -Naur zentrack_2-5-0-1/includes/leftAdmin.php zentrack_2-5-5-1/includes/leftAdmin.php
--- zentrack_2-5-0-1/includes/leftAdmin.php	2004-09-27 22:24:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/leftAdmin.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td <?=($expand_admin)? " class='titleCell'" : $nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/leftBins.php zentrack_2-5-5-1/includes/leftBins.php
--- zentrack_2-5-0-1/includes/leftBins.php	2004-09-27 22:24:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/leftBins.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td class="altCell" align=center>
diff -Naur zentrack_2-5-0-1/includes/leftContacts.php zentrack_2-5-5-1/includes/leftContacts.php
--- zentrack_2-5-0-1/includes/leftContacts.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/leftContacts.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td<?=(isset($expand_contacts)&&$expand_contacts)? " class='titleCell'" : " ".$nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/leftHelp.php zentrack_2-5-5-1/includes/leftHelp.php
--- zentrack_2-5-0-1/includes/leftHelp.php	2004-09-27 22:24:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/leftHelp.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td <?=((isset($expand_help)&&$expand_help))? " class='titleCell'" : $nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/leftMain.php zentrack_2-5-5-1/includes/leftMain.php
--- zentrack_2-5-0-1/includes/leftMain.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/leftMain.php	2005-05-04 14:39:16.000000000 -0700
@@ -1,7 +1,9 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <div class="small" align="center"><b><?=$zen->showLongDate()?></b></div>
 <div class="small" align='center'><?=tr("version")?> <?=$zen->settings["version_xx"]?></div>
-  
 <?
+  if( $zen->demo_mode == 'on' ) { print "<div class='small' align='center'>(demo mode)</div>"; }
+
   $num = 0;
   $num = $zen->getTicketCount('OPEN');
   print "<p align='center' class='small'>";
@@ -76,12 +78,13 @@
   </td>
   </tr>  
   <? 
-     if( $login_level >= $zen->settings["level_reports"] ) {
+//we check also if login_level is a number because in first login it will be 'first_login' what would give access to all.
+     if( $zen->checkNum($login_level) >= $zen->settings["level_reports"] ) {
    include("$libDir/leftReports.php");
       } 
   ?>
   <? 
-     if( $login_level >= $zen->settings["level_settings"] ) {
+     if( $zen->checkNum($login_level) >= $zen->settings["level_settings"] ) {
    include("$libDir/leftAdmin.php");
       } 
   ?>
diff -Naur zentrack_2-5-0-1/includes/leftReports.php zentrack_2-5-5-1/includes/leftReports.php
--- zentrack_2-5-0-1/includes/leftReports.php	2003-03-21 00:27:14.000000000 -0800
+++ zentrack_2-5-5-1/includes/leftReports.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td <?=($expand_reports)? " class='titleCell'" : $nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/leftSearch.php zentrack_2-5-5-1/includes/leftSearch.php
--- zentrack_2-5-0-1/includes/leftSearch.php	2003-03-21 00:27:14.000000000 -0800
+++ zentrack_2-5-5-1/includes/leftSearch.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td<?=(isset($expand_search)&&$expand_search)? " class='titleCell'" : " ".$nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/leftTickets.php zentrack_2-5-5-1/includes/leftTickets.php
--- zentrack_2-5-0-1/includes/leftTickets.php	2003-03-21 00:27:14.000000000 -0800
+++ zentrack_2-5-5-1/includes/leftTickets.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <tr>
   <td<?=(isset($expand_projects)&&$expand_projects)? " class='titleCell'" : " ".$nav_rollover_text?>>
diff -Naur zentrack_2-5-0-1/includes/login.php zentrack_2-5-5-1/includes/login.php
--- zentrack_2-5-0-1/includes/login.php	2004-09-09 17:04:57.000000000 -0700
+++ zentrack_2-5-5-1/includes/login.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   
   // log user out of zentrack if $logoff
   if( isset($logoff) && $logoff > 0 ) {
diff -Naur zentrack_2-5-0-1/includes/nav.php zentrack_2-5-5-1/includes/nav.php
--- zentrack_2-5-0-1/includes/nav.php	2004-09-08 01:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/nav.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <html>
   <head>
   <title><?=$page_prefix.$page_title?></title>
diff -Naur zentrack_2-5-0-1/includes/paging.php zentrack_2-5-5-1/includes/paging.php
--- zentrack_2-5-0-1/includes/paging.php	2004-09-09 17:04:57.000000000 -0700
+++ zentrack_2-5-5-1/includes/paging.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <!--- BEGIN Paging --->
 
 <table width='100%'>
diff -Naur zentrack_2-5-0-1/includes/parseVarfields.php zentrack_2-5-5-1/includes/parseVarfields.php
--- zentrack_2-5-0-1/includes/parseVarfields.php	2004-09-08 01:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/parseVarfields.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,14 +1,16 @@
 <?{
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  
   /**
   * Parses form input and creates an array called $varfield_params which contains the values needed
   * to run $zen->updateVarfieldVals()
   *
   * Depends on the following variables to determine which custom fields are used:
-  *   $customFieldsArray - the results of $zen->getCustomFields() call
+  *   $varfields - the results of $zen->getCustomFields() call
   */
   
   $varfield_fields = array();
-  foreach($customFieldsArray as $f) {
+  foreach($varfields as $f) {
     $k = $f['field_name'];
     $v = $f['field_label'];
     $r = $f['is_required'];
diff -Naur zentrack_2-5-0-1/includes/prepareSearchVarfields.php zentrack_2-5-5-1/includes/prepareSearchVarfields.php
--- zentrack_2-5-0-1/includes/prepareSearchVarfields.php	2004-08-25 09:27:32.000000000 -0700
+++ zentrack_2-5-5-1/includes/prepareSearchVarfields.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
  $varfieldsAll = $zen->getCustomFields(0,"","Search Screen");
  $varfieldsText = array();
  $varfieldsDates = array();
diff -Naur zentrack_2-5-0-1/includes/priorityColors.php zentrack_2-5-5-1/includes/priorityColors.php
--- zentrack_2-5-0-1/includes/priorityColors.php	2003-05-06 23:04:08.000000000 -0700
+++ zentrack_2-5-5-1/includes/priorityColors.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 function color_scale($startcol, $endcol, $pct) {
    // This function returns an HTML colour scaled on a percentile
diff -Naur zentrack_2-5-0-1/includes/reportConfig.php zentrack_2-5-5-1/includes/reportConfig.php
--- zentrack_2-5-0-1/includes/reportConfig.php	2003-03-28 12:42:28.000000000 -0800
+++ zentrack_2-5-5-1/includes/reportConfig.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?{
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /*
   **  ZENGRAPH CONFIGURATION SETTINGS
diff -Naur zentrack_2-5-0-1/includes/reportDataParser.php zentrack_2-5-5-1/includes/reportDataParser.php
--- zentrack_2-5-0-1/includes/reportDataParser.php	2004-10-11 16:35:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/reportDataParser.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 $title_length = 25;
 
@@ -11,32 +13,35 @@
   if( !is_array($params["data_set"]) )
     $params["data_set"] = explode(",",$params["data_set"]);
   $params["chart_options"] = explode(",",$params["chart_options"]);
-
+  
   $zen->addDebug("reportDataParser",
-   "Report generated with id: {$params['report_id']}",2);
+		 "Report generated with id: {$params['report_id']}",2);
   
   // set up the date configuration
   // and the xlabels
   if( !$params["date_low"] || $params["date_selector"] == "range" ) {
     $today = $zen->dateAnchor("day");
     $params["date_low"] = $zen->dateAdjust(-$params["date_value"], 
-                  $params["date_range"],$today);
+					   $params["date_range"],$today);
   }
   // create data set
   // calculate the compact
   // calculate the legend
   if( preg_match("@([a-z]+) ID@i", $params["report_type"], $matches) ) {
     $set_index = array();
-    $n = "get_".strtolower($matches[1]);
+    $m = strtolower($matches[1]);
+    $n = "get_$m";
     $type_column = str_replace(" ","_",strtolower($params["report_type"]));
-    $tbl_column = $zen->getTableId(strtolower($matches[1]));
+    $t = $m == 'ticket'? 'tickets' : $m == 'project'? 'tickets' : 'users';
+    
+    $tbl_column = $zen->getTableId($t);
     foreach($params["data_set"] as $d) {
       $vals = $zen->$n($d);
       $k = $vals["$tbl_column"];
       if( $tbl_column == "user_id" ) {
-   $val = $zen->formatName($vals,1);
+	$val = $zen->formatName($vals,1);
       } else {
-   $val = substr($vals["title"],0,$title_length);
+	$val = substr($vals["title"],0,$title_length);
       }
       $set_index["$k"] = $val;
     }    
@@ -45,12 +50,20 @@
     $set_index = $zen->$n();
     $type_column = strtolower($params["report_type"])."_id";
   }
+
+  //print "<pre>\n";//debug
+  //Zen::printArray($vals,'vals');//debug
+  //print "tbl_column: $tbl_column\n";//debug
+  //Zen::printArray($set_index,'set_index');//debug
+  //print "</pre>\n";//debug
+  //exit;
+  
   $date_set = array();
   $date_labels = array();
   $step = ($params["date_value"] >= 20)?
     ceil($params["date_value"]/10) : 1;
   $end_date = $zen->dateAdjust($params["date_value"],$params["date_range"],
-                $params["date_low"]);
+			       $params["date_low"]);
   for($i=0; $i<$params["date_value"]; $i+=$step) {
     $cdate = ($i>0)? 
       $zen->dateAdjust($i,$params["date_range"],$params["date_low"]) : 
@@ -69,9 +82,9 @@
       $key = strftime("%Y",$cdate);
     } else if( $sub == "ho" || $sub == "mi" ) {
       if( $params["date_value"] > 24 ) {
-   $key = strftime($zen->date_fmt_short." ".$zen->time_fmt,$cdate);
+	$key = strftime($zen->date_fmt_short." ".$zen->time_fmt,$cdate);
       } else {
-   $key = strftime($zen->time_fmt,$cdate);
+	$key = strftime($zen->time_fmt,$cdate);
       }
     } else {
       $key = " $i";
@@ -79,12 +92,12 @@
     $date_set[] = array($cdate,$edate);
     $date_labels[] = $key;
   }
-
+  
   if( $params["chart_combine"] > 0 ) {
     $params["data_set"] = array($params["data_set"]);
     $set_index["Array"] = ucwords(tr("combined"))." {$report_type}s";
   }
-  
+
   $data_array = array();
   $rows_count = array();
   $rows_hours = array();
@@ -236,4 +249,4 @@
   }
 }
     
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/includes/session_save.php zentrack_2-5-5-1/includes/session_save.php
--- zentrack_2-5-0-1/includes/session_save.php	2004-07-22 07:00:50.000000000 -0700
+++ zentrack_2-5-5-1/includes/session_save.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /*
   ** Returns variables extracted to the $_SESSION array
diff -Naur zentrack_2-5-0-1/includes/session_start.php zentrack_2-5-5-1/includes/session_start.php
--- zentrack_2-5-0-1/includes/session_start.php	2004-09-27 22:24:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/session_start.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /*
   **  SESSION TRACKING AND MANAGEMENT
@@ -18,7 +20,7 @@
 }
 
 // ... except the following list
-$reservedList = array("libDir", "rootUrl", 
+$reservedList = array("libDir", "rootUrl", "rootWWW",
 		      "Db_Type", "Db_Instance", "Db_Login", "Db_Pass", "Db_Host", 
 		      "Debug_Mode", "Demo_Mode", "Debug_Overview", 
 		      "page_prefix", "page_title", "page_section", 
@@ -59,7 +61,7 @@
 // which use /bin/php as the SCRIPT_NAME rather
 // than the actual script
 if( (isset($PHP_SELF)&&strlen($PHP_SELF)) 
-    && (!isset($SCRIPT_NAME)||strpos(".php",$SCRIPT_NAME) === false) ) {
+    && (!isset($SCRIPT_NAME)||strpos($SCRIPT_NAME,".php") === false) ) {
   $SCRIPT_NAME = $PHP_SELF;
 }
 
diff -Naur zentrack_2-5-0-1/includes/smtp.class zentrack_2-5-5-1/includes/smtp.class
--- zentrack_2-5-0-1/includes/smtp.class	2002-05-21 07:32:23.000000000 -0700
+++ zentrack_2-5-5-1/includes/smtp.class	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?php
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /**************************************************************************\
   * smtp mailer                                                              *
   * Written by Itzchak Rehberg <izzysoft@qumran.org>                         *
@@ -11,7 +13,7 @@
   * the function send() - unless you are really sure what you are doing!     *
   \**************************************************************************/
 
-  /* $Id: upgrade_2-5-0-1_to_2-5-5-1.patch,v 1.2 2005/05/08 21:14:53 phpzen Exp $ */
+  /* $Id: upgrade_2-5-0-1_to_2-5-5-1.patch,v 1.2 2005/05/08 21:14:53 phpzen Exp $ */
 
 # echo "<!-- *** " . basename(__FILE__) . " starts here. *** -->\n";
 
diff -Naur zentrack_2-5-0-1/includes/sorting.php zentrack_2-5-5-1/includes/sorting.php
--- zentrack_2-5-0-1/includes/sorting.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/sorting.php	2005-05-01 23:59:35.000000000 -0700
@@ -0,0 +1,47 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   * Parses sorting data and stores in session
+   * creates a single string which can be passed
+   * to queries for sorting results.
+   */
+   
+  $sm =& $zen->getSessionManager();
+  $orderby  = $sm->find('ztorderby');
+  if( !$orderby ) {
+    $orderby = array('priority DESC','otime DESC');
+    $sm->store('ztorderby', $orderby);
+  }
+  
+  if( $newsort ) {
+    // make sure our sorting field is valid
+    $tempsort = strpos($newsort, " DESC") > 0?
+        str_replace(" DESC", "", $newsort) : $newsort;
+    if( !array_key_exists($tempsort, $GLOBALS['zt_field_dependencies']['fields']) ) {
+      $zen->addDebug('sorting.php', "Invalid column '$tempsort'", 1);
+      $newsort = false;
+    }
+  }
+   
+  if( $newsort ) {
+    // if we have a valid sorting field, drop it into our stuff.
+    $ordervals = array( preg_replace('/[^0-9a-zA-Z_ ]/', '', $newsort) );
+    for($i=0; $i<count($orderby) && count($ordervals)<2; $i++) {
+      $v = $orderby[$i];
+      $ok = true;
+      if( $v == $newsort ) { $ok = false; }
+      else if( strpos($v, " DESC") > 0 ) {
+        if( $newsort." DESC" == $v ) { $ok = false; }
+      }
+      else {
+        if( $v." DESC" == $newsort ) { $ok = false; }
+      }
+      if( $ok ) { $ordervals[] = $v; }
+    }
+    $orderby = $ordervals;
+    $sm->store('ztorderby', $orderby);
+    $zen->addDebug("sorting.php", "search order set to ".join(',',$orderby),2);
+  }
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/accessForm.php zentrack_2-5-5-1/includes/templates/accessForm.php
--- zentrack_2-5-0-1/includes/templates/accessForm.php	2003-08-28 14:49:15.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/accessForm.php	2005-05-01 23:59:36.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // fetch a list of bins for new bins
   $userBins = $zen->getBins();
 
@@ -59,7 +61,7 @@
   // option tags for the access levels
   function opt_lvls( $selected = '' ) {
     print "<option value=''>---</option>\n";
-    for( $i=0; $i<6; $i++ ) {
+    for( $i=0; $i<11; $i++ ) {
       $sel = (strlen($selected) && $i==$selected)? 
 	" selected" : "";
       print "<option$sel>$i</option>\n";
diff -Naur zentrack_2-5-0-1/includes/templates/actions/assign.php zentrack_2-5-5-1/includes/templates/actions/assign.php
--- zentrack_2-5-0-1/includes/templates/actions/assign.php	2003-03-23 23:25:04.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/assign.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/close.php zentrack_2-5-5-1/includes/templates/actions/close.php
--- zentrack_2-5-0-1/includes/templates/actions/close.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/close.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,48 +1,68 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
-<input type="hidden" name="id" value="<?=$id?>">
+  $view = 'ticket_close';
+  $fields = $map->getFieldMap($view);
+  $hidden_fields = array();
+  $visible_fields = array();
+  foreach($fields as $f=>$field) {
+    if( !$field['is_visible'] ) { $hidden_fields["$f"] = $field; }
+    else {
+      $visible_fields["$f"] = $field;
+    }
+  }
+?>
+
+<form method="post" name="ticketForm" action="<?=$SCRIPT_NAME?>" onSubmit='return validateTicketForm()'>
+<?
+foreach($hidden_fields as $f=>$field) {
+  //$view, $form_name, $field_name, $value = null, $prefix = ''
+  print $map->renderTicketField($view, 'ticketForm', $f, $$f);
+}
+?>
+<input type="hidden" name="id" value="<?=$zen->ffv($id)?>">
 <input type="hidden" name="actionComplete" value="1">
 
 <table width="450" cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
+ <td colspan='2'>
    <span class="bigBold"><?=tr("Close Ticket")?></span>
    <br>
    <span class="small">(<?=tr("Set status to closed/pending")?>)</span>
  </td>
 </tr>
+<?
+
+foreach($visible_fields as $f=>$field) {
+  if( $field['field_type'] == 'section' ) {
+    print "<tr><td colspan='2' class='subTitle'>";
+    print $map->renderTicketField($view, 'ticketForm', $f);
+    print "</td></tr>\n";
+  }
+  else {
+    print "<tr><td class='bars' width='30%'>";
+    print $map->getLabel($view, $f);
+    print "</td><td class='bars'>";
+    print $map->renderTicketField($view, 'ticketForm', $f, $$f);
+    print "</td></tr>\n";
+  }
+}
+
+?>
+
 <tr>
-  <td class="titleCell">
-    <?=tr("Enter any hours worked not previously accounted for")?> <span class="small">(<?=tr("optional")?>)</span>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="text" name="hours" size="10" maxlength="10" value="<?=strip_tags($hours)?>">
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?> <span class="small">(<?=tr("required")?>)</span>
-  </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
+  <td class="titleCell" colspan='2'>
     <?=tr("Click button to close")?>
   </td>
 </tr>
 <tr>
-  <td>
+  <td colspan='2'>
     <input type="submit" value=" <?=uptr("Close")?> " class="submit">
   </td>
 </tr>
 <tr>
 </table>
-
 </form>			     
+<?
+  include_once("$libDir/templates/validateTicketForm.php");
+?>
diff -Naur zentrack_2-5-0-1/includes/templates/actions/contacts.php zentrack_2-5-5-1/includes/templates/actions/contacts.php
--- zentrack_2-5-0-1/includes/templates/actions/contacts.php	2004-10-13 20:39:14.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/actions/contacts.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /**
    * creates a form for adding entries to the contact list
    */
@@ -8,7 +10,7 @@
 <script type="text/javascript">
 function printpopup(varialbe)
 {
-location.href ="<?=$_ENV['SCRIPT_NAME']?>?id=<?=$id?>&company_id="+varialbe
+location.href ="<?=$_SERVER['SCRIPT_NAME']?>?id=<?=$id?>&company_id="+varialbe
 }
 </script>
 
diff -Naur zentrack_2-5-0-1/includes/templates/actions/email.php zentrack_2-5-5-1/includes/templates/actions/email.php
--- zentrack_2-5-0-1/includes/templates/actions/email.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/email.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 
 <script language="javascript">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/estimate.php zentrack_2-5-5-1/includes/templates/actions/estimate.php
--- zentrack_2-5-0-1/includes/templates/actions/estimate.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/estimate.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/log.php zentrack_2-5-5-1/includes/templates/actions/log.php
--- zentrack_2-5-0-1/includes/templates/actions/log.php	2004-08-05 00:22:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/actions/log.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
@@ -48,7 +49,7 @@
 <tr>
   <td>
     <textarea cols="50" rows="4" name="comments"><?=
-      htmlentities(stripslashes($comments))?></textarea>
+      $zen->ffv(stripslashes($comments))?></textarea>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-0-1/includes/templates/actions/move.php zentrack_2-5-5-1/includes/templates/actions/move.php
--- zentrack_2-5-0-1/includes/templates/actions/move.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/move.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/notify.php zentrack_2-5-5-1/includes/templates/actions/notify.php
--- zentrack_2-5-0-1/includes/templates/actions/notify.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/actions/notify.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?{
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /**
    * creates a form for adding entries to the
    * ticket notify list
diff -Naur zentrack_2-5-0-1/includes/templates/actions/reject.php zentrack_2-5-5-1/includes/templates/actions/reject.php
--- zentrack_2-5-0-1/includes/templates/actions/reject.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/reject.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/relate.php zentrack_2-5-5-1/includes/templates/actions/relate.php
--- zentrack_2-5-0-1/includes/templates/actions/relate.php	2004-08-09 01:10:05.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/actions/relate.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>" name='relateTicketForm'>
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/reopen.php zentrack_2-5-5-1/includes/templates/actions/reopen.php
--- zentrack_2-5-0-1/includes/templates/actions/reopen.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/reopen.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/test.php zentrack_2-5-5-1/includes/templates/actions/test.php
--- zentrack_2-5-0-1/includes/templates/actions/test.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/test.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/upload.php zentrack_2-5-5-1/includes/templates/actions/upload.php
--- zentrack_2-5-0-1/includes/templates/actions/upload.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/upload.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form enctype="multipart/form-data" action="<?=$SCRIPT_NAME?>" method="post">
   <input type="hidden" name="MAX_FILE_SIZE" value="<?=$zen->settings["attachment_max_size"]?>">
diff -Naur zentrack_2-5-0-1/includes/templates/actions/varfield_edit.php zentrack_2-5-5-1/includes/templates/actions/varfield_edit.php
--- zentrack_2-5-0-1/includes/templates/actions/varfield_edit.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/varfield_edit.php	2005-05-01 23:59:39.000000000 -0700
@@ -0,0 +1,5 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  include("$libDir/templates/ticket_systemBox.php");
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/actions/yank.php zentrack_2-5-5-1/includes/templates/actions/yank.php
--- zentrack_2-5-0-1/includes/templates/actions/yank.php	2003-03-23 23:25:05.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/actions/yank.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
diff -Naur zentrack_2-5-0-1/includes/templates/adminMenu.php zentrack_2-5-5-1/includes/templates/adminMenu.php
--- zentrack_2-5-0-1/includes/templates/adminMenu.php	2004-07-28 16:22:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/adminMenu.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <br>
 <ul>
   
@@ -13,8 +14,8 @@
   <ul>
     <b><a href='<?=$rootUrl?>/admin/editTicket.php'><?=tr("Edit Tickets")?></a></b>
     <br><span class="small">(<?=tr("Edit ticket information")?>)</span>
-    <br><b><a href='<?=$rootUrl?>/admin/editCustom.php'><?=tr("Edit Variable Fields")?></a></b>
-    <br><span class="small">(<?=tr("Custom defined fields for tickets.")?>)</span>
+    <br><b><a href="<?=$rootUrl?>/admin/fieldMap.php"><?=tr("Edit Field Map")?></a></b>
+    <br><span class="small">(<?=tr("View specific display properties for fields")?></span>
   </ul>
 
   <br><b><?=tr("Data Types")?></b>
diff -Naur zentrack_2-5-0-1/includes/templates/agreementView.php zentrack_2-5-5-1/includes/templates/agreementView.php
--- zentrack_2-5-0-1/includes/templates/agreementView.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/agreementView.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 	<?
 	$sort = "dtime asc";
 	$parms = array(1 => array(1 => "status", 2 => "=", 3 => "1")
diff -Naur zentrack_2-5-0-1/includes/templates/agreement_box.php zentrack_2-5-5-1/includes/templates/agreement_box.php
--- zentrack_2-5-0-1/includes/templates/agreement_box.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/agreement_box.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 /* 
 *Show the contacts that are connected to a company
diff -Naur zentrack_2-5-0-1/includes/templates/agreement_list.php zentrack_2-5-5-1/includes/templates/agreement_list.php
--- zentrack_2-5-0-1/includes/templates/agreement_list.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/agreement_list.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /* 
 *Show the contacts that are connected to a company
 */
diff -Naur zentrack_2-5-0-1/includes/templates/behaviorDetailForm.php zentrack_2-5-5-1/includes/templates/behaviorDetailForm.php
--- zentrack_2-5-0-1/includes/templates/behaviorDetailForm.php	2004-09-27 22:24:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/behaviorDetailForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
    // some elements of page are presented slightly different, although
    // data structure remains the same, when we plan to deal with groups
    // created from files
@@ -85,8 +87,9 @@
             print "<input type='hidden' name='NewComparator[{$j}]' value='eq'>";
           }
           $item['field_value'] = $zen->ffv($item['field_value']);
+          $x = $groupIsFile? 3 : 20;
           print "{$t}<input type='text' name='NewMatchValue[{$j}]' "
-              ." value='{$item['field_value']}' size='20' maxlength='255'>{$te}";
+              ." value='{$item['field_value']}' size='$x' maxlength='255'>{$te}";
             
           // the sort order, normally.  In the case of groups coming from
           // files, this is used as the column index
@@ -109,6 +112,9 @@
       // new detail name
       print "$t<select name='NewFieldName[{$j}]'>\n";
       print "<option value='' selected>".tr('-new/delete-')."</option>\n";
+      if( $groupIsFile ) {
+        print "<option value='value_column'>".tr('-value column-')."</option>\n"; 
+      }
       foreach($field_list as $fl=>$fn) {
         print "<option value='$fn'>$fl</option>\n";
       }
@@ -125,15 +131,19 @@
         print "$te";
         print "{$t}<input type='text' name='NewMatchValue[{$j}]' "
         ." value='' size='20' maxlength='255'>{$te}";
+        // the sort order or the column index
+        print "$t"."<input type='text' name='NewSortOrder[{$j}]' "
+        ." value='' size='3' maxlength='3'>{$te}";
       }
       else {
+        print $t;
         print "<input type='hidden' name='NewComparator[{$j}]' value='eq'>";
-        print "<input type='hidden' name='NewMatchValue[{$j}]' value=''>";
+        print "<input type='text' name='NewMatchValue[{$j}]' value='' size='3' maxlength='20'>";
+        // the sort order or the column index
+        print "<input type='hidden' name='NewSortOrder[{$j}]' value='' size='3' maxlength='3'>";
+        print $te;
       }
       
-      // the sort order or the column index
-      print "$t"."<input type='text' name='NewSortOrder[{$j}]' "
-      ." value='' size='3' maxlength='3'>{$te}";
       print "</tr>\n";
       $j++;
     }
diff -Naur zentrack_2-5-0-1/includes/templates/behaviorForm.php zentrack_2-5-5-1/includes/templates/behaviorForm.php
--- zentrack_2-5-0-1/includes/templates/behaviorForm.php	2004-10-11 16:35:28.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/behaviorForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // generate some text to display based on whether this
   // is an edit page or an add page
   $td = ($TODO == 'EDIT');
diff -Naur zentrack_2-5-0-1/includes/templates/behaviorMenu.php zentrack_2-5-5-1/includes/templates/behaviorMenu.php
--- zentrack_2-5-0-1/includes/templates/behaviorMenu.php	2004-09-27 22:24:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/behaviorMenu.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
          $elnk="$rootUrl/admin/editBehavior.php";
          $llnk="$rootUrl/admin/editBehaviorDetails.php";
          $dlnk="$rootUrl/admin/deleteBehavior.php";
@@ -21,18 +23,19 @@
 	   <b><?=tr("Edit the Behaviors")?></b>
 	 </td>
 	 </tr>
-	 <tr>
-	  <td width="30" class='cell' align='center'><b>ID</b></td>
-          <td class='cell' align='center'><b><?=tr("Enabled")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Sort Order")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Behavior Name")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Match Type")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Field Name")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Group to apply")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Field State")?></b></td>
-          <td class='cell' align='center'><b><?=tr("Actions")?></b></td>
-	 </tr>
-    <? 
+<tr>
+  <td class='subTitle' width='30' align='center'><b><?=tr("ID")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Enabled")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Sort Order")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Behavior Name")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Match Type")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Field Name")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Group to apply")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Field State")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Actions")?></b></td>
+</tr>
+
+<? 
    $behaviors = $zen->getBehaviorList(0);
    $groups=$zen->getDataGroups(0);
    $num = count($behaviors);
diff -Naur zentrack_2-5-0-1/includes/templates/binForm.php zentrack_2-5-5-1/includes/templates/binForm.php
--- zentrack_2-5-0-1/includes/templates/binForm.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/binForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
       <br>
       <p class='error'><?
          $str = "<a href='$rootUrl/help/find.php?s=admin&p=varfields'>".tr('Documentation')."</a>";
diff -Naur zentrack_2-5-0-1/includes/templates/bugForm.php zentrack_2-5-5-1/includes/templates/bugForm.php
--- zentrack_2-5-0-1/includes/templates/bugForm.php	2004-09-09 03:20:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/bugForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form name='bugForm' method='post'>
 <table>
diff -Naur zentrack_2-5-0-1/includes/templates/configForm.php zentrack_2-5-5-1/includes/templates/configForm.php
--- zentrack_2-5-0-1/includes/templates/configForm.php	2004-10-11 16:35:28.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/configForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
       <br>
       <p class='error'><?
          $str = "<a href='$rootUrl/help/find.php?s=admin&p=data_types'>".tr('Documentation')."</a>";
diff -Naur zentrack_2-5-0-1/includes/templates/configSettingsForm.php zentrack_2-5-5-1/includes/templates/configSettingsForm.php
--- zentrack_2-5-0-1/includes/templates/configSettingsForm.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/configSettingsForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
       <br>
       <p><b><?=tr("Changing these settings can have a severe impact on the system.  Please consider this before making modifications.")?></b></p>
       <p class='error'><?
@@ -45,7 +46,7 @@
       } else {
 	print "<input type='text' style='font-size:"
 	   .$zen->settings["font_size_small"]."px' name='newSettings[$k]' "
-	   ." size='20' maxlength='100' value='".htmlentities($s["value"])."'>";
+           ." size='20' maxlength='100' value='".$zen->ffv($s["value"])."'>";
       }
       print "</td>";
       print "<td class='$class'>$s[description]</td>\n";
diff -Naur zentrack_2-5-0-1/includes/templates/contactView.php zentrack_2-5-5-1/includes/templates/contactView.php
--- zentrack_2-5-0-1/includes/templates/contactView.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contactView.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /*
   **  CONTACT VIEW
   **
diff -Naur zentrack_2-5-0-1/includes/templates/contact_!19Box.php zentrack_2-5-5-1/includes/templates/contact_!19Box.php
--- zentrack_2-5-0-1/includes/templates/contact_!19Box.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_!19Box.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_abcBox.php zentrack_2-5-5-1/includes/templates/contact_abcBox.php
--- zentrack_2-5-0-1/includes/templates/contact_abcBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_abcBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_allBox.php zentrack_2-5-5-1/includes/templates/contact_allBox.php
--- zentrack_2-5-0-1/includes/templates/contact_allBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_allBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width="645" cellpadding="0" cellspacing="0" border="0">
 <tr> 
   <td class="ticketCell" height="300" valign="top">
diff -Naur zentrack_2-5-0-1/includes/templates/contact_box.php zentrack_2-5-5-1/includes/templates/contact_box.php
--- zentrack_2-5-0-1/includes/templates/contact_box.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_box.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width="645" cellpadding="0" cellspacing="0" border="0">
 <tr> 
 <td valign="bottom">
diff -Naur zentrack_2-5-0-1/includes/templates/contact_buttonBox.php zentrack_2-5-5-1/includes/templates/contact_buttonBox.php
--- zentrack_2-5-0-1/includes/templates/contact_buttonBox.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_buttonBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width="120" cellpadding="0" cellspacing="0" border="0">
 <tr>
 <?
diff -Naur zentrack_2-5-0-1/includes/templates/contact_defBox.php zentrack_2-5-5-1/includes/templates/contact_defBox.php
--- zentrack_2-5-0-1/includes/templates/contact_defBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_defBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_ghiBox.php zentrack_2-5-5-1/includes/templates/contact_ghiBox.php
--- zentrack_2-5-0-1/includes/templates/contact_ghiBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_ghiBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_jklBox.php zentrack_2-5-5-1/includes/templates/contact_jklBox.php
--- zentrack_2-5-0-1/includes/templates/contact_jklBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_jklBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_list.php zentrack_2-5-5-1/includes/templates/contact_list.php
--- zentrack_2-5-0-1/includes/templates/contact_list.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_list.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /* 
 *Show the contacts that are connected to a company
 */
diff -Naur zentrack_2-5-0-1/includes/templates/contact_mnoBox.php zentrack_2-5-5-1/includes/templates/contact_mnoBox.php
--- zentrack_2-5-0-1/includes/templates/contact_mnoBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_mnoBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_personBox.php zentrack_2-5-5-1/includes/templates/contact_personBox.php
--- zentrack_2-5-0-1/includes/templates/contact_personBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_personBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /* 
 *Show the contacts that are connected to a company
 */
diff -Naur zentrack_2-5-0-1/includes/templates/contact_pqrsBox.php zentrack_2-5-5-1/includes/templates/contact_pqrsBox.php
--- zentrack_2-5-0-1/includes/templates/contact_pqrsBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_pqrsBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_titleBox.php zentrack_2-5-5-1/includes/templates/contact_titleBox.php
--- zentrack_2-5-0-1/includes/templates/contact_titleBox.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_titleBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table cellpadding="0" cellspacing="0">
   <tr>
    <td class="ticketCell"><table 
diff -Naur zentrack_2-5-0-1/includes/templates/contact_tuvBox.php zentrack_2-5-5-1/includes/templates/contact_tuvBox.php
--- zentrack_2-5-0-1/includes/templates/contact_tuvBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_tuvBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/contact_wxyzBox.php zentrack_2-5-5-1/includes/templates/contact_wxyzBox.php
--- zentrack_2-5-0-1/includes/templates/contact_wxyzBox.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/contact_wxyzBox.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/customGroupDetailsForm.php zentrack_2-5-5-1/includes/templates/customGroupDetailsForm.php
--- zentrack_2-5-0-1/includes/templates/customGroupDetailsForm.php	2004-08-04 04:52:18.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/customGroupDetailsForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
       <br>
       <p class='error'><?=tr("Select the items that will appear in this group and their order.")?></p>
       <ul>
diff -Naur zentrack_2-5-0-1/includes/templates/editAgreementForm.php zentrack_2-5-5-1/includes/templates/editAgreementForm.php
--- zentrack_2-5-0-1/includes/templates/editAgreementForm.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/editAgreementForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   $skip = 0;
   
   $agreement = $zen->get_contact($id,"ZENTRACK_AGREEMENT","agree_id");
diff -Naur zentrack_2-5-0-1/includes/templates/editContactForm.php zentrack_2-5-5-1/includes/templates/editContactForm.php
--- zentrack_2-5-0-1/includes/templates/editContactForm.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/editContactForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   $skip = 0;
   $id = NULL;
   
diff -Naur zentrack_2-5-0-1/includes/templates/editCustomsForm.php zentrack_2-5-5-1/includes/templates/editCustomsForm.php
--- zentrack_2-5-0-1/includes/templates/editCustomsForm.php	2004-09-27 22:24:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/editCustomsForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 
       <p class='bigBold'><?=tr('Edit Variable Fields')?></p>
diff -Naur zentrack_2-5-0-1/includes/templates/editTicketForm.php zentrack_2-5-5-1/includes/templates/editTicketForm.php
--- zentrack_2-5-0-1/includes/templates/editTicketForm.php	2004-10-11 16:35:28.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/editTicketForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // if there is an ID, open it up
   // otherwise, ask for the ticket ID
   $skip = 0;
@@ -19,10 +21,12 @@
       extract($varfields);
       extract($ticket);
       $description = preg_replace("@<br ?/?>@","\n",$description); 
-      if( $zen->inProjectTypeIDs($ticket["type_id"]) )
-        include("$templateDir/newProjectForm.php");
-      else
-        include("$templateDir/newTicketForm.php");
+      if( $zen->inProjectTypeIDs($ticket["type_id"]) ) {
+        $view = "project_edit";
+      } else {
+        $view = "ticket_edit";
+      }
+      include("$templateDir/newTicketForm.php");
     }
   } 
   if( !$skip ) {
diff -Naur zentrack_2-5-0-1/includes/templates/email/form_help.template zentrack_2-5-5-1/includes/templates/email/form_help.template
--- zentrack_2-5-0-1/includes/templates/email/form_help.template	2003-03-23 18:43:11.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/email/form_help.template	2005-01-22 15:08:28.000000000 -0800
@@ -7,6 +7,8 @@
 
 The {zen:system_name} email gateway provides an interface for users to perform actions on request tickets via email.
 
+NOTE:  MOST USERS ARE SIMPLY LOOKING TO SEND AN EMAIL AND CREATE A TICKET.  This is not the interface for that purpose.  A seperate email address may be available from your administrator for this purpose.  This interface is designed to provide administrative capabilities (at the cost of additional complexity)
+
 Actions are performed by replying to any email post with the following text format in the subject:
 
 #nnnn: action
diff -Naur zentrack_2-5-0-1/includes/templates/fieldMapForm.php zentrack_2-5-5-1/includes/templates/fieldMapForm.php
--- zentrack_2-5-0-1/includes/templates/fieldMapForm.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fieldMapForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -0,0 +1,412 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+    PREREQUISITES:
+      $map - (ZenFieldMap) map object which can be used to retrieve default values
+      $fields - (array) values from $map->getFieldMap($view);
+      $zen - (ZenTrack)
+  **/
+?>
+<br>
+<p class='error'><?
+   $str = "<a href='$rootUrl/help/find.php?s=admin&p=fieldmap'>".tr('Documentation')."</a>";
+   print tr("Please refer to the ? before using this feature", array($str));
+ ?></p>
+ 
+<form method='post' action='<?=$SCRIPT_NAME?>' name='fieldMapForm'>
+<input type='hidden' name='TODO' value='save'>
+<input type='hidden' name='view' value='<?=$zen->ffv($view)?>'>
+
+<p>
+<nobr>
+<b>Screen to Edit:</b>
+&nbsp;
+<select name='view'>
+<?
+foreach( getFmViewProps() as $k=>$v ) {
+  if( !$v['disabled'] ) {
+    $sel = $view == $k? " selected" : "";
+    print "<option value='$k'$sel>$k</option>\n";
+  }
+}
+?>
+</select>
+&nbsp;
+<input type='submit' name='switchview' onclick='return setTodo("switch")' value='GO'>
+</nobr>
+<br><span class='note'><?=tr("Do not switch views without saving changes!")?></span>
+</p>
+
+<table cellpadding="4" cellspacing="1" class='cell' border=0>
+<tr toofar="toofar">
+  <td class='titleCell' align='center' colspan='10'>
+    <b><?=tr("Edit field map for ?", $view)?></b>
+  </td>
+</tr>
+<?
+if( !is_array($fields) || !count($fields) || !$map || !$view ){
+  print "<tr><td colspan='10' class='cell'>This view has no properties to configure</td></tr>\n";
+}
+else {
+?>
+<tr toofar="toofar">
+  <td class='subTitle' align='center'><b><?=tr("Options")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Name")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Label")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Show")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Required")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Default")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Type")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Columns")?></b></td>
+  <td class='subTitle' align='center'><b><?=tr("Rows")?></b></td>
+</tr>
+
+<?
+function fmfRow( $text, $class ) {
+  print "<td class='$class'>{$text}</td>";
+}
+
+function fmfName( $field_name, $key ) {
+  return " name='{$field_name}[$key]' ";
+}
+
+function fmfVal( $field, $key ) {
+  global $zen;
+  return $zen->ffv($field[$key]);
+}
+
+$vprops = getFmViewProps($view);
+$fcount=0;
+$prevSection = false;
+$typeprops = getFmTypeProps();
+foreach($fields as $f=>$field) {
+  // retrive configurable settings from database
+  //$field = $map->getFieldFromMap($view, $f);
+
+  // convert varfield names using fieldName() method
+  // and get special properties for fields
+  $fprops = getFmFieldProps($view, ZenFieldMap::fieldName($f));
+  $tprops = $typeprops[$field['field_type']];
+  
+  // generate row of information
+  $s = $field['is_visible']? 'bold' : 'disabled';
+  $class = $field['field_type'] == 'section'? "altBars $s" : "bars $s";
+  print "<tr id='$f'>";
+
+  // create options row
+  $txt = '';
+    $fn = "document.fieldMapForm";
+    // up arrow
+    $txt .= "<a href='#' onClick='moveRowUp(this.parentNode);return false;'";
+    $txt .= " border='0' alt='Move Up' title='Move Up'><img src='$rootUrl/images/icon_arrow_up.gif'";
+    $txt .= " width='16' height='16' alt='Move Up' title='Move Up' border='0'></a>";
+    // down arrow
+    $txt .= "<a href='#' onClick='moveRowDown(this.parentNode);return false;'";
+    $txt .= " border='0' alt='Move Down' title='Move Down'><img src='$rootUrl/images/icon_arrow_down.gif'";
+    $txt .= " width='16' height='16' alt='Move Down' title='Move Down' border='0'></a>";
+    // control sort ordering by tracking what order these hidden fields arrive
+    $txt .= "<input type='hidden' name='orderset[$f]' value='$fcount'>";
+  if( $vprops['sections'] ) {
+    if( $field['field_type'] == 'section' && $field['field_name'] != 'elapsed' ) {
+      // remove sections
+      $txt .= "<a href='#' onClick='removeRow(this);return false;'";
+      $txt .= " border='0' alt='Remove Section' title='Remove Section'><img src='$rootUrl/images/icon_trash.gif'";
+      $txt .= " width='16' height='16' alt='Remove Section' title='Remove Section' border='0'></a>";
+    }
+    else {
+      // add new sections
+      $txt .= "<a href='#' onClick='addRow(this);return false;'";
+      $txt .= " border='0' alt='Add Section' title='Add Section'><img src='$rootUrl/images/icon_add.gif'";
+      $txt .= " width='16' height='16' alt='Add Section' title='Add Section' border='0'></a>";
+    }
+  }
+  fmfRow($txt,$class);
+
+  // the field name (read only)
+  fmfRow($field['field_name'],$class);
+  // the label (text)
+  fmfRow("<input type='text' ".fmfName($f,'field_label')
+        ."value='".fmfVal($field,'field_label')."' size=15 maxlength=200>",$class);
+  // visibility (checkbox)
+  $sel = $field['is_visible']? ' checked' : '';
+  fmfRow("<input type='checkbox' ".fmfName($f, 'is_visible')
+         ."value='1' onclick='return checkVisible(this)'$sel>",$class);
+  // required, always required if this is a system based field
+  if( $field['field_type'] == 'section' ) {
+    $s = $field['is_visible']? 'bold' : 'disabled';
+    print "<td class='altBars $s' colspan='5'>&nbsp;</td>";
+  }
+  else {
+    if( $vprops['view_only'] ) {
+      fmfRow(tr('n/a'),$class);
+    }
+    else if( $view == 'search_form' ) {
+      fmfRow(tr('n/a'), $class);
+    }
+    else if( $fprops['always_required'] ) {
+      fmfRow(tr('yes'),$class);
+    }
+    else {
+      $sel = $field['is_required']? ' checked' : '';
+      fmfRow("<input type='checkbox' ".fmfName($f, 'is_required')." value='1'$sel>",$class);
+    }
+    // default value (text)
+    $txt = "n/a";
+    if( $fprops['default'] && !$vprops['view_only'] ) {
+      if( strpos($f,'custom_menu')===0 ) {
+        // custom menus use the data groups as a selector, not a list of values
+        $choices = $zen->getDataGroups();
+      }
+      else {
+        $choices = $map->getChoices($view, $f);
+      }
+      //if( $f == 'custom_menu1' ) { Zen::printArray($choices); }
+      if( is_array($choices) && count($choices) ) {
+        $txt = "<select ".fmfName($f,'default_val').">";
+        $txt .= "<option value=''>--</option>";
+        foreach($choices as $k=>$v) {
+          $sel = $field['default_val'] == $k? " selected" : "";
+          $txt .= "<option value='$k'{$sel}>$v</option>";
+        }
+        $txt .= "</select>";
+      }
+      else {
+        $txt = "<input type='text' ".fmfName($f, 'default_val')
+               ."value='".$zen->ffv($field['default_val'])."' size=10 maxlength=200>";
+      }
+    }
+    fmfRow($txt,$class);
+    
+    // field type, not useful for fields which only have label as type
+    // or for sections
+    if( count($fprops['types']) == 1 && $fprops['types'][0] == 'label' ) {
+      fmfRow($field['field_type']=='section'?'&nbsp;':fmfVal($field,'field_type'),$class);
+    }
+    else {
+      $txt = "<select style='width:80px;' ".fmfName($f, 'field_type').">";
+      if (count($fprops['types'])>0) {
+        foreach($fprops['types'] as $t) {
+          if( $view == 'search_form' && $t == 'checkbox' ) { continue; }
+          $sel = ( $field['field_type'] == $t )? ' selected':'';
+          $txt .= "<option value='$t'$sel>$t</option>\n";
+        }
+      }
+      $txt .= "</select>";
+      fmfRow($txt,$class);
+    }
+    // number of columns
+    fmfRow("<input type='text' ".fmfName($f, 'num_cols')
+        ." value='".fmfVal($field,'num_cols')."' size='5' maxlength='4'>",$class);
+    // number of rows
+    $dorows = false;
+    if( $fprops['types'] ) {
+      foreach($fprops['types'] as $t) {
+        if( $typeprops[$t]['multiple'] ) { $dorows = true; break; }
+      }
+    }
+    if( $dorows ) {
+      fmfRow("<input type='text' ".fmfName($f, 'num_rows')
+          ." value='".fmfVal($field,'num_rows')."' size='3' maxlength='2'>",$class);
+    }
+    else { fmfRow('1',$class); }
+  }
+  
+  print "</tr>\n";
+  $fcount++;
+  $prevSection = $field['field_type'] == 'section';
+}
+?>
+<tr id='section0' style="display:none;">
+  <td class='highlight'><input type='hidden' name='orderset[section0]' value='3'><a href='#' onClick='moveRowUp(this.parentNode);return false;' border='0' alt='Move Up' title='Move Up'><img src='/images/icon_arrow_up.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='moveRowDown(this.parentNode);return false;' border='0' alt='Move Down' title='Move Down'><img src='/images/icon_arrow_down.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='removeRow(this);return false;' border='0' alt='Remove Section' title='Remove Section'><img src='/images/icon_trash.gif' width='16' height='16' alt='Remove Section' title='Remove Section' border='0'></a></td>
+  <td class='highlight' islabel="islabel">section0</td>
+  <td class='highlight'><input type='text' name='section0[field_label]' value='' size=15 maxlength=200></td>
+  <td class='highlight'><input type='checkbox'  name='section0[is_visible]' value='1' onclick='return checkVisible(this)' checked></td>
+  <td class='highlight' colspan='5'>&nbsp;</td>
+</tr>
+<tr id="submitRow" toofar="toofar">
+  <td class='cell' colspan='4'>
+    <input type='submit' value='<?=uptr('save')?>' onClick="return setTodo('save');">
+    &nbsp;
+    <input type='submit' class='submitPlain' value='<?=tr('Reset')?>' onClick="return setTodo('reset');">
+  </td>
+</tr>
+
+<? } ?>
+
+</table>
+</form>
+
+<script type='text/javascript'>
+
+function setTodo( txt ) {
+  document.fieldMapForm.TODO.value = txt;
+  return true;
+}
+
+function addRow( obj ) {
+  if( !confirm("Add a Section Here?") ) { return; }
+  // determine what the next available section number is
+  var x = 1;
+  while( document.getElementById("section"+x) ) { x++; }
+  var newName = "section"+x;
+  var newSection = document.getElementById("section0").cloneNode(true);
+  newSection.setAttribute("id",newName);
+  for(var i=0; i < newSection.childNodes.length; i++) {
+    var sect = newSection.childNodes[i];
+    if( sect.getAttribute && sect.getAttribute("isLabel") ) {
+      s += "set innerhtml for "+sect+"\n";
+      sect.innerHTML = newName;
+    }
+    else if( sect.hasChildNodes() && sect.childNodes[0] ) {
+      var c = sect.childNodes[0];
+      if( c.type == 'text' || c.type == 'checkbox' || c.type == 'hidden' ) {
+        c.setAttribute('name', c.getAttribute('name').replace('section0',newName));
+        s += " - new name: "+c.name+"\n";
+        if ( c.type == 'hidden' ) {
+          var v1, v2;
+          v1=parseFloat(document.fieldMapForm[ "orderset[" + obj.parentNode.parentNode.id + "]" ].value);
+          var previousRow = obj.parentNode.parentNode.previousSibling;
+          while( previousRow && previousRow.nodeName != "TR" ) {
+            previousRow = previousRow.previousSibling;
+          }
+          if( !previousRow || previousRow.getAttribute("toofar") ) {
+            v2=-1.0;
+          } else {
+            v2=parseFloat(document.fieldMapForm[ "orderset[" + previousRow.id + "]" ].value);
+          }
+          v=(v1 + v2) / 2.0;
+          c.setAttribute('value',v);
+        }
+      }
+    }
+  }
+  obj.parentNode.parentNode.parentNode.insertBefore(newSection, obj.parentNode.parentNode);
+  newSection.style.display = "";
+}
+
+function removeRow( obj ) {
+  if( !confirm("Remove this Section?") ) { return; }
+  var thisNode = obj.parentNode.parentNode;
+  thisNode.parentNode.removeChild(thisNode);
+}
+
+function moveRowUp( tdCell ) {
+  var v1, v2;
+  var thisRow = tdCell.parentNode;
+  quickHighlightRow( thisRow, 'subTitle' );  
+  var previousRow = thisRow.previousSibling;
+  var parentNode = thisRow.parentNode;
+  while( previousRow && previousRow.nodeName != "TR" ) {
+    previousRow = previousRow.previousSibling;
+  }
+  if( !previousRow || previousRow.getAttribute("toofar") ) {
+    parentNode.insertBefore(thisRow, document.getElementById("submitRow"));
+    //As this is now the last row, we can get the orderset value of it's new previous row
+    previousRow = thisRow.previousSibling;
+    while( (previousRow && previousRow.nodeName != "TR") || (previousRow && previousRow.id === "section0") ) {
+      previousRow = previousRow.previousSibling;
+    }
+    //And set the current row's orderset value to it's previous row orderset value + 1
+    v1=parseFloat(document.fieldMapForm[ "orderset[" + previousRow.id + "]" ].value);
+    document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value=v1+1;
+    return;
+  }
+  parentNode.insertBefore(thisRow, previousRow);
+  //If it didn't cross the edge of the table, we just swap the orderset values:
+  v1=parseFloat(document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value);
+  v2=parseFloat(document.fieldMapForm[ "orderset[" + previousRow.id + "]" ].value);
+  document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value=v2;
+  document.fieldMapForm[ "orderset[" + previousRow.id + "]" ].value=v1;  
+}
+
+function quickHighlightRow( parentObj, s ) {
+  for(var i=0; i < parentObj.childNodes.length; i++) {
+    var obj = parentObj.childNodes[i];
+    obj.id = parentObj.id + '-'+i;
+    if( obj.nodeName != "TD" ) { continue; }
+    objName = obj.id;
+    if( obj.className ) {
+      obj.className = obj.className + ' ' + s;
+      setTimeout("var x = document.getElementById('"+objName+"'); x.className = x.className.substr(0,x.className.indexOf(' "+s+"'));",500);
+    }
+    else {
+      obj.setAttribute('class', obj.getAttribute('class') + ' ' + s);
+      setTimeout("var x = document.getElementById('"+objName+"'); x.setAttribute('class', x.getAttribute('class').substr(0,x.getAttribute('class').indexOf(' "+s+"')));",500);
+    }
+    
+  }
+}
+
+function moveRowDown( tdCell ) {
+  var v1, v2;
+  var thisRow = tdCell.parentNode;
+  quickHighlightRow( thisRow, 'subTitle' );  
+  var nextRow = thisRow.nextSibling;
+  var parentNode = thisRow.parentNode;
+  //while( nextRow && nextRow.nodeName != "TR" ) {
+  while( (nextRow && nextRow.nodeName != "TR") || (nextRow && nextRow.id === "section0") ) {
+    nextRow = nextRow.nextSibling;
+  }
+  if( !nextRow || nextRow.getAttribute("toofar") ) {
+    nextRow = thisRow;
+    thisRow = parentNode.firstChild;
+    while( thisRow.nodeName != "TR" || thisRow.getAttribute("toofar") ) {
+      thisRow = thisRow.nextSibling;
+    }
+    //We set the current row's orderset value to the first row's orderset -1
+    v1=parseFloat(document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value);
+    document.fieldMapForm[ "orderset[" + nextRow.id + "]" ].value=v1-1;
+  } else {
+    //We swap the orderset values:
+    v1=parseFloat(document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value);
+    v2=parseFloat(document.fieldMapForm[ "orderset[" + nextRow.id + "]" ].value);
+    document.fieldMapForm[ "orderset[" + thisRow.id + "]" ].value=v2;
+    document.fieldMapForm[ "orderset[" + nextRow.id + "]" ].value=v1;
+  } 
+  parentNode.insertBefore(nextRow, thisRow);  
+}
+
+function toggleRowColor( checkBox ) {
+    // navigate to the TR tag for this row
+    var trTag = checkBox.parentNode.parentNode;
+    
+    for(var i=0; i < trTag.childNodes.length; i++) {
+      var obj = trTag.childNodes[i];
+      if( obj.nodeName != "TD" ) { continue; }
+      // perform the class switch
+      if( obj.className ) {
+        // determine what we are setting the style to based on checkbox
+        obj.className = checkBox.checked? 
+          obj.className.substr(0, obj.className.indexOf(" ")) + " bold" :
+          obj.className.substr(0, obj.className.indexOf(" ")) + " disabled";
+      }
+      else {
+        // determine what we are setting the style to based on checkbox
+        var oldStyle = obj.getAttribute('class');
+        obj.setAttribute('class', checkBox.checked? 
+          oldStyle.substr(0, oldStyle.indexOf(" "))+" bold" : 
+          oldStyle.substr(0, oldStyle.indexOf(" "))+" disabled" );
+      }
+    }
+}
+
+  function checkVisible( obj ) {
+    var namePrefix = getNamePrefix(obj.name);
+    var defName = namePrefix+'[default_val]';
+    var reqName = namePrefix+'[is_required]';
+    var defObj = document.fieldMapForm[defName];
+    var reqObj = document.fieldMapForm[reqName];
+    toggleRowColor( document.fieldMapForm[namePrefix+"[is_visible]"] );
+    //if( !defObj ) { alert("crap!"); }//debug
+    if( defObj && defObj.value == null && reqObj.checked ) {
+      alert("You cannot hide a required field unless it has a default value.");
+      return false;
+    }
+    return true;
+  }
+  
+  function getNamePrefix( name ) {
+    return name.substr(0, name.indexOf('['))
+  }
+</script>
diff -Naur zentrack_2-5-0-1/includes/templates/fields/checkbox.template zentrack_2-5-5-1/includes/templates/fields/checkbox.template
--- zentrack_2-5-0-1/includes/templates/fields/checkbox.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/checkbox.template	2005-03-09 07:55:38.000000000 -0800
@@ -0,0 +1 @@
+<input type="checkbox" name="{field_name}" value="1"{if:field_value:" checked"} {field_events}>
diff -Naur zentrack_2-5-0-1/includes/templates/fields/date.template zentrack_2-5-5-1/includes/templates/fields/date.template
--- zentrack_2-5-0-1/includes/templates/fields/date.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/date.template	2005-03-11 07:37:39.000000000 -0800
@@ -0,0 +1,6 @@
+
+<input type="text" name="{field_name}" size="{field_cols}" maxlength="{field_max}" value="{field_value}" 
+  hascalendar="{field_name}-calendar_icon" {field_events}>
+  <img name="date_button" src='{rooturl}/images/cal.gif' 
+    onClick="popUpCalendar(this, document.{form_name}['{field_name}'], '{date_format}')"
+    alt="Select a Date" id="{field_name}-calendar_icon">
diff -Naur zentrack_2-5-0-1/includes/templates/fields/hidden.template zentrack_2-5-5-1/includes/templates/fields/hidden.template
--- zentrack_2-5-0-1/includes/templates/fields/hidden.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/hidden.template	2005-01-30 23:10:03.000000000 -0800
@@ -0,0 +1,2 @@
+
+<input type='hidden' name='{field_name}' value='{field_value}'>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/fields/label.template zentrack_2-5-5-1/includes/templates/fields/label.template
--- zentrack_2-5-0-1/includes/templates/fields/label.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/label.template	2005-03-31 12:11:54.000000000 -0800
@@ -0,0 +1,2 @@
+
+<input type='hidden' name='{field_name}' value='{field_value}'><div id='{field_name}LabelText'>{field_label}</div>
diff -Naur zentrack_2-5-0-1/includes/templates/fields/menu.template zentrack_2-5-5-1/includes/templates/fields/menu.template
--- zentrack_2-5-0-1/includes/templates/fields/menu.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/menu.template	2005-03-11 07:37:39.000000000 -0800
@@ -0,0 +1,4 @@
+
+<select name='{field_name}' size='{field_rows}' {field_multiple} {field_events}>
+{list:field_choices:"<option value='"+index+"'"+selected+">"+value+"</option>"}
+</select>
diff -Naur zentrack_2-5-0-1/includes/templates/fields/radio.template zentrack_2-5-5-1/includes/templates/fields/radio.template
--- zentrack_2-5-0-1/includes/templates/fields/radio.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/radio.template	2005-03-11 07:37:39.000000000 -0800
@@ -0,0 +1,2 @@
+
+{list:field_choices:"<input type='radio' name='"+field_name+"' value='"+index+"'>&nbsp;"+value+"&nbsp;"}
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/fields/searchbox.template zentrack_2-5-5-1/includes/templates/fields/searchbox.template
--- zentrack_2-5-0-1/includes/templates/fields/searchbox.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/searchbox.template	2005-01-30 23:10:03.000000000 -0800
@@ -0,0 +1,6 @@
+
+    <input type="text" name="{field_name}" size="{field_cols}" maxlength="{field_max}"
+    value="{field_value}">
+    &nbsp;<input type='button' class='searchbox' value=' ... ' 
+    onClick='popupWindowScrolls("{search_url}","popupHelper",375,500)'>
+  {search_text}
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/fields/section.template zentrack_2-5-5-1/includes/templates/fields/section.template
--- zentrack_2-5-0-1/includes/templates/fields/section.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/section.template	2005-01-30 23:10:03.000000000 -0800
@@ -0,0 +1 @@
+{label}
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/fields/text.template zentrack_2-5-5-1/includes/templates/fields/text.template
--- zentrack_2-5-0-1/includes/templates/fields/text.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/text.template	2005-01-30 23:10:03.000000000 -0800
@@ -0,0 +1,3 @@
+
+
+<input type="text" name="{field_name}" value="{field_value}" size="{field_cols}" maxlength="{field_max}" {field_events}>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/fields/textarea.template zentrack_2-5-5-1/includes/templates/fields/textarea.template
--- zentrack_2-5-0-1/includes/templates/fields/textarea.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/fields/textarea.template	2005-01-30 23:10:03.000000000 -0800
@@ -0,0 +1,2 @@
+
+<textarea cols="{field_cols}" rows="{field_rows}" name="{field_name}" {field_events}>{field_value}</textarea>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/groupAdd.php zentrack_2-5-5-1/includes/templates/groupAdd.php
--- zentrack_2-5-0-1/includes/templates/groupAdd.php	2004-10-11 16:35:28.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/groupAdd.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // generate some text to display based on whether this
   // is an edit page or an add page
   $td = ($TODO == 'EDIT');
diff -Naur zentrack_2-5-0-1/includes/templates/groupDetailsForm.php zentrack_2-5-5-1/includes/templates/groupDetailsForm.php
--- zentrack_2-5-0-1/includes/templates/groupDetailsForm.php	2004-09-27 22:24:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/groupDetailsForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
       <br>
       <p class='error'><?=tr("Select the items that will appear in this group and their order.")?></p>
       <ul>
diff -Naur zentrack_2-5-0-1/includes/templates/groupForm.php zentrack_2-5-5-1/includes/templates/groupForm.php
--- zentrack_2-5-0-1/includes/templates/groupForm.php	2004-10-13 20:39:14.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/groupForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,6 +1,9 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
          $elnk="$rootUrl/admin/editGroup.php";
          $llnk="$rootUrl/admin/editGroupDetails.php";
+         $dlnk="$rootUrl/admin/deleteGroup.php";
 ?>
       <br>
       <p><b><?=tr("Edit existing groups or create a new group.")?></b></p>
@@ -85,6 +88,10 @@
 		 . "[<a href='".$llnk."?group_id=".$v['group_id']."'>"
 		 .uptr('entries')."</a>]";
 	     }
+             print "<br>";
+	     print "<span class='small'>"
+		 . "[<a href='".$dlnk."?group_id=".$v['group_id']."' onclick='return confirm(\"Delete this group permanently?\")'>"
+		 .uptr('delete')."</a>]";
 	     print $te;
 	       
 	     print "</tr>\n";
diff -Naur zentrack_2-5-0-1/includes/templates/homebinForm.php zentrack_2-5-5-1/includes/templates/homebinForm.php
--- zentrack_2-5-0-1/includes/templates/homebinForm.php	2003-05-22 00:11:24.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/homebinForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>">
 
diff -Naur zentrack_2-5-0-1/includes/templates/languageForm.php zentrack_2-5-5-1/includes/templates/languageForm.php
--- zentrack_2-5-0-1/includes/templates/languageForm.php	2003-05-03 03:07:43.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/languageForm.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" action="<?=$rootUrl?>/misc/language.php">
 
diff -Naur zentrack_2-5-0-1/includes/templates/listContacts.php zentrack_2-5-5-1/includes/templates/listContacts.php
--- zentrack_2-5-0-1/includes/templates/listContacts.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/listContacts.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /*
 *Company bar to show some info
 */
diff -Naur zentrack_2-5-0-1/includes/templates/listContacts2.php zentrack_2-5-5-1/includes/templates/listContacts2.php
--- zentrack_2-5-0-1/includes/templates/listContacts2.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/listContacts2.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /*
 *Person bar to show some info
 */
diff -Naur zentrack_2-5-0-1/includes/templates/listTickets.php zentrack_2-5-5-1/includes/templates/listTickets.php
--- zentrack_2-5-0-1/includes/templates/listTickets.php	2004-09-03 08:41:49.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/listTickets.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,100 +1,197 @@
 <?
+  if( !ZT_DEFINED ) { die("Illegal access"); }
 
+  /**
+   PREREQUISITES:
+     (ZenFieldMap)$map - contains properties for fields
+     (string)$view - the current view (probably project_list or ticket_list)
+     (array)$fields - [optional]properties for fields to be rendered, obtained from ZenFieldMap::getFieldMap( view )
+     (string)$page_type - (optional) either 'ticket' or 'project'
+     (array)$tickets - list of tickets to be displayed, as retrieved from zenTrack::get_tickets()
+  **/
+  
 if( !$page_type )
   $page_type = "ticket";
   
+$fields = $map->getFieldMap($view);
+include_once("$libDir/sorting.php");
+  
 if( is_array($tickets) && count($tickets) ) {
-      ?>
-        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+?>
+<script type='text/javascript'>
+function resortListPage( sortName ) {
+<? if( strpos($view, 'search')===0 ) { ?>
+  document.searchModifyForm.newsort.value = sortName;
+  document.searchModifyForm.TODO.value = 'SEARCH';
+  document.searchModifyForm.submit();
+  return false;
+<? } else { ?>
+  s = window.location.href;
+  s += s.indexOf('?') > 0? '&newsort='+sortName : '?newsort='+sortName;
+  window.location = s;
+<? } ?>
+}
+</script>
+<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
    <tr bgcolor="<?=$zen->settings["color_title_background"]?>">
-   <td width="32" height="25" valign="middle" title="Tracking ID for the <?=$page_type?>">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
-   </td>
-   <td height="25" valign="middle" title="The name of the <?=$page_type?>">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Title")?></span></b></span></div>
-   </td>
-   <td width="32" height="25" valign="middle" title="The importance of the <?=$page_type?>">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Pri")?></span></b></span></div>
-   </td>
-   <td width="32" height="25" valign="middle" title="The type of task to complete">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Type")?></span></b></span></div>
-   </td>
-   <td width="60" height="25" valign="middle" title="When the <?=$page_type?> was created">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Opened")?></span></b></span></div>
-   </td>
-   <td width="40" height="25" valign="middle" title="Who the <?=$page_type?> belongs to">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Owner")?></span></b></span></div>
-   </td>
-   <td width="60" height="25" valign="middle" title="The location of the <?=$page_type?>">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Bin")?></span></b></span></div>
-   </td>
-   <td width="80" height="25" valign="middle" title="The length of time the <?=$page_type?> has been open">
-   <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Time")?></span></b></span></div>
-   </td>
-   </tr>
-      <?      
+<?
+  // print some table headings
+  $custom_field_list = array(); //store these for later
+  foreach($fields as $f=>$field) {
+    // skip hidden fields
+    if( !$field['is_visible'] ) { continue; }
 
-   $td_ttl = "title='".tr("Click here to view the ?", $page_type)."'";
+    $tf = tr($map->getLabel($view,$f));
+    $sn = in_array($f, $orderby)? "$f DESC" : $f;
+    print "<td width='32' height='25' valign='middle' ";
+    if( getFmFieldProps($view, $f) ) {
+      print "onclick='resortListPage(\"$sn\")' $nav_rollover_eff ";
+    }
+    print " title='".$zen->ffv($tf)."' class='titleCell'><span class='small'>$tf</span></td>\n";
+    
+    // store information about field types
+    if( strpos($f, 'custom_') === 0 && $field['is_visible'] ) {
+      $custom_field_list[] = $f;
+    }
+  }
+  
+  // close the row
+  print "</tr>\n";
+
+  // we will now cache a list of users, if needed, to prevent multiple database
+  // lookups from being performed
+  $user_ids = array();
+  $has_user_ids = array_key_exists('user_id', $fields) && $fields['user_id']['is_visible'];
+  $has_creator_ids = array_key_exists('creator_id', $fields) && $fields['creator_id']['is_visible'];
+  $ticket_ids = array();
+  $custom_fields = array();
+  if( $has_user_ids or $has_creator_ids || count($custom_field_list) ) {
+    foreach($tickets as $t) {
+      if( count($custom_field_list) ) { $ticket_ids[] = $t['id']; }
+      if( $has_user_ids && $t['user_id'] ) { $user_ids[] = $t['user_id']; }
+      if( $has_creator_ids && $t['creator_id'] ) { $user_ids[] = $t['creator_id']; }
+    }
+    
+    // now query for the user ids and map them to keys which we will store
+    // for use while rendering all of the rows
+    if( count($user_ids) ) {
+      $query = "SELECT user_id, initials FROM ".$zen->table_users." WHERE user_id in (".join(',', array_unique($user_ids)).")";
+      $vals = $zen->db_query($query);
+      if( $vals && count($vals) ) {
+        $user_ids = array();
+        foreach($vals as $v) {
+          $user_ids["{$v[0]}"] = $v[1];
+        }
+      }
+      else {
+        // default to no entries
+        $user_ids = array();
+      }
+    }
+    
+    // now query for variable field content as needed
+    if( count($custom_field_list) && count($ticket_ids) ) {
+      $custom_fields = $zen->getVarfieldsForTickets($ticket_ids, $custom_field_list);
+    }
+  }
+
+   $td_ttl = "title='".tr("Click here to view the ?", array($page_type))."'";
    foreach($tickets as $t) {
       $row = $zen->settings["color_background"];
+      
+      // create special url for projects
       if( $zen->inProjectTypeIDs($t["type_id"]) ) {
          $link = $projectUrl;
       } else {
          $link = $ticketUrl;   
       }
       
+      // determine the color of the row based on priority or status
       if( $t["status"] == 'CLOSED' ) {
-        $classxText = "class='bars' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_greytext";
+        $classxText = "class='bars' onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' $rollover_greytext";
       }
       else if( $zen->settings["priority_medium"] ) {
         $classxText = "class='priority{$t['priority']}' "
-         ."onclick='ticketClk(\"{$link}?id={$t['id']}\")' "
+         ."onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' "
          ."onMouseOver='mClassX(this, \"priority{$t['priority']}Over\", true)' "
          ."onMouseOut='mClassX(this, \"priority{$t['priority']}\", false)'";
       }
       else {
-        $classxText = "class='cell' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_text";
+        $classxText = "class='cell' onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' $rollover_text";
       }
-
-      ?>
-   <tr <?=$classxText?>>
-   <td height="25" valign="middle" <?=$td_ttl?>>
-    <a class="rowLink" href="<?=$link?>?id=<?=$t["id"]?>"><?=$t["id"]?></a>
-   </td>
-   <td height="25" valign="middle" <?=$td_ttl?>>
-    <a class="rowLink" href="<?=$link?>?id=<?=$t["id"]?>"><?=$t["title"]?></a>
-   </td>
-   <td height="25" valign="middle">
-   <?=$zen->priorities["$t[priority]"]?>
-   </td>
-   <td height="25" valign="middle">
-   <?=$zen->types["$t[type_id]"]?>
-   </td>
-   <td height="25" valign="middle">
-   <?=($t["otime"])? $zen->showDate($t["otime"]) : "n/a";?>
-   </td>
-   <td width="40" height="25" valign="middle">
-   <? 
-     $user = $zen->get_user($t["user_id"]);
-          if( $user ) {
-        print ($t["user_id"] == $login_id)? 
-          "<b>".$user["initials"]."</b>" :
-          $user["initials"];
-     } else {
-        print "n/a";
-     }
-        ?>
-   </td>
-   <td height="25" valign="middle">
-   <?=$zen->bins["$t[bin_id]"]?>
-   </td>
-   <td height="25" valign="middle" align="right">
-   <?=$zen->showTimeElapsed($t["otime"],$t["ctime"],1,1)?>
-   </td>
-   </tr>       
-   <?
-   }      
-     
+      
+      // render the row properties
+      print "<tr $classxText>\n";
+      
+      // render each field in the row
+      foreach($fields as $f=>$field) {
+        // skip hidden fields
+        if( !$field['is_visible'] ) { continue; }
+        $align = $f == 'elapsed'? 'align="right"' : '';
+        print "<td height='25' valign='middle' $align $td_ttl>";
+        print "<a class='rowLink' href='$link?id={$t['id']}'>";
+        if( $f == 'user_id' || $f == 'creator_id' ) {
+          $uid = $t["$f"];
+          $name = $zen->ffv($user_ids["$uid"], $field['num_cols']);
+          print $name? $name : '&nbsp;';
+        }
+        else if( $f == 'elapsed' ) {
+          print $zen->showTimeElapsed($t["otime"],$t["ctime"],1,1);
+        }
+        else {
+          $value = strpos($f, 'custom_')===0? $custom_fields[$t["id"]][$f] : $t[$f];
+          print $map->getTextValue($view, $f, $value);
+        }
+        print "</a></td>\n";
+      }
+      
+      // close the row
+      print "</tr>";
+   }
+   
+   if( strpos($view, 'search')===0 ) {
+?>
+   <tr>
+       <td colspan="<?= 9+$vfcount ?>" class="titleCell">
+       <nobr>
+       <form method="post" action="search.php" name='searchModifyForm' style="display: inline; margin: 0px;">
+          <input type="submit" class="smallSubmit" value="<?=tr("Modify Search")?>">
+          <input type='hidden' name='TODO' value=''>
+          <input type='hidden' name='newsort' value=''>
+          <input type="hidden" name="search_text" value="<?=$zen->ffv($search_text)?>">
+          <?
+           foreach($search_params as $k=>$v) {
+             print "<input type='hidden' name='search_params[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+           foreach($search_dates as $k=>$v) {
+             print "<input type='hidden' name='search_dates[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+           foreach($search_fields as $k=>$v) {
+             print "<input type='hidden' name='search_fields[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+           ?>
+     </form>
+     <form method="post" action="exportSearch.php" style="display: inline; margin: 0px;">
+          <input type="submit" class="smallSubmit" value="<?=tr("Export Results")?>">
+          <input type="hidden" name="search_text" value="<?=$zen->ffv($search_text)?>">
+          <?
+           foreach($search_params as $k=>$v) {
+             print "<input type='hidden' name='search_params[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+           foreach($search_dates as $k=>$v) {
+             print "<input type='hidden' name='search_dates[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+           foreach($search_fields as $k=>$v) {
+             print "<input type='hidden' name='search_fields[$k]' value='".$zen->ffv($v)."'>\n";
+           }
+         ?>
+        </nobr>
+       </form>
+     </td>
+   </tr>
+<?
+   }
+   
    print "</table>\n";
    
 } else {
diff -Naur zentrack_2-5-0-1/includes/templates/listTickets_workFormat.php zentrack_2-5-5-1/includes/templates/listTickets_workFormat.php
--- zentrack_2-5-0-1/includes/templates/listTickets_workFormat.php	2003-05-22 00:11:25.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/listTickets_workFormat.php	2005-05-01 23:59:37.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   
 if( is_array($tickets) ) {
  
diff -Naur zentrack_2-5-0-1/includes/templates/loginForm zentrack_2-5-5-1/includes/templates/loginForm
--- zentrack_2-5-0-1/includes/templates/loginForm	2003-10-11 09:38:45.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/loginForm	2005-03-11 07:37:38.000000000 -0800
@@ -1,19 +1,38 @@
-
-<blockquote><br>
-  <p>&nbsp;</p>
-  <p><span class="big"><b>Welcome!  Please Log On.</b></span></p>
-  <p><b><i style="color:red">Login and passphrase are case sensitive!</i></b></p>
-  <form method="post" action="<?=$SCRIPT_NAME?><?=($id)? "?id=".strip_tags($id) : ""?>">
-  <input type=text name=username value='<?=strip_tags($zentrackUsername)?>' width=20 maxlength=20>&nbsp;Login Name
-  <br>
-  <input type="password" name="passphrase" width=20 maxlength=20>&nbsp;Password
-  <p>
-  <input type=hidden name=redirect value='<?=strip_tags($redirect)?>'>
-  <input type=submit name=TODO value="Log On">
-  </form>
-</blockquote>
-
-
-
-
-
+
+
+<blockquote><br>
+
+  <p>&nbsp;</p>
+
+  <p><span class="big"><b><?=tr("Welcome!  Please Log On.")?></b></span></p>
+
+  <p><b><i style="color:red"><?tr("Login and passphrase are case sensitive!")?></i></b></p>
+
+  <form method="post" action="<?=$SCRIPT_NAME?><?=($id)? "?id=".strip_tags($id) : ""?>">
+
+  <input type=text name=username value='<?=strip_tags($zentrackUsername)?>' width=20 maxlength=20>&nbsp;<?=tr("Login Name")?>
+
+  <br>
+
+  <input type="password" name="passphrase" width=20 maxlength=20>&nbsp;<?=tr("Password")?>
+
+  <p>
+
+  <input type=hidden name=redirect value='<?=strip_tags($redirect)?>'>
+
+  <input type=submit name=TODO value="<?=tr("Log On")?>">
+
+  </form>
+
+</blockquote>
+
+
+
+
+
+
+
+
+
+
+
diff -Naur zentrack_2-5-0-1/includes/templates/newAgreementForm.php zentrack_2-5-5-1/includes/templates/newAgreementForm.php
--- zentrack_2-5-0-1/includes/templates/newAgreementForm.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/newAgreementForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <script language='javascript' type='text/javascript'>
   function checkMyBox(fieldName, event) {
     if( !event ) { event = window.event; }
@@ -45,7 +46,7 @@
 
 <tr>
   <td class="bars" >
-    <?=tr("Contract ID")?>:
+    <?=tr("Agreement ID")?>:
   </td>
   <td class="bars">
     <input type="text" name="contractnr" size="20" maxlength="25"
@@ -237,4 +238,4 @@
     document.agreementForm.TODO.value = action;
     return true;
   }
-</script>
\ No newline at end of file
+</script>
diff -Naur zentrack_2-5-0-1/includes/templates/newContactForm.php zentrack_2-5-5-1/includes/templates/newContactForm.php
--- zentrack_2-5-0-1/includes/templates/newContactForm.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/newContactForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" name="contactForm" action="<?=($skip)? "editContactSubmit.php" : "$rootUrl/addContactSubmit.php"?>">
 <input type="hidden" name="id" value="<?=strip_tags($id)?>">
@@ -189,4 +190,5 @@
    <input type="submit" value=" <?=($skip)?"Save":"Create"?> " class="submit">
   </td>
 </tr>
-</table>
\ No newline at end of file
+</table>
+</form>
diff -Naur zentrack_2-5-0-1/includes/templates/newContacteForm.php zentrack_2-5-5-1/includes/templates/newContacteForm.php
--- zentrack_2-5-0-1/includes/templates/newContacteForm.php	2004-09-09 16:30:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/newContacteForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <form method="post" name="contactForm" action="<?=($skip)? "editContacteSubmit.php" : "$rootUrl/addContacteSubmit.php"?>">
 <?
@@ -194,3 +195,4 @@
   </td>
 </tr>
 </table>
+</form>
diff -Naur zentrack_2-5-0-1/includes/templates/newProjectForm.php zentrack_2-5-5-1/includes/templates/newProjectForm.php
--- zentrack_2-5-0-1/includes/templates/newProjectForm.php	2004-10-11 16:35:28.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/newProjectForm.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,294 +0,0 @@
-<?	
-  unset($userBins);
-  unset($users);
-  $userBins = $zen->getUsersBins($login_id,"level_create_proj");
-  if( is_array($userBins) && count($userBins) ) {
-    $users = $zen->get_users( $userBins, "level_user" );
-  } else {
-    print "<span class='error'>".
-      tr("You do not have permission to create projects.")
-      ."</span>\n";
-    include("$libDir/footer.php");
-    exit;
-  }
-  $td = ($TODO == 'EDIT');
-  if( !$deadline && !$td )
-     $deadline = $zen->getDefaultValue("default_deadline");
-  if( !$start_date && !$td )
-     $start_date = $zen->getDefaultValue("default_start_date");
-?>     
-
-<form method="post" name="newProjectForm" action="<?=($td)? "editProjectSubmit.php" : "$rootUrl/addProjectSubmit.php"?>">
-<input type="hidden" name="id" value="<?=strip_tags($id)?>">
-  
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
-<tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
-     <?=tr("Enter Project Information")?>
-  </td>
-</tr>
-  
-<tr>
-  <td colspan="2" class="subTitle">
-    <?=tr("Details")?>
-  </td>
-</tr>
-
-  <tr>
-  <td class="bars">
-    <?=tr("Master Project")?>
-  </td>
-  <td class="bars">
-    <select name="project_id">
-    <option value=''>--<?=tr("none")?>--</option>
-    <?
-      $bins = $zen->getUsersBins($login_id);
-      if( is_array($bins) ) {
-	 $params["bin_id"] = $bins;
-	 $params["status"] = "OPEN";
-	 $projects = $zen->get_projects($params,title);
-      } 
-      if( is_array($projects) ) {
-	 foreach($projects as $p) {
-	    $sel = ($p["id"] == $project_id)? " selected" : "";
-	    print "<option value='$p[id]'$sel>".stripslashes($p["title"])."</option>\n";
-	 }
-      }
-    ?>
-    </select>
-  </td>
-</tr>
- 
-<tr>
-  <td class="bars">
-    <?=tr("Title")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="title" size="30" maxlength="255"
-value="<?=strip_tags($title)?>">
-  </td>
-</tr>
-
-<tr>
-  <td class="bars">
-    <?=tr("System")?>
-  </td>
-  <td class="bars">
-    <select name="system_id">
-<?
-    $systems = $zen->getSystems(1);
-    if( is_array($systems) ) {
-    	foreach($systems as $v) {
-	   $k = $v["sid"];
-	   $v = $v["name"];
-	   $check = ( $k == $system_id )? "selected" : "";	   
-	   print "<option $check value='$k'>$v</option>\n";
-	}
-    } else {
-      print "<option value=''>--none--</option>\n";
-    }
-?>
-    </select>
-  </td>
-</tr>
-
-<tr>
-  <td class="bars" width="125">
-    <?=tr("Owner")?>
-  </td>
-  <td class="bars" width="515">
-    <select name="user_id">
-      <option value=''>--<?=tr("none")?>--</option>
-<?
-/*
-    if( is_array($users) ) {
-        foreach($users as $k=>$v) {
-           $check = ( $k == $user_id )? "selected" : "";
-           print "<option $check value='$k'>$v[lname], $v[fname]</option>\n";
-        }
-    }
-*/
-?>
-<?
-   /* PTA : 1/25/2003 5:48 PM CST : Bug 673258
-    * ----------------------------------------
-    * The above logic was assuming that the user_id's were always going to be
-    * sequential as the "key" is just going to 0,1,2...N while the user_ids 
-    * can be out of order if users are deleted from the Admin interface.
-    */
-    if( is_array($users) ) {
-       asort($users);
-       foreach($users as $usr) {
-         $check = ( $usr["user_id"] == $login_id )? "selected" : "";
-         print "<option $check value='";
-         print $usr["user_id"]."'>";
-         print $usr["lname"].", ".$usr["fname"];
-         print "</option>\n";
-       }
-    }
-?>
-
-    </select>&nbsp;(<?=tr("optional")?>)
-  </td>
-</tr>				   
-<tr>
-  <td class="bars">
-    <?=tr("Bin")?>
-  </td>
-  <td class="bars">
-    <select name="bin_id">
-<?
-   if( is_array($userBins) && count($userBins) ) {
-      foreach($zen->getBins(1) as $v) {
-         $k = $v["bid"];
-         
-         if(in_array($k, $userBins)) {
-      	   $check = ( $k == $bin_id || (!$bin_id && !$td && $k == $login_bin) )? "selected" : "";
-            print "<option $check value='$k'>$v[name]</option>";
-         }
-      }
-   } else {
-      print "<option value=''>--".tr("none")."--</option>\n";
-   }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td colspan="2" class="subtitle">
-    <?=tr("Requirements")?>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Priority")?>
-  </td>
-  <td class="bars">
-    <select name="priority">
-<?
-    if( is_array($zen->getPriorities(1)) ) {
-    	foreach($zen->getPriorities(1) as $v) {
-	   $k = $v["pid"];
-	   $v = $v["name"];
-	   $check = ( $k == $priority )? "selected" : "";
-	   print "<option $check value='$k'>$v</option>\n";
-	}
-    } else {
-      print "<option value=''>--no priorities--</option>\n";
-    }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Start Date")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="start_date" size="12" maxlength="10"
-	value="<?=($start_date)?$zen->showDate(strip_tags($start_date)):""?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-	onClick="popUpCalendar(this,document.newProjectForm.start_date, '<?=$zen->popupDateFormat()?>')"
-	alt="Select a Date">
-    &nbsp;(<?=tr("optional")?>)
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Deadline")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="deadline" size="12" maxlength="10"
-value="<?=($deadline)?$zen->showDate(strip_tags($deadline)):""?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-	onClick="popUpCalendar(this,document.newProjectForm.deadline, '<?=$zen->popupDateFormat()?>')"
-	alt="Select a Date">
-    &nbsp;(<?=tr("optional")?>)
-  </td>
-</tr>   
-<tr>
-  <td class="bars">
-    <?=tr("Testing Required")?>
-  </td>
-  <td class="bars">
-  <? if( $td ) { ?>
-    <select name='tested'>
-      <option value='0' <?=$ticket['tested'] == 0? ' selected':''?>><?=tr('n/a')?></option>
-      <option value='1' <?=$ticket['tested'] == 1? ' selected':''?>><?=tr('Required')?></option>
-      <option value='2' <?=$ticket['tested'] == 2? ' selected':''?>><?=tr('Completed')?></option>
-    </select>
-  <? } else { ?>
-    <input type="checkbox" name="tested" value="1" 
-    <?= $zen->getDefaultValue("default_test_checked") ?>>
-  <? } ?>
-  </td>
-</tr>   
-<tr>
-  <td class="bars">
-    <?=tr("Approval Required")?>
-  </td>
-  <td class="bars">
-  <? if( $td ) { ?>
-    <select name='approved'>
-      <option value='0' <?=$ticket['approved'] == 0? ' selected':''?>><?=tr('n/a')?></option>
-      <option value='1' <?=$ticket['approved'] == 1? ' selected':''?>><?=tr('Required')?></option>
-      <option value='2' <?=$ticket['approved'] == 2? ' selected':''?>><?=tr('Completed')?></option>
-    </select>
-  <? } else { ?>
-    <input type="checkbox" name="approved" value="1" 
-    <?= $zen->getDefaultValue("default_aprv_checked") ?>>
-  <? } ?>
-  </td>
-</tr>
-
-<?
- $varfields = $zen->getCustomFields(0,'Project', 'New');
- if( is_array($varfields) && count($varfields) ) {
-?>
-<tr>
-  <td colspan="2" class="subtitle">
-    <?=tr("Other Fields")?>
-  </td>
-</tr>
-<?
-    foreach($varfields as $v) {
-      $k = $v['field_name'];
-      $val = isset($$k)? $$k : $v['field_value'];
-?>
-<tr>
-  <td class="bars">
-   <?=tr($v['field_label'])?>
-  </td>
-  <td class="bars">
-   <?= genVarfield( 'newProjectForm', $v, $val ) ?>
-  </td>
-</tr>
-<?
-   }
- }
-?>
-  
-<tr>
-  <td colspan="2" class="subtitle">
-  <?=tr("Description")?>
-  </td>
-</tr>
-  
-<tr>
-  <td colspan="2">
-    <textarea cols="60" rows="10" name="description"><?= 
-	 ereg_replace("&","&amp;",stripslashes($description)); 
-    ?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($TODO=='EDIT')?tr("save your changes"):tr("create your ticket")?>
-  </td>
-</tr>
-<tr>
-  <td colspan="2" class="bars">
-   <input type="submit" value=" <?=($TODO=='EDIT')?tr("Save"):tr("Create")?> " class="submit">
-  </td>
-</tr>
-</table>
diff -Naur zentrack_2-5-0-1/includes/templates/newTicketForm.php zentrack_2-5-5-1/includes/templates/newTicketForm.php
--- zentrack_2-5-0-1/includes/templates/newTicketForm.php	2004-10-14 11:29:49.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/newTicketForm.php	2005-05-08 13:44:39.000000000 -0700
@@ -1,21 +1,44 @@
 <?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   PREREQUISITES:
+     (ZenFieldMap)$map - contains properties for fields
+     (string)$view - the current view (probably project_create or ticket_create)
+     (string)$page_type - (optional) either 'ticket' or 'project'
+  **/
+
+
   unset($users);
   $td = ($TODO == 'EDIT');
+  
+  // determine what type of page we are looking at and create some useful labels
+  if( !isset($page_type) ) { 
+    $page_type = strpos($view,'project')===0? 'project' : 'ticket'; 
+  }
+  $plural = $page_type == 'project'? 'projects' : 'tickets';
+  $ucfirst = ucfirst($page_type);
+  
+  // calculate the bins which this user can access
   if( $td ) {
     $userBins = $zen->getUsersBins($login_id,"level_edit");  
   }
   else {
-    $userBins = $zen->getUsersBins($login_id,"level_create");
+    $level = $page_type=='project'? 'level_create_proj' : "level_create";
+    $userBins = $zen->getUsersBins($login_id,$level);
+    $id = 0;
+    $creator_id = $login_id;
+    $status = 'OPEN';
   }
-  if( is_array($userBins) && count($userBins) ) {
-    $users = $zen->get_users( $userBins, "level_user" );
-  } else {
+  
+  // blow up if this user does not have proper access to any bins
+  if( !is_array($userBins) || !count($userBins) ) {
     print "<span class='error'>";
     if( $td ) {
-      print tr("You do not have permission to edit tickets.");
+      print tr("You do not have permission to edit ?.", array($plural));
     }
     else {
-      print tr("You do not have permission to create tickets.");
+      print tr("You do not have permission to create ?.", array($plural));
     }
     print "</span>\n";
     include("$libDir/footer.php");
@@ -25,370 +48,107 @@
      $deadline = $zen->getDefaultValue("default_deadline");
   if( !$start_date && !$td )
      $start_date = $zen->getDefaultValue("default_start_date");
-?>     
-
-<form method="post" name="ticketForm" action="<?=($td)? "editTicketSubmit.php" : "$rootUrl/addSubmit.php"?>" onSubmit='return validateTicketForm()'>
-<input type="hidden" name="id" value="<?=strip_tags($id)?>">
-
-  
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
-<tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
-     <?=tr("Ticket Information")?>
-  </td>
-</tr>
-  
-<tr>
-  <td colspan="2" class="subTitle">
-    <?=tr("Details")?>
-  </td>
-</tr>
-  
-<tr>
-  <td class="bars">
-    <?=tr("Project")?>
-  </td>
-  <td class="bars">
-    <select name="project_id">
-    <option value=''>--<?=tr("none")?>--</option>
-    <?
-    $bins = $zen->getUsersBins($login_id);
-    if( is_array($bins) ) {
-      $params = array("bin_id" => $bins, "status" => "OPEN");
-      $projects = $zen->get_projects($params,'title');
-    } 
-    if( is_array($projects) ) {
-      foreach($projects as $p) {
-        $sel = ($p["id"] == $project_id)? " selected" : "";
-        print "<option value='$p[id]'$sel>"
-        .stripslashes($p["title"])."</option>\n";
-      }
+     
+  if( strlen($deadline) ) { $deadline = $zen->showDateTime($deadline); }
+  if( strlen($start_date) ) { $start_date = $zen->showDateTime($start_date); }
+  if( strlen($ctime) ) { $ctime = $zen->showDateTime($ctime); }
+  if( strlen($otime) && $td ) { $otime = $zen->showDateTime($otime); }
+  if( !$td ) { $otime = time(); }
+     
+  //$view = $td? 'ticket_edit' : 'ticket_create';
+  $fields = $map->listFieldsForView($view);
+  $hidden_fields = array();
+  $visible_fields = array();
+  $sections = array();
+  foreach($fields as $f) {
+    $field = $map->getFieldFromMap($view,$f);
+    if( !$field['is_visible'] ) { $hidden_fields[] = $f; }
+    else { 
+      $visible_fields[] = $f;
+      if( $field['field_type'] == 'section' ) { $sections[] = $f; }
     }
-    ?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Title")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="title" size="30" maxlength="255"
-      value="<?=strip_tags($title)?>">
-  </td>
-</tr>            
+  }
   
-<tr>
-  <td class="bars">
-    <?=tr("Type")?>
-  </td>
-  <td class="bars">
-    <select name="type_id">
-<?
-    if( is_array($zen->types) ) {
-      foreach($zen->getTypes(1) as $v) {
-     $k = $v["type_id"];
-     if( $k != $zen->projectTypeID() ) {
-        // does not allow projects to be created here
-        // user must use the "new project" link for this
-        // task
-        $check = ( $k == $type_id )? "selected" : "";
-        print "<option $check value='$k'>$v[name]</option>\n";
-     }
+  // calculate the destination of our form results
+  if( $td ) {
+    $formDest = $page_type == 'project'? 'editProjectSubmit.php' : 'editTicketSubmit.php';
+  }
+  else {
+    $formDest = $page_type == 'project'? 'addProjectSubmit.php' : 'addSubmit.php';
   }
-    } else {
-      print "<option value=''>--".tr("none")."--</option>\n";
-    }
 ?>
-    </select>
-  </td>
-</tr>
+<form method="post" name="ticketForm" action="<?=$formDest?>" onSubmit='return validateTicketForm()'>
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
 <tr>
-  <td class="bars">
-    <?=tr("System")?>
-  </td>
-  <td class="bars">
-    <select name="system_id">
-<?
-    $systems = $zen->getSystems(1);
-    if( is_array($systems) ) {
-      foreach($systems as $v) {
-	$k = $v["sid"];
-	$v = $v["name"];
-	$sel = ( $k == $system_id )? " selected" : "";     
-	print "<option value='$k'$sel>$v</option>\n";
-      }
-    } else {
-      print "<option value=''>--".tr("none")."--</option>\n";
-    }
-?>
-    </select>
+  <td colspan="2" width="640" class="titleCell" align="center">
+     <?=tr("$ucfirst Information")?>
   </td>
 </tr>
-<tr>
-  <td class="bars" width="125">
-    <?=tr("Owner")?>
-  </td>
-  <td class="bars" width="515">
-    <select name="user_id">
-      <option value=''>--<?=tr("n/a")?>--</option>
 <?
-   if( is_array($users) && $zen->settings["allow_assign"] == "on" ) {
-     foreach($users as $v) {
-       $check = ( $v["user_id"] == $user_id )? "selected" : "";
-       print "<option $check value='$v[user_id]'>".$zen->formatName($v,1)
-  ."</option>\n";
-     }
-   }
-?>
-    </select>&nbsp;(optional)
-  </td>
-</tr>          
-<tr>
-  <td class="bars">
-    <?=tr("Bin")?>
-  </td>
-  <td class="bars">
-    <select name="bin_id">
-<?
-   if( is_array($userBins) && count($userBins) ) {
-      foreach($zen->getBins(1) as $v) {
-         $k = $v["bid"];
-         
-         if(in_array($k, $userBins)) {
-            $check = ($k == $bin_id || (!$bin_id && !$td && $k == $login_bin))? "selected" : "";
-            print "<option $check value='$k'>$v[name]</option>";
-         }
-      }
-   } else {
-      print "<option value=''>--".tr("none")."--</option>\n";
-   }
-?>
-    </select>
-  </td>
-</tr>          
-<tr>
-  <td class="bars">
-    <?=tr("Related Tickets")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="relations" size="20" maxlength="255"
-value="<?=strip_tags($relations)?>">
-    &nbsp;<input type='button' class='searchbox' value=' ... ' 
-	onClick='popupWindowScrolls("<?=$rootUrl?>/helpers/ticketSearchbox.php?return_form=ticketForm&return_field=relations","popupHelper",375,500)'>
-
-  <br>(<?=tr("Enter multiple ids, separated by a comma")?>)
-  </td>
-</tr>          
+foreach($hidden_fields as $f) {
+  //$view, $form_name, $field_name, $value = null, $prefix = ''
+  print $map->renderTicketField($view, 'ticketForm', $f, $$f);
+}
 
-<tr>
-  <td colspan="2" class="subtitle">
-    <?=tr("Requirements")?>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Priority")?>
-  </td>
-  <td class="bars">
-    <select name="priority">
-<?
-    if( is_array($zen->priorities) ) {
-      foreach($zen->getPriorities(1) as $v) {
-     $k = $v["pid"];
-     $v = $v["name"];
-     $check = ( $k == $priority )? "selected" : "";
-     print "<option $check value='$k'>$v</option>\n";
+foreach($visible_fields as $f) {
+  if( in_array($f, $sections) ) {
+    print "<tr><td colspan='2' class='subTitle'>";
+    print $map->renderTicketField($view, 'ticketForm', $f);
+    print "</td></tr>\n";
   }
-    } else {
-      print "<option value=''>--".tr("none")."--</option>\n";
+  else {
+    print "<tr><td class='bars'>";
+    print $map->getLabel($view, $f);
+    print "</td><td class='bars'>";
+    if( $td && $page_type == 'project' && $f == 'type_id' ) {
+      // do not allow type to be edited for projects
+      print $map->getTextValue($view, $f, $$f);
     }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Start Date")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="start_date" size="12" maxlength="10"
-value="<?=($start_date)?$zen->showDate(strip_tags($start_date)):""?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-  onClick="popUpCalendar(this,document.ticketForm.start_date, '<?=$zen->popupDateFormat()?>')"
-  alt="Select a Date">
-    &nbsp;(<?=tr("optional")?>)
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Estimated Hours to Complete")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="est_hours" size="12" maxlength="10"
-value="<?=strip_tags($est_hours)?>">&nbsp;(<?=tr("up to two decimal places, optional")?>)
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Deadline")?>
-  </td>
-  <td class="bars">
-    <input type="text" name="deadline" size="12" maxlength="10"
-value="<?=($deadline)?$zen->showDate(strip_tags($deadline)):""?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-  onClick="popUpCalendar(this, document.ticketForm.deadline, '<?=$zen->popupDateFormat()?>')"
-  alt="Select a Date">
-    &nbsp;(<?=tr("optional")?>)
-  </td>
-</tr>          
-
-<tr>
-  <td class="bars">
-    <?=tr("Testing Required")?>
-  </td>
-  <td class="bars">
-  <? if( $td ) { ?>
-    <select name='tested'>
-      <option value='0' <?=$ticket['tested'] == 0? ' selected':''?>><?=tr('n/a')?></option>
-      <option value='1' <?=$ticket['tested'] == 1? ' selected':''?>><?=tr('Required')?></option>
-      <option value='2' <?=$ticket['tested'] == 2? ' selected':''?>><?=tr('Completed')?></option>
-    </select>
-  <? } else { ?>
-    <input type="checkbox" name="tested" value="1" 
-    <?= $zen->getDefaultValue("default_test_checked") ?>>
-  <? } ?>
-  </td>
-</tr>   
-<tr>
-  <td class="bars">
-    <?=tr("Approval Required")?>
-  </td>
-  <td class="bars">
-  <? if( $td ) { ?>
-    <select name='approved'>
-      <option value='0' <?=$ticket['approved'] == 0? ' selected':''?>><?=tr('n/a')?></option>
-      <option value='1' <?=$ticket['approved'] == 1? ' selected':''?>><?=tr('Required')?></option>
-      <option value='2' <?=$ticket['approved'] == 2? ' selected':''?>><?=tr('Completed')?></option>
-    </select>
-  <? } else { ?>
-    <input type="checkbox" name="approved" value="1" 
-    <?= $zen->getDefaultValue("default_aprv_checked") ?>>
-  <? } ?>
-  </td>
-</tr>
+    else {
+      print $map->renderTicketField($view, 'ticketForm', $f, $$f);
+    }
+    print "</td></tr>\n";
+  }
+}
 
-<?
- $varfields = $zen->getCustomFields(0,'Ticket', 'New');
- if( is_array($varfields) && count($varfields) ) {
 ?>
 <tr>
-  <td colspan="2" class="subtitle">
-    <?=tr($zen->settings['varfield_tab_name'])." ".tr("Fields")?>
+  <td class="titleCell" colspan="2" align="center">
+  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your $page_type")?>.
   </td>
 </tr>
 <?
-    foreach($varfields as $v) {
-      $k = $v['field_name'];
-      $type = getVarfieldDataType($v['field_name']);
-      $val = isset($$k)? $$k : $type == 'menu'? '' : $v['field_value'];
+  if ($td && $zen->settings['edit_reason_required']=='on' && $zen->settings['log_edit']=='on') {
+    $er_vals=array('field_cols'   => '60',
+                   'field_rows'   => '5',
+                   'field_name'   => 'edit_reason',
+                   'field_events' => '',
+                   'field_value'  => '');
+    $er_template=new zenTemplate("$templateDir/fields/textarea.template");
+    $er_template->values($er_vals);
 ?>
 <tr>
   <td class="bars">
-   <?=tr($v['field_label'])?>
+    <?=tr("Edit Reason")?><br>
+    (<?=tr("Mandatory")?>)
   </td>
   <td class="bars">
-   <?= genVarfield( 'ticketForm', $v, $val ) ?>
-  </td>
-</tr>
 <?
-   }
- }
+    print $er_template->process();
 ?>
-
- 
-<tr>
-  <td colspan="2" class="subtitle">
-    <?=tr("Description")?>
-  </td>
-</tr>
-  
-<tr>
-  <td colspan="2">
-    <textarea cols="60" rows="10" name="description"><?= 
-   ereg_replace("&","&amp;",stripslashes($description)); 
-    ?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your ticket")?>.
   </td>
 </tr>
+<?
+  }
+?>
 <tr>
   <td colspan="2" class="bars">
    <input type="submit" value=" <?=tr(($td)?"Save":"Create")?> " class="submit">
   </td>
 </tr>
 </table>
+</form>
 
-<script language='Javascript' type='text/javascript'>
-
- function validateTicketForm() {
-   var errs = new Array();
-   if( !document.ticketForm.title.value ) {
-     errs[ errs.length ] = "<?=tr("? is required",array( tr("Title") ))?>";
-   }
-   
 <?
-$varfields = $zen->getCustomFields(0,'Ticket', 'New');
-if( is_array($varfields) && count($varfields) ) {
-  foreach($varfields as $v) {
-    $k = $v['field_name'];
-    $l = $v['field_label'];
-    if( $v['js_validation'] ) {
-      print preg_replace('/\{form\}/', 'document.ticketForm', $v['js_validation']);
-    }
-    else {
-      $f = "document.ticketForm.{$k}";
-      $e = 'errs[ errs.length ]';
-      switch( getVarfieldDataType($k) ) {
-        case "menu":
-        // if the value of the menu selection is '', then
-        // the required status is significant
-        if( $v['is_required'] ) {
-          print "if( {$f}.options[ {$f}.selectedIndex ].value == '' )"
-          . " { {$e} = '{$l} is required'; }\n";
-        }
-        case "boolean":
-        // no validation for checkboxes
-        break;
-        case "number":
-        // make sure it is a valid number
-        print "if( {$f}.value.match( /[^0-9.]/ ) ) { {$e} = '"
-        .tr('? is not a valid number',array(tr($l)))."'; }\n";
-        default:
-        // nothing to do for dates or strings, just
-        // check the required status
-        // numbers fall through to here also
-        if( $v['is_required'] ) {
-          print "if( !{$f}.value ) { {$e} = '"
-          .tr('? is required',array(tr($l)))."'; }\n";
-        }
-      }
-    }
-  }
-}
+  include_once("$libDir/templates/validateTicketForm.php");
 ?>
-   if( errs.length > 0 ) {
-     var str = "<?=tr("Please correct the following errors:")?>\n----------\n";
-     for( var i=0; i < errs.length; i++ ) {
-       str += errs[i]+"\n";
-     }
-     alert(str);
-     return false;
-   }
-   return true;
- }
-
-</script>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/optionsMenu.php zentrack_2-5-5-1/includes/templates/optionsMenu.php
--- zentrack_2-5-0-1/includes/templates/optionsMenu.php	2004-09-27 22:24:16.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/optionsMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <br>
 <ul>
@@ -13,7 +14,7 @@
 </ul>
 
 <? 
-  if( $page_tile == tr("Change Password") ) {
+  if( $page_title == tr("Change Password") ) {
     $link = "<a href='$helpUrl/tutorial.php'>".tr('Tutorial')."</a>";
     print "<p><span class='error'>";
     print tr("If this is your first time logging in, please read the ?!", array($link));
diff -Naur zentrack_2-5-0-1/includes/templates/projectView.php zentrack_2-5-5-1/includes/templates/projectView.php
--- zentrack_2-5-0-1/includes/templates/projectView.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/projectView.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /*
   **  PROJECT VIEW
   **
diff -Naur zentrack_2-5-0-1/includes/templates/pwcForm.php zentrack_2-5-5-1/includes/templates/pwcForm.php
--- zentrack_2-5-0-1/includes/templates/pwcForm.php	2003-05-22 00:11:25.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/pwcForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   $user = $zen->getUser($login_id);
   if( $user["passphrase"] == $zen->encval($user["lname"]) ) {
     print "<p class='hot'>".tr("Your passphrase is currently set to the system default.  Please change it.")."</p>\n";
diff -Naur zentrack_2-5-0-1/includes/templates/referencedGroupForm.php zentrack_2-5-5-1/includes/templates/referencedGroupForm.php
--- zentrack_2-5-0-1/includes/templates/referencedGroupForm.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/referencedGroupForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -0,0 +1,80 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+         $elnk="$rootUrl/admin/deleteGroup.php";
+?>
+      <br>
+      <p><b><?=tr("The data group ? is currently being used.",array($group_id))?></b></p>
+      <p class='error'><?
+         $str = "<a href='$rootUrl/help/find.php?s=admin&p=data_groups'>".tr('Documentation')."</a>";
+         print tr("Please refer to the ? before using this feature", array($str));
+       ?></p>      
+      <ul>
+      <form name='referencedGroupForm' action='<?=$elnk?>' method='post'>
+      <input type='hidden' name='TODO' value=''>
+      <input type='hidden' name='group_id' value='<?=$group_id?>'>
+      <table cellpadding="4" cellspacing="1" class='cell'>
+	 <tr>
+	 <td class='titleCell' align='center' colspan='2'>
+	   <b><?=tr("Choose what to do before data group deletion")?></b>
+	 </td>
+	 </tr>
+	 <tr>
+           <td class='bars' align='left'>
+             <b><?=tr("Disable all varfields and behaviors that are currently using this data group.")?></b>
+             <br><b><?=tr("After that, delete the data group.")?></b>
+           </td>
+           <td class='bars' align='center'>
+             <input type='submit' class='submit' value='<?=tr('Disable')?>' onClick="return setTodo('DISABLE')">
+           </td>
+	 </tr>
+<?
+  if( isset($_SESSION['data_groups']) && count($_SESSION['data_groups']) > 1 )  {
+?>
+	 <tr>
+           <td class='bars' align='left'>
+             <b><?=tr("Move all of it's references to")?></b>
+             <select name='new_data_group'>
+<?
+           $sel_item=" selected";
+           foreach( $_SESSION['data_groups'] as $g ) {
+             if ( $g['group_id'] != $group_id ) { 
+               print "<option value='{$g['group_id']}'$sel_item>{$g['group_name']}</option>\n";
+               $sel_item="";
+             }
+           }
+?>
+             </select>
+             <br><b><?=tr("After that, delete the data group.")?></b>
+           </td>
+           <td class='bars' align='center'>
+             <input type='submit' class='submit' value='<?=tr('Move')?>' onClick="return setTodo('MOVE')">
+           </td>
+	 </tr>
+<?
+  }
+?>    
+
+	 <tr>
+           <td class='bars' align='left'>
+             <b><?=tr("Cancel the request. DO NOT delete the data group.")?></b>
+           </td>
+           <td class='bars' align='center'>
+             <input type='submit' class='submit' value='<?=tr('Cancel')?>' onClick="return setTodo('CANCEL')">
+           </td>
+	 </tr>
+
+
+      </table>
+      </ul>
+
+      </form>
+
+
+      <script language='javascript'>
+          function setTodo( val ) {
+           document.referencedGroupForm.TODO.value = val;
+         }
+      </script>
+                                                                                                                             
+
diff -Naur zentrack_2-5-0-1/includes/templates/reportMenu.php zentrack_2-5-5-1/includes/templates/reportMenu.php
--- zentrack_2-5-0-1/includes/templates/reportMenu.php	2004-02-27 03:37:46.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width='300'>
 <tr>
   <td class='titleCell' align='center'><?=tr("View Reports")?></td>
diff -Naur zentrack_2-5-0-1/includes/templates/reportsDataMenu.php zentrack_2-5-5-1/includes/templates/reportsDataMenu.php
--- zentrack_2-5-0-1/includes/templates/reportsDataMenu.php	2003-03-23 23:25:02.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsDataMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <!-- DATA MENU -->
 
 <?
diff -Naur zentrack_2-5-0-1/includes/templates/reportsDateMenu.php zentrack_2-5-5-1/includes/templates/reportsDateMenu.php
--- zentrack_2-5-0-1/includes/templates/reportsDateMenu.php	2003-03-23 23:25:02.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsDateMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <!-- DATE MENU -->
 <?
   // validate data
diff -Naur zentrack_2-5-0-1/includes/templates/reportsMenu.php zentrack_2-5-5-1/includes/templates/reportsMenu.php
--- zentrack_2-5-0-1/includes/templates/reportsMenu.php	2003-03-23 23:25:02.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
 
diff -Naur zentrack_2-5-0-1/includes/templates/reportsOptionsMenu.php zentrack_2-5-5-1/includes/templates/reportsOptionsMenu.php
--- zentrack_2-5-0-1/includes/templates/reportsOptionsMenu.php	2003-03-23 23:25:02.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsOptionsMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <!-- OPTIONS MENU -->
 <?
   // validation
diff -Naur zentrack_2-5-0-1/includes/templates/reportsSubmit.php zentrack_2-5-5-1/includes/templates/reportsSubmit.php
--- zentrack_2-5-0-1/includes/templates/reportsSubmit.php	2003-03-23 23:25:03.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsSubmit.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <!-- SUBMIT MENU -->
 <tr>
   <td class='<?=($tf_options)? "titleCell" : "subTitle" ?>' colspan='3'>
diff -Naur zentrack_2-5-0-1/includes/templates/reportsTasks.php zentrack_2-5-5-1/includes/templates/reportsTasks.php
--- zentrack_2-5-0-1/includes/templates/reportsTasks.php	2003-01-03 22:11:49.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsTasks.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 Form for detailed input of report parameters:
 
diff -Naur zentrack_2-5-0-1/includes/templates/reportsTypeMenu.php zentrack_2-5-5-1/includes/templates/reportsTypeMenu.php
--- zentrack_2-5-0-1/includes/templates/reportsTypeMenu.php	2003-03-23 23:25:03.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/reportsTypeMenu.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // set a toggle
   if( $report_type )
      $report_type = $zen->checkAlphaNum($report_type,"_ ");
diff -Naur zentrack_2-5-0-1/includes/templates/searchContact2List.php zentrack_2-5-5-1/includes/templates/searchContact2List.php
--- zentrack_2-5-0-1/includes/templates/searchContact2List.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContact2List.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 if( is_array($tickets) && count($tickets) ) {
  
    $link = $zen->settings["url_view_ticket"];   
diff -Naur zentrack_2-5-0-1/includes/templates/searchContact3List.php zentrack_2-5-5-1/includes/templates/searchContact3List.php
--- zentrack_2-5-0-1/includes/templates/searchContact3List.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContact3List.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 if( is_array($tickets) && count($tickets) ) {
  
    $link = $zen->settings["url_view_ticket"];   
diff -Naur zentrack_2-5-0-1/includes/templates/searchContact4List.php zentrack_2-5-5-1/includes/templates/searchContact4List.php
--- zentrack_2-5-0-1/includes/templates/searchContact4List.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContact4List.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 if( is_array($tickets) && count($tickets) ) {
  
    $link = $zen->settings["url_view_ticket"];   
diff -Naur zentrack_2-5-0-1/includes/templates/searchContactForm.php zentrack_2-5-5-1/includes/templates/searchContactForm.php
--- zentrack_2-5-0-1/includes/templates/searchContactForm.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContactForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 
 <form action="<?=($SCRIPT_NAME)?>" name="searchCompany">
@@ -14,7 +15,7 @@
 	</td>
 	<td class="bars">
 		<input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
 	</td>
   <td class="bars">
      <input type="submit" class="submit" value="<?=tr("Search")?>">
@@ -38,7 +39,7 @@
 	</td>
 	<td class="bars">
 		<input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
 	</td>
   <td class="bars">
      <input type="submit" class="submit" value="<?=tr("Search")?>">
@@ -62,7 +63,7 @@
 	</td>
 	<td class="bars">
 		<input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
 	</td>
   <td class="bars">
      <input type="submit" class="submit" value="<?=tr("Search")?>">
@@ -86,7 +87,7 @@
 	</td>
 	<td class="bars">
 		<input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
 	</td>
   <td class="bars">
      <input type="submit" class="submit" value="<?=tr("Search")?>">
diff -Naur zentrack_2-5-0-1/includes/templates/searchContactList.php zentrack_2-5-5-1/includes/templates/searchContactList.php
--- zentrack_2-5-0-1/includes/templates/searchContactList.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContactList.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 if( is_array($tickets) && count($tickets) ) {
  
    $link = $zen->settings["url_view_ticket"];   
diff -Naur zentrack_2-5-0-1/includes/templates/searchContactResults.php zentrack_2-5-5-1/includes/templates/searchContactResults.php
--- zentrack_2-5-0-1/includes/templates/searchContactResults.php	2004-09-02 09:40:51.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchContactResults.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <?{
 	
diff -Naur zentrack_2-5-0-1/includes/templates/searchForm.php zentrack_2-5-5-1/includes/templates/searchForm.php
--- zentrack_2-5-0-1/includes/templates/searchForm.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,8 +1,39 @@
 <?
-  include("{$libDir}/prepareSearchVarfields.php");
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   PREREQUISITES:
+     (ZenFieldMap)$map - contains properties for fields
+     (string)$view - the current view (probably project_list or ticket_list)
+  **/  
+  
+  $view = 'search_form';
+  $fields = $map->getFieldMap($view);
+  $text_fields = array();
+  $other_fields = array();
+  $hidden_fields = array();
+  $date_fields = array();
+  foreach($fields as $f=>$field) {
+    if( $field['field_type'] == 'hidden' ) {
+      $hidden_fields[$f] = $field;
+    }
+    else if( !$field['is_visible'] ) { continue; }
+    
+    if( $field['field_type'] == 'text' || $field['field_type'] == 'textarea' ) {
+      $text_fields[$f] = $field; }
+    else if( $field['field_type'] == 'date' ) {
+      $date_fields[$f] = $field;
+    }
+    else { $other_fields[$f] = $field; }
+  }
 ?>
-<form action="<?=$SCRIPT_NAME?>" name="searchForm">
+<form action="<?=$SCRIPT_NAME?>" name="searchForm" method='POST'>
 <input type="hidden" name="TODO" value="SEARCH">
+<?
+foreach($hidden_fields as $f=>$field) {
+  $map->renderTicketField($view, 'searchForm', $f, $$f);
+}
+?>
   
 <table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
 <tr>
@@ -11,9 +42,12 @@
   </td>
 </tr>
 
+<?
+if( count($text_fields) ) {
+?>
 <tr>
   <td colspan="2" class="subTitle">
-    <?=tr("By Text Match")?>
+    <?=tr("Containing Text")?>
   </td>
 </tr>
 <tr>
@@ -22,7 +56,7 @@
   </td>
   <td class="bars">
    <input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
   </td>
 </tr>
 <tr>
@@ -30,316 +64,76 @@
      <?=tr("In any of these")?>
   </td>
   <td class="bars">
-  <?
-   $sft = ((is_array($search_fields) && in_array("title",$search_fields)) 
-	     || 
-           !is_array($search_fields));
-   //   $sfd = (is_array($search_fields) && in_array("description",$search_fields));
-   //default checked
-   $sfd = ((is_array($search_fields) && in_array("description",$search_fields))
-	    || !is_array($search_fields)); 
-  ?>
-  <input type="checkbox" name="search_fields[title]" value="title"<?=($sft)?" checked":""?>>
-   &nbsp;<?=tr("Title")?>
-  <br>
-  <input type="checkbox" name="search_fields[description]" value="description"<?=($sfd)?" checked":""?>>
-   &nbsp;<?=tr("Description")?>
-  <?
-   foreach($varfieldsText as $key=>$label) {
-     $sel = $search_fields[$key]? ' checked' : '';
-  ?>
-     <br>
-     <input type="checkbox" 
-            name="search_fields[<?=$key?>]" 
-            value="<?=$key?>"
-            <?=$sel?>>
-      &nbsp;<?=tr($label)?>
-  <?
-   }
-  ?>
-  </td>
-</tr>
-
-
-<?  
-//#####################################################
-// between date field
-//#####################################################
-?>
-<tr>
-  <td colspan="2" class="subTitle">
-    <?=tr("By Date")?>
-  </td>
-</tr>
-
-<tr>
-  <td class="bars">
-    <?=tr("Opened")?>
-  </td>
-  <td class="bars">
-    <span class='note'><?= tr("between") ?>
-    <input type="text" name="otime_begin" size="12" maxlength="10" 
-      value="<?
-        if (!empty($search_dates['otime_begin'])) {
-          echo $zen->showDate($search_dates['otime_begin']);
-        }?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-  onClick="popUpCalendar(this,document.searchForm.otime_begin, '<?=$zen->popupDateFormat()?>')"
-  alt="Select a Date">
-    &nbsp;<?=tr("and")?>&nbsp;
-    <input type="text" name="otime_end" size="12" maxlength="10"
-      value="<?= empty($search_dates['otime_end'])? "+1 day" : $zen->showDate($search_dates['otime_end']) ?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-      onClick="popUpCalendar(this,document.searchForm.otime_end, '<?=$zen->popupDateFormat()?>')"
-      alt="Select a Date">
-    </span>
-  </td>
-</tr>
-
-<tr>
-  <td class="bars">
-    <?=tr("Closed")?>
-  </td>
-  <td class="bars">
-    <span class='note'><?= tr("between") ?>
-    <input type="text" name="ctime_begin" size="12" maxlength="10" 
-      value="<?
-        if (!empty($search_dates['ctime_begin'])) {
-          echo $zen->showDate($search_dates['ctime_begin']);
-        }?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-  onClick="popUpCalendar(this,document.searchForm.ctime_begin, '<?=$zen->popupDateFormat()?>')"
-  alt="Select a Date">
-    &nbsp;<?=tr("and")?>&nbsp;
-    <input type="text" name="ctime_end" size="12" maxlength="10"
-      value="<?= empty($search_dates['ctime_end'])? "+1 day" : $zen->showDate($search_dates['ctime_end']) ?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-      onClick="popUpCalendar(this,document.searchForm.ctime_end, '<?=$zen->popupDateFormat()?>')"
-      alt="Select a Date">
-    </span>
-  </td>
-</tr>
-
+    <table><tr><td valign='top'>
 <?
-//#####################################################
-// variable field dates
-//#####################################################
-    foreach( $varfieldsDates as $key=>$label ) {
-     $keyb = "{$key}_begin";
-     $keye = "{$key}_end";
+  $c = 0;
+  if( !is_array($search_fields) ) 
+      { $search_fields = array('title'=>1,'description'=>1); }
+    foreach($text_fields as $t=>$field) {
+      if( $c > 0 && !$switch) { print "<br>"; }
+      $switch = false;
+      $checked = is_array($search_fields) && array_key_exists($t, $search_fields) && $search_fields["$t"] > 0? " checked" : "";
+      print "<input type='checkbox' name='search_fields[$t]' value='1'$checked>&nbsp;".$map->getLabel($view, $t)."\n";
+      if( count($text_fields) > 3 && ++$c == ceil(count($text_fields)/2) ) {
+        $switch = true;
+        print "</td><td valign='top'>\n";
+      }
+    }
+}
 ?>
-<tr>
-  <td class="bars">
-    <?=tr("$label")?>
-  </td>
-  <td class="bars">
-    <span class='note'><?= tr("between") ?>
-    <input type="text" name="dates_<?=$keyb?>" size="12" maxlength="10" 
-      value="<?
-        if (!empty($search_dates[$keyb])) {
-          echo $zen->showDate($search_dates[$keyb]);
-        }?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-        onClick="popUpCalendar(this,document.searchForm.dates_<?=$keyb?>, '<?=$zen->popupDateFormat()?>')"
-        title="Select a Date">
-    &nbsp;<?=tr("and")?>&nbsp;
-    <input type="text" name="dates_<?=$keye?>" size="12" maxlength="10"
-      value="<?= empty($search_dates[$keye])? "+1 day" : $zen->showDate($search_dates[$keye]) ?>">
-    <img name="date_button" src='<?=$rootUrl?>/images/cal.gif' 
-      onClick="popUpCalendar(this,document.searchForm.dates_<?=$keye?>, '<?=$zen->popupDateFormat()?>')"
-      title="Select a Date">
-    </span>
+    </td></tr></table>
   </td>
 </tr>
 <?
-   }
-?>
 
-<?
-//#####################################################
-// Parameter Fields
-//#####################################################
+if( count($date_fields) ) {
 ?>
-
 <tr>
   <td colspan="2" class="subTitle">
-    <?=tr("By Parameters")?>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-     <?=tr("Status")?>
-  </td>
-  <td class="bars">
-     <select name="search_params[status]">
-      <option value=''>----</option>
-      <option value='OPEN'  
-         <?=($search_params["status"] == 'OPEN')? " selected" : ""?>
-         >Open</option>
-      <option value='PENDING'  
-         <?=($search_params["status"] == 'PENDING')? " selected" : ""?>
-         >Pending</option>
-      <option value='CLOSED'  
-         <?=($search_params["status"] == 'CLOSED')? " selected" : ""?>
-         >Closed</option>  
-     </select>
+    <?=tr("Date Matches")?>
   </td>
 </tr>
-<tr>
-  <td class="bars">
-     <?=tr("Owner")?>
-  </td>
-  <td class="bars">
-     <select name="search_params[user_id]">
-       <option value="">----</option>
 <?
-   $userBins = $zen->getUsersBins($login_id);
-   if( is_array($userBins) && $zen->settings["allow_assign"] == "on" ) {
-     $users = $zen->get_users($userBins,'level_view');
-     if( is_array($users) ) {
-       asort($users);
-       foreach($users as $k=>$v) {
-	 $check = ( $search_params["user_id"] && $v["user_id"] == $search_params["user_id"] )? 
-	   "selected" : "";
-	 print "<option $check value='$v[user_id]'>$v[lname], $v[fname]</option>\n";
-       }
-     }
-   }
-?>
-     </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Type")?>
-  </td>
-  <td class="bars">
-    <select name="search_params[type_id]">
-       <option value="">----</option>
-<?
-   if( is_array($zen->types) ) {
-     foreach($zen->getTypes(1) as $v) {
-       $k = $v["type_id"];
-       $check = ( $search_params["type_id"] && $k == $search_params["type_id"] )? 
-       "selected" : "";
-       print "<option $check value='$k'>$v[name]</option>\n";
-     }
-   } else {
-     print "<option value=''>--no types--</option>\n";
-   }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("System")?>
-  </td>
-  <td class="bars">
-    <select name="search_params[system_id]">
-       <option value="">----</option>
-<?
-  if( is_array($zen->systems) ) {
-    foreach($zen->systems as $k=>$v) {
-      $check = ( $k == $search_params["system_id"] )? "selected" : "";	   
-      print "<option $check value='$k'>$v</option>\n";
-    }
-  } else {
-    print "<option value=''>--no systems--</option>\n";
+  foreach( $date_fields as $f=>$field ) {
+      print "<tr><td class='bars'>";
+      print $map->getLabel($view, $f);
+      print "</td><td class='bars'>";
+      print "<span class='note'>between ";
+      $name = "{$f}_begin";
+      print $map->renderTicketField($view, 'searchForm', $f, $search_params["$name"], "search_params[$name]");
+      print " and ";
+      $name = "{$f}_end";
+      print $map->renderTicketField($view, 'searchForm', $f, $search_params["$name"], "search_params[$name]");
+      print "</span>";
+      print "</td></tr>\n";
   }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Bin")?>
-  </td>
-  <td class="bars">
-    <select name="search_params[bin_id]">
-       <option value="">----</option>
-<?
-  if( is_array($userBins) ) {
-    foreach($zen->getBins(1) as $v) {
-      $k = $v["bid"];      
-      if (in_array($k, $userBins)) {
-        $check = ( $k == $search_params["bin_id"] )? " selected" : "";
-        print "<option $check value='$k' $check>$v[name]</option>";
-      }
-    }
-  } else {
-    print "<option value=''>--no bins--</option>\n";
-  }
-?>
-    </select>
-  </td>
-</tr>
-<tr>
-  <td class="bars">
-    <?=tr("Priority")?>
-  </td>
-  <td class="bars">
-    <select name="search_params[priority]">
-       <option value="">----</option>
-<?
-  if( is_array($zen->priorities) ) {
-    foreach($zen->getPriorities(1) as $v) {
-      $k = $v["pid"];
-      $v = $v["name"];
-      $check = ( $k == $search_params["priority"] )? "selected" : "";
-      print "<option $check value='$k'>$v</option>\n";
-    }
-  } else {
-    print "<option value=''>--no priorities--</option>\n";
-  }
-?>
-    </select>&nbsp;<span class='small'><?=tr("(or higher)")?></span>
-  </td>
-</tr>
+}
 
-<?
-  foreach( $varfieldsParms as $key=>$val ) {
+
+if( count($other_fields) ) {
 ?>
 <tr>
-  <td class='bars'>
-   <?=tr($val['field_label'])?>
-  </td>
-  <td class='bars'>
-<?
-  $type = getVarfieldDataType($key);
-  if( $type == 'menu' ) {
-    print "    <select name='search_params[{$key}]'>\n";
-    print "        <option value=''>---</option>\n";
-    foreach( genDataGroupChoices($val['field_value'], false) as $v ) {
-      $t = $v['label'];
-      $k = $v['field_value'];
-      $sel = $k == $search_params[$key]? ' selected' : '';
-      print "      <option value='$k'$sel>$t</option>\n";
-    }
-    print "    </select>\n";
-  }
-  else if( $type == 'boolean' ) {
-?>
-    <select name='search_params[<?=$key?>]'>
-      <option value=''>---</option>
-      <option value='1'>True</option> 
-      <option value='0'>False</option>
-    </select> 
-<?
-  }
-  else {
-    $zen->addDebug('searchForm', "Invalid parm type: $type, ignoring", 1);
-  }
-?> 
+  <td colspan="2" class="subTitle">
+    <?=tr("Other Fields")?>
   </td>
 </tr>
 <?
+  
+  foreach( $other_fields as $f=>$field ) {
+    print "<tr><td class='bars'>";
+    print $map->getLabel($view,$f);
+    print "</td><td class='bars'>";
+    print $map->renderTicketField($view, 'searchForm', $f, $search_params["$f"], "search_params[$f]");
+    if( $f == 'priority' ) {
+      print "&nbsp;<input type='checkbox' name='or_higher' checked value='1'> or higher";
+    }
+    print "</td></tr>\n";
   }
+}
 ?>
-
 <tr>
   <td colspan="2" class="subTitle">
-	<?=tr("Click 'Search' to execute the search")?>
+	<?=tr("Click 'Search' to find results")?>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-0-1/includes/templates/searchList.php zentrack_2-5-5-1/includes/templates/searchList.php
--- zentrack_2-5-0-1/includes/templates/searchList.php	2004-10-12 22:49:08.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchList.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,452 +0,0 @@
-<?  
-$cf = $zen->getCustomFields(1,"","S");
-
-$vfcount = 0;
-foreach($cf as $k=>$v) {
-  if( includeVarfield($k) ) { $vfcount++; }
-}
-
-function includeVarfield($name) {
-  global $search_fields;
-  global $search_params;
-  global $search_dates;
-
-  $type = getVarfieldDataType($name);
-  switch($type) {
-   case "text":
-     return false;
-   case "date":
-     return $search_dates["{$key}_begin"]? false : true;
-   case "boolean":
-   case "menu":
-     return $search_params[$key]? false : true;
-   default:
-     return $search_fields[$name]? true : false;
-  }
-}
-
-if( is_array($tickets) && count($tickets) ) {
- 
-   $link = $zen->settings["url_view_ticket"];   
-   $c = count($tickets);
-   $TODO = "SEARCH";
-   
-?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
-<tr><td class='titleCell' colspan="<?=9+$vfcount ?>" align='center'><?=($c>1)? tr("? Matches",array($c)) : tr("1 Match");?></td></tr>
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
-<?
-
-//#####################################################
-//Id asc desc box begin
-//#####################################################
-
-?> 
-<td<?=$nav_rollover_text?> width="32" height="25" valign="middle" title="<?=tr("ID of the ticket")?>">
-<?
-if ($orderby == "id asc") {
-	$image = "/asc_order.gif";
-	$i = "id desc";
-} elseif($orderby == "id desc") {
-	$image = "/desc_order.gif";
-	$i = "id asc";
-} else {
-	$image = "";
-	$i = "id asc";
-}
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<?
-
-//#####################################################
-//title asc desc box begin
-//#####################################################
-
-?>   
-<td<?=$nav_rollover_text?> height="25" valign="middle" title="<?=tr("The name of the ticket")?>">
-<?
-   if ($orderby == "title asc") {
-	   $i = "title desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "title desc") {
-	   $i = "title asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "title asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<?
-
-//#####################################################
-//custom fields asc desc box begin
-//#####################################################
-
-foreach($cf as $k=>$v) {
-  if( includeVarfield($k) ) {
-?>
-    <td<?=$nav_rollover_text?> width="32" height="25" valign="middle" title="<?=tr("$v")?>">
-    <?
-       if ($orderby == "$k asc") {
-	 $i = "$k desc";
-	 $image = "/desc_order.gif";
-       } else if($orderby == "$k desc") {
-	 $i = "$k asc";
-	 $image = "/asc_order.gif";
-       } else {
-	 $image = "";
-	 $i = "$k asc";
-       }
-    ?>
-    <A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-    <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr(substr($v,0,15))?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-    </A>
-    </td>
-    <? 
-  } 
-}
-
-//#####################################################
-//priority asc desc box begin
-//#####################################################
-
-if( !$search_params["priority"] || is_array($search_params["priority"]) ) { ?>
-<td<?=$nav_rollover_text?> width="32" height="25" valign="middle" title="<?=tr("The importance of the ticket")?>">
-<?
-   if ($orderby == "priority asc") {
-	   $i = "priority desc";
-	   $image = "/desc_order.gif";
-   } elseif($orderby == "priority desc") {
-	   $i = "priority asc";
-	   $image = "/asc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "priority asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Pri")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<? } 
-
-//#####################################################
-//status asc desc box begin
-//#####################################################
-
-if( !$search_params["status"] || is_array($search_params["status"]) ) { ?>
-<td<?=$nav_rollover_text?> width="50" height="25" valign="middle" title="<?=tr("Current status of the ticket")?>">
-<?
-   if ($orderby == "status asc") {
-	   $i = "status desc";
-	   $image = "/desc_order.gif";
-   } elseif($orderby == "status desc") {
-	   $i = "status asc";
-	   $image = "/asc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "status desc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Status")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<? } 
-
-//#####################################################
-//user_id asc desc box begin
-//#####################################################
-
-if( !$search_params["user_id"] || is_array($search_params["user_id"]) ) { ?>
-<td<?=$nav_rollover_text?> width="50" height="25" valign="middle" title="<?=tr("Person ticket is assigned to")?>">
-<?
-   if ($orderby == "user_id asc") {
-	   $i = "user_id desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "user_id desc") {
-	   $i = "user_id asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "user_id asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">     
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Owner")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<? }
-
-//#####################################################
-//type_id asc desc box begin
-//#####################################################
-
-if( !$search_params["type_id"] || is_array($search_params["type_id"]) ) { ?>
-<td<?=$nav_rollover_text?> width="32" height="25" valign="middle" title="<?=tr("Type of ticket")?>">
-<?
-   if ($orderby == "type_id asc") {
-	   $i = "type_id desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "type_id desc") {
-	   $i = "type_id asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "type_id asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Type")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<?}
-
-//#####################################################
-//system_id asc desc box begin
-//#####################################################
-
-if( !$search_params["system_id"] || is_array($search_params["system_id"]) ) { ?>
-<td<?=$nav_rollover_text?> width="50" height="25" valign="middle" title="<?=tr("System involved in ticket")?>">
-<?
-   if ($orderby == "system_id asc") {
-	   $i = "system_id desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "system_id desc") {
-	   $i = "system_id asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "system_id asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("System")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<?}
- 
-//#####################################################
-//bin_id asc desc box begin
-//#####################################################
-
-if( !$search_params["bin_id"] || is_array($search_params["bin_id"]) ) { ?>
-<td<?=$nav_rollover_text?> width="50" height="25" valign="middle" title="<?=tr("Bin ticket is located in")?>">
-<?
-   if ($orderby == "bin_id asc") {
-	   $i = "bin_id desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "bin_id desc") {
-	   $i = "bin_id asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "bin_id asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Bin")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-<?}
- 
-//#####################################################
-//start_date asc desc box begin
-//#####################################################
-     
-?>
-<td<?=$nav_rollover_text?> width="32" height="25" valign="middle" title="<?=tr("Date of ticket")?>">
-<?
-   if ($orderby == "start_date asc") {
-	   $i = "start_date desc";
-	   $image = "/asc_order.gif";
-   } elseif($orderby == "start_date desc") {
-	   $i = "start_date asc";
-	   $image = "/desc_order.gif";
-   } else {
-	  $image = "";
-	  $i = "start_date asc";
-   }
-?>
-<A class='menuLink' HREF="<?=$zen->create_link($SCRIPT_NAME,$TODO,$i,$search_text,$search_fields,$search_params)?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Date")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
-</A>
-</td>
-</tr>
-<?      
-   $td_ttl = "title='Click here to view the $page_type.'";
-   foreach($tickets as $t) {
-      $row = $zen->settings["color_background"];
-      if( $zen->inProjectTypeIDs($t["type_id"]) ) {
-         $link = $projectUrl;
-      } else {
-         $link = $ticketUrl;   
-      }
-      
-      if( $t["status"] == 'CLOSED' ) {
-        $classxText = "class='bars' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_greytext";
-      }
-      else if( $zen->settings["priority_medium"] ) {
-        $classxText = "class='priority{$t['priority']}' "
-         ."onclick='ticketClk(\"{$link}?id={$t['id']}\")' "
-         ."onMouseOver='mClassX(this, \"priority{$t['priority']}Over\", true)' "
-         ."onMouseOut='mClassX(this, \"priority{$t['priority']}\", false)'";
-      }
-      else {
-        $classxText = "class='cell' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_text";
-      }
-      
-      if( $search_text && $search_fields["title"] ) {
-          $t["title"] = $zen->highlight($t["title"],$search_text);
-      }
-      
-      ?>
-
-   <tr <?=$classxText?>>
-      <td height="25" valign="middle" <?=$td_ttl?>>
-        <a class="rowLink" href="<?=$link?>?id=<?=$t["id"]?>"><?=$t["id"]?></a>
-      </td>
-      
-      <td height="25" valign="middle" <?=$td_ttl?>>
-        <a class="rowLink" href="<?=$link?>?id=<?=$t["id"]?>"><?=$t["title"]?></a>
-      </td>
-    
-    <?
-    foreach($cf as $k=>$v) {
-      if ( includeVarfield($k) ) {
-        $v = strlen($v) > 25? substr($v, 0, 22)."..." : $v;
-        $v = $t[$k];
-        if( $search_fields[$k] ) {	  
-          $v = $zen->highlight($v, $search_text);
-        }
-        if( !$v ) { $v = '&nbsp;'; }
-        print "<td height='25' {$tx} valign='middle'>$v</td>\n";
-      } 
-    } 
-?>
-
-    <? if( !$search_params["priority"] || is_array($search_params["priority"]) ) { ?>
-      <td height="25" <?=$tx?> valign="middle">
-         <?=$zen->priorities["$t[priority]"]?>
-      </td>
-    <? } ?>
-    <? if( !$search_params["status"] || is_array($search_params["status"]) ) { ?>
-      <td height="25" valign="middle">
-         <?=$t["status"]?>
-      </td>
-    <? } ?>
-    <? if( !$search_params["user_id"] || is_array($search_params["user_id"]) ) { ?>
-      <td height="25" valign="middle">
-         <?=$zen->formatName($t["user_id"],2)?>
-      </td>
-    <? } ?>
-    <? if( !$search_params["type_id"] || is_array($search_params["type_id"]) ) { ?>
-       <td height="25" valign="middle">
-         <?=$zen->types["$t[type_id]"]?>
-       </td>
-    <? } ?>
-    <? if( !$search_params["system_id"] || is_array($search_params["system_id"]) ) { ?>
-       <td height="25" valign="middle">
-          <?=$zen->systems["$t[system_id]"]?>
-       </td>
-    <? } ?>
-    <? if( !$search_params["bin_id"] || is_array($search_params["bin_id"]) ) { ?>
-       <td height="25" valign="middle">
-          <?=$zen->bins["$t[bin_id]"]?>
-       </td>
-    <? } 
-    //#####################################################
-    //date field 
-    //#####################################################
-    ?>
-       <td height="25" valign="middle">
-          <?=$zen->showDate($t[otime])?>
-       </td>
-   </tr>       
-   
-   <? if( $search_text && $search_fields["description"] 
-	  && $t["description"] && !(strpos($t['description'],$search_text)===false) ) { ?>
-   <tr <?=$classxText?>>
-     <td colspan='2' align='right'><span class='tiny'><?=tr("Description")?></span></td>										 
-     <td height="25" colspan="<?=7+$vfcount ?>">   
-       <?
-       $t["description"] = str_replace("<br />", "<br>", $t["description"]);
-       $parts = explode("<br>", $t["description"]);
-       unset($pt);
-       for($i=0; $i<count($parts); $i++) {
-	 $p = stripslashes($parts[$i]);
-	 if( !(strpos($p, $search_text)===false) ) {
-               $pt .= ($pt)? "<br>\n" : "";
-               $pt .= $zen->highlight($p,$search_text);
-           }
-       }
-       print $pt;
-       ?>
-     </td>
-
-   <? 
-    } 
-
-    // print out any text fields which were searched
-    foreach($cf as $k=>$v) {
-      if( !includeVarfield($k) && !(strpos($k,'custom_text')===false)
-	  && !(strpos($t[$k], $search_text)===false) ) {
-	if( $search_text && $search_fields[$k] && $t[$k] ) {
-?>
-   <tr <?=$classxText?>>
-     <td colspan='2' align='right'><span class='tiny'><?=tr($v)?></span></td>										 
-     <td height="25" colspan="<?=7+$vfcount ?>">   
-       <?
-       $t[$k] = str_replace("<br />", "<br>", $t[$k]);
-       $parts = explode("<br>", $t[$k]);
-       $pt = "";
-       for($i=0; $i<count($parts); $i++) {
-	 $p = stripslashes($parts[$i]);
-	 if( !(strpos($p, $search_text) === false) ) {
-	   $pt .= ($pt)? "<br>\n" : "";
-	   $pt .= $zen->highlight($p,$search_text);
-	 }
-       }
-       print $pt;
-       ?>
-     </td>
-<?	  
-	}
-      }
-    }
-
-    print "</tr>\n";
-
-   }  // End forech ticket loop
-   ?>
-
-   <tr>
-     <form method="post" action="<?=$SCRIPT_NAME?>">
-       <td colspan="<?= 9+$vfcount ?>" class="titleCell">
-          <input type="submit" class="smallSubmit" value="<?=tr("Modify Search")?>">
-          <input type="hidden" name="search_text" value="<?=$zen->ffv($search_text)?>">
-          <?
-           foreach($search_params as $k=>$v) {
-             print "<input type='hidden' name='search_params[$k]' value='".$zen->ffv($v)."'>\n";
-           }
-           foreach($search_dates as $k=>$v) {
-	     print "<input type='hidden' name='search_dates[$k]' value='".$zen->ffv($v)."'>\n";
-	   }
-	   foreach($search_fields as $k=>$v) {
-	     print "<input type='hidden' name='search_fields[$k]' value='".$zen->ffv($v)."'>\n";
-	   }
-           ?>
-       </td>
-     </form>
-   </tr>
-  </table>
-<?  
-}
-?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/templates/searchLogForm.php zentrack_2-5-5-1/includes/templates/searchLogForm.php
--- zentrack_2-5-0-1/includes/templates/searchLogForm.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchLogForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // create a default date
   if( !$search_date )
     $search_date = 0;
@@ -29,7 +31,7 @@
   </td>
   <td class="bars">
    <input type="text" name="search_text" 
-      value="<?=htmlentities($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
   </td>
 </tr>
 
diff -Naur zentrack_2-5-0-1/includes/templates/searchLogList.php zentrack_2-5-5-1/includes/templates/searchLogList.php
--- zentrack_2-5-0-1/includes/templates/searchLogList.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchLogList.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 if( is_array($logs) && count($logs) ) {
   
@@ -90,7 +92,7 @@
       <td height="25" colspan="8" <?=$td_ttl?> <?=$txt?>>
       <a class="rowLink" href='<?=$link?>?id=<?=$t["ticket_id"]?>&setmode=log'>
       <?
-      $t["entry"] = htmlentities($t["entry"]);
+      $t["entry"] = $zen->ffv($t["entry"]);
       $parts = explode("\n",$t["entry"]);
       if( $search_text ) {
         unset($pt);
@@ -132,4 +134,4 @@
   <?   
 }
 
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/includes/templates/searchLogResults.php zentrack_2-5-5-1/includes/templates/searchLogResults.php
--- zentrack_2-5-0-1/includes/templates/searchLogResults.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchLogResults.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?{
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   // integrity
   $params = array();
diff -Naur zentrack_2-5-0-1/includes/templates/searchResults.php zentrack_2-5-5-1/includes/templates/searchResults.php
--- zentrack_2-5-0-1/includes/templates/searchResults.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/searchResults.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,6 +1,13 @@
 <?{
-  // set up search parms
-  include("{$libDir}/prepareSearchVarfields.php");
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  
+  include("$libDir/sorting.php");
+  
+  function searchResultsMaxPri( $a, $b ) {
+    if( $a > $b ) { return $a; }
+    return $b;
+  }
   
   // integrity
   $params = array();
@@ -10,100 +17,103 @@
   //organize the date
   //#####################################################
   
-  //opened date
   $search_dates = array();
-  if (!empty($otime_begin)){
-    $d1 = $zen->dateParse($otime_begin);
-    $params[] = array("otime", ">=", $d1, 1);
-    if (!empty($otime_end)){
-      $d2 = $zen->dateParse($otime_end);
-      $params[] = array("otime", "<=", $d2+86400, 1);
-    }
-    else {
-      $d2 = $d1;
-      $params[] = array("otime", "<=", $d2+86400, 1);
-    }
-    $search_dates['otime_begin'] = $d1;
-    $search_dates['otime_end'] = $d2;
-  }
-  $otime_begin = null;
-  $otime_end = null;
-  
-  //closed date
-  if (!empty($ctime_begin)){
-    $d1 = $zen->dateParse($ctime_begin);
-    $params[] = array("ctime", ">=", $d1, 1);
-    if (!empty($ctime_end)){
-      $d2 = $zen->dateParse($ctime_end);
-      $params[] = array("ctime", "<=", $d2+86400, 1);
-    }
-    else {
-      $d2 = $d1;
-      $params[] = array("ctime", "<=", $d2+86400, 1);
-    }
-    $search_dates['ctime_begin'] = $d1;
-    $search_dates['ctime_end'] = $d2;
-  }
-  $ctime_begin = null;
-  $ctime_end = null;
-  
-  // custom dates
-  foreach( $varfieldsDates as $k=>$v ) {
-    $kb = "{$k}_begin";
-    $rb = "custom_$kb";
-    $ke = "{$k}_end";
-    $re = "custom_$ke";
-    if( !empty($$rb) ) {
-      $d1 = $zen->dateParse($$rb);
-      $params[] = array($k, ">=", $d1, 1);
-      if (!empty($$re)){
-        $d2 = $zen->dateParse($$re);
-        $params[] = array($k, "<=", $d2+86400, 1);
-      }
-      else {
-        $d2 = $d1;
-        $params[] = array($k, "<=", $d2+86400, 1);
-      }
-    }
-    $search_dates[$kb] = $d1;
-    $search_dates[$ke] = $d2;
-  }
-  
-  //#####################################################
-  //orderby checkin
-  //#####################################################
-  if ($orderby == "") {
-    $orderby="status DESC, priority DESC";
-  }
-  
+  $view = 'search_form';
+    
   // determine which bins user can view
   $userBins = $zen->getUsersBins($login_id);
   
   // organize the search params
   if( is_array($search_params) ) {
     foreach($search_params as $k=>$v) {
-      if( strlen($v) ) {
-        $type = getVarfieldDataType($k);
-        if( $type == 'boolean' ) {
-          $params[] = array($k, ($v? "=":"!="), 1, 1);
+      if( !strlen($v) || is_array($v) && count($v) == 0 ) { continue; }
+      if( is_array($v) && count($v) == 1 && !strlen($v[0]) ) { continue; }
+      
+      $props = getFmFieldProps($view, $k);
+      if( !$props && preg_match('/^([a-zA-Z0-9_]+)_(begin|end)$/', $k, $matches) ) {
+        $props = getFmFieldProps($view, $matches[1]);
+      }
+      $type = $props['data_type'];
+      $zen->addDebug('searchResults.php', "Including search_param[$k] ($type)", 3);
+      if( $type == 'boolean' && $field['num_rows'] == 1 ) {
+        $params[] = array($k, ($v? "=":"!="), 1, 1);
+        continue;
+      }
+      else if( $type == 'date' ) {
+        // we process on the _begin dates, so skip _end
+        if( strpos($k, '_end') > 0 ) { continue; }
+        
+        // determine the field name, sans the begin/end suffix
+        $base = substr($k, 0, -6);
+
+        // calculate the name of the end field
+        $re = "{$base}_end";
+
+        // check for bugs in the form contents... dates must all have an
+        // _begin and _end field
+        if( !preg_match('/_begin$/', $k) ) {
+          $zen->addDebug('searchResults.php', "$k is a date, must have a {$k}_begin and {$k}_end", 1);
+          continue;
         }
-        else {
-          switch($k) {
-            case "priority":
-            $params[] = array($zen->table_tickets.".$k","<=",$v,1);
+        
+        // convert the user's string to a date integer
+        $d1 = $zen->dateParse($v);
+        // add to the search parms
+        $params[] = array($base, ">=", $d1, 1);
+        
+        if( empty($search_params["$re"]) ) { 
+          $zen->addDebug('searchResults.php', "$re not found, defaulting to $d1+86400", 3);
+          $d2 = strtotime("+1 year", $d1); 
+        }
+        else { $d2 = $zen->dateParse($search_params["$re"]); }
+        $params[] = array($base, "<=", $d2, 1);
+
+        $search_dates[$k] = $d1;
+        $search_dates[$re] = $d2;
+      }
+      else {
+        $field = $map->getFieldFromMap($view, $k);
+        $op = '=';
+        if( $field['field_type'] == 'searchbox' ) {
+          $v = split(' *, *', $v);
+          $op = 'IN';
+        }
+        else if( is_array($v) ) {
+          $op = 'IN';
+        }
+        switch($k) {
+          case "priority":
+            if( $or_higher ) {
+              if( is_array($v) ) {
+                $v = array_reduce($v, "searchResultsMaxPri");
+              }
+              $params[] = array($zen->table_tickets.".$k",'<=',$v,1);
+            }
+            else {
+              $params[] = array($zen->table_tickets.".$k",$op,$v,1);
+            }
             break;
-            case "bin_id":
-            if( in_array($v, $userBins) ) {
+          case "bin_id":
+            if( is_array($v) ) {
+              $ok = true;
+              foreach($v as $val) {
+                if( !in_array($val, $userBins) ) {
+                  $ok = false;
+                  break;
+                }
+              }
+              $params[] = array($k, 'IN', $v, 1);
+            }
+            else if( in_array($v, $userBins) ) {
               $params[] = array($k, '=', $v, 1);
             }
             else {
               $errs[] = tr('You do not have permission to search this bin'); 
             }
+            break;  
+          default:
+            $params[] = array($k, $op, $v, 1);
             break;
-            default: 
-            $params[] = array($k, "=", $v, 1);
-            break;
-          }
         }
       }
     }
@@ -115,8 +125,9 @@
   if( $search_text && is_array($search_fields) && count($search_fields)>0 ) {
     unset($sp);
     foreach($search_fields as $k=>$f) {
+      $zen->addDebug("searchResults.php", "Adding text search for $k", 3);
       $c = !(strpos($k, 'custom_text')===false && strpos($k,'description') === false);
-      $sp[] = array($f,"contains",$search_text, $c);
+      $sp[] = array($k,"contains",$search_text, $c);
     }
     $params[] = (count($sp)>1)? array("OR",$sp) : $sp[0];
   }
@@ -146,7 +157,8 @@
     }
     $zen->addDebug("searchResults.php-params[]",join("|",$dp),3);
     
-    $tickets = $zen->search_tickets($params, "AND", "0", $orderby);//"status DESC, priority DESC"
+    $limit = $nolimit? 0 : false;
+    $tickets = $zen->search_tickets($params, "AND", "0", join(',',$orderby), $limit);//"status DESC, priority DESC"
   }
   
-}?>
\ No newline at end of file
+}?>
diff -Naur zentrack_2-5-0-1/includes/templates/ticketView.php zentrack_2-5-5-1/includes/templates/ticketView.php
--- zentrack_2-5-0-1/includes/templates/ticketView.php	2003-03-06 00:29:54.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/ticketView.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   /*
   **  TICKET VIEW
   **
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_actionBar.php zentrack_2-5-5-1/includes/templates/ticket_actionBar.php
--- zentrack_2-5-0-1/includes/templates/ticket_actionBar.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_actionBar.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 
 <!-- BEGIN ACTION BAR -->
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_attachmentsBox.php zentrack_2-5-5-1/includes/templates/ticket_attachmentsBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_attachmentsBox.php	2003-03-23 23:25:04.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/ticket_attachmentsBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
    $rollover_text = " onclick=\"mClk(this);\" "
       ."onmouseout=\"mOut(this,'".$zen->settings["color_background"]."', '');\" "
       ."onmouseover=\"mOvr(this,'".$zen->settings["color_bars"]."', '');\"";
@@ -67,7 +69,7 @@
      }    
      print "</table>\n";
   } else {
-     print tr("No attachments exist for this $page_type");
+     print tr("No attachments exist for this ?", array($page_type));
   }
 ?>
     </td>
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_box.php zentrack_2-5-5-1/includes/templates/ticket_box.php
--- zentrack_2-5-0-1/includes/templates/ticket_box.php	2004-09-03 08:40:06.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_box.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width="645" cellpadding="0" cellspacing="0" border="0">
 <tr> 
   <td valign="bottom"><?
@@ -77,10 +78,9 @@
     // tr("Related"); tr("Notify"); tr("Tasks");
     $txt = (isset($counts[$key]) && $counts[$key])?
       $t." (".$counts["$key"].")" : $t;
-    $link = ($key == 'system')? $SCRIPT_NAME : $pageUrl;
     $w = ($key == "attachments")? 85 : 60;
     print "<td class='$class' height='$height_num' width='$w'>";
-    print "<a href='$link?id=$id&setmode=$key' class='$lclass'>$txt</a></td>\n";
+    print "<a href='$pageUrl?id=$id&setmode=$key' class='$lclass'>$txt</a></td>\n";
     if( $i < count($tabs) ) {
       print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
     }
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_contactsBox.php zentrack_2-5-5-1/includes/templates/ticket_contactsBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_contactsBox.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_contactsBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   // security measure
   if( $login_level < $zen->settings['level_contacts'] ) {
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_customBox.php zentrack_2-5-5-1/includes/templates/ticket_customBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_customBox.php	2004-08-24 01:47:59.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_customBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <? 
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 if( $TODO == 'SAVED' ) {
   $zen->print_errors($errs); 
   if( $save_message ) {
@@ -15,11 +17,16 @@
 ?>
   <table width="600" align="center" cellpadding="2" cellspacing="2">
 <?
+  $sfd=$zen->getBehaviorDestinationFieldsArray();
   $cfd=$zen->getCustomFields(0,$page_type,"C");
   $rc = 0;
   if( $editMode ) { 
     foreach($cfd as $f) {
       $k = $f['field_name'];
+      $l = $f['field_label'];
+      if ( isset($sfd["$l"]) ) {
+        unset($sfd["$l"]);
+      }
       $v = $varfields["$k"];
       if( $v == 'NULL' ) { $v = ''; }
 ?>
@@ -30,7 +37,26 @@
     </td>
   </tr>
 <?   
-     }
+    }
+    foreach($sfd as $k=>$f) {
+      $v = isset($ticket["$f"])? $ticket["$f"] : ( isset($varfields["$f"]) ? $varfields["$f"] : NULL );
+      if( $v == 'NULL' ) { $v = ''; }
+      //If it is a date field it has to be formatted
+      switch ($f) {
+        case "ctime":
+        case "deadline":
+        case "otime":
+        case "start_date":
+          if( $v == 0 ) { $v = ""; }
+          if( strlen($v) && preg_match("/^[0-9]+$/", $v) ) {
+            $v = $zen->showDateTime($v);
+          }
+          break;
+      }
+?>
+         <input type="hidden" name="<?=$f?>" value="<?=strip_tags($v)?>">
+<?
+    }
   } 
   else {
     foreach($cfd as $f) {
@@ -76,35 +102,35 @@
       $k = $v['field_name'];
       $l = $v['field_label'];
       if( $v['js_validation'] ) {
-	print preg_replace('/\{form\}/', 'document.ticket_customForm', $v['js_validation']);
+	      print preg_replace('/\{form\}/', 'document.ticket_customForm', $v['js_validation']);
       }
       else {
-	$f = "document.ticket_customForm.{$k}";
-	$e = 'errs[ errs.length ]';
-	switch( getVarfieldDataType($k) ) {
-	case "menu":
-	  // if the value of the menu selection is '', then
-	  // the required status is significant
-	  if( $v['is_required'] ) {
-	    print "if( {$f}.options[ {$f}.selectedIndex ].value == '' )"
-	      . " { {$e} = '{$l} is required'; }\n";
-	  }
-	case "boolean":
-	  // no validation for checkboxes
-	  break;
-	case "number":
-	  // make sure it is a valid number
-	  print "if( {$f}.value.match( /[^0-9.]/ ) ) { {$e} = '"
-	    .tr('? is not a valid number',array(tr($l)))."'; }\n";
-	default:
-	  // nothing to do for dates or strings, just
-	  // check the required status
-	  // numbers fall through to here also
-	  if( $v['is_required'] ) {
-	    print "if( !{$f}.value ) { {$e} = '"
-	      .tr('? is required',array(tr($l)))."'; }\n";
-	  }
-	}
+        $f = "document.ticket_customForm.{$k}";
+        $e = 'errs[ errs.length ]';
+        switch( getVarfieldDataType($k) ) {
+          case "menu":
+            // if the value of the menu selection is '', then
+            // the required status is significant
+            if( $v['is_required'] ) {
+              print "if( {$f}.options[ {$f}.selectedIndex ].value == '' )"
+                . " { {$e} = '{$l} is required'; }\n";
+            }
+          case "boolean":
+            // no validation for checkboxes
+            break;
+          case "number":
+            // make sure it is a valid number
+            print "if( {$f}.value.match( /[^0-9.]/ ) ) { {$e} = '"
+              .tr('? is not a valid number',array(tr($l)))."'; }\n";
+          default:
+            // nothing to do for dates or strings, just
+            // check the required status
+            // numbers fall through to here also
+            if( $v['is_required'] ) {
+              print "if( !{$f}.value ) { {$e} = '"
+                .tr('? is required',array(tr($l)))."'; }\n";
+            }
+        }
       }
    }
  }
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_detailsBox.php zentrack_2-5-5-1/includes/templates/ticket_detailsBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_detailsBox.php	2004-08-09 01:10:05.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_detailsBox.php	2005-05-08 13:44:39.000000000 -0700
@@ -1,3 +1,17 @@
+<? 
+  /**
+   * This displays the details tab within the ticket view.
+   *
+   * Requirements:
+   *   ZenTrack $zen - zenTrack class and utils
+   *   ZenFieldMap $map - an instance of $ZenFieldMap used to obtain list of fields
+   *   String $view - a view as defined in ZenFieldMap.class, used to obtain fields and properties
+   *   int $project_id - [optional] if defined, represents the project this ticket belongs to
+   *   mixed [various] - ticket fields from ZENTRACK_TICKETS are provided to this page as $column_name
+   */
+   
+   if( !ZT_DEFINED ) { die("Illegal Access"); } 
+?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
@@ -7,8 +21,8 @@
     <td colspan="3" class='titleCell'><?=uptr("Project")?></td>
    <? } else { ?>
     <td colspan="3" rowspan="2"><span class="bigBold"><?=
-	strtoupper($zen->systems["$system_id"]." ".$zen->types["$type_id"]);
-	?></span></td>
+    strtoupper($zen->systems["$system_id"]." ".$zen->types["$type_id"]);
+    ?></span></td>
    <? } ?>
     <td width="30">&nbsp;</td>
     <td class="smallTitleCell"><?=uptr("Start Date")?></td>
@@ -18,10 +32,10 @@
     <td colspan='3' <?=$rollover_text?>><a 
 	href='<?=$rootUrl?>/project.php?id=<?=$project_id?>' 
 	class='rowLink'><?=$project_id?> -  
-    	<?=stripslashes($project["title"])?></a></td>
+    	<?=$zen->ffv($project["title"])?></a></td>
     <? } ?>
     <td class='altCellInv'>&nbsp;</td>
-    <td class='altCellInv'><?=($start_date)?$zen->showDate($start_date):"n/a"?></td>  
+    <td class='altCellInv'><?=($start_date)?$zen->showDateTime($start_date):"n/a"?></td>  
   </tr>
   <? if( $project_id ) { ?>
   <tr>
@@ -41,31 +55,31 @@
     <td><?=($system_id)?$zen->systems["$system_id"]:tr("n/a")?></td>
     <td>&nbsp;</td>  
     <?
-         $set = ($page_browser == 'ns')? 
-            "  ".uptr("Set")."  " : str_pad(uptr("Set"),18," ",STR_PAD_RIGHT);
-         if( $type_id == $zen->projectTypeID() ) {
+    $set = ($page_browser == 'ns')? 
+    "  ".uptr("Set")."  " : str_pad(uptr("Set"),18," ",STR_PAD_RIGHT);
+    if( $type_id == $zen->projectTypeID() ) {
 	    list($est_hours,$wkd_hours) = $zen->getProjectHours($id);
 	    if( $est_hours <= 0 )
-	      $est_hours = tr("n/a");
+      $est_hours = tr("n/a");
 	    print "<td>$est_hours</td>\n";
-	 } else if($est_hours > 0) {
-            print "<td>$est_hours</td>\n";
-	 } else if( $user_id == $login_id ) {
+    } else if($est_hours > 0) {
+      print "<td>$est_hours</td>\n";
+    } else if( $user_id == $login_id ) {
 	    echo('
-		 <form method="post" action="'.$rootUrl.'/actions/estimate.php">
+      <form method="post" action="'.$rootUrl.'/actions/estimate.php">
 		  <input type="hidden" name="id" value="'.$id.'">
 		  <td><input type="submit" class="actionButton" value="'.$set.'"></td>
-	         </form>');
-	 } else {
+      </form>');
+    } else {
 	    echo('
-		 <form method="post" action="'.$rootUrl.'/actions/estimate.php">
+      <form method="post" action="'.$rootUrl.'/actions/estimate.php">
 		  <input type="hidden" name="id" value="'.$id.'">
 		  <td><input type="button" class="actionButton"
-		     style="color:'.$zen->settings["color_alt_background"].'"
-                     value="'.$set.'"></td>
-	         </form>');
-	 }
-        ?>
+      style="color:'.$zen->settings["color_alt_background"].'"
+      value="'.$set.'"></td>
+      </form>');
+    }
+    ?>
   </tr>
   <tr>
     <td class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Closed")?></td>
@@ -75,29 +89,29 @@
     <td class="smallTitleCell"><?=uptr("Hours Worked")?></td>  
   </tr>
    <tr>
-    <td><?=($ctime)?$zen->showDate($ctime):tr("n/a")?></td>    
+    <td><?=($ctime)?$zen->showDateTime($ctime):tr("n/a")?></td>    
     <td><? 
       switch($tested){
         case 1: 
-	 print "<b>".tr("required")."</b>";
-	 break; 
-	case 2:
-	 print tr("completed");
-	 break; 
-	default:
-	 print tr("n/a");
+         print "<b>".tr("required")."</b>";
+         break; 
+        case 2:
+         print tr("completed");
+         break; 
+        default:
+         print tr("n/a");
       } 
      ?></td>
     <td><? 
       switch($approved){
         case 1: 
-	 print "<b>".tr("required")."</b>";
-	 break; 
-	case 2:
-	 print tr("completed");
-	 break; 
-	default:
-	 print tr("n/a");
+         print "<b>".tr("required")."</b>";
+         break; 
+        case 2:
+         print tr("completed");
+         break; 
+        default:
+         print tr("n/a");
       } 
      ?></td>  
     <td>&nbsp;</td>    
@@ -118,13 +132,16 @@
     $varfield_type=ereg_replace("[^a-z_]", "", $k);
     switch($varfield_type) {
       case "custom_number":
-        $cfv = strlen($varfields["$k"])? $varfields["$k"] : 'n/a';
+        $cfv = strlen($varfields["$k"])? $varfields["$k"] : '&nbsp;';
         break;
       case "custom_date":
-        $cfv = $varfields["$k"]? $zen->showDateTime($varfields["$k"]) : "n/a";
+        $cfv = $varfields["$k"]? $zen->showDateTime($varfields["$k"]) : "&nbsp;";
+        break;
+      case "custom_text":
+        $cfv = strlen($varfields["$k"])? $zen->ffvText($varfields["$k"]) : "&nbsp;";
         break;
       default:
-        $cfv = $varfields["$k"]? htmlspecialchars($varfields["$k"]) : 'n/a';
+        $cfv = $varfields["$k"]? $zen->ffv($varfields["$k"]) : '&nbsp;';
         break;
     }
 ?>
@@ -134,10 +151,7 @@
    </tr>
    <tr>
       <td colspan="3"<?= $varfield_type == 'custom_text'? " class='outlined'" : '' ?>>
-      <?= 
-	 $varfield_type == 'custom_text'?
-           (get_magic_quotes_runtime()? nl2br(stripslashes($cfv)) : nl2br($cfv)) : htmlspecialchars($cfv);
-      ?>
+      <?= $cfv ?>
     </td>
     <td colspan='2'>&nbsp;</td>
    </tr>
@@ -153,7 +167,7 @@
    </tr>
    <tr>
     <td colspan="5" class="outlined">
-   <?=(get_magic_quotes_runtime())?nl2br(stripslashes($description)):nl2br($description); ?>
+   <?= $zen->ffvText($description) ?>
     </td>
    </tr>  
 
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_logBox.php zentrack_2-5-5-1/includes/templates/ticket_logBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_logBox.php	2003-04-16 20:26:52.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_logBox.php	2005-05-08 07:41:03.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
       <?
@@ -28,11 +29,7 @@
       // the log and attachments
       if( $l["entry"] ) {
 	print "<br>\n";
-//	$l["entry"] = nl2br(htmlspecialchars(stripslashes($l["entry"])));
-	if ( get_magic_quotes_runtime() ) {
-	   $l["entry"] = stripslashes($l["entry"]);
-	}
-	$l["entry"] = nl2br(htmlspecialchars($l["entry"]));
+	$l["entry"] = nl2br($zen->ffv($l["entry"]));
 	$l["entry"] = preg_replace("#\&amp;#", "&", $l["entry"]);
 //	$l["entry"] = preg_replace("#(https?://[a-zA-Z0-9_/.-]+[a-zA-Z0-9\-_]+\.[a-z]{2,3}(/[a-zA-Z/\._\?=&0-9-]+))#", "<a href='\\1' target='_blank'>\\1</a>", $l["entry"]);
 	$l["entry"] = preg_replace("|(https?://[a-zA-Z0-9_/.-]+(/[a-zA-Z0-9/\.,_\?=&;:#+$!~*%'()-]+[a-zA-Z0-9_=&#+~%-]))|",
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_notifyBox.php zentrack_2-5-5-1/includes/templates/ticket_notifyBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_notifyBox.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_notifyBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
   <tr> 
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_relatedBox.php zentrack_2-5-5-1/includes/templates/ticket_relatedBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_relatedBox.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_relatedBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
@@ -10,14 +11,17 @@
 <?
   $tickets = false;
   if( $page_type == "ticket" ) {
+    $view='ticket_list';
     $ticket = $zen->get_ticket($id);
   } else {
+    $view='project_list';
     $ticket = $zen->get_project($id);
   }
   if( $ticket["relations"] ) {
      $tids = explode(",", $ticket["relations"]);
      $tickets = $zen->get_tickets( array("id"=>$tids) );
   }
+  $fields=$map->getFieldMap($view);
   if( is_array($tickets) && count($tickets) ) {
      include("$templateDir/listTickets.php");
   } else {
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_reportBox.php zentrack_2-5-5-1/includes/templates/ticket_reportBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_reportBox.php	2002-03-19 01:11:54.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/ticket_reportBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
    <tr>  
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_systemBox.php zentrack_2-5-5-1/includes/templates/ticket_systemBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_systemBox.php	2003-03-23 23:25:04.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/ticket_systemBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   
   if( $action ) {   
      
@@ -13,7 +15,7 @@
        include("$templateDir/actions/$action.php");
      }
      else {
-       print "<p class='error'>".tr("Invalid action declared")."</p>\n";
+       print "<p class='error'>".tr("Invalid action declared")." (".$zen->ffv($action).")</p>\n";
      }
   
      print "<p>&nbsp;</p>\n";
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_tasksBox.php zentrack_2-5-5-1/includes/templates/ticket_tasksBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_tasksBox.php	2003-03-23 23:25:04.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/ticket_tasksBox.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
   <table width="600" align="center" cellpadding="2" cellspacing="2">
   <tr> 
diff -Naur zentrack_2-5-0-1/includes/templates/ticket_titleBox.php zentrack_2-5-5-1/includes/templates/ticket_titleBox.php
--- zentrack_2-5-0-1/includes/templates/ticket_titleBox.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/ticket_titleBox.php	2005-05-08 07:41:03.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <table width="560" cellpadding="0" cellspacing="0">
   <tr>
    <td class="ticketCell"><table 
@@ -11,16 +12,16 @@
 	  </tr>
 	  <tr>
 	   <td class="small"><?=$id?></td>
-	   <td class="small" colspan="2"><?=stripslashes($title)?></td>
+	   <td colspan="2"><?=$zen->ffv($title)?></td>
 	  </tr>
 	  <tr>
 	   <td class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Elapsed")?></td>  
-	   <td class="smallTitleCell" width="100"><?=uptr("Opened")?></td>
-	   <td class="smallTitleCell" width="100"><?=uptr("Deadline")?></td>
+	   <td class="smallTitleCell"><?=uptr("Opened")?></td>
+	   <td class="smallTitleCell"><?=uptr("Deadline")?></td>
 	  </tr>
 	  <tr>
 	   <td class="small"><?=$zen->showTimeElapsed($otime,$ctime,1,0)?></td>  
-	   <td class="small"><?=$zen->showDate($otime)?></td>
+	   <td class="small"><?=$zen->showDateTime($otime)?></td>
 	   <td class="small"><?=($deadline)?$zen->showDateTime($deadline):"n/a"?></td>
 	  </tr>
 	  <tr>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/add_attachment.php zentrack_2-5-5-1/includes/templates/tutorial/english/add_attachment.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/add_attachment.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/add_attachment.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Attachments</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/bins.php zentrack_2-5-5-1/includes/templates/tutorial/english/bins.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/bins.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/bins.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Bins and the Move feature</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/close_ticket.php zentrack_2-5-5-1/includes/templates/tutorial/english/close_ticket.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/close_ticket.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/close_ticket.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <p align='center' class='bigbold'>Closing Tickets</p>
 
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/closure.php zentrack_2-5-5-1/includes/templates/tutorial/english/closure.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/closure.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/closure.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Thanks for Reading the Tutorial</p>
 
 <p>Hopefully this walkthrough has been somewhat useful to you and hasn't resulted
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/contacts.php zentrack_2-5-5-1/includes/templates/tutorial/english/contacts.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/contacts.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/contacts.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Contacts</p>
 
 <b>Important Note:</b> If contacts are not useful to your organization, they
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/create_ticket.php zentrack_2-5-5-1/includes/templates/tutorial/english/create_ticket.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/create_ticket.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/create_ticket.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Creating a New Ticket</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/introduction.php zentrack_2-5-5-1/includes/templates/tutorial/english/introduction.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/introduction.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/introduction.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Introduction</p>
 
 <p>This tutorial explains the basic flowpath and actions you will need to 
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/log_ticket.php zentrack_2-5-5-1/includes/templates/tutorial/english/log_ticket.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/log_ticket.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/log_ticket.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>The Ticket Log</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/login.php zentrack_2-5-5-1/includes/templates/tutorial/english/login.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/login.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/login.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Logging In</p>
 
 <p><b>Getting Login and Password</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/notify_list.php zentrack_2-5-5-1/includes/templates/tutorial/english/notify_list.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/notify_list.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/notify_list.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Notify Lists</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/ownership.php zentrack_2-5-5-1/includes/templates/tutorial/english/ownership.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/ownership.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/ownership.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Ownership of Tickets</p>
 
 <p><b>You must own a ticket for most actions</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/relate_ticket.php zentrack_2-5-5-1/includes/templates/tutorial/english/relate_ticket.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/relate_ticket.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/relate_ticket.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Related Tickets</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/use_project.php zentrack_2-5-5-1/includes/templates/tutorial/english/use_project.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/use_project.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/use_project.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Projects</p>
 
 <p><b>Purpose</b></p>
diff -Naur zentrack_2-5-0-1/includes/templates/tutorial/english/view_tickets.php zentrack_2-5-5-1/includes/templates/tutorial/english/view_tickets.php
--- zentrack_2-5-0-1/includes/templates/tutorial/english/view_tickets.php	2004-09-08 17:28:27.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/tutorial/english/view_tickets.php	2005-05-01 23:59:39.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <p align='center' class='bigbold'>Viewing Tickets</p>
 
 <img src="<?=$tutImageUrl?>/nav_tickets.gif" 
diff -Naur zentrack_2-5-0-1/includes/templates/userAdd.php zentrack_2-5-5-1/includes/templates/userAdd.php
--- zentrack_2-5-0-1/includes/templates/userAdd.php	2004-07-01 21:56:37.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/userAdd.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   // generate some text to display based on whether this
   // is an edit page or an add page
   $td = ($TODO == 'EDIT');
diff -Naur zentrack_2-5-0-1/includes/templates/userSearchForm.php zentrack_2-5-5-1/includes/templates/userSearchForm.php
--- zentrack_2-5-0-1/includes/templates/userSearchForm.php	2004-09-08 17:39:02.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/userSearchForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,3 +1,4 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
 <table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
 <tr>
@@ -13,6 +14,7 @@
 
 <form action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="TODO" value="ALL">
+<input type="hidden" name="return_field" value="<?=$zen->ffv($return_field)?>">
 
 <tr>
   <td class="bars" colspan="2">
@@ -35,7 +37,7 @@
   </td>
   <td class="bars">
    <input type="text" name="search_text" 
-      value="<?=htmlspecialchars($search_text)?>" size="25" maxlength="50">
+      value="<?=$zen->ffv($search_text)?>" size="25" maxlength="50">
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-0-1/includes/templates/userSearchList.php zentrack_2-5-5-1/includes/templates/userSearchList.php
--- zentrack_2-5-0-1/includes/templates/userSearchList.php	2003-03-23 23:25:04.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/userSearchList.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   
 if( is_array($users) && count($users) ) {
  
diff -Naur zentrack_2-5-0-1/includes/templates/userSearchResults.php zentrack_2-5-5-1/includes/templates/userSearchResults.php
--- zentrack_2-5-0-1/includes/templates/userSearchResults.php	2002-04-30 03:11:12.000000000 -0700
+++ zentrack_2-5-5-1/includes/templates/userSearchResults.php	2005-05-01 23:59:38.000000000 -0700
@@ -1,4 +1,6 @@
 <?{
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   // integrity
   unset($params);
diff -Naur zentrack_2-5-0-1/includes/templates/validateTicketForm.php zentrack_2-5-5-1/includes/templates/validateTicketForm.php
--- zentrack_2-5-0-1/includes/templates/validateTicketForm.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/templates/validateTicketForm.php	2005-05-01 23:59:38.000000000 -0700
@@ -0,0 +1,68 @@
+<?  
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   PREREQUISITES:
+     (ZenFieldMap)$map - contains properties for fields
+     (string)$view - the current view (probably project_create or ticket_create)
+     (string)$page_type - (optional) either 'ticket' or 'project'
+  **/
+?>
+
+<script language='Javascript' type='text/javascript'>
+
+ function validateField( obj ) {
+    switch( obj.type ) {
+      case "checkbox":
+        return obj.checked;
+      case "text":
+      case "textarea":
+      case "file":
+        return obj.value != null && obj.value.length;
+      case "select":
+      case "select-one":
+        var val = obj.options[ obj.selectedIndex ].value;       
+        return val != null && val != "";    
+      case "select-multiple":
+      case "radio":
+        return true;
+      case "button":
+      case "submit":
+      case "hidden":
+      case "password":
+      case "reset":
+      default:
+        return false;
+    }
+ }
+
+ function validateTicketForm() {
+   var errs = new Array();
+<?
+foreach($fields as $f) {
+  $field = $map->getFieldFromMap($view,$f['field_name']);
+  // we don't want to validate any hidden fields using javascript, this is
+  // a potential problem.
+  if( $field['is_required'] && $field['is_visible'] && $field['field_type'] != 'label' ) {
+    $label = $map->getLabel($view,$f);
+    $tr = $zen->fixJSVal(tr("? is required",array(tr($label))));
+    print "\tif( !validateField(document.ticketForm.$f) ) { errs[errs.length] = $tr; }\n";
+  }
+}
+if ($td && $zen->settings['edit_reason_required']=='on' && $zen->settings['log_edit']=='on') {
+    $tr = $zen->fixJSVal(tr("? is required",array(tr("Edit Reason"))));
+    print "\tif( !validateField(document.ticketForm.edit_reason) ) { errs[errs.length] = $tr; }\n";
+}
+?>
+   if( errs.length > 0 ) {
+     var str = "<?=tr("Please correct the following errors:")?>\n----------\n";
+     for( var i=0; i < errs.length; i++ ) {
+       str += errs[i]+"\n";
+     }
+     alert(str);
+     return false;
+   }
+   return true;
+ }
+
+</script>
diff -Naur zentrack_2-5-0-1/includes/translations/spanish.trans zentrack_2-5-5-1/includes/translations/spanish.trans
--- zentrack_2-5-0-1/includes/translations/spanish.trans	2003-05-25 05:56:05.000000000 -0700
+++ zentrack_2-5-5-1/includes/translations/spanish.trans	2005-03-22 08:31:41.000000000 -0800
@@ -1,3547 +1,5919 @@
-# This is the translation template file. It is automatically generated from developers/tr-parser.php
-# If you have any questions on how to create a translation file please direct them to zentrack support
-
-#file "D:\zentrack\zentrack/www/actions/assign.php"
-#args "array($r)"
-msgid " ? is required"
-msgstr "? es obligatorio"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "%"
-msgstr "%"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args "array($file_type)"
-msgid "'?' is not an allowed file extension - See your systems administrator for more information"
-msgstr "'?' no es una extensi&oacute;n v&aacute;lida de fichero - Para m&aacute;s informaci&oacute; consulte con su Administrador de Sistemas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "* = required"
-msgstr "* = obligatorio"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "1 Match"
-msgstr "1 Ocurrencia"
-
-
-#file "D:\zentrack\zentrack/www/actions/close.php"
-#args "array($zen->types[$c['type_id']], $c['id'])"
-msgid "? ? is not completed."
-msgstr "? ? no est&aacute; completado."
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args "array($c)"
-msgid "? Matches"
-msgstr "? Ocurrencias"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
-msgid "? Settings"
-msgstr "? Configuraciones"
-
-
-#file "D:\zentrack\zentrack/www/admin/bins.php"
-#args "array($j)"
-msgid "? bins were saved to the database. Updates complete"
-msgstr "? 'bins' se han guardado en la base de datos. Actualizaciones completadas"
-
-
-#file "D:\zentrack\zentrack/www/actions/editSubmit.php"
-#args "array(ucfirst($r))"
-msgid "? is a required field"
-msgstr "? es un campo obligatorio"
-
-
-#file "D:\zentrack\zentrack/www/actions/email.php"
-#args "array($r)"
-msgid "? is required"
-msgstr "? es obligatorio"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($k)"
-msgid "? must be set to 'on' or 'off'"
-msgstr "Debe establecer ? a 'on' o a 'off'"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($k)"
-msgid "? must have a value, use zero instead of a blank"
-msgstr "? debe tener un valor, use cero en lugar de blanco"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($j, count($newparams))"
-msgid "? of ? settings changed were successfully updated"
-msgstr "? de ? cambios en la configuraci&oacuten fueron salvados en la base de datos con &eacute;xito"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args "array($num,count($zen->bins))"
-msgid "? open tickets in ? bins"
-msgstr "Existen ? 'tickets' abiertos en ? 'bins'"
-
-
-#file "D:\zentrack\zentrack/www/admin/priorities.php"
-#args "array($j)"
-msgid "? priorities were saved to the database. Updates complete"
-msgstr "? 'priorities' han sido guardadas en la base de datos. Actualizaci&oacute;n completada"
-
-
-#file "D:\zentrack\zentrack/www/admin/systems.php"
-#args "array($j)"
-msgid "? systems were saved to the database. Updates complete"
-msgstr "? 'systems' han sido guardados en la base de datos. Actualizaci&oacute;n completada"
-
-
-#file "D:\zentrack\zentrack/www/admin/tasks.php"
-#args "array($j)"
-msgid "? tasks were saved to the database. Updates complete"
-msgstr "? 'tasks' han sido guardadas en la base de datos. Actualizaci&oacute;n completada"
-
-
-#file "D:\zentrack\zentrack/www/admin/types.php"
-#args "array($j)"
-msgid "? types were saved to the database. Updates complete"
-msgstr "? 'types' han sido guardados en la base da datos. Actualizaci&oacute;n completada"
-
-
-#file "D:\zentrack\zentrack/www/actions/addToNotify.php"
-#args "array($u)"
-msgid "? was not a valid user id"
-msgstr "? no es un identificador de usuario v&aacute;lido"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "A large number of elements will appear better in a line chart, bar charts tend to be more pleasing with smaller numbers."
-msgstr "Para mostar un n&uacute;mero elevado de elementos le recomendamos el tipo de gr&afico de l&iacuteneas. Los gr&aacute;raficos de barras son m&aacute;s recomendables para grupos peque&ntilde;os de elementos"
-
-
-#file "D:\zentrack\zentrack/includes/leftHelp.php"
-#args ""
-msgid "API"
-msgstr "API"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "ATC"
-msgstr "ATC"
-
-
-#file "D:\zentrack\zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
-msgid "About ?"
-msgstr "Acerca de ?"
-
-
-#file "D:\zentrack\zentrack/includes/leftHelp.php"
-#args ""
-msgid "About"
-msgstr "Acerca de"
-
-
-#file "D:\zentrack\zentrack/www/addSubmit.php"
-#args ""
-msgid "Access Error"
-msgstr "Error de acceso"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Access"
-msgstr "Acceso"
-
-
-#file "D:\zentrack\zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Account Options"
-msgstr "Opciones de la cuenta de usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Configuraci&oacute;n de la cuenta de usuario"
-msgstr ""
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Account is Active"
-msgstr "La cuenta de usuario est&aacute; Activada"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Action Taken"
-msgstr "Acci&oacute;n realizada"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Action"
-msgstr "Acci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Active"
-msgstr "Activo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Add Attachment"
-msgstr "A&ntilde;adir Fichero Adjunto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add Notify Recipient"
-msgstr "A&ntilde;adir Receptor de Notificaciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Add Recipient"
-msgstr "A&ntilde;adir Receptor"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Add a total figure"
-msgstr "A&nadir un gr&afico por totales"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Add an average figure"
-msgstr "A&nadir un gr&afico por medias"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add recipients to the notify list for this ticket"
-msgstr "A&ntilde;adir receptores a la lista de notificaciones para este 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Add ticket to project"
-msgstr "A&ntilde;adir 'ticket' al proyecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add"
-msgstr "A&ntilde;adir"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args ""
-msgid "Admin Section"
-msgstr "Secci&oacute;n de Administrador"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Admin"
-msgstr "Administrador"
-
-
-#file "D:\zentrack\zentrack/www/admin/admin_header.php"
-#args ""
-msgid "Administration"
-msgstr "Administraci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Administrative Options"
-msgstr "Opciones de Administraci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "All bins were removed from access for user ?"
-msgstr "Se elimin&oacute; el acceso a todos los 'bins' para el usuario ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "All entries must contain a value."
-msgstr "Todas los objetos deben tener valor."
-
-
-#file "D:\zentrack\zentrack/www/misc/homebin.php"
-#args ""
-msgid "All"
-msgstr "Todos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Amount of time worked"
-msgstr "Tiempo empleado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Any valid date format"
-msgstr "Cualquier formato de fecha v&aacute;lido"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Approval Required"
-msgstr "Se requiere aprobaci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Approval"
-msgstr "Aprobaci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Archive Tickets"
-msgstr "Archivar 'Tickets'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Are you sure you want to permanently delete this template?"
-msgstr "&iquest;Desea eliminar este patr&oacute;n permanentemente?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Assign Ticket"
-msgstr "Asignar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Assign the ticket to a new user"
-msgstr "Asignar el 'ticker' a otro usuario"
-
-
-#file "D:\zentrack\zentrack/includes/leftTickets.php"
-#args ""
-msgid "Assigned to"
-msgstr "Asignado a"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Associate this ticket with others"
-msgstr "Asociar este 'ticket' con otros"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Attach"
-msgstr "Adjuntar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Attachment"
-msgstr "Adjunto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_attachmentsBox.php"
-#args "array($page_type,$id)"
-msgid "Attachments on ? #?"
-msgstr "Elementos adjuntados en ? #?"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "Attachments"
-msgstr "Elementos adjuntos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Bar Chart"
-msgstr "Gr&aacute;fico de Barras"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Bin Name"
-msgstr "Nombre del 'Bin'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Bin ticket is located in"
-msgstr "El 'ticket' perteneciente al 'bin' se encuentra en"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Bin"
-msgstr "Bin"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Bin(s)"
-msgstr "Bin(s)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Date"
-msgstr "Por Fecha"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Parameters"
-msgstr "Por Par&aacute;metros"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Text Match"
-msgstr "Por Texto Conteniendo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "By Text"
-msgstr "Por Texto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Default Bin"
-msgstr "Cambiar el 'Bin' Por Defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Language"
-msgstr "Cambiar Idioma"
-
-
-#file "D:\zentrack\zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Password"
-msgstr "Cambiar Clave"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Change User Password"
-msgstr "Cambiar Clave del Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "Change Your Default Bin"
-msgstr "Cambiar Su 'Bin' Por Defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "Change Your Language"
-msgstr "Cambiar Su Idioma"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDataMenu.php"
-#args ""
-msgid "Change"
-msgstr "Cambiar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Changing these settings can have a severe impact on the system.  Please consider this before making modifications."
-msgstr "El cambio de estas opciones de configuraci&oacute;n puede tener un impacto grave sobre el sistema. Considere esto antes de realizar las modificaciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Changing this configuration list has a large system impact."
-msgstr "El cambio de esta lista de configuraci&oacute;n tendr&aacute; un gran impacto en el sistema"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Chart Options"
-msgstr "Opciones del gr&aacute;fico"
-
-
-#file "D:\zentrack\zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Chart could not be saved."
-msgstr "El gr&aacute;fico no puede ser salvado."
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Choose one of the following options"
-msgstr "Seleccionar una de las siguientes opciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Click 'Search' to execute the search"
-msgstr "Pulse 'Buscar' para comenzar la b&uacute;squeda"
-
-
-#file "D:\zentrack\zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "Click 'Update' to change your default bin"
-msgstr "Pulse 'Actualizar' para cambiar su 'bin' por defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "Click 'Update' to change your language"
-msgstr "Pulse 'Actualizar' para cambiar su idioma"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args "array($button,$blurb)"
-msgid "Click ? to ?"
-msgstr "Pulse ? para ?"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUser.php"
-#args ""
-msgid "Click Here to search for users"
-msgstr "Pulse Aqu&iacute; para buscar por usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/translations/english.trans"
-#args ""
-msgid "Click Here"
-msgstr "Pulse Aqu&iacute;"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Click button to add recipients"
-msgstr "Pulse el bot&oacute;n para a%ntilde;adir receptores (recipients)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Click button to assign relations"
-msgstr "Pulse el bot&oacute;n para asignar relaciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Click button to assign"
-msgstr "Pulse el bot&oacute;n para asignar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Click button to close"
-msgstr "Pulse el bot&oacute;n para cerrar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Click button to create log"
-msgstr "Pulse el bot&oacute;n para crear traza"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Click button to move ticket"
-msgstr "Pulse el bot&oacute;n para mover 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Click button to open"
-msgstr "Pulse el bot&oacute;n para abrir"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Click button to reject"
-msgstr "Pulse el bot&oacute;n para rechazar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Click button to send email"
-msgstr "Pulse el bot&oacute;n para enviar e-mail"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Click button to set estimated hours to completion"
-msgstr "Pulse el bot&oacute;n para indicar el n&uacute;mero de horas estimadas para completar la acci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Click button to upload file and attach to ticket"
-msgstr "Pulse el bot&oacute;n para cargar el fichero y adjuntarlo al 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Click button to yank ticket"
-msgstr "Pulse el bot&oacute;n para desechar el 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Click button to"
-msgstr "Pulse le bot&oacute;n para"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Close Ticket"
-msgstr "Cerrar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Close"
-msgstr "Cerrar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Closed"
-msgstr "Cerrado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args "array(strip_tags($report_type))"
-msgid "Combine selected ?s"
-msgstr "Combinar ?s seleccionados"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Comments or Instructions"
-msgstr "Comentarios o Instrucciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Comments"
-msgstr "Comentarios"
-
-
-#file "D:\zentrack\zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "Commit Edited Ticket"
-msgstr "Guardar 'Ticket' editado"
-
-
-#file "D:\zentrack\zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "Commit New Project"
-msgstr "Guardar Proyecto Nuevo"
-
-
-#file "D:\zentrack\zentrack/www/addSubmit.php"
-#args ""
-msgid "Commit New Ticket"
-msgstr "Crear 'Ticket' Nuevo"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "Completed"
-msgstr "Completado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Configuration Settings"
-msgstr "Opciones de Configuraci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Containing"
-msgstr "Contenido"
-
-
-#file "D:\zentrack\zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "Could not create ticket."
-msgstr "No es posible crear 'ticket'."
-
-
-#file "D:\zentrack\zentrack/includes/leftTickets.php"
-#args ""
-msgid "Create New"
-msgstr "Crear Nuevo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Create Reports"
-msgstr "Crear Informes"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Create Sub-Project"
-msgstr "Crear Sub-Proyecto"
-
-
-#file "D:\zentrack\zentrack/www/newProject.php"
-#args ""
-msgid "Create a New Project"
-msgstr "Crear un Proyecto Nuevo"
-
-
-#file "D:\zentrack\zentrack/www/newTicket.php"
-#args ""
-msgid "Create a New Ticket"
-msgstr "Crear un Nuevo 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Create a log entry, or log hours worked"
-msgstr "Crear una traza o traza de horas trabajadas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Create a new user account"
-msgstr "Crear una nueva cuenta de usuario"
-
-
-#file "D:\zentrack\zentrack/includes/leftBins.php"
-#args ""
-msgid "Current Bin"
-msgstr "'Bin' actual"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Current status of the ticket"
-msgstr "Estado actual del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "Custom Access priviledges updated for user ?"
-msgstr "Se han actualizado los privilegios de Acceso Personalizados para el usuario ?"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "DESCRIPTION"
-msgstr "DESCRIPCION"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Data Options"
-msgstr "Opciones de Datos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDataMenu.php"
-#args ""
-msgid "Data Selection"
-msgstr "Selecci&oacute;n de Datos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Date Range"
-msgstr "Rango de fechas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Date log was created"
-msgstr "La traza de fechas ha sido creada"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Date"
-msgstr "Fecha"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Days"
-msgstr "D&iacute;as"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Deadline"
-msgstr "Tope"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Default Acces Level"
-msgstr "Nivel de Acceso por Defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Default Access Level"
-msgstr "Nivel de Acceso por Defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Delete Reports"
-msgstr "Eliminar Informes"
-
-
-#file "D:\zentrack\zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "Delete User"
-msgstr "Eliminar Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Delete"
-msgstr "Eliminar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Description of Attachment"
-msgstr "Descripci&oacute;n o Elemento Adjunto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Description"
-msgstr "Descripci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Details"
-msgstr "Detalles"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Disabled"
-msgstr "Deshabilidata"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Display Values"
-msgstr "Mostrar Valores"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Drop Recipients"
-msgstr "Eliminar Receptores"
-
-
-#file "D:\zentrack\zentrack/www/reports/drop.php"
-#args ""
-msgid "Drop Template"
-msgstr "Eliminar Plantilla"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "ETC"
-msgstr "ETC"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Bins"
-msgstr "Editar 'Bins'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Priorities"
-msgstr "Editar Prioridades"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Edit Settings"
-msgstr "Editar Atributos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Systems"
-msgstr "Editar Sistemas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Tasks"
-msgstr "Editar Tareas"
-
-
-#file "D:\zentrack\zentrack/www/actions/edit.php"
-#args ""
-msgid "Edit Ticket"
-msgstr "Editar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Edit Tickets"
-msgstr "Editar 'Tickets'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Types"
-msgstr "Editar Tipos"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "Edit User Submit"
-msgstr "Aceptar Edicci&oacute;n de Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Edit Users"
-msgstr "Editar Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Users/Access"
-msgstr "Editar Usuarios/Accesos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args "array(ucfirst($type))"
-msgid "Edit the Active ?s"
-msgstr "Editar los ?s Activos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the current bins"
-msgstr "Editar los 'bins' actuales"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the priorities list"
-msgstr "Editar la lista de prioridades"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the systems list"
-msgstr "Editar la lista de sistemas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the tasks list"
-msgstr "Editar la lista de tareas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the types list"
-msgstr "Editar la lista de tipos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the zenTrack settings.  Consult the documentation before using this feature."
-msgstr "Editar los par&aacute;metros de zenTrack. Consulte la documentaci&oacute;n antes de utilizar esta utilidad."
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit ticket information"
-msgstr "Editar la informaci&oacute;n del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_titleBox.php"
-#args ""
-msgid "Elapsed"
-msgstr "Transcurrido"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Email Ticket"
-msgstr "Notificar 'Ticket' por e-mail"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Email"
-msgstr "E-mail"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Enter Project Information"
-msgstr "Introducir Informaci&oacute;n de Proyecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Enter Ticket IDs"
-msgstr "Introudir identificador de 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/nav.php"
-#args ""
-msgid "Enter a ticket ID and press enter"
-msgstr "Introducir identificador de 'ticket' y pulsar 'intro'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Enter any hours worked not previously accounted for"
-msgstr "Introducir el total de horas trabajadas y no computadas anteriormente"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Enter hours worked"
-msgstr "Introducir horas trabajadas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Enter multiple ids, separated by a comma"
-msgstr "Introducir la lista de identificadores separados por comas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Enter registered users"
-msgstr "Introducir usuarios registrados"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Enter the hours worked for this entry"
-msgstr "Indicar las horas trabajadas para este concepto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Enter the number of hours (can contain up to 2 decimal places)"
-msgstr "Introducir el n&uacute;mero de horas (se permiten hasta dos decimales)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Enter ticket ids, separated by commas"
-msgstr "Introducir los identificadores de los 'tickets' separados por comas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Equals"
-msgstr "Igual a"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Est Hrs"
-msgstr "Tiempo estimado (en Horas)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Estimate Ticket Hours"
-msgstr "Tiempo estimado del 'Ticket' (en Horas)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Estimated Hours to Complete"
-msgstr "Tiempo estimado para finalizar (en Horas)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Estimated Hours"
-msgstr "Horas estimadas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Estimated time to complete"
-msgstr "Tiempo estimado para finalizar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "First Name"
-msgstr "Nombre"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Greater Than"
-msgstr "Mayor Que"
-
-
-#file "D:\zentrack\zentrack/includes/leftHelp.php"
-#args ""
-msgid "Help"
-msgstr "Ayuda"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Home Bin"
-msgstr "'Bin' Inicial"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Home"
-msgstr "Inicio"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Hours Worked"
-msgstr "Horas Trabajadas"
-
-
-#file "D:\zentrack\zentrack/www/actions/log.php"
-#args ""
-msgid "Hours must be entered if the activity is 'LABOR'"
-msgstr "Se debe indicar el n&uacute;mero de horas si se ha indicado la actividad 'TRABAJO' (LABOR)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Hours"
-msgstr "Horas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "ID of the ?"
-msgstr "Identificador de ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "ID of the ticket"
-msgstr "Identificador del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "ID"
-msgstr "Identificador"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Image Type"
-msgstr "Tipo de imagen"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Image"
-msgstr "Imagen"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Importance of the ?"
-msgstr "Importancia del ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Initials"
-msgstr "Iniciales"
-
-
-#file "D:\zentrack\zentrack/includes/leftHelp.php"
-#args ""
-msgid "Installation"
-msgstr "Instalaci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Items in this list cannot be destroyed, to maintain data integrity."
-msgstr "Para mantener la integridad de los datos los elementos de la lista no pueden ser eliminados."
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "LOG"
-msgstr "TRAZA"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Last Name"
-msgstr "Apellido"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Less Than"
-msgstr "Menor Que"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Less"
-msgstr "Menos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Level"
-msgstr "Nivel"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Line Chart"
-msgstr "Gr&aacute;fico de L&iacute;neas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "List All Users"
-msgstr "Listar Todos los Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "Log History")
-msgstr "Hist&oacute;rico de trazas")
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Log ID"
-msgstr "Identificador de traza"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "Log Off"
-msgstr "Desactivar traza"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "Log On"
-msgstr "Activar traza"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Log"
-msgstr "Traza"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Login Name"
-msgstr "Usuario"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Make Visible To"
-msgstr "Hacer Visible A"
-
-
-#file "D:\zentrack\zentrack/www/reports/projectSearchbox.php"
-#args ""
-msgid "Make search of projects that returns comma delimited list"
-msgstr "El resultado de la busqueda de proyectos ser&aacute; una lista de objetos delimitados por comas"
-
-
-#file "D:\zentrack\zentrack/www/reports/ticketSearchbox.php"
-#args ""
-msgid "Make ticket search that returns comma delimited list"
-msgstr "El resultado de la busqueda de 'tickets' ser&aacute; una lista de objetos delimitados por comas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Manage Reports"
-msgstr "Gestionar Informes"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Master Project"
-msgstr "Proyecto ra&iacute;z"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Maximum Age"
-msgstr "Fecha M&aacute;xima"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Modify Existing"
-msgstr "Modificar Existente"
-
-
-#file "D:\zentrack\zentrack/www/reports/view.php"
-#args ""
-msgid "Modify Report"
-msgstr "Modificar Informe"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Modify Reports"
-msgstr "Modificar Informes"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Modify Search"
-msgstr "Modificar B&uacute;squeda"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Modify"
-msgstr "Modificar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Months"
-msgstr "Meses"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "More"
-msgstr "M&aacute;s"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Most Current"
-msgstr "M&aacute;s Actual"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Move Ticket"
-msgstr "Mover 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Move"
-msgstr "Mover"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Name of the ?"
-msgstr "Nombre del ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Name"
-msgstr "Nombre"
-
-
-#file "D:\zentrack\zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "New Default Bin"
-msgstr "Nuevo 'Bin' Por Defecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "New Language"
-msgstr "Idioma nuevo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "New Password"
-msgstr "Clave nueva"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "New Report"
-msgstr "Informe nuevo"
-
-
-#file "D:\zentrack\zentrack/includes/leftSearch.php"
-#args ""
-msgid "New Search"
-msgstr "Nueva b&uacute;squeda"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "New Template"
-msgstr "Plantilla nueva"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "New User"
-msgstr "Usuario nuevo"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "No Log Entries"
-msgstr "No existen trazas"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "No Related Tickets"
-msgstr "No existen 'Tickets' relaccionados"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "No Tasks Assigned to this Project"
-msgstr "No existen tareas asignadas para este proyecto (project)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "No attachments exist for this $page_type"
-msgstr "No hay elementos adjuntados para este $page_type"
-
-
-#file "D:\zentrack\zentrack/www/actions/log.php"
-#args ""
-msgid "No comments were entered."
-msgstr "No se han introducido comentarios."
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "No file was uploaded."
-msgstr "No se cargado ning&uacuten fichero."
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "No logs found"
-msgstr "No se han encontrado trazas"
-
-
-#file "D:\zentrack\zentrack/www/actions/dropFromNotify.php"
-#args ""
-msgid "No recipients were selected to drop"
-msgstr "No se han seleccionado receptores para eliminar"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args ""
-msgid "No settings were recieved"
-msgstr "No se han recibido par&aacute;metros"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "No tickets have been added to this Project."
-msgstr "No se han a&ntilde;adido 'tickets' al Proyecto."
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_relatedBox.php"
-#args ""
-msgid "No tickets have been associated with this ticket."
-msgstr "No hay 'tickets' asociados a este 'ticket'"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "No user id was recieved"
-msgstr "No se recibido el identificador de usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogResults.php"
-#args ""
-msgid "No valid fields were provided to conduct a search"
-msgstr "No se han indicado campos v&aacute;lidos para realizar la b&uacute;squeda"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "Not Required"
-msgstr "Opcional"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Note"
-msgstr "Nota"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Notes"
-msgstr "Notas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Notify List"
-msgstr "Lista de noficicaciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "OR manually enter email addresses, seperated by commas"
-msgstr "O introduzca manualmente las direcciones de correo separadas por comas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Off"
-msgstr "Off"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "On"
-msgstr "On"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Only the root administrator can change the root administrator's passphrase"
-msgstr "La clave de administrador solo puede ser modificada por el Administrador"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Open ticket closed in error"
-msgstr "El 'ticket' se cerr&oacute; con error"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Opened"
-msgstr "Abierto"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Optional.  Use control or shift to select multiples"
-msgstr "Opcional. Use las teclas 'control' o 'shift' para seleccionar varias"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Optional. You do not need to select yourself"
-msgstr "Opcional. No es necesario selecionarse a si mismo"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "Options"
-msgstr "Opciones"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Or add an unregistered user"
-msgstr "O a&ntilde;ada un usuario no registrado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Order"
-msgstr "Orden"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Owner"
-msgstr "Propietario"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args "array($user_id)"
-msgid "Password reset to the default [user's last name] for user ?"
-msgstr "La Clave del usuario ? ha sido inicializada a su valor por defecto [apellido del usuario]"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Password successfully changed"
-msgstr "Clave modificada correctamente"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Percent completed"
-msgstr "Porcentaje completado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args "array($u["user_id"])"
-msgid "Permanently remove user ??"
-msgstr "&iquest; Confirma la eliminaci&oacute;n del usuario ??"
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Person ticket is assigned to"
-msgstr "El 'ticket' ha sido asignado a"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Pick a type"
-msgstr "Seleccione un tipo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Pie Chart"
-msgstr "Gr&aacute;fico de Tarta"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Please consider this before making modifications."
-msgstr "Por favor, considere esto antes de realizar modificaciones."
-
-
-#file "D:\zentrack\zentrack/includes/templates/editTicketForm.php"
-#args ""
-msgid "Please enter a ticket ID"
-msgstr "Por favor, introduzca un identifcador de 'ticket'"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Please fill in both of the fields"
-msgstr "Por favor, rellene todos los campos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Please keep track of your new passphrase."
-msgstr "Por favor, anote su nueva clave."
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "Please log in to view the entire ticket."
-msgstr "Por favor, reg&iacute;strese para visualizar el 'ticket'."
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Press 'Reset' to restore the original values."
-msgstr "Pulse 'Reset' para restaurar los valores iniciales."
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Press 'Save' when you are sure that the values are correct."
-msgstr "Pulse 'Salvar' tras introducir los valores correctos."
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press LESS to remove blank fields"
-msgstr "Pulse MENOS para eliminar los campos en blanco"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press MORE to remove blank rows"
-msgstr "Pulse MENOS para eliminar las filas en blanco"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press MORE to add more custom fields"
-msgstr "Pulse MAS para a&ntilde;adir m&aacute;s campos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press MORE to create new rows"
-msgstr "Pulse MAS para crear nuevas filas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press Reset to return to original values"
-msgstr "Pulse 'Reset' para establecer los valores originales"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press Reset to return to users existing values"
-msgstr "Pulse 'Reset' para establecer los valores existentes para los usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press Save to save changes"
-msgstr "Pulse 'Salvar' para guardar los cambios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press Update to save changes"
-msgstr "Pulse 'Actualizar' para guardar los cambios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Pri"
-msgstr "Pri"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Priority"
-msgstr "Prioridad"
-
-
-#file "D:\zentrack\zentrack/www/admin/addUserSubmit.php"
-#args ""
-msgid "Process completed successfully.  Account not added, because this is a demo site"
-msgstr "El proceso ha finalizado con &eacute;xito. La cuenta de usuario no ha sido a&ntilde;adida porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/bins.php"
-#args ""
-msgid "Process completed successfully.  Bins were not updated since this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. Los 'Bins' no han sido actualizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Process completed successfully.  No changes were made because this is a demo site"
-msgstr "El proceso ha finalizado con &eacute;xito. Los cambios no han sido realizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args ""
-msgid "Process completed successfully.  No changes were made, because this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. Los cambios no han sido realizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/priorities.php"
-#args ""
-msgid "Process completed successfully.  Priorities were not updated since this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. Las prioridades no han sido actualizadas porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/systems.php"
-#args ""
-msgid "Process completed successfully.  Systems were not updated since this is a demo site."
-"msgstr "El proceso ha finalizado con &eacute;xito. Los sistemas no han sido actualizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/tasks.php"
-#args ""
-msgid "Process completed successfully.  Tasks were not updated since this is a demo site."
-"msgstr "El proceso ha finalizado con &eacute;xito. Las tareas no han sido actualizadas porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/types.php"
-#args ""
-msgid "Process completed successfully.  Types were not updated since this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. Los tipos no han sido actualizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args ""
-msgid "Process completed successfully. No privileges were changed, because this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. Los priviliegios no han sido actualizados porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "Process successful.  User was not updated, because this is a demo site."
-msgstr "El proceso ha finalizado con &eacute;xito. El usuario no ha sido actualizado porque esta es una web de demo"
-
-
-#file "D:\zentrack\zentrack/www/reports/show.php"
-#args ""
-msgid "Processing Error: Report ID Missing"
-msgstr "Error de proceso. No se encuentra el Identificador de Informe"
-
-
-#file "D:\zentrack\zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Processing error: tempid not found\n"
-msgstr "Error de proceso; no se encuentra 'tempid'\n"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Processing error: template not found."
-msgstr "Error de proceso. No se encuentar la plantilla"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Project ID"
-msgstr "Identificador de proyecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Project"
-msgstr "Proyecto"
-
-
-#file "D:\zentrack\zentrack/includes/leftTickets.php"
-#args ""
-msgid "Projects"
-msgstr "Proyectos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Pull ticket from the current owner"
-msgstr "Desasignar 'ticket' a su propietario actual"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "RELATED TICKETS"
-msgstr "TICKETS RELACIONADOS"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Range"
-msgstr "Rango"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "Really log out of zenTrack?"
-msgstr "&iquest;Est&aacute; seguro de que quiere abandonar zenTrack?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reason"
-msgstr "Raz&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reject Ticket"
-msgstr "Eliminar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reject"
-msgstr "Eliminar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Relate Ticket"
-msgstr "Asociar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Relate"
-msgstr "Asociar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_relatedBox.php"
-#args "array($page_type)"
-msgid "Related ?s"
-msgstr "Asociados ?s"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Related Tickets"
-msgstr "'Tickets' asociados"
-
-
-#file "D:\zentrack\zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Remember My Password"
-msgstr "Recordar mi Clave"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Reopen Ticket"
-msgstr "Reabrir 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Reopen"
-msgstr "Reabrir"
-
-
-#file "D:\zentrack\zentrack/www/reports/drop.php"
-#args ""
-msgid "Report Deleted"
-msgstr "Informe Eliminado"
-
-
-#file "D:\zentrack\zentrack/www/reports/custom.php"
-#args ""
-msgid "Report ID not found"
-msgstr "Identificador de Informe no encontrado"
-
-
-#file "D:\zentrack\zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Report Name is required"
-msgstr "El nombre del Informe es obligatorio"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Report Type"
-msgstr "Tipo de Informe"
-
-
-#file "D:\zentrack\zentrack/includes/leftReports.php"
-#args ""
-msgid "Reports"
-msgstr "Informes"
-
-
-#file "D:\zentrack\zentrack/www/addSubmit.php"
-#args ""
-msgid "Required field missing:"
-msgstr "Campo obligatorio no encontrado:"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "Required"
-msgstr "Obligatorio"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Requirements"
-msgstr "Campos requeridos"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Reset Password"
-msgstr "Inicializar Clave"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args "array($u["user_id"])"
-msgid "Reset the password for user ??"
-msgstr "Inicilizar la clave del usuario ??"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Reset"
-msgstr "Reset"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Return ticket to sender"
-msgstr "Devolver el 'ticket' al emisor"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Retype New Password"
-msgstr "Teclee otra vez su nueva clave"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Role"
-msgstr "Perfil"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Save Report"
-msgstr "Guardar Informe"
-
-
-#file "D:\zentrack\zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Save Submit"
-msgstr "Guardar Operaci&oacute;n"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Save Template"
-msgstr "Guardar Plantilla"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Save"
-msgstr "Guardar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Scatter Chart"
-msgstr "Gr&aacute;fico de Dispersi&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Search For Logs"
-msgstr "B&uacute;squeda por Trazas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Search For Users"
-msgstr "B&uacute;squeda por Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/leftSearch.php"
-#args ""
-msgid "Search Logs"
-msgstr "Buscar Trazas"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Search Projects"
-msgstr "Buscar Proyectos"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Search Tickets"
-msgstr "Buscar 'Tickets'"
-
-
-#file "D:\zentrack\zentrack/www/helpers/userSearchbox.php"
-#args ""
-msgid "Search Users"
-msgstr "Buscar Usuarios"
-
-
-#file "D:\zentrack\zentrack/www/admin/listUsers.php"
-#args ""
-msgid "Search for Users"
-msgstr "B&uacute;squeda por Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/leftSearch.php"
-#args ""
-msgid "Search"
-msgstr "Buscar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDataMenu.php"
-#args "array($zen->ffv($report_type))"
-msgid "Select ?s"
-msgstr "Seleccionar ?s"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select Projects"
-msgstr "Seleccionar Proyectos"
-
-
-#file "D:\zentrack\zentrack/www/helpers/ticketSearchbox.php"
-#args ""
-msgid "Select Tickets"
-msgstr "Seleccionar 'Tickets'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Select a Recipient"
-msgstr "Seleccionar un Receptor"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Select a User"
-msgstr "Seleccionar un Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Select a file to upload"
-msgstr "Seleccionar fichero a cargar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Select an activity"
-msgstr "Seleccionar una actividad"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select more than one by using control or shift"
-msgstr "Use las teclas control o shift para seleccionar m&aacute;s de un elemento"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select"
-msgstr "Seleccionar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a link to this ticket only"
-msgstr "Enviar un enlace a este 'ticket' &uacute;nicamente"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a summary of the ticket"
-msgstr "Enviar un resumen de este 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a summary, and the ticket's log"
-msgstr "Enviar el resumen y la traza del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Send ticket to another bin"
-msgstr "Enviar el 'ticket' a otro 'bin'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send ticket to specified recipients"
-msgstr "Enviar el 'ticket' a los receptores especificados"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args "array($zen->formatName($user_id))"
-msgid "Set Access for ?"
-msgstr "Establecer el Nivel de Acceso para ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Set Password"
-msgstr "Establecer la Clave"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Set status to closed/pending"
-msgstr "Establecer el estado a cerrado/pendiente"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Set testing to completed on ticket"
-msgstr "Finalizar el test sobre el 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Set the expected hours this ticket will take to complete"
-msgstr "Establecer el n&uacute;mero de horas estimado para completar el 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Set"
-msgstr "Set"
-
-
-#file "D:\zentrack\zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Settings"
-msgstr "Propiedades"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Show All Users"
-msgstr "Mostrar todos los Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Both"
-msgstr "Mostrar Todos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Graph"
-msgstr "Mostrar Gr&aacute;fico"
-
-
-#file "D:\zentrack\zentrack/www/reports/show.php"
-#args ""
-msgid "Show Report"
-msgstr "Mostrar Informe"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Tables"
-msgstr "Mostrar Tablas"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Stack Chart"
-msgstr "Gr&aacute;fico de Bloques"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Start Date"
-msgstr "Fecha de comienzo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Start From Date"
-msgstr "Comenzar en"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Status"
-msgstr "Estado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsSubmit.php"
-#args ""
-msgid "Submit Results"
-msgstr "Enviar Resultados"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Subtitle"
-msgstr "Subt&iacute;tulo"
-
-
-#file "D:\zentrack\zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "System Error"
-msgstr "Error de sistema"
-
-
-#file "D:\zentrack\zentrack/www/admin/addUserSubmit.php"
-#args "array($lname, $fname)"
-msgid "System Error: Could not add ?, ? to the system"
-msgstr "Error de sistema: No es posible a&ntilde;adir ?,? al sistema
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args "array($lname, $fname)"
-msgid "System Error: Could not update ?, ?"
-msgstr "Error de sistema: No es posible actualizar ?, ?"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "System Error: Unable to change user passphrase."
-msgstr "Error de sistema: No es posible modificar la clave del usuario."
-
-
-#file "D:\zentrack\zentrack/www/misc/homebin.php"
-#args ""
-msgid "System Error: Unable to update bin."
-msgstr "Error del sistema: No es posible actualizar el 'bin'"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args ""
-msgid "System Error: could not update access &#151; this is most likely because no bins were set, and no bins previously existed (i.e. nothing happened)"
-msgstr "Error de sistema: no es posible actualizar &#151; puede deberse a que no se establecieron 'bins' y no existian 'bins' previamente (nada ha sido modificado)"
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "System Error: could not update access for user ?"
-msgstr "Error de sistema: No es posible actualizar el nivel de acceso para el usuario ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_systemBox.php"
-#args ""
-msgid "System History"
-msgstr "Hist&orico del sistema"
-
-
-#file "D:\zentrack\zentrack/www/actions/log.php"
-#args ""
-msgid "System error: Activity could not be logged."
-msgstr "Error del sistema: No es posible tracear la actividad del sistema"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args "array($userfile_name, $id)"
-msgid "System error: Attachment ? could not be uploaded for ticket ?. "
-msgstr "Error del sistema: No es posible adjuntar el fichero ? al 'ticket' ?"
-
-
-#file "D:\zentrack\zentrack/www/actions/addToNotify.php"
-#args ""
-msgid "System error: Notify list could not be updated "
-msgstr "Error del sistema: la Lista de Notificaciones no ha podido ser actualizada"
-
-
-#file "D:\zentrack\zentrack/www/actions/accept.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be accepted"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser aceptado"
-
-
-#file "D:\zentrack\zentrack/www/actions/approve.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be approved"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser aprobado"
-
-
-#file "D:\zentrack\zentrack/www/actions/assign.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be assigned"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser sido asignado"
-
-
-#file "D:\zentrack\zentrack/www/actions/close.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be closed"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser cerrado"
-
-
-#file "D:\zentrack\zentrack/www/actions/email.php"
-#args ""
-msgid "System error: Ticket ? could not be emailed", array($id
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser comunicado v&iacute;a e-mail", array($id
-
-
-#file "D:\zentrack\zentrack/www/actions/move.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be moved. "
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser movido."
-
-
-#file "D:\zentrack\zentrack/www/actions/reject.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be rejected"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser rechazado"
-
-
-#file "D:\zentrack\zentrack/www/actions/relate.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be related, or the entries were the same."
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser relacionado, o las entradas son las mismas."
-
-
-#file "D:\zentrack\zentrack/www/actions/reopen.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be reopened."
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser reabierto."
-
-
-#file "D:\zentrack\zentrack/www/actions/test.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be tested"
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser testeado"
-
-
-#file "D:\zentrack\zentrack/www/actions/yank.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be yanked."
-msgstr "Error de sistema: el 'Ticket' ? no ha podido ser desasignado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "System involved in ticket"
-msgstr "Sistema relacionado con 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "System"
-msgstr "Sistema"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "TASKS FOR COMPLETION"
-msgstr "TAREAS A COMPLETAR"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Tasks for this project"
-msgstr "Tareas del proyecto"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Test Ticket"
-msgstr "Testear 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Tested"
-msgstr "Testeado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Testing Required"
-msgstr "Se requiere chequeo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Testing"
-msgstr "Chequeando"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Text"
-msgstr "Texto"
-
-
-#file "D:\zentrack\zentrack/www/misc/homebin.php"
-#args ""
-msgid "That bin doesn't exist"
-msgstr "Este 'bin' no existe"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "That is not a recognized file type, by your browsers determinations"
-msgstr "El navegador no reconoce este tipo de fichero"
-
-
-#file "D:\zentrack\zentrack/www/admin/addUserSubmit.php"
-#args ""
-msgid "That login name already exists.  Please choose another."
-msgstr "El identificador existe. Por favor, elija otro."
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "That login name is in use by another account"
-msgstr "El identificador est&aacute; en uso por otro usuario"
-
-
-#file "D:\zentrack\zentrack/www/reports/custom.php"
-#args ""
-msgid "That temporary report doesn't exist"
-msgstr "El importe temporal no existe"
-
-
-#file "D:\zentrack\zentrack/www/ticket.php"
-#args ""
-msgid "That ticket doesn't exist"
-msgstr "El 'ticket' no existe"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUser.php"
-#args ""
-msgid "That user could not be found"
-msgstr "El usuario no ha sido encontrado"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "The Guest Password cannot be changed!"
-msgstr "La clave de invitado (Guest) no puede ser modificada!"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUser.php"
-#args ""
-msgid "The Root Admin Account can only be modified by the Root Administrator"
-msgstr "La cuenta de Administrador Root &uacute;nicamente puede ser modificada por el Administrador Root"
-
-
-#file "D:\zentrack\zentrack/www/admin/deleteUser.php"
-#args "array($user_id)"
-msgid "The account (?) could not be found/deleted successfully"
-msgstr "La cuenta de usuario (?) no ha podido ser localizada/eliminada correctamente"
-
-
-#file "D:\zentrack\zentrack/www/admin/deleteUser.php"
-#args "array($user_id)"
-msgid "The account(?) was successfully removed"
-msgstr "La cuenta de usuario (?) ha sido eliminada correctamente"
-
-
-#file "D:\zentrack\zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "The action completed successfully.  The account was not actually deleted, because this is a demo site"
-msgstr "La acci&oacute;n se ha completado con &eacute;xito. La cuenta de usuario no se ha eliminado debido a que este es un site de demo"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "The file could not be uploaded "
-msgstr "El fichero no ha podido ser cargado"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args "array(number_format($userfile_size), number_format($max_size))"
-msgid "The file size (?) exceeded the maximum allowed (?)"
-msgstr "El tama&ntilde;o (?) del fichero excede el m&aacute;ximo permitido (?)"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args "array(substr($max_size,0,strlen($max_size)-3))"
-msgid "The file was not recieved. Check to insure it's size does not exceed ?KB"
-msgstr "No se ha recibido el fichero. Cheque&eacute; que su tama&ntilde;no no excede de ?KB"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "The importance of the ticket"
-msgstr "La importancia del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/www/misc/language.php"
-#args ""
-msgid "The language could not be changed to $newlang"
-msgstr "No es posible modificar el idioma a $newlang"
-
-
-#file "D:\zentrack\zentrack/www/misc/language.php"
-#args ""
-msgid "The language file chosen was not valid"
-msgstr "El fichero de idioma elegido no es v&aacute;lido"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "The name of the ticket"
-msgstr "El nombre del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "The name of the user"
-msgstr "El nombre del usuario"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin access cannot be less than the level_settings parameter"
-msgstr "El nivel de acceso del administrador root no puede ser menor que el parametro level_settings"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin account cannot be deactivated"
-msgstr "No es posible desactivar la cuenta de administrador root"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin account must have access of 5 or greater"
-msgstr "El nivel de acceso para el usuario administrador root debe ser al menos 5"
-
-
-#file "D:\zentrack\zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "The root administrator account cannot be deleted"
-msgstr "La cuenta de administrador de root no puede ser eliminada"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "The type of ticket"
-msgstr "El tipo del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the html form."
-msgstr "La longitud del fichero cargado excede la directiva MAX_FILE_SIZE que fu&eacute; especificada en el formulario html."
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file exceeds the upload_max_filesize directive in php.ini."
-msgstr "La longitud del fichero cargado excede la directiva upload_max_filesize del fichero php.ini."
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file was only partially uploaded."
-msgstr "El fichero fu&eacute; cargado solo parcialmente"
-
-
-#file "D:\zentrack\zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "The user passphrase could not be found/edited"
-msgstr "La clave de usuario no puede ser encontrada/editada"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "There are more log entries."
-msgstr "No existen m&aacute;s trazas."
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args ""
-msgid "There is already an entry with that value."
-msgstr "Ya existe un elemento con ese valor"
-
-
-#file "D:\zentrack\zentrack/www/admin/bins.php"
-#args ""
-msgid "There was nothing provided to update"
-msgstr "No hay ning&uacute;n elemento a actualizar"
-
-
-#file "D:\zentrack\zentrack/www/admin/config.php"
-#args ""
-msgid "There were no changes made to the settings.  Procedure skipped."
-msgstr "No se han ralizado cambios sobre los par&aacute;rametros de configuraci&oacute;n. Procedimiento omitido."
-
-
-#file "D:\zentrack\zentrack/www/searchLogs.php"
-#args ""
-msgid "There were no logs matching your search."
-msgstr "No existen ficheros de traza para la b&uacute;squeda solicitada."
-
-
-#file "D:\zentrack\zentrack/www/actions/email.php"
-#args ""
-msgid "There were no recipients"
-msgstr "No existen receptores"
-
-
-#file "D:\zentrack\zentrack/www/admin/listUsers.php"
-#args ""
-msgid "There were no results for your search"
-msgstr "No existen resultados para la b&uacute;squeda solicitada"
-
-
-#file "D:\zentrack\zentrack/www/search.php"
-#args ""
-msgid "There were no results for your search."
-msgstr "No existen resultados para su b&uacute;squeda."
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "These options aren't useful when only graphing one element."
-msgstr "Estas opciones no son &uacute;tiles para gr&aacute;ficos de un &uacute;nico elemento."
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "This could be a long list! Proceed anyways?"
-msgstr "&iexcl;La lista puede ser excesivamente larga! &iquest;Continuar?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "This grants the user the specified level of 
- 	access to all bins not otherwise indicated by 'user access'."
-msgstr "Esto garantiza al usuario el nivel especificado de acceso
-	a todos los 'bins' adem&aacute;s de los indicados por el 'acceso propio de usuario'."
-
-
-#file "D:\zentrack\zentrack/includes/editTicketSubmit.php"
-#args "array($id)"
-msgid "Ticket #? cannot be edited in its current status"
-msgstr "El 'ticket' #? no puede ser editado debido a su estado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/editTicketForm.php"
-#args "array($id)"
-msgid "Ticket #? could not be found"
-msgstr "No se encuentra el 'ticket' #?"
-
-
-#file "D:\zentrack\zentrack/www/actions/action_header.php"
-#args "array($id)"
-msgid "Ticket #?"
-msgstr "'Ticket' #?"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id,$this->formatName($user_id,2))"
-msgid "Ticket #?: Log added by ?"
-msgstr "'Ticket' #?: Traza a&ntilde;dida por ?"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "Ticket #?: assigned to ?"
-msgstr "'Ticket' #?: asignado a ?"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: closed"
-msgstr "'Ticket' #?: cerrado"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: created"
-msgstr "'Ticket' #?: creado"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id,$this->getBinName($newBin))"
-msgid "Ticket #?: moved to ?"
-msgstr "'Ticket' #?: movido a ?"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: rejected"
-msgstr "'Ticket' #?: rechazado"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: reopened"
-msgstr "'Ticket' #?: reabierto"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "Ticket #?: yanked by ?"
-msgstr "'Ticket' #?: desechado por ?"
-
-
-#file "D:\zentrack\zentrack/www/actions/editSubmit.php"
-#args "array($id)"
-msgid "Ticket ? could not edit ticket. "
-msgstr "'Ticket' ? no puede editar el 'ticket'."
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Ticket Administration"
-msgstr "Administraci&oacute;n de 'tickets'"
-
-
-#file "D:\zentrack\zentrack/includes/nav.php"
-#args ""
-msgid "Ticket ID"
-msgstr "Identificador de 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Ticket Information"
-msgstr "Informaci&oacute;n de 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "Ticket Summary")
-msgstr "Resum&eacute;n de 'ticket'")
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "Ticket has been reopened."
-msgstr "El 'ticket' ha sido reabierto."
-
-
-#file "D:\zentrack\zentrack/www/ticket.php"
-#args ""
-msgid "Ticket"
-msgstr "Ticket"
-
-
-#file "D:\zentrack\zentrack/www/assignedTickets.php"
-#args ""
-msgid "Tickets assigned"
-msgstr "'Tickets' asignados"
-
-
-#file "D:\zentrack\zentrack/includes/leftTickets.php"
-#args ""
-msgid "Tickets"
-msgstr "Tickets"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Time"
-msgstr "Tiempo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Title"
-msgstr "T&iacute;tulo"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configForm.php"
-#args "array($type)"
-msgid "To remove a ? from use, uncheck the 'active' box."
-msgstr "Para eliminar un ? de uso, deschequear la selecci&oacute;n 'activo'"
-
-
-#file "D:\zentrack\zentrack/www/actions/print.php"
-#args ""
-msgid "Totals"
-msgstr "Totales"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "Tracker"
-msgstr "Rastreador"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Try using Combine Selected with a very large number of elements, if you intend to view a graphical image."
-msgstr "Use 'Combinar Seleccionados' si quiere ver un gr&aacute;fico cuando el n&uacute;mero de elementos es muy elevado."
-
-
-#file "D:\zentrack\zentrack/www/admin/access.php"
-#args ""
-msgid "Two or more bins were submitted with the same name"
-msgstr "Se han intentado salvar dos o m&aacute;s 'bins' con el mismo nombre"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "Type ids separated by commas, or click on the button."
-msgstr "Escriba los identificadores separados por comas, o pulse el bot&oacute;n."
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Type of ticket"
-msgstr "Tipo del 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Type"
-msgstr "Tipo"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args ""
-msgid "URL"
-msgstr "URL"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Uncheck to disable this account."
-msgstr "Deseleccione para desahabilitar la cuenta."
-
-
-#file "D:\zentrack\zentrack/www/admin/bins.php"
-#args ""
-msgid "Update Bins"
-msgstr "Actualizar 'Bins'"
-
-
-#file "D:\zentrack\zentrack/www/admin/priorities.php"
-#args ""
-msgid "Update Priorities"
-msgstr "Actualizar Prioridades"
-
-
-#file "D:\zentrack\zentrack/www/admin/systems.php"
-#args ""
-msgid "Update Systems"
-msgstr "Actualizar Sistemas"
-
-
-#file "D:\zentrack\zentrack/www/admin/tasks.php"
-#args ""
-msgid "Update Tasks"
-msgstr "Actualizar Tareas"
-
-
-#file "D:\zentrack\zentrack/www/admin/types.php"
-#args ""
-msgid "Update Types"
-msgstr "Actualizar Tipos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Update"
-msgstr "Actualizar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Upload Attachment"
-msgstr "Actualizar Ficheros Adjuntos"
-
-
-#file "D:\zentrack\zentrack/www/actions/upload.php"
-#args ""
-msgid "Uploaded file size 0 bytes"
-msgstr "El fichero cargado contiene 0 bytes"
-
-
-#file "D:\zentrack\zentrack/www/reports/index.php"
-#args ""
-msgid "Usage Reports"
-msgstr "Uso de Informes"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Use zero if unsure."
-msgstr "Indicar 0 si no est&aacute; seguro."
-
-
-#file "D:\zentrack\zentrack/www/admin/addUserSubmit.php"
-#args "array($user_id, "<br><a href='$rootUrl/admin/access.php?user_id=$user_id'>" . tr("Click Here") . "</a>", $user_id)"
-msgid "User ? was added successfully. The password is the last name of the user. ? to customize user ?'s access permissions."
-msgstr "El usuario ? ha sido a&ntilde;adido correctamente. Se ha establecido como clave el apellido del usuario. ? para modificar los permisos de acceso del usuario ?"
-
-
-#file "D:\zentrack\zentrack/www/admin/editUserSubmit.php"
-#args "array($user_id, "<br><a href='$rootUrl/admin/access.php?user_id=$user_id'>" . tr("Click Here") . "</a>", $user_id)"
-msgid "User ? was updated successfully. ? to customize user ?'s access permissions."
-msgstr "El usuario ? ha sido actualizado correctamente. ? para modificar los permisos de acceso del usuario ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "User Administration"
-msgstr "Administraci&oacute;n de Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "User ID"
-msgstr "Identificador de Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "User Information"
-msgstr "Informaci&oacute;n de Usuario"
-
-
-#file "D:\zentrack\zentrack/www/options.php"
-#args ""
-msgid "User Options"
-msgstr "Opciones de Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "User"
-msgstr "Usuario"
-
-
-#file "D:\zentrack\zentrack/www/reports/save.php"
-#args ""
-msgid "User(s)"
-msgstr "Usuario(s)"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users Default Bin"
-msgstr "'Bin' por defecto del Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users Initials"
-msgstr "Iniciales del Usuario"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users System ID"
-msgstr "Identificadores de Usuarios del Sistema"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users email address"
-msgstr "Direcciones de correo de los Usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Value"
-msgstr "Valor"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsSubmit.php"
-#args ""
-msgid "View Chart"
-msgstr "Ver Gr&aacute;ficos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "View Reports"
-msgstr "Ver Informes"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Weeks"
-msgstr "Semanas"
-
-
-#file "D:\zentrack\zentrack/www/index.php"
-#args ""
-msgid "Welcome to zenTrack"
-msgstr "Bienvenido a zenTrack"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "What to Graph"
-msgstr "Informaci&oacute;n a mostrar en el Gr&aacute;fico"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Who the ? belongs to"
-msgstr "A qui&eacute;n pertenece el ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Worked"
-msgstr "Trabajado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Yank Ticket"
-msgstr "Desechar 'Ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Yank"
-msgstr "Desechar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Years"
-msgstr "A&ntilde;os"
-
-
-#file "D:\zentrack\zentrack/www/ticket.php"
-#args ""
-msgid "You are not allowed to view the following in this bin"
-msgstr "No est&aacute; autorizado a visualizar este 'bin'"
-
-
-#file "D:\zentrack\zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "You cannot edit a ticket in this bin "
-msgstr "No puede editar un 'ticket' en este 'bin'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/editTicketForm.php"
-#args ""
-msgid "You cannot edit a ticket in this bin"
-msgstr "No puede editar un 'ticket' en este 'bin'"
-
-
-#file "D:\zentrack\zentrack/www/admin/admin_header.php"
-#args ""
-msgid "You do not have access to administrate zenTrack."
-msgstr "No tiene acceso de administraci&oacute;n en el sistema zenTrack"
-
-
-#file "D:\zentrack\zentrack/includes/templates/searchResults.php"
-#args ""
-msgid "You do not have access to any bins."
-msgstr "No tiene acceso a ning&uacute;n 'bin'"
-
-
-#file "D:\zentrack\zentrack/www/index.php"
-#args ""
-msgid "You do not have access to any existing bins"
-msgstr "No tiene acceso a ning&uacute;n 'bin' existente"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "You do not have permission to create projects."
-msgstr "No tiene permiso para crear proyectos"
-
-
-#file "D:\zentrack\zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "You do not have permission to create tickets in this bin."
-msgstr "No tiene permiso para crear 'tickets' en este 'bin'."
-
-
-#file "D:\zentrack\zentrack/www/reports/reports_header.php"
-#args ""
-msgid "You do not have permission to view the reports."
-msgstr "No tiene permiso para visualizar los informes."
-
-
-#file "D:\zentrack\zentrack/www/helpers/userSearchbox.php"
-#args ""
-msgid "You may use * for a wildcard in any field but the id.. i.e. J* would match anything starting with J"
-msgstr "Utilice * como comod&iacute;n en cualquier campo, por ejemplo, J* seleccionar&aacute; cualquier elemento que comience por J"
-
-
-#file "D:\zentrack\zentrack/www/helpers/ticketSearchbox.php"
-#args ""
-msgid "You may use * for a wildcard in the title or           description.. i.e. J* would match anything starting with J"
-msgstr "Utilice * como comod&iacute;n en el t&iacutetulo o           la descripci&oacute;n, por ejemplo, J* seleccionar&aacute; cualquier elemento que comience por J"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "You may use * for a wildcard in the title or description.. i.e. J* would match anything starting with J"
-msgstr "Utilice * como comod&iacute;n en el t&iacutetulo o la descripci&oacute;n, por ejemplo, J* seleccionar&aacute; cualquier elemento que comience por J"
-
-
-#file "D:\zentrack\zentrack/www/actions/addToNotify.php"
-#args ""
-msgid "You must provide at least one registered user, or a valid name and email address"
-msgstr "Debe indicar al menos un usuario registrado o un nombre y correo electr&oacute;nico v&aacute;lidos"
-
-
-#file "D:\zentrack\zentrack/www/misc/homebin.php"
-#args ""
-msgid "Your bin has been changed to"
-msgstr "Su 'bin' ha sido modificado a"
-
-
-#file "D:\zentrack\zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Your chart has been saved successfully saved with title: $report_name"
-msgstr "Su gr&aacute;fico ha sido salvado con el t&iacute;tulo: $report_name"
-
-
-#file "D:\zentrack\zentrack/www/misc/language.php"
-#args ""
-msgid "Your language has been changed to $newlang"
-msgstr "Su idioma ha sido modificado a $newlang"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your new passphrase must contain at least 1 non-letter character"
-msgstr "Su nueva clave debe contener al menos 1 car&aacute;cter no alfab&eacute;tico"
-
-
-#file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Your passphrase must be at least 6 characters long and 
-     contain at least 1 non-letter character."
-msgstr "Su nueva clave debe ser de al menos 6 caracteres y contener al menos 1 car&aacute;cter no alfab&eacute;tico"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your passphrase must be at least 6 digits long"
-msgstr "Su nueva clave debe ser de al menos 6 caracteres "
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your passwords did not match"
-msgstr "Sus claves no son iguales"
-
-
-#file "D:\zentrack\zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your request was successful, but this is a demo site, so the passphrase was not altered"
-msgstr "Su petici&oacute;n ha sido correcta pero este es un site de demo por lo que la clave no ha sido modificada"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "accepts up to 2 decimal places"
-msgstr "se admiten hasta 2 decimales"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "access"
-msgstr "acceso"
-
-
-#file "D:\zentrack\zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "completed"
-msgstr "completado"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "create an attachment for this ticket"
-msgstr "crear un fichero adjunto para este 'ticket'"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "delete"
-msgstr "borrar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "edit"
-msgstr "editar"
-
-
-#file "D:\zentrack\zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "edit,delete,change access"
-msgstr "editar, borrar, cambiar accesos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "enter a number"
-msgstr "introduzca un n&uacute;mero"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "hold control or shift to select multiple users"
-msgstr "pulse las teclas 'control' o may&uacute;scula para seleccionar varios usuarios"
-
-
-#file "D:\zentrack\zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "less"
-msgstr "menos"
-
-
-#file "D:\zentrack\zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "n/a"
-msgstr "n/a"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no bins"
-msgstr "'bins' no"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no priorities"
-msgstr "prioridades no"
-
-
-#file "D:\zentrack\zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no systems"
-msgstr "sistemas no"
-
-
-#file "D:\zentrack\zentrack/www/helpers/ticketSearchbox.php"
-#args ""
-msgid "no types"
-msgstr "tipos no"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "no"
-msgstr "no"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "none"
-msgstr "ninguno"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "optional"
-msgstr "opcional"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "password"
-msgstr "clave"
-
-
-#file "D:\zentrack\zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "required field missing:"
-msgstr "campo requerido no encontrado:"
-
-
-#file "D:\zentrack\zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "required"
-msgstr "requerido"
-
-
-#file "D:\zentrack\zentrack/www/reports/view.php"
-#args ""
-msgid "required... processing error"
-msgstr "requerido... error de proceso"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "save your changes"
-msgstr "guardar los cambios"
-
-
-#file "D:\zentrack\zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "ticket #?: accepted by ?"
-msgstr "'ticket' #?: aceptado por ?"
-
-
-#file "D:\zentrack\zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "up to two decimal places, optional"
-msgstr "hasta dos decimales, opcional"
-
-
-#file "D:\zentrack\zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "use 4 digit year, time is optional"
-msgstr "indicar el a&ntilde;o con 4 d&iacute;gitos, el tiempo es opcional"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "user ID"
-msgstr "Identificador de usuario"
-
-
-#file "D:\zentrack\zentrack/includes/leftMain.php"
-#args ""
-msgid "version"
-msgstr "versi&oacute;n"
-
-
-#file "D:\zentrack\zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "yes"
-msgstr "s&iacute;"
-
-
-msgid "Account Settings"
-msgstr ""
+# This is the translation template file. It is automatically generated from developers/tr-parser.php
+# If you have any questions on how to create a translation file please direct them to zentrack support
 
+#file "/home/ired/zentrack_2/www/actions/assign.php"
+#args "array($r)"
+msgid " ? is required"
+msgstr " ? es obligatorio"
 
-msgid "Press LESS to remove blank rows"
-msgstr ""
 
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "%"
+msgstr "%"
 
-msgid "Process completed successfully.  Systems were not updated since this is a demo site."
-msgstr ""
 
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args "array($file_type)"
+msgid "'?' is not an allowed file extension - See your systems administrator for more information"
+msgstr "'?' no es un tipo de archivo v&aacute;lido - Consulte a su administrador para m&aacute;s informaci&oacute;n"
 
-msgid "Process completed successfully.  Tasks were not updated since this is a demo site."
-msgstr ""
 
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "(or higher)"
+msgstr "(o superior)"
 
-msgid "Process completed successfully.  Types were not updated since this is a demo site."
-msgstr ""
 
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "* = required"
+msgstr "* = obligatorio"
 
-msgid "System Error: Could not add ?, ? to the system"
-msgstr ""
 
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args ""
+msgid "1 Match"
+msgstr "1 Coincidencia"
 
-msgid "System Error: Could not update ?, ?"
-msgstr ""
 
+#file "/home/ired/zentrack_2/www/actions/close.php"
+#args "array($zen->types[$c['type_id']], $c['id'])"
+msgid "? ? is not completed."
+msgstr "? ? no est&aacute; completo."
 
-msgid "This grants the user the specified level of  	access to all bins not otherwise indicated by 'user access'."
-msgstr ""
 
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args "array($c)"
+msgid "? Matches"
+msgstr "? Coincidencias"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args "array($zen->settings["system_name"])"
+msgid "? Settings"
+msgstr "Configuraciones de ?"
+
+
+#file "/home/ired/zentrack_2/www/admin/bins.php"
+#args "array($j)"
+msgid "? bins were saved to the database. Updates complete"
+msgstr "? 'bins' fueron salvados en la base de datos. Actualizaci&oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/addProjectSubmit.php"
+#args "array(tr('Project'))"
+msgid "? created, but variable fields could not be saved"
+msgstr "? creado, pero los campos customizables no pudieron ser salvados"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorDetails.php"
+#args "array($j)"
+msgid "? elements were saved in the selected behavior. Updates complete"
+msgstr "? elementos fueron salvados en el comportamiento seleccionado. Actualizaci&oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/actions/editSubmit.php"
+#args "array(ucfirst($r))"
+msgid "? is a required field"
+msgstr "? es un campo obligatorio"
+
+
+#file "/home/ired/zentrack_2/includes/parseVarfields.php"
+#args "array(ucfirst(tr($v)))"
+msgid "? is required"
+msgstr "? es obligatorio"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args "array($k)"
+msgid "? must be set to 'on' or 'off'"
+msgstr "Debe asignar 'on' u 'off' a ?"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args "array($k)"
+msgid "? must have a value, use zero instead of a blank"
+msgstr "? debe tener un valor. Utilice cero en lugar de un blanco"
 
-msgid "Your passphrase must be at least 6 characters long and      contain at least 1 non-letter character."
-msgstr ""
 
+#file "/home/ired/zentrack_2/www/admin/editGroupDetails.php"
+#args "array($num, count($elements))"
+msgid "? of ? elements were saved in the selected group. Updates complete"
+msgstr "? de ? elementos fueron salvados en el grupo seleccionado. Actualizaci&oacute;n completa"
 
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args "array($j, count($newparams))"
+msgid "? of ? settings changed were successfully updated"
+msgstr "? de ? configuraciones fueron actualizadas exitosamente"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args "array($num,count($zen->bins))"
+msgid "? open tickets in ? bins"
+msgstr "? tickets abiertos en ? comunidades"
+
+
+#file "/home/ired/zentrack_2/www/admin/priorities.php"
+#args "array($j)"
+msgid "? priorities were saved to the database. Updates complete"
+msgstr "? prioridades fueron salvadas en la base de datos. Actualizaci&oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/admin/systems.php"
+#args "array($j)"
+msgid "? systems were saved to the database. Updates complete"
+msgstr "? sistemas fueron salvados en la base de datos. Actualizaci?oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/admin/tasks.php"
+#args "array($j)"
+msgid "? tasks were saved to the database. Updates complete"
+msgstr "? tareas fueron salvadas en la base de datos. Actualizaci?oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/admin/addGroupSubmit.php"
+#args "array("--link--")"
+msgid "? to customize this group's entries."
+msgstr "? para personalizar el contenido de este grupo"
+
+
+#file "/home/ired/zentrack_2/www/admin/types.php"
+#args "array($j)"
+msgid "? types were saved to the database. Updates complete"
+msgstr "? tipos fueron salvados en la base de datos. Actualizaci?oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/includes/editTicketSubmit.php"
+#args "array(tr($x))"
+msgid "? updated, but variable fields could not be saved"
+msgstr "? actualizado, pero los campos customizables no pudieron ser salvados"
+
+
+#file "/home/ired/zentrack_2/www/admin/editCustom.php"
+#args "array($j)"
+msgid "? variable field definitions were saved to the database. Updates complete"
+msgstr "? definiciones de campos customizables fueron salvadas en la base de datos. Actualizaci?oacute;n completa"
+
+
+#file "/home/ired/zentrack_2/www/actions/addToNotify.php"
+#args "array($u)"
+msgid "? was not a valid user id"
+msgstr "? no era un ID de usuario v&aacute;lido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "A large number of elements will appear better in a line chart, bar charts tend to be more pleasing with smaller numbers."
+msgstr "Una gran cantidad de elementos se ver&aacute; mejor en un gr&aacute;fico de l&iacute;nea. Los gr&aacute;ficos de barras suelen ser m&aacute;s vistosos con n&uacute;meros m&aacute;s peque&ntilde;os"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "ATC"
+msgstr "ATC"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
 msgid "Accept"
-msgstr ""
+msgstr "Aceptar"
+
+
+#file "/home/ired/zentrack_2/www/addSubmit.php"
+#args ""
+msgid "Access Error"
+msgstr "Error de Acceso"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Access"
+msgstr "Acceso"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Account Options"
+msgstr "Opciones de cuenta"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Account Settings"
+msgstr "Configuraci&oacuten de cuenta"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Account is Active"
+msgstr "La cuenta est&aacute; Activa"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogList.php"
+#args ""
+msgid "Action Taken"
+msgstr "Acci&oacute;n Tomada"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogForm.php"
+#args ""
+msgid "Action"
+msgstr "Acci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Actions"
+msgstr "Acciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Active"
+msgstr "Activo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_attachmentsBox.php"
+#args ""
+msgid "Add Attachment"
+msgstr "Adjuntar archivo"
+
+
+#file "/home/ired/zentrack_2/www/admin/addBehaviorSubmit.php"
+#args ""
+msgid "Add Behavior Submit"
+msgstr "Generar nuevo comportamiento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_contactsBox.php"
+#args ""
+msgid "Add Contacts"
+msgstr "Agregar Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Add Item"
+msgstr "Agregar Item"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Add Notify Recipient"
+msgstr "Agregar Destinatario de Notificaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_notifyBox.php"
+#args ""
+msgid "Add Recipient"
+msgstr "Agregar Destinatario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Add a Contact"
+msgstr "Agregar un Contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Add a total figure"
+msgstr "Agregar valor total"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Add an average figure"
+msgstr "Agregar valor promedio"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Add recipients to the notify list for this ticket"
+msgstr "Agregar destinatarios a la lista de notificaci&oacute;n de este ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_tasksBox.php"
+#args ""
+msgid "Add ticket to project"
+msgstr "Agregar un ticket a este proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Add"
+msgstr "Agregar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Address line "
+msgstr "L&iacute;nea de direcci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_titleBox.php"
+#args ""
+msgid "Address"
+msgstr "Direcci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args ""
+msgid "Admin Section"
+msgstr "Secci&oacute;n de Administraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Admin"
+msgstr "Administraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/admin_header.php"
+#args ""
+msgid "Administration"
+msgstr "Administraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Administrative Options"
+msgstr "Opciones Administrativas"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/admin_header.php"
+#args ""
+msgid "Administrator's Manual"
+msgstr "Manual del Administrador"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid "After that, delete the data group."
+msgstr "Luego de eso, elimine el grupo de datos"
+
+
+#file "/home/ired/zentrack_2/www/actions/agreement_edit.php"
+#args ""
+msgid "Agreement #?"
+msgstr "Acuerdo #?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Agreement Information"
+msgstr "Informaci&oacute;n de acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/agreements.php"
+#args ""
+msgid "Agreement list"
+msgstr "Lista de acuerdos"
+
+
+#file "/home/ired/zentrack_2/www/agreement.php"
+#args ""
+msgid "Agreement"
+msgstr "Acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/leftContacts.php"
+#args ""
+msgid "Agreements"
+msgstr "Acuerdos"
+
 
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args "array($user_id)"
+msgid "All bins were removed from access for user ?"
+msgstr "El usuario ? ya no tiene acceso a ninguna comunidad"
 
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "All entries must contain a value."
+msgstr "Todos los registros deben contener un valor."
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "All rules"
+msgstr "Todas las reglas (AND)"
+
+
+#file "/home/ired/zentrack_2/www/admin/addBehaviorSubmit.php"
+#args ""
+msgid "All the fields are required"
+msgstr "Todos los campos son obligatorios"
+
+
+#file "/home/ired/zentrack_2/includes/leftBins.php"
+#args ""
+msgid "All"
+msgstr "Todas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Amount of time worked"
+msgstr "Cantidad de tiempo trabajado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Any fields which are disabled should have the order set to 0"
+msgstr "Los campos deshabilitados deber&iacute;n tener el valor 0 en el campo de ordenamiento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Any rule"
+msgstr "Cualquier regla (OR)"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Any valid date format"
+msgstr "Cualquier formato de fecha v&aacute;lido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Approval Required"
+msgstr "Aprobac. Requerida"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_detailsBox.php"
+#args ""
+msgid "Approval"
+msgstr "Aprobaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
 msgid "Approve"
-msgstr ""
+msgstr "Aprobar"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Archive Tickets"
+msgstr "Pasar Tickets a Hist&oacute;rico"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Are you sure you want to archive this agreement?"
+msgstr "Est&aacute; seguro de que desea mover este acuerdo al archivo hist&oacute;rico?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Are you sure you want to permanently delete this template?"
+msgstr "Est&aacute; seguro de que desea eliminar permanentemente este modelo?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Assign Ticket"
+msgstr "Asignar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Assign the ticket to a new user"
+msgstr "Asignar el ticket a un nuevo usuario"
 
 
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
 msgid "Assign"
-msgstr ""
+msgstr "Asignar"
 
 
-msgid "Bins cannot be destroyed, to maintain data integrity."
-msgstr ""
+#file "/home/ired/zentrack_2/includes/leftTickets.php"
+#args ""
+msgid "Assigned to"
+msgstr "Asignados a"
 
 
-msgid "Changing the Bin Configuration has a large system impact."
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Associate this ticket with others"
+msgstr "Asociar este ticket a otros tickets"
 
 
-msgid "Create"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "Attach"
+msgstr "Adjuntar"
 
 
-msgid "Edit"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/ticket_attachmentsBox.php"
+#args ""
+msgid "Attachment"
+msgstr "Archivo Adjunto"
 
 
-msgid "License"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/ticket_attachmentsBox.php"
+#args "array($page_type,$id)"
+msgid "Attachments on ? #?"
+msgstr "Archivos Adjuntos en ? #?"
 
 
-msgid "Login and passphrase are case sensitive"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Attachments"
+msgstr "Adjuntos"
 
 
-msgid "Notify"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Bar Chart"
+msgstr "Gr&aacute;fico de barras"
 
 
-msgid "Print"
-msgstr ""
+#file "/home/ired/zentrack_2/www/admin/addBehaviorSubmit.php"
+#args "array($NewBehaviorName, 			"--link--", 			$NewBehaviorName)"
+msgid "Behavior ? was added successfully. ? to customize behavior ?'s rules."
+msgstr "El comportamiento ? fue agregado exitosamente. ? para personalizar las reglas del comportamiento ?."
 
 
-msgid "Related"
-msgstr ""
+#file "/home/ired/zentrack_2/www/admin/editBehaviorSubmit.php"
+#args "array($NewBehaviorName,         "--link--",         $NewBehaviorName)"
+msgid "Behavior ? was updated successfully. ? to customize behavior ?'s details."
+msgstr "El comportamiento ? fue actualizado exitosamente. ? para personalizar los detalles del comportamiento ?."
 
 
-msgid "Settings Administration"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Behavior Information"
+msgstr "Informaci&oacute;n del Comportamiento"
 
 
-msgid "Support"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Behavior Name"
+msgstr "Nombre del Comportamiento"
 
 
-msgid "System error: Ticket ? could not be emailed."
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Behaviors let you specify how a field modification would affect other field of the current ticket."
+msgstr "Los comportamientos le permiten especificar c&oacute;mo las modificaciones en un campo afectar&aacute;n otros campos en el mismo ticket"
 
 
-msgid "System error: Ticket ? hours could not be set"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Bin Name"
+msgstr "Nombre de la Comunidad"
 
 
-msgid "Tasks"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Bin ticket is located in"
+msgstr "Comunidad en el que se encuentra el ticket"
 
 
-msgid "Test"
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/listTickets.php"
+#args ""
+msgid "Bin"
+msgstr "Comunidad"
 
 
-msgid "The language could not be changed to ?"
-msgstr ""
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Bin(s)"
+msgstr "Comunidad(es)"
 
 
-msgid "This grants the user the specified level of access to all bins not otherwise indicated by 'user access'."
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Bins and Permissions"
+msgtr "Comunidades y Permisos"
 
 
-msgid "Ticket ? has been reopened."
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Data Types (standard ticket fields)"
+msgtr "Tipos de datos (campos est&aacute;ndar de los tickets)"
 
 
-msgid "To remove a bin from use, uncheck the 'active' box."
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Data Groups"
+msgtr "Grupos de Datos"
 
 
-msgid "Visit the zenTrack development site"
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Behaviors"
+msgtr "Comportamientos"
 
 
-msgid "Welcome"
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Variable Fields (custom ticket fields)"
+msgtr "Campos variables (campos personalizables de los tickets)"
 
 
-msgid "Your language has been changed to ?"
-msgstr ""
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "System Settings"
+msgstr "Configuraciones del Sistema"
 
 
-msgid "Your passphrase must be at least 6 characters long and contain at least 1 non-letter character."
-msgstr ""
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Bins are departments or groups that tickets belong to."
+msgstr "Las Comunidades son departamentos o grupos a los que pertenecen los tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/view_tickets.php"
+#args ""
+msgid "Bins"
+msgstr "Comunidades"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "By Date"
+msgstr "Por Fecha"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "By Parameters"
+msgstr "Por Par&aacute;metros"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "By Text Match"
+msgstr "Por Coincidencia Textual"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "By Text"
+msgstr "Por Texto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid "Cancel the request. DO NOT delete the data group."
+msgstr "Cancelar el pedido. NO BORRAR el grupo de datos."
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Change Default Bin"
+msgstr "Cambiar Comunidad Inicial"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Change Language"
+msgstr "Cambiar Idioma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Change Password"
+msgstr "Cambiar Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Change Password"
+msgtr "Cambiar Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Tutorial"
+msgstr "Tutorial"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "Change User Password"
+msgstr "Cambiar Contrase&ntilde;a de Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/homebinForm.php"
+#args ""
+msgid "Change Your Default Bin"
+msgstr "Cambiar Su Comunidad Inicial"
+
+
+#file "/home/ired/zentrack_2/includes/templates/languageForm.php"
+#args ""
+msgid "Change Your Language"
+msgstr "Cambiar Su Idioma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDataMenu.php"
+#args ""
+msgid "Change"
+msgstr "Cambiar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Changing these settings can have a severe impact on the system.  Please consider this before making modifications."
+msgstr "Cambiar estos valores puede tener un severo impacto en el sistema. Por favor asg&uacute;rese de que est&aacute; haciendo lo correcto."
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Chart Options"
+msgstr "Opciones del Gr&aacute;fico"
+
+
+#file "/home/ired/zentrack_2/www/reports/saveSubmit.php"
+#args ""
+msgid "Chart could not be saved."
+msgstr "El Gr&aacute;fico no pudo ser salvado."
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Choose one of the following options"
+msgstr "Seleccione una de las siguientes opciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid "Choose what to do before data group deletion"
+msgstr "Seleccione qu&eacute; hacer antes de la eliminaci&oacute;n del grupo de datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "Click 'Search' to execute the search"
+msgstr "Presione 'Buscar' para ejecutar la b&uacute;squeda"
+
+
+#file "/home/ired/zentrack_2/includes/templates/homebinForm.php"
+#args ""
+msgid "Click 'Update' to change your default bin"
+msgstr "Presione 'Actualizar' para cambiar su comunidad inicial"
+
+
+#file "/home/ired/zentrack_2/includes/templates/languageForm.php"
+#args ""
+msgid "Click 'Update' to change your language"
+msgstr "Presione 'Actualizar' para cambiar su idioma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args "array($button,$blurb)"
+msgid "Click ? to ?"
+msgstr "Presione ? para ?"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUser.php"
+#args ""
+msgid "Click Here to search for users"
+msgstr "Presione Aqu&iacute; para buscar usuarios"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehavior.php"
+#args ""
+msgid "Click Here to view available behaviors"
+msgstr "Presione Aqu&iacute; para ver los comportamientos disponibles"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroup.php"
+#args ""
+msgid "Click Here to view available groups"
+msgstr "Presione Aqu&iacute; para ver los grupos de datos disponibles"
+
+
+#file "/home/ired/zentrack_2/includes/translations/english.trans"
+#args ""
+msgid "Click Here"
+msgstr "Presione Aqu&iacute;"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Click button to add contact"
+msgstr "Presione el bot&oacute;n para agregar el contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Click button to add recipients"
+msgstr "Presione el bot&oacute;n para agregar los destinatarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Click button to assign relations"
+msgstr "Presione el bot&oacute;n para establecer las relaciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Click button to assign"
+msgstr "Presione el bot&oacute;n para efectuar la asignaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "Click button to close"
+msgstr "Presione el bot&oacute;n para cerrar el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "Click button to create log"
+msgstr "Presione el bot&oacute;n para a&ntilde;adir la entrada al log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/move.php"
+#args ""
+msgid "Click button to move ticket"
+msgstr "Presione el bot&oacute;n para mover el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reopen.php"
+#args ""
+msgid "Click button to open"
+msgstr "Presione el bot&oacute;n para abrir el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reject.php"
+#args ""
+msgid "Click button to reject"
+msgstr "Presione el bot&oacute;n para rechazar el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Click button to send email"
+msgstr "Presione el bot&oacute;n para enviar el e-mail"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/estimate.php"
+#args ""
+msgid "Click button to set estimated hours to completion"
+msgstr "Presione el bot&oacute;n para establecer las horas estimadas para completar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "Click button to upload file and attach to ticket"
+msgstr "Presione el bot&oacute;n para adjuntar un archivo al ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/yank.php"
+#args ""
+msgid "Click button to yank ticket"
+msgstr "Presione el bot&oacute;n para capturar el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Click button to"
+msgstr "Presione el bot&oacute;n para"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "Close Ticket"
+msgstr "Cerrar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "Close"
+msgstr "Cerrar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "Closed"
+msgstr "Cerrado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args "array(strip_tags($report_type))"
+msgid "Combine selected ?s"
+msgstr "Combinar los items seleccionados de ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Commentary"
+msgstr "Comentario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Comments or Instructions"
+msgstr "Comentarios o Instrucciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/move.php"
+#args ""
+msgid "Comments"
+msgstr "Comentarios"
+
+
+#file "/home/ired/zentrack_2/includes/editTicketSubmit.php"
+#args ""
+msgid "Commit Edited Ticket"
+msgstr "Guardado de Cambios en Ticket"
+
+
+#file "/home/ired/zentrack_2/www/addAgreementSubmit.php"
+#args ""
+msgid "Commit New Agreement"
+msgstr "Generar Nuevo Acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/addContactSubmit.php"
+#args ""
+msgid "Commit New Project"
+msgstr "Generar Nuevo Proyecto"
+
+
+#file "/home/ired/zentrack_2/www/addSubmit.php"
+#args ""
+msgid "Commit New Ticket"
+msgstr "Generar Nuevo Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Company"
+msgstr "Compa&ntilde;&iacute;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Company:"
+msgstr "Compa&ntilde;&iacute;a:"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "Compare Field"
+msgstr "Campo de Comparaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "Compare Value"
+msgstr "Valor de Comparaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "Completed"
+msgstr "Completado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Configuration Settings"
+msgstr "Valores de Configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editAgreementForm.php"
+#args "array($id)"
+msgid "Contact #? could not be found"
+msgstr "El contacto #? no pudo ser encontrado"
+
+
+#file "/home/ired/zentrack_2/www/actions/contact_edit.php"
+#args "array($id)"
+msgid "Contact #?"
+msgstr "Contacto #?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Contact Information"
+msgstr "Informaci&oacute;n del Contacto"
+
+
+#file "/home/ired/zentrack_2/www/contacts.php"
+#args ""
+msgid "Contact list - Company"
+msgstr "Lista de contactos - Compa&ntilde;&iacute;a"
+
+
+#file "/home/ired/zentrack_2/www/contacts.php"
+#args ""
+msgid "Contact list - Persons Extern"
+msgstr "Lista de contactos - Personal Externo"
+
+
+#file "/home/ired/zentrack_2/www/contacts.php"
+#args ""
+msgid "Contact list - Persons Intern"
+msgstr "Lista de contactos - Personal Interno"
+
+
+#file "/home/ired/zentrack_2/www/contact.php"
+#args ""
+msgid "Contact"
+msgstr "Contacto"
+
+
+#file "/home/ired/zentrack_2/www/newContact.php"
+#args ""
+msgid "Contacts Administration"
+msgstr "Administraci&oacute;n de Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/editAgreementSubmit.php"
+#args ""
+msgid "Contacts"
+msgstr "Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "Containing"
+msgstr "Conteniendo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Agreement ID"
+msgstr "ID del Acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/addAgreementSubmit.php"
+#args ""
+msgid "Could not create agreement."
+msgstr "No se pudo crear el acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/addContactSubmit.php"
+#args ""
+msgid "Could not create contact."
+msgstr "No se pudo crear el contacto"
+
+
+#file "/home/ired/zentrack_2/www/actions/agreement_edit.php"
+#args ""
+msgid "Could not create item."
+msgstr "No se pudo crear el &iacute;tem"
+
+
+#file "/home/ired/zentrack_2/www/addProjectSubmit.php"
+#args ""
+msgid "Could not create ticket."
+msgstr "No se pudo crear el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Country"
+msgstr "Pa&itilde;s"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "County / State"
+msgstr "Provincia"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Create New Contact"
+msgstr "Crear Nuevo Contacto"
+
+
+#file "/home/ired/zentrack_2/includes/leftTickets.php"
+#args ""
+msgid "Create New"
+msgstr "Crear Nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Create Reports"
+msgstr "Crear reportes"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_tasksBox.php"
+#args ""
+msgid "Create Sub-Project"
+msgstr "Crear Sub-Proyecto"
+
+
+#file "/home/ired/zentrack_2/www/newProject.php"
+#args ""
+msgid "Create a New Project"
+msgstr "Crear un Nuevo Proyecto"
+
+
+#file "/home/ired/zentrack_2/www/newTicket.php"
+#args ""
+msgid "Create a New Ticket"
+msgstr "Crear un Nuevo Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "Create a log entry, or log hours worked"
+msgstr "Crear una entrada de log, o registrar horas trabajadas"
+
+
+#file "/home/ired/zentrack_2/www/newAgreement.php"
+#args ""
+msgid "Create a new Agreement"
+msgstr "Crear un Nuevo Acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/newContact.php"
+#args ""
+msgid "Create a new Contact"
+msgstr "Crear un Nuevo Contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Create a new user account"
+msgstr "Crear una Nueva Cuenta de Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Create new ticket window?"
+msgstr "Incluir en ventana de creaci&oacute;n de tickets?"
+
+
+#file "/home/ired/zentrack_2/includes/leftContacts.php"
+#args ""
+msgid "Create new"
+msgstr "Crear Nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Create"
+msgstr "Crear"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "Created"
+msgstr "Creado"
+
+
+#file "/home/ired/zentrack_2/includes/leftBins.php"
+#args ""
+msgid "Current Bin"
+msgstr "Comunidad Actual"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Current status of the ticket"
+msgstr "Estado actual del ticket"
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args "array($user_id)"
+msgid "Custom Access priviledges updated for user ?"
+msgstr "Privilegios de acceso actualizados para el usuario ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/customGroupDetailsForm.php"
+#args ""
+msgid "Custom Group Details"
+msgstr "Detalles del grupo personalizado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Custom defined fields for tickets."
+msgstr "Campos personalizados para tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Custom"
+msgstr "Personalizados"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "DESCRIPTION"
+msgstr "DESCRIPCION"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupDetailsForm.php"
+#args ""
+msgid "Data Group Details"
+msgstr "Detalles del Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Data Group"
+msgstr "Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid "Data Groups"
+msgstr "Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Data Options"
+msgstr "Opciones de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDataMenu.php"
+#args ""
+msgid "Data Selection"
+msgstr "Selecci&oacute;n de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Data Types"
+msgstr "Tipos de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Data groups are a list created from a data type"
+msgstr "Los Grupos de Datos son listas creadas a partir de un tipo de datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Date Range"
+msgstr "Rango de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogList.php"
+#args ""
+msgid "Date log was created"
+msgstr "Fecha de la entrada en el log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Date of ticket"
+msgstr "Fecha del ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Date"
+msgstr "Fecha"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Dates"
+msgstr "Fechas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Days"
+msgstr "D&iacute;as"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Deadline"
+msgstr "Fecha l&iacute;mite"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Default Access Level"
+msgstr "Nivel de acceso por omisi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Default"
+msgstr "Contenido inicial"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteBehavior.php"
+#args ""
+msgid "Delete Behavior"
+msgstr "Eliminar Comportamiento"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteGroup.php"
+#args ""
+msgid "Delete Data Group"
+msgstr "Eliminar Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Delete Reports"
+msgstr "Eliminar Reportes"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteUser.php"
+#args ""
+msgid "Delete User"
+msgstr "Eliminar Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/customGroupDetailsForm.php"
+#args ""
+msgid "Delete"
+msgstr "Eliminar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Department"
+msgstr "Departamento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "Description of Attachment"
+msgstr "Descripci&oacute;n del Archivo Adjunto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Description"
+msgstr "Descripci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Details"
+msgstr "Detalles"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Details"
+msgtr "Detalles"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Log"
+msgtr "Log"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Notify"
+msgtr "Notificar"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Contacts"
+msgtr "Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Related"
+msgtr "Relaciones"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "Attachments"
+msgtr "Adjuntos"
+
+
+#file "/home/ired/zentrack_2/includes/headerInc.php"
+#args ""
+msgid "System"
+msgstr "Consola"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid "Disable all varfields and behaviors that are currently using this data group."
+msgstr "Deshabilitar todos los campos personalizados y comportamientos que actualmente utilizan este grupo de datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Disabled"
+msgstr "Deshabilitado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Display Values"
+msgstr "Mostrar Valores"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_contactsBox.php"
+#args ""
+msgid "Drop Contacts"
+msgstr "Eliminar Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Drop Items"
+msgstr "Eliminar Items"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_notifyBox.php"
+#args ""
+msgid "Drop Recipients"
+msgstr "Eliminar Destinatarios"
+
+
+#file "/home/ired/zentrack_2/www/reports/drop.php"
+#args ""
+msgid "Drop Template"
+msgstr "Eliminar Modelo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "E-mail"
+msgstr "E-mail"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "ETC"
+msgstr "ETC"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorDetails.php"
+#args ""
+msgid "Edit Behavior Details"
+msgstr "Editar Detalles del Comportamiento"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorSubmit.php"
+#args ""
+msgid "Edit Behavior Submit"
+msgstr "Guardado de Cambios en el Comportamiento"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Edit Behaviors"
+msgstr "Editar Comportamientos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Bins"
+msgstr "Editar Comunidades"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroupDetails.php"
+#args ""
+msgid "Edit Data Group"
+msgstr "Editar Grupos de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Edit Data Groups"
+msgstr "Editar Grupos de Datos"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroupSubmit.php"
+#args ""
+msgid "Edit Group Submit"
+msgstr "Guardado de Cambios en el Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Priorities"
+msgstr "Editar Prioridades"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Edit Settings"
+msgstr "Editar Configuraciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Systems"
+msgstr "Editar Sistemas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Tasks"
+msgstr "Editar Tareas"
+
+
+#file "/home/ired/zentrack_2/www/actions/edit.php"
+#args ""
+msgid "Edit Ticket"
+msgstr "Editar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Edit Tickets"
+msgstr "Editar Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Types"
+msgstr "Editar Tipos de Problema"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "Edit User Submit"
+msgstr "Guardado de Cambios en Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Edit Users"
+msgstr "Editar Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit Users/Access"
+msgstr "Editar Usuarios/Accesos"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Edit Variable Fields"
+msgstr "Editar Campos Personalizados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Edit existing behaviors or create a new one."
+msgstr "Editar comportamientos existentes o crear uno nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid "Edit existing groups or create a new group."
+msgstr "Editar grupos de datos existentes o crear uno nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args "array(ucfirst($type))"
+msgid "Edit the Active ?s"
+msgstr "Editar la lista de items de ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Edit the Available Custom Fields"
+msgstr "Editar los Campos Personalizados Disponibles"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Edit the Behaviors"
+msgstr "Editar los Comportamientos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit the zenTrack settings.  Consult the documentation before using this feature."
+msgstr "Editar la configuraci&oacute;n de zenTrack. Consulte la documentaci&oacute;n antes de utilizar este m&oacute;dulo."
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit ticket information"
+msgstr "Editar el contenido de un ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Edit user accounts and permissions."
+msgstr "Editar cuentas y permisos de usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
+msgid "Edit"
+msgstr "Editar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_titleBox.php"
+#args ""
+msgid "Elapsed"
+msgstr "Tiempo transcurrido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Email Ticket"
+msgstr "Enviar Ticket por E-mail"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Email"
+msgstr "E-mail"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Enabled"
+msgstr "Habilitado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Enter Project Information"
+msgstr "Ingrese Informaci&oacute;n del Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Enter Ticket IDs"
+msgstr "Ingrese los N&uacute;meros de Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/nav.php"
+#args ""
+msgid "Enter a ticket ID and press enter"
+msgstr "Ingrese el n&uacute;mero de ticket y presione enter"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "Enter any hours worked not previously accounted for"
+msgstr "Ingrese las horas trabajadas pero a&uacute;n no registradas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/test.php"
+#args ""
+msgid "Enter hours worked"
+msgstr "Ingrese las horas trabajadas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Enter multiple ids, separated by a comma"
+msgstr "Ingrese los n&uacute;meros de ticket, separados por coma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Enter registered users"
+msgstr "Ingrese usuarios registrados para notificar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "Enter the hours worked for this entry"
+msgstr "Ingrese las horas trabajadas para esta entrada del log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "Enter the names of fields and the corresponding column numbers in the data file here:"
+msgstr "Ingrese los nombres de los campos y la posici&oacute;n de su columna en el archivo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/estimate.php"
+#args ""
+msgid "Enter the number of hours (can contain up to 2 decimal places)"
+msgstr "Ingrese la cantidad de horas (puede incluir hasta 2 posiciones decimales)"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Enter ticket ids, separated by commas"
+msgstr "Ingrese los n&uacute;meros de ticket, separados por coma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid "Entries"
+msgstr "Elementos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Equals"
+msgstr "Es igual a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Equals"
+msgtr "Es igual a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Not equal"
+msgtr "No es igual a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Contains"
+msgtr "Contiene"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Does not contain"
+msgtr "No contiene"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Starts with"
+msgtr "Comienza con"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Ends with"
+msgtr "Termina con"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Greater than"
+msgtr "Es mayor a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Less than"
+msgtr "Es menor a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Greater than or equal"
+msgtr "Es mayor o igual a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Less than or equal"
+msgtr "Es menor o igual a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Evaluate"
+msgstr "Evaluar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Est Hrs"
+msgstr "Hrs Est"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/estimate.php"
+#args ""
+msgid "Estimate Ticket Hours"
+msgstr "Horas Estimadas del Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Estimated Hours to Complete"
+msgstr "Horas Estimadas para Completar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_detailsBox.php"
+#args ""
+msgid "Estimated Hours"
+msgstr "Horas Estimadas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Estimated time to complete"
+msgstr "Tiempo estimado para completar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid "Eval Script"
+msgstr "Script de Evaluaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid "Eval Type"
+msgstr "Tipo de Evaluaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "Expiration Date"
+msgstr "Fecha de Expiraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_titleBox.php"
+#args ""
+msgid "Fax no"
+msgstr "Nro de Fax"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Field Label"
+msgstr "Etiqueta del Campo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Field Name"
+msgstr "Nombre del Campo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Field State"
+msgstr "Estado del Campo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Field is enabled"
+msgstr "El campo queda habilitado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Field to change"
+msgstr "Campo a modificar"
+
+
+#file "/home/ired/zentrack_2/includes/editCustomSubmit.php"
+#args ""
+msgid "Fields updated successfully"
+msgstr "Campos actualizados exitosamente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "First Name"
+msgstr "Nombre"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "First name"
+msgstr "Nombre"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "Global"
+msgstr "Global"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Greater Than"
+msgstr "Es mayor a"
+
+
+#file "/home/ired/zentrack_2/www/admin/addGroupSubmit.php"
+#args "array($NewGroupName)"
+msgid "Group '?' was updated successfully."
+msgstr "El Grupo '?' fue actualizado con &eacute;xito"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid "Group Information"
+msgstr "Informaci&oacute;n del Grupo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid "Group Name"
+msgstr "Nombre del Grupo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Group to apply"
+msgstr "Grupo a aplicar"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Help Menu"
+msgstr "Men&uacute; de Ayuda"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Home Bin"
+msgstr "Comunidad Inicial"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Home"
+msgstr "Com.Inic."
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_detailsBox.php"
+#args ""
+msgid "Hours Worked"
+msgstr "Horas Trabajadas"
+
+
+#file "/home/ired/zentrack_2/www/actions/log.php"
+#args ""
+msgid "Hours must be entered if the activity is 'LABOR'"
+msgstr "Es obligatorio ingresar la cantidad de horas cuando la actividad es 'LABOR'"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Hours"
+msgstr "Horas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args "array($page_type)"
+msgid "ID of the ?"
+msgstr "ID del ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "ID of the agreement"
+msgstr "ID del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "ID of the contact"
+msgstr "ID del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "ID of the ticket"
+msgstr "ID del ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "ID"
+msgstr "ID"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args "array($link)"
+msgid "If this is your first time logging in, please read the ?!"
+msgstr "Si es la primera vez que ingresa, por favor lea el ?!"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Image Type"
+msgstr "Tipo de Im&aacute;gen"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Image"
+msgstr "Im&aacute;gen"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args "array($page_type)"
+msgid "Importance of the ?"
+msgstr "Importancia del ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "In any of these"
+msgstr "En cualquiera de estos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Info"
+msgstr "Info"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "Initials"
+msgstr "Iniciales"
+
+
+#file "/home/ired/zentrack_2/www/ticket.php"
+#args "array(tr($page_type))"
+msgid "Invalid ? id requested"
+msgstr "El id ? solicitado es inv&aacute;lido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Is this field required?"
+msgstr "Es &eacute;ste un campo obligatorio?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupDetailsForm.php"
+#args ""
+msgid "Item"
+msgstr "Item"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Items"
+msgstr "Items"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Jobtitle"
+msgstr "Cargo"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "LOG"
+msgstr "LOG"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Last Name"
+msgstr "Apellido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "Last name"
+msgstr "Apellido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Less Than"
+msgstr "Es menor a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Less"
+msgstr "Restar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Level"
+msgstr "Nivel"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Line Chart"
+msgstr "Gr&aacute;fico de L&iacute;neas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "List All Users"
+msgstr "Listar Todos los Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Lists"
+msgstr "Listados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Location"
+msgstr "Localidad"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Log History")
+msgstr "Historia de Log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_attachmentsBox.php"
+#args ""
+msgid "Log ID"
+msgstr "ID de Log"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "Log Off"
+msgstr "Cerrar Sesi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "Log On"
+msgstr "Inicio de Sesi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "Log"
+msgstr "Log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Login Name"
+msgstr "Nombre de Sesi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/index.php"
+#args ""
+msgid "Main Menu"
+msgstr "Men&uacute; Principal"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Make Visible To"
+msgstr "Hacer Visible Para"
+
+
+#file "/home/ired/zentrack_2/www/reports/projectSearchbox.php"
+#args ""
+msgid "Make search of projects that returns comma delimited list"
+msgstr "Hacer que la b&uacute;squeda de proyectos devuelva una lista delimitada por comas"
+
+
+#file "/home/ired/zentrack_2/www/reports/ticketSearchbox.php"
+#args ""
+msgid "Make ticket search that returns comma delimited list"
+msgstr "Hacer que la b&uacute;squeda de tickets devuelva una lista delimitada por comas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Manage Reports"
+msgstr "Administrar Reportes"
+
+
+#file "/home/ired/zentrack_2/includes/leftHelp.php"
+#args ""
+msgid "Manual"
+msgstr "Manual"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Master Project"
+msgstr "Proyecto Maestro"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorForm.php"
+#args ""
+msgid "Match Type"
+msgstr "Tipo de Coincidencia"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogList.php"
+#args "array($first,$last,$zen->total_records)"
+msgid "Matches ?-? of ?"
+msgstr "Coincidencias ?-? de ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogForm.php"
+#args ""
+msgid "Maximum Age"
+msgstr "Antig&#0252;edad M&aacute;xima"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Mobile no"
+msgstr "Celular"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "Mobile"
+msgstr "Celular"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Modify Existing"
+msgstr "Modificar Versi&oacute;n Existente"
+
+
+#file "/home/ired/zentrack_2/www/reports/view.php"
+#args ""
+msgid "Modify Report"
+msgstr "Modificar Reporte"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Modify Reports"
+msgstr "Modificar Reportes"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args ""
+msgid "Modify Search"
+msgstr "Modificar B&uacute;squeda"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "Modify"
+msgstr "Modificar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Months"
+msgstr "Meses"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "More"
+msgstr "M&aacute;s"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Most Current"
+msgstr "M&aacute;s Actuales"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/move.php"
+#args ""
+msgid "Move Ticket"
+msgstr "Mover Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid "Move all of it's references to"
+msgstr "Mover todas sus referencias a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/move.php"
+#args ""
+msgid "Move"
+msgstr "Mover"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args "array($page_type)"
+msgid "Name of the ?"
+msgstr "Nombre del ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Name"
+msgstr "Nombre"
+
+
+#file "/home/ired/zentrack_2/www/newContact.php"
+#args ""
+msgid "New Company"
+msgstr "Nueva Compa&ntilde;&iacute;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/homebinForm.php"
+#args ""
+msgid "New Default Bin"
+msgstr "Nueva Comunidad Inicial"
+
+
+#file "/home/ired/zentrack_2/www/admin/addGroupSubmit.php"
+#args ""
+msgid "New Group Submit"
+msgstr "Guardado de Nuevo Grupo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/languageForm.php"
+#args ""
+msgid "New Language"
+msgstr "Nuevo Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "New Password"
+msgstr "Nueva Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/www/newContact.php"
+#args ""
+msgid "New Person"
+msgstr "Nueva Persona"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "New Report"
+msgstr "Nuevo Reporte"
+
+
+#file "/home/ired/zentrack_2/includes/leftSearch.php"
+#args ""
+msgid "New Search"
+msgstr "Nueva B&uacute;squeda"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "New Template"
+msgstr "Nuevo Modelo"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "New User"
+msgstr "Nuevo Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "New"
+msgstr "Nuevo"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "No Log Entries"
+msgstr "No hay Entradas de Log"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "No Related Tickets"
+msgstr "No hay Tickets Relacionados"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "No Tasks Assigned to this Project"
+msgstr "No hay Tareas Asignadas a este Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_attachmentsBox.php"
+#args "array($page_type)"
+msgid "No attachments exist for this ?"
+msgstr "No existen adjuntos para este ?"
+
+
+#file "/home/ired/zentrack_2/www/actions/log.php"
+#args ""
+msgid "No comments were entered."
+msgstr "No se ingresaron comentarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_!19Box.php"
+#args ""
+msgid "No contacts in this section."
+msgstr "No hay contactos en esta secci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/actions/dropFromContacts.php"
+#args ""
+msgid "No contacts were selected to drop"
+msgstr "No se seleccionaron contactos para eliminar"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "No file was uploaded."
+msgstr "No se transfiri&oacute; ning&uacute;n archivo"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "No logs found"
+msgstr "No se encontraron logs"
+
+
+#file "/home/ired/zentrack_2/www/actions/dropFromNotify.php"
+#args ""
+msgid "No recipients were selected to drop"
+msgstr "No se seleccionaron destinatarios para eliminar"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args ""
+msgid "No settings were recieved"
+msgstr "No se recibi&oacute; ninguna configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_tasksBox.php"
+#args ""
+msgid "No tickets have been added to this Project."
+msgstr "No se agregaron tickets a este Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_relatedBox.php"
+#args ""
+msgid "No tickets have been associated with this ticket."
+msgstr "Este ticket no tiene otros tickets asociados"
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args ""
+msgid "No user id was recieved"
+msgstr "No se recibi&oacute; ning&uacute;n ID de usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContactResults.php"
+#args ""
+msgid "No valid fields were provided to conduct a search"
+msgstr "No se han suministrado los datos necesarios para realizar una b&uacute;squeda"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "No"
+msgstr "No"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Normal"
+msgstr "Normal"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "Not Required"
+msgstr "No Requerido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Note"
+msgstr "Nota"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "Notes"
+msgstr "Notas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_notifyBox.php"
+#args ""
+msgid "Notify List"
+msgstr "Lista de Notificaciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_box.php"
+#args ""
+msgid "Notify"
+msgstr "Notificaciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "Nr"
+msgstr "Nr"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Numbers"
+msgstr "N&uacute;meros"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "OR manually enter email addresses, seperated by commas"
+msgstr "O -exclusivo- ingrese manualmente direcciones de correo, separadas por coma"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Off"
+msgstr "Desactivado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Office"
+msgstr "Oficina"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "On"
+msgstr "Activado"
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args ""
+msgid "Only the root administrator can change the root administrator's passphrase"
+msgstr "Solamente el Administrador Principal puede cambiar su contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reopen.php"
+#args ""
+msgid "Open ticket closed in error"
+msgstr "Abrir tickets que se cerraron por error"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets.php"
+#args ""
+msgid "Opened"
+msgstr "Abierto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "Operator"
+msgstr "Operador"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Optional.  Use control or shift to select multiples"
+msgstr "Opcional. Utilice la tecla Ctrl o May&uacute;sc para seleccionar m&aacute;s de uno"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Optional. You do not need to select yourself"
+msgstr "Opcional. No es necesario que se marque a Ud. mismo"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "Options"
+msgstr "Opciones"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Or Person:"
+msgstr "O Personas:"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Or add a contact"
+msgstr "O agregue un contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/notify.php"
+#args ""
+msgid "Or add an unregistered user"
+msgstr "O agregue un usuario no registrado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Order"
+msgstr "Orden"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Other Fields"
+msgstr "Otros Campos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets.php"
+#args ""
+msgid "Owner"
+msgstr "Responsable"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "P.O. Box"
+msgstr "Casilla Postal"
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args "array($user_id)"
+msgid "Password reset to the default [user's last name] for user ?"
+msgstr "Se ha reiniciado al apellido la contrase&ntilde;a del usuario ?"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Password successfully changed"
+msgstr "La contrase&ntilde;a ha sido cambiada exitosamente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Percent completed"
+msgstr "Porcentaje completado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args "array($v['behavior_id'])"
+msgid "Permanently remove behavior ??"
+msgstr "Eliminar permanentemente el comportamiento ??"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args "array($u["user_id"])"
+msgid "Permanently remove user ??"
+msgstr "Eliminar permanentemente el usuario ??"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Person ticket is assigned to"
+msgstr "Persona a la que se asigna el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Person"
+msgstr "Persona"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsTypeMenu.php"
+#args ""
+msgid "Pick a type"
+msgstr "Seleccione un tipo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Pie Chart"
+msgstr "Gr&aacute;fico de torta"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Please correct the following errors:"
+msgstr "Por favor corrija los siguientes errores:"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editTicketForm.php"
+#args ""
+msgid "Please enter a ticket ID"
+msgstr "Por favor ingrese el ID del ticket"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Please fill in both of the fields"
+msgstr "Por favor complete ambos campos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "Please keep track of your new passphrase."
+msgstr "Por favor no olvide su nueva contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Please log in to view the entire ticket."
+msgstr "Por favor inicie su sesi&oacute;n para ver el ticket completo."
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args "array($str)"
+msgid "Please refer to the ? before using this feature"
+msgstr "Por favor consulte la ? antes de usar esta caracter&iacute;stica"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args "array($lnk)"
+msgid "Please refer to the ? for more information."
+msgstr "Por favor consulte la ? para m&aacute;s informaci&oacute;n."
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContactForm.php"
+#args ""
+msgid "Postal Code(Zip)"
+msgstr "C&oacute;digo Postal"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Press 'Reset' to restore the original values."
+msgstr "Presione 'Restaurar' para recuperar los valores originales."
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Press 'Save' when you are sure that the values are correct."
+msgstr "Presione 'Guardar' cuando est&eacute; seguro de que los valores son correctos."
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Press LESS to remove blank fields"
+msgstr "Presione RESTAR para eliminar los campos en blanco"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Press LESS to remove blank rows"
+msgstr "Presione RESTAR para eliminar los registros en blanco"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Press MORE to add more custom fields"
+msgstr "Presione AGREGAR para a&ntilde;adir m&aacute;s campos personalizados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Press MORE to create new rows"
+msgstr "Presione AGREGAR para crear nuevos registros"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Press Reset to return to original values"
+msgstr "Presione Restaurar para recuperar los valores originales"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Press Reset to return to users existing values"
+msgstr "Presione Restaurar para volver a los valores pre-existentes"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Press Save to save changes"
+msgstr "Presione Guardar para almacenar los cambios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Press Update to save changes"
+msgstr "Presione Actualizar para almacenar los cambios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets.php"
+#args ""
+msgid "Pri"
+msgstr "Pri"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
+msgid "Print"
+msgstr "Imprimir"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Priorities represent the importance of an issue."
+msgstr "Las Prioridades representan la importancia de una solicitud"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Priority"
+msgstr "Prioridad"
+
+
+#file "/home/ired/zentrack_2/www/admin/addUserSubmit.php"
+#args ""
+msgid "Process completed successfully.  Account not added, because this is a demo site"
+msgstr "Proceso finalizado satisfactoriamente. La cuenta no fue agregada porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/bins.php"
+#args ""
+msgid "Process completed successfully.  Bins were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Las Comunidades no fueron actualizadas porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editCustom.php"
+#args ""
+msgid "Process completed successfully.  Changes were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los cambios no fueron realizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args ""
+msgid "Process completed successfully.  No changes were made because this is a demo site"
+msgstr "Proceso finalizado satisfactoriamente. Los cambios no fueron realizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args ""
+msgid "Process completed successfully.  No changes were made, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los cambios no fueron realizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/priorities.php"
+#args ""
+msgid "Process completed successfully.  Priorities were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Las Prioridades no fueron actualizadas porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/systems.php"
+#args ""
+msgid "Process completed successfully.  Systems were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los Sistemas no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/tasks.php"
+#args ""
+msgid "Process completed successfully.  Tasks were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Las Tareas no fueron actualizadas porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/types.php"
+#args ""
+msgid "Process completed successfully.  Types were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los Tipos de Problema no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorDetails.php"
+#args ""
+msgid "Process completed successfully. Behaviors were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los Comportamientos no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroupDetails.php"
+#args ""
+msgid "Process completed successfully. Groups were not updated since this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los Grupos de Datos no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args ""
+msgid "Process completed successfully. No privileges were changed, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. Los Provilegios no fueron modificados porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/addBehaviorSubmit.php"
+#args ""
+msgid "Process successful.  Behavior was not added, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. El Comportamiento no fue agregado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorSubmit.php"
+#args ""
+msgid "Process successful.  Behavior was not updated, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. El Comportamiento no fue actualizado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/addGroupSubmit.php"
+#args ""
+msgid "Process successful.  Group was not added, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. El Grupo de Datos no fue agregado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroupSubmit.php"
+#args ""
+msgid "Process successful.  Group was not updated, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. El Grupo de Datos no fue actualizado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "Process successful.  User was not updated, because this is a demo site."
+msgstr "Proceso finalizado satisfactoriamente. El Usuario no fue actualizado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/reports/show.php"
+#args ""
+msgid "Processing Error: Report ID Missing"
+msgstr "Error de Procesamiento: ID del Reporte Falta"
+
+
+#file "/home/ired/zentrack_2/www/reports/saveSubmit.php"
+#args ""
+msgid "Processing error: tempid not found\n"
+msgstr "Error de Procesamiento: tempid no encontrado\n"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Processing error: template not found."
+msgstr "Error de Procesamiento: Modelo no encontrado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsTypeMenu.php"
+#args ""
+msgid "Project ID"
+msgstr "ID del Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Project"
+msgstr "Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/leftTickets.php"
+#args ""
+msgid "Projects"
+msgstr "Proyectos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/yank.php"
+#args ""
+msgid "Pull ticket from the current owner"
+msgstr "Tomar como propio el ticket de otra persona"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "RELATED TICKETS"
+msgstr "TICKETS RELACIONADOS"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Range"
+msgstr "Rango"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "Read-only"
+msgstr "S&oacute;lo-Lectura"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "Really log out of zenTrack?"
+msgstr "Realmente desea desconectarse de zenTrack?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reject.php"
+#args ""
+msgid "Reason"
+msgstr "Motivo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reject.php"
+#args ""
+msgid "Reject Ticket"
+msgstr "Rechazar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reject.php"
+#args ""
+msgid "Reject"
+msgstr "Rechazar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Relate Ticket"
+msgstr "Relacionar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/relate.php"
+#args ""
+msgid "Relate"
+msgstr "Relacionar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_relatedBox.php"
+#args "array($page_type)"
+msgid "Related ?s"
+msgstr "Lista de ?s Relacionados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_contactsBox.php"
+#args "array($page_type)"
+msgid "Related Contacts"
+msgstr "Contactos Relacionados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Related Tickets"
+msgstr "Tickets Relacionados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_box.php"
+#args ""
+msgid "Related"
+msgstr "Relacionados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/optionsMenu.php"
+#args ""
+msgid "Remember My Password"
+msgstr "Recordar mi contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reopen.php"
+#args ""
+msgid "Reopen Ticket"
+msgstr "Reabrir Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reopen.php"
+#args ""
+msgid "Reopen"
+msgstr "Reabrir"
+
+
+#file "/home/ired/zentrack_2/www/reports/drop.php"
+#args ""
+msgid "Report Deleted"
+msgstr "Reporte Eliminado"
+
+
+#file "/home/ired/zentrack_2/www/reports/custom.php"
+#args ""
+msgid "Report ID not found"
+msgstr "ID del Reporte no encontrado"
+
+
+#file "/home/ired/zentrack_2/www/reports/saveSubmit.php"
+#args ""
+msgid "Report Name is required"
+msgstr "El Nombre del Reporte es necesario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsTypeMenu.php"
+#args ""
+msgid "Report Type"
+msgstr "Tipo de Reporte"
+
+
+#file "/home/ired/zentrack_2/includes/leftReports.php"
+#args ""
+msgid "Reports"
+msgstr "Reportes"
+
+
+#file "/home/ired/zentrack_2/www/addSubmit.php"
+#args ""
+msgid "Required field missing:"
+msgstr "Falta campo obligatorio:"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Required"
+msgstr "Obligatorio"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Requirements"
+msgstr "Solicitudes"
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args ""
+msgid "Reset Password"
+msgstr "Restaurar Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args "array($u["user_id"])"
+msgid "Reset the password for user ??"
+msgstr "Restaurar la contrase&ntilde;a para el usuario ??"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Reset"
+msgstr "Resturar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/reject.php"
+#args ""
+msgid "Return ticket to sender"
+msgstr "Devolver el ticket a su creador"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "Retype New Password"
+msgstr "Repita la Nueva Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Role"
+msgstr "Rol"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Save Report"
+msgstr "Guardar Reporte"
+
+
+#file "/home/ired/zentrack_2/www/reports/saveSubmit.php"
+#args ""
+msgid "Save Submit"
+msgstr "Operaci&oacute;n de Guardado"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Save Template"
+msgstr "Guardar Modelo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "Save"
+msgstr "Guardar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Scatter Chart"
+msgstr "Gr&aacute;fico de Dispersi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/searchContacts.php"
+#args ""
+msgid "Search Contacts"
+msgstr "Buscar Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogForm.php"
+#args ""
+msgid "Search For Logs"
+msgstr "Buscar En Logs"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "Search For Tickets"
+msgstr "Buscar En Cabeceras de Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Search For Users"
+msgstr "Buscar Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/leftSearch.php"
+#args ""
+msgid "Search Logs"
+msgstr "Buscar Logs"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "Search Projects"
+msgstr "Buscar Proyectos"
+
+
+#file "/home/ired/zentrack_2/www/search.php"
+#args ""
+msgid "Search Tickets"
+msgstr "Buscar Tickets"
+
+
+#file "/home/ired/zentrack_2/www/helpers/userSearchbox.php"
+#args ""
+msgid "Search Users"
+msgstr "Buscar Usuarios"
+
+
+#file "/home/ired/zentrack_2/www/admin/listUsers.php"
+#args ""
+msgid "Search for Users"
+msgstr "Buscar Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContactForm.php"
+#args ""
+msgid "Search in agreements"
+msgstr "Buscar en Acuerdos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContactForm.php"
+#args ""
+msgid "Search in company"
+msgstr "Buscar en Compa&ntilde;&iacute;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContactForm.php"
+#args ""
+msgid "Search in items"
+msgstr "Buscar en Items"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContactForm.php"
+#args ""
+msgid "Search in persons"
+msgstr "Buscar en Personas"
+
+
+#file "/home/ired/zentrack_2/includes/leftContacts.php"
+#args ""
+msgid "Search"
+msgstr "Buscar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Searches"
+msgstr "B&uacute;squedas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDataMenu.php"
+#args "array($zen->ffv($report_type))"
+msgid "Select ?s"
+msgstr "Seleccionar ?s"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "Select Projects"
+msgstr "Seleccionar Proyectos"
+
+
+#file "/home/ired/zentrack_2/www/helpers/ticketSearchbox.php"
+#args ""
+msgid "Select Tickets"
+msgstr "Seleccionar Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "Select a Recipient"
+msgstr "Seleccionar un Destinatario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Select a User"
+msgstr "Seleccionar un Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "Select a contact"
+msgstr "Seleccionar un contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "Select a file to upload"
+msgstr "Seleccionar un archivo para transferir"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "Select an activity"
+msgstr "Seleccionar una actividad"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "Select more than one by using control or shift"
+msgstr "Seleccionar m&aacute;s de uno con ayuda de las teclas May&uacute;sc &oacute; Control"
+
+
+#file "/home/ired/zentrack_2/includes/templates/customGroupDetailsForm.php"
+#args ""
+msgid "Select the items that will appear in this group and their order."
+msgstr "Seleccione los &iacute;tems que aparecer&aacute;n en este grupo y su orden."
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "Select"
+msgstr "Seleccionar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Send a link to this ticket only"
+msgstr "Env&iacute;e solamente un v&iacute;nculo a este ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Send a summary of the ticket"
+msgstr "Env&iacute;e un resumen del ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Send a summary, and the ticket's log"
+msgstr "Env&iacute;e el resumen, y el log del ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/move.php"
+#args ""
+msgid "Send ticket to another bin"
+msgstr "Trasladar el ticket a otra comunidad"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "Send ticket to specified recipients"
+msgstr "Enviar el ticket a los destinatarios especificados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args "array($zen->formatName($user_id))"
+msgid "Set Access for ?"
+msgstr "Establecer Acceso para ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "Set Password"
+msgstr "Establecer Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "Set status to closed/pending"
+msgstr "Modificar el estado a cerrado/pendiente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/test.php"
+#args ""
+msgid "Set testing to completed on ticket"
+msgstr "Marcar el testeo como completado en el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/estimate.php"
+#args ""
+msgid "Set the expected hours this ticket will take to complete"
+msgstr "Establecer la cantidad de horas que se estima trabajar para completar este ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/estimate.php"
+#args ""
+msgid "Set"
+msgstr "Establecer"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Settings Administration"
+msgstr "Administraci&oacute;n de Configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/leftAdmin.php"
+#args ""
+msgid "Settings"
+msgstr "Configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "Show All Users"
+msgstr "Mostrar Todos los Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Show Both"
+msgstr "Mostrar Ambos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Show Graph"
+msgstr "Mostrar Gr&aacute;fico"
+
+
+#file "/home/ired/zentrack_2/www/reports/show.php"
+#args ""
+msgid "Show Report"
+msgstr "Mostrar Reporte"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Show Tables"
+msgstr "Mostrar Tablas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Show in custom tab?"
+msgstr "Mostrar en solapa de campos personalizados?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Show in detail tab?"
+msgstr "Mostrar en solapa de detalle?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupDetailsForm.php"
+#args ""
+msgid "Show"
+msgstr "Mostrar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "Sort Order"
+msgstr "Orden"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Stack Chart"
+msgstr "Gr&aacute;fico de Pila"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreement_box.php"
+#args ""
+msgid "Start Date"
+msgstr "Fecha de Inicio"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Start From Date"
+msgstr "Iniciar Desde la Fecha"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Status"
+msgstr "Estado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsSubmit.php"
+#args ""
+msgid "Submit Results"
+msgstr "Generar Resultados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Subtitle"
+msgstr "Subt&iacute;tulo"
+
+
+#file "/home/ired/zentrack_2/includes/editAgreementSubmit.php"
+#args ""
+msgid "System Error"
+msgstr "Error del Sistema"
+
+
+#file "/home/ired/zentrack_2/www/admin/addGroupSubmit.php"
+#args "array($NewGroupName)"
+msgid "System Error: Could not add ? to the system"
+msgstr "Error del Sistema: No se pudo agregar ? al sistema"
+
+
+#file "/home/ired/zentrack_2/www/admin/addBehaviorSubmit.php"
+#args "array($NewBehaviorName)"
+msgid "System Error: Could not add ?"
+msgstr "Error del Sistema: No se pudo agregar ?"
+
+
+#file "/home/ired/zentrack_2/www/admin/addUserSubmit.php"
+#args "array($lname, $fname)"
+msgid "System Error: Could not add ?, ? to the system"
+msgstr "Error del Sistema: No se pudo agregar ?, ? al sistema"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehaviorSubmit.php"
+#args "array($NewBehaviorName)"
+msgid "System Error: Could not update ?"
+msgstr "Error del Sistema: No se pudo actualizar ?"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args "array($lname, $fname)"
+msgid "System Error: Could not update ?, ?"
+msgstr "Error del Sistema: No se pudo actualizar ?, ?"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "System Error: Unable to change user passphrase."
+msgstr "Error del Sistema: No se pudo cambiar la contrase&ntilde; del usuario"
+
+
+#file "/home/ired/zentrack_2/www/misc/homebin.php"
+#args ""
+msgid "System Error: Unable to update bin."
+msgstr "Error del Sistema: No se pudo actualizar la comunidad."
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args ""
+msgid "System Error: could not update access &#151; this is most likely because no bins were set, and no bins previously existed (i.e. nothing happened)"
+msgstr "Error del Sistema: No se pudo actualizar el acceso. Esto seguramente se debe a que no existen (ni existieron) comunidades"
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args "array($user_id)"
+msgid "System Error: could not update access for user ?"
+msgstr "Error del Sistema: No se pudo actualizar el acceso para el usuario ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_systemBox.php"
+#args ""
+msgid "System History"
+msgstr "Historial de Consola"
+
+
+#file "/home/ired/zentrack_2/www/actions/log.php"
+#args ""
+msgid "System error: Activity could not be logged."
+msgstr "Error del Sistema: La actividad no pudo ser registrada en el log"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args "array($userfile_name, $id)"
+msgid "System error: Attachment ? could not be uploaded for ticket ?. "
+msgstr "Error del Sistema: El adjunto ? no pudo ser transferido para el ticket ?"
+
+
+#file "/home/ired/zentrack_2/www/actions/addToNotify.php"
+#args ""
+msgid "System error: Notify list could not be updated "
+msgstr "Error del Sistema: La lista de notificaciones no pudo ser actualizada "
+
+
+#file "/home/ired/zentrack_2/www/actions/accept.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be accepted"
+msgstr "Error del Sistema: El ticket ? no pudo ser aceptado"
+
+
+#file "/home/ired/zentrack_2/www/actions/approve.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be approved"
+msgstr "Error del Sistema: El ticket ? no pudo ser aprobado"
+
+
+#file "/home/ired/zentrack_2/www/actions/assign.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be assigned"
+msgstr "Error del Sistema: El ticket ? no pudo ser asignado"
+
+
+#file "/home/ired/zentrack_2/www/actions/close.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be closed"
+msgstr "Error del Sistema: El ticket ? no pudo ser cerrado"
+
+
+#file "/home/ired/zentrack_2/www/actions/move.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be moved. "
+msgstr "Error del Sistema: El ticket ? no pudo ser movido. "
+
+
+#file "/home/ired/zentrack_2/www/actions/reject.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be rejected"
+msgstr "Error del Sistema: El ticket ? no pudo ser rechazado"
+
+
+#file "/home/ired/zentrack_2/www/actions/relate.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be related, or the entries were the same."
+msgstr "Error del Sistema: El ticket ? no pudo ser relacionado, o se trata de una referencia a s&iacute; mismo."
+
+
+#file "/home/ired/zentrack_2/www/actions/reopen.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be reopened."
+msgstr "Error del Sistema: El ticket ? no pudo ser reabierto"
+
+
+#file "/home/ired/zentrack_2/www/actions/test.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be tested"
+msgstr "Error del Sistema: El ticket ? no pudo ser testeado"
+
+
+#file "/home/ired/zentrack_2/www/actions/yank.php"
+#args "array($id)"
+msgid "System error: Ticket ? could not be yanked."
+msgstr "Error del Sistema: El ticket ? no pudo ser sustra&iacute;do"
+
+
+#file "/home/ired/zentrack_2/www/actions/estimate.php"
+#args "array($id)"
+msgid "System error: Ticket ? hours could not be set"
+msgstr "Error del Sistema: No se pudo establecer las horas para el ticket ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "System involved in ticket"
+msgstr "Sistema involucrado en el ticket"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "System"
+msgstr "Sistema"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Systems represent a component or area the ticket is specific to."
+msgstr "Los Sistemas representan un componente o un &aacute;rea para la cual el ticket es espec&iacute;fico"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "TASKS FOR COMPLETION"
+msgstr "TAREAS A COMPLETAR"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid "Table Name"
+msgstr "Nombre de la Tabla"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_tasksBox.php"
+#args ""
+msgid "Tasks for this project"
+msgstr "Tareas para esta proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Tasks represent types of log entries."
+msgstr "Las Tareas representan tipos de registros en el log"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_box.php"
+#args ""
+msgid "Tasks"
+msgstr "Tareas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "Telephone Nr."
+msgstr "Tel&eacute;fono"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_list.php"
+#args ""
+msgid "Telephone no"
+msgstr "Tel&eacute;fono"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newContacteForm.php"
+#args ""
+msgid "Telephone"
+msgstr "Tel&eacute;fono"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/test.php"
+#args ""
+msgid "Test Ticket"
+msgstr "Testear Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_actionBar.php"
+#args ""
+msgid "Test"
+msgstr "Testear"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/test.php"
+#args ""
+msgid "Tested"
+msgstr "Testeado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "Testing Required"
+msgstr "Testeo Requerido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_detailsBox.php"
+#args ""
+msgid "Testing"
+msgstr "Testeado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Text"
+msgstr "Texto"
+
+
+#file "/home/ired/zentrack_2/www/admin/editBehavior.php"
+#args ""
+msgid "That behavior could not be found"
+msgstr "Ese comportamiento no pudo ser encontrado"
+
+
+#file "/home/ired/zentrack_2/www/misc/homebin.php"
+#args ""
+msgid "That bin doesn't exist"
+msgstr "Esa comunidad no existe"
+
+
+#file "/home/ired/zentrack_2/www/agreement.php"
+#args ""
+msgid "That contact doesn't exist"
+msgstr "Ese contacto no existe"
+
+
+#file "/home/ired/zentrack_2/www/admin/editGroup.php"
+#args ""
+msgid "That group could not be found"
+msgstr "Ese grupo de datos no pudo ser encontrado"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "That is not a recognized file type, by your browsers determinations"
+msgstr "Ese tipo de archivo no es reconocido de acuerdo a la configuraci&oacute;n de su navegador de Internet"
+
+
+#file "/home/ired/zentrack_2/www/admin/addUserSubmit.php"
+#args ""
+msgid "That login name already exists.  Please choose another."
+msgstr "Esa cuenta de usuario ya existe. Por favor elija otro nombre."
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "That login name is in use by another account"
+msgstr "Ese nombre de usuario ya est&aacute; en uso por otra cuenta"
+
+
+#file "/home/ired/zentrack_2/www/reports/custom.php"
+#args ""
+msgid "That temporary report doesn't exist"
+msgstr "Ese reporte temporal no existe"
+
+
+#file "/home/ired/zentrack_2/www/ticket.php"
+#args ""
+msgid "That ticket doesn't exist"
+msgstr "Ese ticket no existe"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUser.php"
+#args ""
+msgid "That user could not be found"
+msgstr "No pudo encontrarse ese usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args ""
+msgid "The E-mail address of the contact"
+msgstr "La direcci&oacute;n de E-mail del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "The Expiration Date"
+msgstr "La Fecha de Expiraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "The Guest Password cannot be changed!"
+msgstr "La Contrase&ntilde;a de Guest no puede ser cambiada!"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUser.php"
+#args ""
+msgid "The Root Admin Account can only be modified by the Root Administrator"
+msgstr "La Cuenta del Administrador Principal solamente puede ser modificada por &eacute;l mismo"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteUser.php"
+#args "array($user_id)"
+msgid "The account (?) could not be found/deleted successfully"
+msgstr "La cuenta (?) no pudo ser encontrada/eliminada con &eacute;xito"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteUser.php"
+#args "array($user_id)"
+msgid "The account(?) was successfully removed"
+msgstr "La cuenta (?) fue eliminada exitosamente"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteBehavior.php"
+#args ""
+msgid "The action completed successfully.  The account was not actually deleted, because this is a demo site"
+msgstr "La acci&oacute;n fue completada con &eacute;xito. La cuenta no fue realmente eliminada porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteGroup.php"
+#args ""
+msgid "The action completed successfully.  The data group was not actually deleted, because this is a demo site"
+msgstr "La acci&oacute;n fue completada con &eacute;xito. El grupo de datos no fue realmente eliminado porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteBehavior.php"
+#args "array($behavior_id)"
+msgid "The behavior (?) could not be found/deleted successfully"
+msgstr "El comportamiento (?) no pudo ser encontrado/eliminado con &eacute;xito"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteBehavior.php"
+#args "array($behavior_id)"
+msgid "The behavior (?) was successfully removed"
+msgstr "El comportamiento (?) fue eliminado exitosamente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "The company of the agreement"
+msgstr "La compa&ntilde;&iacute;a del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts2.php"
+#args ""
+msgid "The company of the contact"
+msgstr "La compa&ntilde;&iacute;a del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "The company where the agreement runs"
+msgstr "La compa&ntilde;&iacute;a donde el acuerdo est&aacute; vigente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args ""
+msgid "The company where the contact works"
+msgstr "La compa&ntilde;&iacute;a en la que trabaja el contacto"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteGroup.php"
+#args "array($group_id)"
+msgid "The data group (?) WAS NOT removed"
+msgstr "El grupo de datos (?) NO FUE eliminado"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteGroup.php"
+#args "array($group_id)"
+msgid "The data group (?) could not be found/deleted successfully"
+msgstr "El grupo de datos (?) no pudo ser encontrado/eliminado con &eacute;xito"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteGroup.php"
+#args "array($group_id)"
+msgid "The data group (?) was successfully removed"
+msgstr "El grupo de datos (?) fue eliminado con &eacute;xito"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args "array($group_id)"
+msgid "The data group ? is currently being used."
+msgstr "El grupo de datos ? est&aacute; siendo utilizado."
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts2.php"
+#args ""
+msgid "The e-mail of the contact"
+msgstr "El e-mail del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "The email of the contact"
+msgstr "El e-mail del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "The expiration date of the agreement"
+msgstr "La fecha de expiraci&oacute;n del acuerdo"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "The file could not be uploaded "
+msgstr "El archivo no pudo ser transferido"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args "array(number_format($userfile_size), number_format($max_size))"
+msgid "The file size (?) exceeded the maximum allowed (?)"
+msgstr "El archivo tiene un tama&ntilde;o (?) superior al m&aacute;ximo permitido (?)"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args "array(substr($max_size,0,strlen($max_size)-3))"
+msgid "The file was not recieved. Check to insure it's size does not exceed ?KB"
+msgstr "El archivo no fue recibido. Aseg&uacute;rese de que su tama&ntilde;o no exceda los ? KB"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "The importance of the ticket"
+msgstr "La importancia del ticket"
+
+
+#file "/home/ired/zentrack_2/www/misc/language.php"
+#args "$newlang"
+msgid "The language could not be changed to ?"
+msgstr "No pudo cambiarse al idioma ?"
+
+
+#file "/home/ired/zentrack_2/www/misc/language.php"
+#args ""
+msgid "The language file chosen was not valid"
+msgstr "El archivo de idioma seleccionado no es v&aacute;lido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "The name of the agreement"
+msgstr "El nombre del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts2.php"
+#args ""
+msgid "The name of the contact"
+msgstr "El nombre del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "The name of the ticket"
+msgstr "El nombre del ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "The name of the user"
+msgstr "El nombre del usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "The nr of the agreement"
+msgstr "El Nro del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid "The priority order fields should all be filled in and should be consecutive (for proper coloring)."
+msgstr "Los campos de ordenamiento de las prioridades deber&iacute;an estar todos completos y con n&uacute;meros consecutivos (para lograr una coloraci&oacute;n adecuada de los tickets)"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "The root admin access cannot be less than the level_settings parameter"
+msgstr "El nivel de acceso del Administrador Principal no puede ser menor al par&aacute;metro level_settings"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "The root admin account cannot be deactivated"
+msgstr "La cuenta del Administrador Principal no puede ser desactivada"
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args ""
+msgid "The root admin account must have access of 5 or greater"
+msgstr "La cuenta del Administrador Principal debe tener un nivel de acceso de 5 &oacute; m&aacute;s"
+
+
+#file "/home/ired/zentrack_2/www/admin/deleteUser.php"
+#args ""
+msgid "The root administrator account cannot be deleted"
+msgstr "La cuenta del Administrador Principal no puede ser eliminada"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact2List.php"
+#args ""
+msgid "The telephone number of the contact"
+msgstr "El n&uacute;mero de tel&eacute;fono del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "The telephone of the contact"
+msgstr "El tel&eacute;fono del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "The title of the agreement"
+msgstr "El t&iacute;tulo del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "The title of the contact"
+msgstr "El t&iacute;tulo del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "The type of ticket"
+msgstr "El tipo de problema en el ticket"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the html form."
+msgstr "El tama&ntilde;o del archivo transferido excede la directiva MAX_FILE_SIZE que se indica en el formulario HTML."
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "The uploaded file exceeds the upload_max_filesize directive in php.ini."
+msgstr "El tama&ntilde;o del archivo transferido excede la directiva max_filesize que se indica en el archivo php.ini"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "The uploaded file was only partially uploaded."
+msgstr "El archivo fue transferido PARCIALMENTE."
+
+
+#file "/home/ired/zentrack_2/www/admin/resetPassword.php"
+#args ""
+msgid "The user passphrase could not be found/edited"
+msgstr "La contrase&ntilde;a del usuario no pudo ser encontrado/editada"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "The website of the contact"
+msgstr "El sitio web del contacto"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "There are more log entries."
+msgstr "Existen m&aacute;s registros en el log."
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "There are no contacts to add."
+msgstr "No hay contactos para agregar."
+
+
+#file "/home/ired/zentrack_2/www/admin/bins.php"
+#args ""
+msgid "There was nothing provided to update"
+msgstr "No se di&oacute; nada para actualizar"
+
+
+#file "/home/ired/zentrack_2/www/admin/config.php"
+#args ""
+msgid "There were no changes made to the settings.  Procedure skipped."
+msgstr "No se realizaron cambios en la configuraci&oacute;n. Se saltea el procedimiento."
+
+
+#file "/home/ired/zentrack_2/www/searchLogs.php"
+#args ""
+msgid "There were no logs matching your search."
+msgstr "En el log no se encontraron registros coincidentes con su b&uacute;squeda."
+
+
+#file "/home/ired/zentrack_2/www/actions/email.php"
+#args ""
+msgid "There were no recipients"
+msgstr "No se indicaron destinatarios"
+
+
+#file "/home/ired/zentrack_2/www/admin/listUsers.php"
+#args ""
+msgid "There were no results for your search"
+msgstr "No hubo resultados para su b&uacute;squeda"
+
+
+#file "/home/ired/zentrack_2/www/search.php"
+#args ""
+msgid "There were no results for your search."
+msgstr "No hubo resultados para su b&uacute;squeda."
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "These options aren't useful when only graphing one element."
+msgstr "Estas opciones no son &uacute;tiles cuando se grafica un solo elemento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "This grants the user the specified level of access to all bins not otherwise indicated by 'user access'."
+msgstr "Esto le d&aacute; al usuario el nivel de acceso indicado, para todas las comunidades (a menos que se indique otro valor en 'accesos de usuario'."
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid "This screen will let you list, add, edit and delete behavior rules."
+msgstr "Esta pantalla le permitir&aacute; listar, agregar y eliminar reglas para el comportamiento."
+
+
+#file "/home/ired/zentrack_2/includes/editCustomSubmit.php"
+#args "array($id)"
+msgid "Ticket #?: Save Custom Fields"
+msgstr "Ticket #?: Guardar Campos Personalizados"
+
+
+#file "/home/ired/zentrack_2/includes/editCustomSubmit.php"
+#args "array($id)"
+msgid "Ticket #? cannot be edited in its current status"
+msgstr "El ticket #? no puede ser editado en el estado actual"
+
+
+#file "/home/ired/zentrack_2/www/actions/editCustomSubmit.php"
+#args "array($id)"
+msgid "Ticket #? cannot be edited right now"
+msgstr "El ticket #? no puede ser editado en este momento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editTicketForm.php"
+#args "array($id)"
+msgid "Ticket #? could not be found"
+msgstr "El ticket #? no pudo ser encontrado"
+
+
+#file "/home/ired/zentrack_2/www/actions/action_header.php"
+#args "array($id)"
+msgid "Ticket #?"
+msgstr "Ticket #?"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id,$this->formatName($user_id,2))"
+msgid "Ticket #?: Log added by ?"
+msgstr "Ticket #?: Registro de Log a&ntilde;adido por ?"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id,$name)"
+msgid "Ticket #?: assigned to ?"
+msgstr "Ticket #?: asignado a ?"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id)"
+msgid "Ticket #?: closed"
+msgstr "Ticket #?: cerrado"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id)"
+msgid "Ticket #?: created"
+msgstr "Ticket #?: creado"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id,$this->getBinName($newBin))"
+msgid "Ticket #?: moved to ?"
+msgstr "Ticket #?: movido a ?"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id)"
+msgid "Ticket #?: rejected"
+msgstr "Ticket #?: rechazado"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id)"
+msgid "Ticket #?: reopened"
+msgstr "Ticket #?: reabierto"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id,$name)"
+msgid "Ticket #?: yanked by ?"
+msgstr "Ticket #?: Sustra&iacute;do por ?"
+
+
+#file "/home/ired/zentrack_2/www/actions/editSubmit.php"
+#args "array($id)"
+msgid "Ticket ? could not edit ticket. "
+msgstr "El ticket ? no pudo ser editado. "
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id)"
+msgid "Ticket ? has been reopened."
+msgstr "El ticket ? ha sido reabierto"
+
+
+#file "/home/ired/zentrack_2/www/actions/email.php"
+#args "array($id, tr($err))"
+msgid "Ticket ? not mailed: ?"
+msgstr "El ticket ? NO FUE ENVIADO: ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Ticket Administration"
+msgstr "Administraci&oacute;n de Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/nav.php"
+#args ""
+msgid "Ticket ID"
+msgstr "ID del Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "Ticket Information"
+msgstr "Informaci&oacute;n del Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Ticket Summary")
+msgstr "Resumen del Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Ticket lists?"
+msgstr "Listados de tickets?"
+
+
+#file "/home/ired/zentrack_2/www/ticket.php"
+#args ""
+msgid "Ticket"
+msgstr "Ticket"
+
+
+#file "/home/ired/zentrack_2/www/assignedTickets.php"
+#args ""
+msgid "Tickets assigned"
+msgstr "Tickets asignados"
+
+
+#file "/home/ired/zentrack_2/includes/leftTickets.php"
+#args ""
+msgid "Tickets"
+msgstr "Tickets"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Tickets"
+msgtr "Tickets"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Projects"
+msgtr "Proyectos"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Personal Options"
+msgtr "Opciones Personales"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "Contacts"
+msgstr "Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets.php"
+#args ""
+msgid "Time"
+msgstr "Tiempo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "Title of the agreement"
+msgstr "T&iacute;tulo del acuerdo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/agreementView.php"
+#args ""
+msgid "Title"
+msgstr "T&iacute;tulo"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Title"
+msgtr "T&iacute;tulo"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Priority"
+msgtr "Prioridad"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Status"
+msgtr "Estado"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Description"
+msgtr "Descripci&oacute;n"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Open Time"
+msgtr "Fecha de Apertura"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Close Time"
+msgtr "Fecha de Cierre"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Bin"
+msgtr "Comunidad"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Type"
+msgtr "Tipo de Problema"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Owner"
+msgtr "Responsable"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "System"
+msgtr "Sistema"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Created by"
+msgtr "Creado por"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Tested"
+msgtr "Testeado"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Approved"
+msgtr "Aprobado"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Project"
+msgtr "Proyecto"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Estimated Hours"
+msgtr "Horas Estimadas"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Deadline"
+msgtr "Fecha L&iacute;mite"
+ 
+     
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid "Start Date"
+msgstr "Fecha de Inicio"
+
+
+#file "/home/ired/zentrack_2/www/actions/print.php"
+#args ""
+msgid "Totals"
+msgstr "Totales"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "Tracker"
+msgstr "Seguimiento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "Try using Combine Selected with a very large number of elements, if you intend to view a graphical image."
+msgstr "Intente usar 'Combinar los items seleccionados' cuando tenga una gran cantidad de elementos, si su objetivo es ver un gr&aacute;fico"
+
+
+#file "/home/ired/zentrack_2/www/admin/access.php"
+#args ""
+msgid "Two or more bins were submitted with the same name"
+msgstr "Se suministraron dos o m&aacute;s Comunidades con el mismo nombre"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "Type ids separated by commas, or click on the button."
+msgstr "Ingrese los IDs separador por comas, o haga click en el bot&oacute;n."
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchList.php"
+#args ""
+msgid "Type of ticket"
+msgstr "Tipo de ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid "Type"
+msgstr "Tipo de Problema"
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "Types represent the type of ticket activity."
+msgstr "Los Tipos de Problema representan por qu&eacute; se gener&oacute; el ticket."
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Uncheck to disable this account."
+msgstr "Quite el tilde para deshabilitar esta cuenta."
+
+
+#file "/home/ired/zentrack_2/www/admin/bins.php"
+#args ""
+msgid "Update Bins"
+msgstr "Actualizar Comunidades"
+
+
+#file "/home/ired/zentrack_2/www/admin/priorities.php"
+#args ""
+msgid "Update Priorities"
+msgstr "Actualizar Prioridades"
+
+
+#file "/home/ired/zentrack_2/www/admin/systems.php"
+#args ""
+msgid "Update Systems"
+msgstr "Actualizar Sistemas"
+
+
+#file "/home/ired/zentrack_2/www/admin/tasks.php"
+#args ""
+msgid "Update Tasks"
+msgstr "Actualizar Tareas"
+
+
+#file "/home/ired/zentrack_2/www/admin/types.php"
+#args ""
+msgid "Update Types"
+msgstr "Actualizar Tipos"
+
+
+#file "/home/ired/zentrack_2/www/admin/editCustom.php"
+#args ""
+msgid "Update Variable Fields"
+msgstr "Actualizar Campos Personalizados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "Update"
+msgstr "Actualizar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "Upload Attachment"
+msgstr "Transferir Archivo Adjunto"
+
+
+#file "/home/ired/zentrack_2/www/actions/upload.php"
+#args ""
+msgid "Uploaded file size 0 bytes"
+msgstr "El archivo transferido tiene 0 bytes"
+
+
+#file "/home/ired/zentrack_2/www/reports/index.php"
+#args ""
+msgid "Usage Reports"
+msgstr "Reportes de Utilizaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "Use zero if unsure."
+msgstr "Use cero si no est&aacute; seguro"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Used for projects?"
+msgstr "Usado para proyectos?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Used for searches?"
+msgstr "Usado para b&uacute;squedas?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid "Used for tickets?"
+msgstr "Usado para tickets?"
+
+
+#file "/home/ired/zentrack_2/www/admin/addUserSubmit.php"
+#args "array($user_id, "--link--" . tr("Click Here") . "</a>", $user_id)"
+msgid "User ? was added successfully. The password is the last name of the user. ? to customize user ?'s access permissions."
+msgstr "El usuario ? fue agregado con &eacute;xito. La contrase&ntilde;a es el apellido del usuario. ? para personalizar los permisos de acceso para el usuario ?."
+
+
+#file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
+#args "array($user_id, 			"--link--", 			$user_id)"
+msgid "User ? was updated successfully. ? to customize user ?'s access permissions."
+msgstr "El usuario ? fue actualizado con &eacute;xito. ? para personalizar los permisos de acceso para el usuario ?."
+
+
+#file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
+#args ""
+msgid "User Administration"
+msgstr "Administraci&oacute;n de Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsTypeMenu.php"
+#args ""
+msgid "User ID"
+msgstr "ID de Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userAdd.php"
+#args ""
+msgid "User Information"
+msgstr "Informaci&oacute;n de Usuario"
+
+
+#file "/home/ired/zentrack_2/www/options.php"
+#args ""
+msgid "User Options"
+msgstr "Opciones de Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogForm.php"
+#args ""
+msgid "User"
+msgstr "Usuario"
+
+
+#file "/home/ired/zentrack_2/www/help/english/tutorial.php"
+#args ""
+msgid "User's Manual"
+msgstr "Manual del Usuario"
+
+
+#file "/home/ired/zentrack_2/www/reports/save.php"
+#args ""
+msgid "User(s)"
+msgstr "Usuario(s)"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Users Default Bin"
+msgstr "Comunidad Inicial del Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Users Initials"
+msgstr "Iniciales del Usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Users System ID"
+msgstr "ID del Usuario en el Sistema"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "Users email address"
+msgstr "Direcci&oacute;n de e-mail del usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configSettingsForm.php"
+#args ""
+msgid "Value"
+msgstr "Valor"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsSubmit.php"
+#args ""
+msgid "View Chart"
+msgstr "Ver Gr&aacute;fico"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "View Reports"
+msgstr "Ver Reportes"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportMenu.php"
+#args ""
+msgid "View"
+msgstr "Ver"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listContacts.php"
+#args ""
+msgid "Website"
+msgstr "Sitio Web"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Weeks"
+msgstr "Semanas"
+
+
+#file "/home/ired/zentrack_2/www/index.php"
+#args ""
+msgid "Welcome to zenTrack"
+msgstr "Bienvenido a zenTrack"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsOptionsMenu.php"
+#args ""
+msgid "What to Graph"
+msgstr "Qu&eacute; Graficar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args "array($page_type)"
+msgid "Who the ? belongs to"
+msgstr "A qui&eacute;n pertenece el ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "Worked"
+msgstr "Trabajado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/yank.php"
+#args ""
+msgid "Yank Ticket"
+msgstr "Capturar Ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/yank.php"
+#args ""
+msgid "Yank"
+msgstr "Capturar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "Years"
+msgstr "A&ntilde;os"
+
+
+#file "/home/ired/zentrack_2/www/ticket.php"
+#args ""
+msgid "You are not allowed to view the following in this bin"
+msgstr "Usted no tiene para acceder esta comunidad"
+
+
+#file "/home/ired/zentrack_2/includes/editTicketSubmit.php"
+#args ""
+msgid "You cannot edit a ticket in this bin "
+msgstr "Usted no puede editar tickets en esta comunidad "
+
+
+#file "/home/ired/zentrack_2/includes/templates/editTicketForm.php"
+#args ""
+msgid "You cannot edit a ticket in this bin"
+msgstr "Usted no puede esitar tickets en esta comunidad"
+
+
+#file "/home/ired/zentrack_2/includes/editCustomSubmit.php"
+#args ""
+msgid "You cannot edit a ticket's custom fields in this bin "
+msgstr "Usted no puede editar los campos personalizados de los tickets de esta comunidad "
+
+
+#file "/home/ired/zentrack_2/www/actions/editCustomSubmit.php"
+#args ""
+msgid "You cannot edit a ticket's custom fields in this bin"
+msgstr "Usted no puede editar los campos personalizados de los tickets de esta comunidad"
+
+
+#file "/home/ired/zentrack_2/www/admin/admin_header.php"
+#args ""
+msgid "You do not have access to administrate zenTrack."
+msgstr "Usted no tiene el nivel de acceso necesario para administrar zenTrack"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchResults.php"
+#args ""
+msgid "You do not have access to any bins."
+msgstr "Usted no tiene acceso a ninguna comunidad."
+
+
+#file "/home/ired/zentrack_2/www/index.php"
+#args ""
+msgid "You do not have access to any existing bins"
+msgstr "Usted no tiene acceso a ninguna comunidad existente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "You do not have permission to create projects."
+msgstr "usted no tiene permiso de crear proyectos."
+
+
+#file "/home/ired/zentrack_2/www/addProjectSubmit.php"
+#args ""
+msgid "You do not have permission to create tickets in this bin."
+msgstr "Usted no tiene permiso para crear tickets en esta comunidad."
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "You do not have permission to create tickets."
+msgstr "Usted no tiene permiso para crear tickets."
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "You do not have permission to edit tickets."
+msgstr "Usted no tiene permiso para editar tickets."
+
+
+#file "/home/ired/zentrack_2/www/reports/reports_header.php"
+#args ""
+msgid "You do not have permission to view the reports."
+msgstr "Usted no tiene permiso para ver reportes."
+
+
+#file "/home/ired/zentrack_2/www/helpers/userSearchbox.php"
+#args ""
+msgid "You may use * for a wildcard in any field but the id.. i.e. J* would match anything starting with J"
+msgstr "Usted podr&iacute;a utilizar * como un comod&iacute;n en cualquier campo excepto el ID. Por ejemplo J* har&iacute;a coincidir cualquier cosa que comience con una J"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "You may use * for a wildcard in the title or description.. i.e. J* would match anything starting with J"
+msgstr "Usted podr&iacute;a utilizar * como un comod&iacute;n en el t&iacute;tulo o en la descripci&oacute;n. Por ejemplo J* har&iacute;a coincidir cualquier cosa que comience con una J"
+
+
+#file "/home/ired/zentrack_2/www/actions/addToNotify.php"
+#args ""
+msgid "You must provide at least one registered user, or a valid name and email address"
+msgstr "Usted debe brindar al menos un usuario registrado, o un nombre v&aacute;lido y direcci&oacute;n de e-mail"
+
+
+#file "/home/ired/zentrack_2/www/actions/addToContacts.php"
+#args ""
+msgid "You must select a Company or Person."
+msgstr "Usted debe seleccionar una Compa&ntilde;&iacute;a o Persona"
+
+
+#file "/home/ired/zentrack_2/www/misc/homebin.php"
+#args ""
+msgid "Your bin has been changed to"
+msgstr "Su comunidad ha sido cambiada a"
+
+
+#file "/home/ired/zentrack_2/www/reports/saveSubmit.php"
+#args "array($report_name)"
+msgid "Your chart has been successfully saved with title: ?"
+msgstr "Su gr&aacute;fico ha sido almacenada exitosamente con el t&iacute;tulo: ?"
+
+
+#file "/home/ired/zentrack_2/www/misc/language.php"
+#args ""
+msgid "Your language has been changed to ?"
+msgstr "Su idioma ha sido cambiado a ?"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Your new passphrase must contain at least 1 non-letter character"
+msgstr "Su nueva contrase&ntilde;a debe contener por lo menos 1 caracter que no sea una letra"
+
+
+#file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
+#args ""
+msgid "Your passphrase must be at least 6 characters long and contain at least 1 non-letter character."
+msgstr "Su contrase&ntilde;a debe tener al menos 6 caracteres, y contener al menos uno que no sea una letra."
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Your passphrase must be at least 6 digits long"
+msgstr "Su contrase&ntilde;a debe tener al menos 6 caracteres"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Your passwords did not match"
+msgstr "Sus contrase&ntilde;as no coinciden"
+
+
+#file "/home/ired/zentrack_2/www/misc/pwc.php"
+#args ""
+msgid "Your request was successful, but this is a demo site, so the passphrase was not altered"
+msgstr "Su solicitud fue exitosa, pero la contrase&ntilde;a no fue alterada porque &eacute;ste es un sitio de demostraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/log.php"
+#args ""
+msgid "accepts up to 2 decimal places"
+msgstr "Acepta hasta 2 posiciones decimales"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "access"
+msgstr "acceso"
+
+
+#file "/home/ired/zentrack_2/includes/templates/contact_titleBox.php"
+#args ""
+msgid "add"
+msgstr "agregar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "and"
+msgstr "y"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchForm.php"
+#args ""
+msgid "between"
+msgstr "entre"
+
+
+#file "/home/ired/zentrack_2/includes/templates/ticket_detailsBox.php"
+#args ""
+msgid "completed"
+msgstr "completado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/upload.php"
+#args ""
+msgid "create an attachment for this ticket"
+msgstr "agregar un archivo adjunto para este ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid "create your ticket"
+msgstr "crear su ticket"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid "delete"
+msgstr "eliminar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "edit"
+msgstr "editar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "enter a number"
+msgstr "ingrese un n&uacute;mero"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/email.php"
+#args ""
+msgid "hold control or shift to select multiple users"
+msgstr "Mantenga presionada la tecla May&uacute;sc o Control para seleccionar m&aacute;s de un usuario"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid "id"
+msgstr "id"
+
+
+#file "/home/ired/zentrack_2/www/addAgreementSubmit.php"
+#args ""
+msgid "incorrect date values"
+msgstr "Valores de fecha incorrectos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/accessForm.php"
+#args ""
+msgid "less"
+msgstr "menos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
+#args ""
+msgid "n/a"
+msgstr "n/a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact4List.php"
+#args ""
+msgid "name"
+msgstr "nombre"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "no bins"
+msgstr "ninguna comunidad"
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "ninguna prioridad"
+msgstr ""
+
+
+#file "/home/ired/zentrack_2/www/helpers/projectSearchbox.php"
+#args ""
+msgid "no systems"
+msgstr "ning&uacute;n sistema"
+
+
+#file "/home/ired/zentrack_2/www/helpers/ticketSearchbox.php"
+#args ""
+msgid "no types"
+msgstr "ning&uacute;n tipo de problema"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "no"
+msgstr "no"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid "none"
+msgstr "ninguno"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "nr"
+msgstr "nro"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/assign.php"
+#args ""
+msgid "optional"
+msgstr "opcional"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "password"
+msgstr "contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/www/addAgreementSubmit.php"
+#args ""
+msgid "required field missing:"
+msgstr "falta campo obligatorio:"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/close.php"
+#args ""
+msgid "required"
+msgstr "obligatorio"
+
+
+#file "/home/ired/zentrack_2/www/reports/view.php"
+#args ""
+msgid "required... processing error"
+msgstr "obligatorio... error de procesamiento"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newAgreementForm.php"
+#args ""
+msgid "save your changes"
+msgstr "guardar sus cambios"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args "array($id,$name)"
+msgid "ticket #?: accepted by ?"
+msgstr "ticket #?: aceptado por ?"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchContact3List.php"
+#args ""
+msgid "title"
+msgstr "t&iacute;tulo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid "up to two decimal places, optional"
+msgstr "hasta dos posiciones decimales, opcional"
+
+
+#file "/home/ired/zentrack_2/includes/templates/reportsDateMenu.php"
+#args ""
+msgid "use 4 digit year, time is optional"
+msgstr "utilice a&ntilde;o de 4 d&iacute;gitos, la hora es opcional"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchForm.php"
+#args ""
+msgid "user ID"
+msgstr "ID de usuario"
+
+
+#file "/home/ired/zentrack_2/includes/leftMain.php"
+#args ""
+msgid "version"
+msgstr "versi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
+#args ""
+msgid "yes"
+msgstr "s&iacute;"
+
+
+#file "/home/ired/zentrack_2/www/help/help_header.php"
+#args ""
+msgid "zenTrack Help | "
+msgstr "Ayuda de zenTrack | "
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Accept'
+msgstr "Aceptar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Active'
+msgstr "Activo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/notify_list.php"
+#args ""
+msgid 'Add Recipient'
+msgstr "Agregar Destinatario"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Admin'
+msgstr "Admin"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Approval Required'
+msgstr "Se Requiere Aprobaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Approval'
+msgstr "Aprobaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Approve'
+msgstr "Aprobar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/ownership.php"
+#args ""
+msgid 'Assign'
+msgstr "Asignar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_types.php"
+#args ""
+msgid 'Bin'
+msgstr "Comunidad"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/bins.php"
+#args ""
+msgid 'Bins'
+msgstr "Comunidades"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid 'Cancel'
+msgstr "Cancelar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/options.php"
+#args ""
+msgid 'Change Default Bin'
+msgstr "Cambiar Comunidad Inicial"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/options.php"
+#args ""
+msgid 'Change Language'
+msgstr "Cambiar Idioma"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/options.php"
+#args ""
+msgid 'Change Password'
+msgstr "Cambiar Contrase&ntilde;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid 'Click Here'
+msgstr "Haga Click Aqu&iacute;"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Close'
+msgstr "Cerrar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Closed'
+msgstr "Cerrado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Column Number'
+msgstr "N&uacute;mero de Columna"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Compare Value'
+msgstr "Comparar Valores"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid 'Completed'
+msgstr "Completo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/settings.php"
+#args ""
+msgid 'Configuration Settings'
+msgstr "Valores de Configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/contacts.php"
+#args ""
+msgid 'Contacts'
+msgstr "Contactos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/contacts.php"
+#args ""
+msgid 'Create New'
+msgstr "Crear Nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Create new'
+msgstr "Crear nuevo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Custom'
+msgstr "Personalizado"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Data Group'
+msgstr "Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/bins.php"
+#args ""
+msgid 'Data Types'
+msgstr "Tipos de Datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Deadline'
+msgstr "Fecha L&iacute;mite"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Debug Output'
+msgstr "Debug Output"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Default'
+msgstr "Valor por Omisi&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Description'
+msgstr "Descripci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Details'
+msgstr "Detalles"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid 'Disable'
+msgstr "Deshabilitar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'Done'
+msgstr "Hecho"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Edit Behaviors'
+msgstr "Editar Comportamientos"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Edit Data Groups'
+msgstr "Editar Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/bins.php"
+#args ""
+msgid 'Edit Users'
+msgstr "Editar Usuarios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/editCustomsForm.php"
+#args ""
+msgid 'Edit Variable Fields'
+msgstr "Editar Campos Personalizados"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Edit'
+msgstr "Editar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Elapsed'
+msgstr "Transcurrido"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Email'
+msgstr "Email"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Entries'
+msgstr "Registros"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Estimated Hours to Complete'
+msgstr "Horas Estimadas para Compeltar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Eval Script'
+msgstr "Script de Evaluaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Eval Type'
+msgstr "Tipo de Evaluaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Explanation'
+msgstr "Explicaci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Field Label'
+msgstr "Etiqueta del Campo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Field Name'
+msgstr "Nombre del Campo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Field is enabled'
+msgstr "El campo queda habilitado"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Field to change'
+msgstr "Campo a cambiar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid 'File Name'
+msgstr "Nombre del Archivo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Group Name'
+msgstr "Nombre del Grupo de Datos"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'ID'
+msgstr "ID"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'JS Validation'
+msgstr "Validaci&oacute;n JS"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Javascript'
+msgstr "Javascript"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Lists'
+msgstr "Listados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/log_ticket.php"
+#args ""
+msgid 'Log'
+msgstr "Log"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Match All'
+msgstr "Coincidir todos (ALL)"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Match Any'
+msgstr "Coincidir al menos uno (OR)"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Match Type'
+msgstr "Tipo de Coincidencia"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Matches'
+msgstr "Coincidencias"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'More'
+msgstr "Agregar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/referencedGroupForm.php"
+#args ""
+msgid 'Move'
+msgstr "Mover"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Name'
+msgstr "Nombre"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'New'
+msgstr "Nuevo"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid 'Next'
+msgstr "Siguiente"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid 'Notes are special tickets which do not require any actions.'
+msgstr "Las Notas son tickets especiales que no requieren ninguna acci&oacute;n."
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/notify_list.php"
+#args ""
+msgid 'Notify'
+msgstr "Notificaciones"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Opened'
+msgstr "Abierto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupAdd.php"
+#args ""
+msgid 'Optional'
+msgstr "Opcional"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/options.php"
+#args ""
+msgid 'Options'
+msgstr "Opciones"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_types.php"
+#args ""
+msgid 'Order'
+msgstr "Orden"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Owner'
+msgstr "Responsable"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Page'
+msgstr "P&aacute;gina"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid 'Person'
+msgstr "Persona"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'Press DONE when you are finished'
+msgstr "Presione HECHO cuando haya finalizado"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid 'Press DONE when you have finished with the edition'
+msgstr "Presione HECHO cuando haya finalizado la edici&oacute;n"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Press LESS to remove blank rows'
+msgstr "Presione RESTAR para eliminar los registros vac&iacute;os"
+
+
+#file "/home/ired/zentrack_2/includes/templates/binForm.php"
+#args ""
+msgid 'Press MORE to create new bins'
+msgstr "Presione AGREGAR para crear nuevas comunidades"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Press MORE to create new detail items'
+msgstr "Presione AGREGAR para crear nuevos items de detalle"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'Press NEW to create new behaviors'
+msgstr "Presione NUEVO para crear nuevos comportamientos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/groupForm.php"
+#args ""
+msgid 'Press NEW to create new data groups'
+msgstr "Presione NUEVO para crear nuevos grupos de datos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/customGroupDetailsForm.php"
+#args ""
+msgid 'Press Reset to ignore them'
+msgstr "Presione RESTAURAR para ignorarlos"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Press Reset to return to original values'
+msgstr "Presione RESTAURAR para volver a los valores originales"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Press Save to save changes'
+msgstr "Presione Guardar para almacenar los cambios"
+
+
+#file "/home/ired/zentrack_2/includes/templates/customGroupDetailsForm.php"
+#args ""
+msgid 'Press Save to store your changes'
+msgstr "Presione Guardar para almacenar los cambios"
+
+
+#file "/home/ired/zentrack_2/includes/zenTrack.class"
+#args ""
+msgid 'Prev'
+msgstr "Ant"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Print'
+msgstr "Imprimir"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Priority'
+msgstr "Prioridad"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Project'
+msgstr "Proyecto"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid 'Projects act as containers, which can hold multiple tickets as "tasks" which are part of the projects completion requirements.'
+msgstr "Los Proyectos funcionan como contenedores, que pueden incluir varios tickets como si fueran 'tareas' que forman parte de los requerimientos para completar un proyecto."
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Projects'
+msgstr "Proyectos"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Reject'
+msgstr "Rechazar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/relate_ticket.php"
+#args ""
+msgid 'Relate'
+msgstr "Relacionar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/relate_ticket.php"
+#args ""
+msgid 'Related'
+msgstr "Relacionados"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid 'Required'
+msgstr "Obligatorio"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Reset'
+msgstr "Restaurar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'Save'
+msgstr "Guardar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/use_project.php"
+#args ""
+msgid 'Search'
+msgstr "Buscar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Searches'
+msgstr "B&uacute;squedas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Send'
+msgstr "Enviar"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Settings Administration'
+msgstr "Administraci&oacute;n de la Configuraci&oacute;n"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid 'Sort Order'
+msgstr "Orden"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Start Date'
+msgstr "Fecha de Inicio"
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'Submit a Bug to Zentrack Team'
+msgstr "Enviar un Error al Equipo de Desarrollo de ZenTrack"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'System'
+msgstr "Systema"
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
+#args ""
+msgid 'Table Name'
+msgstr "Nombre de la Tabla"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/use_project.php"
+#args ""
+msgid 'Tasks'
+msgstr "Tareas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/projectView.php"
+#args ""
+msgid 'Tasks'
+msgstr "Tareas"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Test'
+msgstr "Testeo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Testing Required'
+msgstr "Se Requiere Testeo"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Testing'
+msgstr "Testeo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid 'There are no employees assigned to this company.'
+msgstr "No hay empleados asignados a esta compa&ntilde;&iacute;a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid 'There are two special types, which can be set by including either the word <span class="error">project</span> or <span class="error">note</span> in the bin name.'
+msgstr "Hay dos tipos especiales, que pueden indicarse mediante la inclusi&oacute;n de la palabra <span class='error'>project</span> o <span class='error'>note</span> en el nombre de la comunidad."
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid 'They start their life closed, and do not need to be completed.'
+msgstr "Inician su vida en estado cerrado, y no necesitan completarse."
+
+
+#file "/home/ired/zentrack_2/www/help/english/admin/varfields.php"
+#args ""
+msgid 'Ticket Administration'
+msgstr "Administraci&oacute;n de Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Tickets'
+msgstr "Tickets"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Title'
+msgstr "T&iacute;tulo"
+
+
+#file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
+#args ""
+msgid 'Type'
+msgstr "Tipo de Problema"
+
+
+#file "/home/ired/zentrack_2/includes/templates/configForm.php"
+#args ""
+msgid 'Use them only for tracking and documentation.'
+msgstr "Utilice solamente para seguimiento y documentaci&oaucte;n."
+
+
+#file "/home/ired/zentrack_2/includes/templates/bugForm.php"
+#args ""
+msgid 'User Info'
+msgstr "Informe de Usuario"
+
+
+#file "/home/ired/zentrack_2/www/help/english/users/tickets.php"
+#args ""
+msgid 'Yank'
+msgstr "Capturar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogResults.php"
+#args ""
+msgid 'You do not have access to any bins.'
+msgstr "Usted no tiene acceso a esta comunidad."
+
+
+#file "/home/ired/zentrack_2/includes/templates/searchLogResults.php"
+#args ""
+msgid 'You do not have permission to search this bin'
+msgstr "Usted no tiene permiso para hacer b&uacute;squedas en esta comunidad"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorDetailForm.php"
+#args ""
+msgid 'less'
+msgstr "restar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newProjectForm.php"
+#args ""
+msgid 'n/a'
+msgstr "n/a"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'properties'
+msgstr "propiedades"
+
+
+#file "/home/ired/zentrack_2/includes/templates/behaviorMenu.php"
+#args ""
+msgid 'rules'
+msgstr "reglas"
+
+
+#file "/home/ired/zentrack_2/includes/templates/actions/contacts.php"
+#args ""
+msgid 'to add one'
+msgstr "para agregar uno"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid 'Save'
+msgstr "Guardar"
+
+
+#file "/home/ired/zentrack_2/includes/templates/newTicketForm.php"
+#args ""
+msgid 'Create'
+msgstr "Crear"
+
+
+#file "/home/ired//zentrack_2/includes/templates/loginForm"
+#args ""
+msgid "Welcome!  Please Log On."
+msgstr "Bienvenido!  Por favor Inicie Su Sesi&oacute;n"
+
+
+#file "/home/ired//zentrack_2/includes/templates/loginForm"
+#args ""
+msgid "Login Name"
+msgstr "Cuenta de Usuario"
+
+
+#file "/home/ired//zentrack_2/includes/templates/loginForm"
+#args ""
+msgid "Password"
+msgstr "Contrase&ntilde;a"
 
 
diff -Naur zentrack_2-5-0-1/includes/translator.class zentrack_2-5-5-1/includes/translator.class
--- zentrack_2-5-0-1/includes/translator.class	2004-09-03 08:41:48.000000000 -0700
+++ zentrack_2-5-5-1/includes/translator.class	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?php
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 /**
  * The translation function wrapper
  *
@@ -69,7 +71,7 @@
       $this->_domainList = array();
       $this->_curDomain = '';
       $this->_locale = '';
-      $this->_zenObj;
+      $this->_zenObj = null;
       $this->_translationCache = array();
    }
 
@@ -157,7 +159,7 @@
       $error = false;
       $translationFile = $this->_domainList[$this->_curDomain] . '/' . $this->_locale . '.trans';
       $compiledFile = $this->_domainList[$this->_curDomain] . '/' . $this->_locale . '.ctrans';
-
+      
       //Check for a cached copy
       if (!array_key_exists($translationFile, $this->_translationCache)) {
          //check for file
diff -Naur zentrack_2-5-0-1/includes/validateFields.php zentrack_2-5-5-1/includes/validateFields.php
--- zentrack_2-5-0-1/includes/validateFields.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/includes/validateFields.php	2005-05-08 07:41:02.000000000 -0700
@@ -0,0 +1,55 @@
+<?{
+  
+  /*
+  ** Validates input fields for add/edit operations
+  **
+  ** Depends on the following variables:
+  **    (String)$view - the view which will be passed into the field map
+  **    (ZenFieldMap)$map - the field map to collect field info from
+  **
+  ** Creates the following variables:
+  **    (Array)$fields - key/value pairs of (String)field => (String)data_type
+  **    (Array)$required - array of (String)field names which are required for this view
+  **    (Array)$varfield_params - contains the values needed to run $zen->updateVarfieldVals() (if any)
+  */
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  
+  $fields = array();
+  $varfields = array();
+  $required = array();
+  $customFieldsArray = false;
+  $customFieldsArray = $map->getFieldMap($view);
+  $fprops = getFmFieldProps($view);
+  foreach($customFieldsArray as $f=>$field) {
+    // don't include sections
+    if( $field['field_type'] == 'section' ) { continue; }
+    // parse dates
+    if( $fprops["$f"]['data_type'] == 'date' ) {
+      $$f = $zen->dateParse($$f);
+    }
+    //if( !$field['is_visible'] ) { continue; }
+    if( $field['is_required'] || $fprops["$f"]['always_required'] ) {
+      $required[] = $f;
+    }
+    if ( strpos($f,'custom_') === 0 ) { $varfields["$f"] = $field; }
+    else { $fields["$f"] = $fprops["$f"]['data_type']; }
+  }
+
+  $zen->cleanInput($fields);
+  
+  // check for required fields
+  foreach($required as $r) {
+    if( !strlen($$r) ) {
+      $errs[] = tr("Required field missing:") . " " . ucfirst($r);
+    }
+  }
+  
+  // parse variable fields which appear in new ticket screen, 
+  // store them in $varfield_params
+  // insure that all requirements are met before proceeding
+  // with the ticket save process
+  if( count($varfields) ) {
+    include("$libDir/parseVarfields.php");
+  }
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/includes/varfieldConfig.php zentrack_2-5-5-1/includes/varfieldConfig.php
--- zentrack_2-5-0-1/includes/varfieldConfig.php	2004-08-24 01:47:58.000000000 -0700
+++ zentrack_2-5-5-1/includes/varfieldConfig.php	2005-05-01 23:59:35.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 /**
  *  This file contains configuration settings for variable ticket fields
diff -Naur zentrack_2-5-0-1/includes/zen.class zentrack_2-5-5-1/includes/zen.class
--- zentrack_2-5-0-1/includes/zen.class	2004-10-12 22:49:08.000000000 -0700
+++ zentrack_2-5-5-1/includes/zen.class	2005-05-08 07:41:02.000000000 -0700
@@ -1,4 +1,6 @@
 <? /* -*- Mode: C; c-basic-indent: 3; indent-tabs-mode: nil -*- ex: set tabstop=3 expandtab: */ 
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 include_once("$libDir/zenDate.class");  
   
@@ -77,12 +79,21 @@
      }
      return $this->_ucwords;
    }
+   
+   function ffvText( $val = '', $strlen = 0 ) {
+     if( $strlen && strlen($val) > $strlen ) { $val = substr($val,0,$strlen); }
+     $val = $this->ffv($val);
+     $val = nl2br($val);
+     return $val;
+   }
 
-   function ffv( $val = '' ) {
+   function ffv( $val = '', $strlen = 0 ) {
      // converts special characters to ascii codes
      // to be used in <input> fields
      if( strlen($val) ) {
-       $val = htmlspecialchars(stripslashes($val),ENT_QUOTES);
+       if( $strlen && strlen($val) > $strlen ) { $val = substr($val,0,$strlen); }
+       $val = htmlspecialchars($val,ENT_QUOTES,$this->settings["character_set"]);
+       $val = str_replace('\\', '&#92;', $val);
        $val = str_replace('&amp;', '&', $val);
      }
      return $val;
@@ -312,7 +323,7 @@
              $vals["$k"] = $this->checkAlphaNum($v,"_.-");
              break;
            case "text":
-             $vals["$k"] = htmlspecialchars("$v");
+             $vals["$k"] = $v; //$this->checkSlashes($v);
              break;
            default:
              $vals["$k"] = strip_tags("$v", $this->html_allowed);
@@ -357,7 +368,7 @@
            $$k = $this->checkAlphaNum($$k, "_.-");
            break;
          case "text":
-           $$k = htmlspecialchars($$k);
+           //$$k = $$k;
            break;
          default:
            $$k = strip_tags($$k, $this->html_allowed);
@@ -540,7 +551,7 @@
      if( $lvl <= $this->debug )
        $this->debugMessages[] = (is_array($msg))?
      array($title,$msg,$lvl) :
-     array($title,htmlentities($msg),$lvl);
+     array($title,$this->ffv($msg),$lvl);
    }
 
    /**
@@ -563,12 +574,9 @@
    /**
     * Prints the debug output collected by addDebug()
     */
-   function printDebugMessages() {  
+   function printDebugMessages() { 
      if( is_array($this->debugMessages) ) {
        $styles = array("","error","warning","note");
-       print "<p>--------<b>MESSAGES</b>--------<ul>\n";
-       print "<i>To disable this output, set \$Debug_Mode ";
-       print "in header.php to 0.</i><br>\n";
        if( is_array($this->debugMessages) ) {   
          foreach($this->debugMessages as $v) {
            $n = $v[2];
@@ -580,9 +588,9 @@
            else {
              print $v[1];
            }
+           print "\"";
          }
        }      
-       print "</ul>------<b>MESSAGES</b>------</p>\n";
      }
    }
    
@@ -643,7 +651,7 @@
    * @return boolean
    */
    function inString( $pattern, $text ) {
-     return !strlen(strpos($text, $pattern));
+     return strlen(strpos($text, $pattern));
    }
    
    /**
@@ -695,6 +703,29 @@
      }
    }
    
+  /**
+   * Merges two arrays into a single array.  Does not throw a warning if one
+   * of the arrays is null.  If the arrays are indexed, values from the second
+   * array will overwrite the first if the keys are equal.
+   *
+   * @param array $arr1
+   * @param array $arr2
+   * @return array an empty array if both values are null or empty
+   */
+   function mergeArrays($arr1, $arr2) {
+     if( is_array($arr1) && is_array($arr2) ) { return array_merge($arr1,$arr2); }
+     else if( is_array($arr1) ) { return $arr1; }
+     else if( is_array($arr2) ) { return $arr2; }
+     else { return array(); }
+   }
+   
+   /**
+    * Converts file names to an absolute path name using / characters.
+    */
+    function cleanPath( $path ) {
+      return str_replace('\\', '/', realpath($path) );
+    }
+   
    /*
    **  SYSTEM METHODS
    */
@@ -718,4 +749,4 @@
    
 } 
   
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/includes/zenDatabase.class zentrack_2-5-5-1/includes/zenDatabase.class
--- zentrack_2-5-0-1/includes/zenDatabase.class	2002-05-06 13:49:02.000000000 -0700
+++ zentrack_2-5-5-1/includes/zenDatabase.class	2005-05-01 23:59:36.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
   
 class zenDatabase {
 
diff -Naur zentrack_2-5-0-1/includes/zenDate.class zentrack_2-5-5-1/includes/zenDate.class
--- zentrack_2-5-0-1/includes/zenDate.class	2003-08-27 02:16:12.000000000 -0700
+++ zentrack_2-5-5-1/includes/zenDate.class	2005-05-01 23:59:36.000000000 -0700
@@ -1,11 +1,11 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /*
   **
   **  zenDate Class
   **
-  **  Author: phpZEN (Michael Richardson)
-  **  Contact: postmaster@phpzen.net
   **  Version: 1.2
   **  Updated: 12/05/01
   **
diff -Naur zentrack_2-5-0-1/includes/zenGraph.class zentrack_2-5-5-1/includes/zenGraph.class
--- zentrack_2-5-0-1/includes/zenGraph.class	2003-01-14 01:11:46.000000000 -0800
+++ zentrack_2-5-5-1/includes/zenGraph.class	2005-05-01 23:59:36.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /*
   **  ZENGRAPH - REPORT GENERATING TOOL
@@ -9,6 +11,11 @@
   **  from user provided data
   **
   */
+  if( !function_exists("hypot") ) {
+    function hypot($x, $y) {
+      return sqrt($x*$x + $y*$y);
+    }
+  }
 
 class zenGraph extends Zen {
 
diff -Naur zentrack_2-5-0-1/includes/zenTemplate.class zentrack_2-5-5-1/includes/zenTemplate.class
--- zentrack_2-5-0-1/includes/zenTemplate.class	2003-05-06 15:57:38.000000000 -0700
+++ zentrack_2-5-5-1/includes/zenTemplate.class	2005-05-01 23:59:36.000000000 -0700
@@ -1,4 +1,6 @@
 <?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
   /**
    **  TEMPLATE PROCESSING ENGINE
@@ -25,6 +27,10 @@
    **  <li>{varname} - inserts value of varname
    **  <li>{zen:varname} - inserts value of $zen->settings["varname"]
    **  <li>{list:varname:"text"+index+"more text"+value} - loops through indexed array and prints name/value
+   **  <li>{list:varname:"text"+index+"more text"+selected+"other text"+value} - loops through indexed array and print
+   **                                                                            name/value (and " selected" when appropriate)
+   **  <li>{list:varname:"text"+index+"more text"+checked+"other text"+value} - loops through indexed array and print
+   **                                                                            name/value (and " checked" when appropriate)
    **  <li>{foreach:varname:"text"+value+"text"} - loops through array and prints values
    **  <li>{include:template_name} - inserts another template into this one
    **  <li>{if:field:"text to print"+field+"text to print"} - inserts text if field exists
@@ -73,7 +79,7 @@
       $this->_text = file($this->_template);
     }
     else {
-      $this->_text = array("Template file $template could not be found.");
+      $this->_text = array("Template file {$this->_template} could not be found.");
     }
   }
 
@@ -136,7 +142,17 @@
 	    $str = $this->_parseString($parts[2]);
 	    // loop the list and make output text
 	    foreach($vars as $k=>$v) {
-	      $tmp = str_replace("{index}", $k, $str);
+        $fv = $this->_getVar("field_value");
+	      $tmp=$str;
+	      if($fv==$k || is_array($fv) && in_array($k, $fv) || 
+            (!is_array($fv) && !strlen($k) && !strlen($fv))) {
+	        $tmp = str_replace("{selected}", " selected", $tmp);
+	        $tmp = str_replace("{checked}", " checked", $tmp);
+	      } else {
+	        $tmp = str_replace("{selected}", "", $tmp);
+	        $tmp = str_replace("{checked}", "", $tmp);
+	      }
+	      $tmp = str_replace("{index}", $k, $tmp);
 	      $txt .= str_replace("{value}", $v, $tmp);
 	    }
 	    return $txt;
@@ -220,6 +236,7 @@
    **/
   function _parseString( $text ) {
     $text = str_replace('\\"', '"', $text);
+    $text = str_replace("\\'", "'", $text);
     // parse the string to print
     $vals = explode("+",trim($text));
     $str = "";
@@ -237,6 +254,14 @@
       else if( $v == "value" ) {
 	$str .= "{value}";
       }
+      // this is used for list elements and is set to " selected" when the key equals the field_value
+      else if( $v == "selected" ) {
+	$str .= "{selected}";
+      }
+      // this is used for list elements and is set to " checked" when the key equals the field_value
+      else if( $v == "checked" ) {
+	$str .= "{checked}";
+      }
       // this is another variable
       else {
 	$str .= $this->_getVar($v);
@@ -265,7 +290,6 @@
   var $_zen;
   var $_text;  //the template data loaded and ready for parsing
   var $_vars;  //the variables to use for template parsing
-
 }
 
 ?>
diff -Naur zentrack_2-5-0-1/includes/zenTrack.class zentrack_2-5-5-1/includes/zenTrack.class
--- zentrack_2-5-0-1/includes/zenTrack.class	2004-10-13 20:39:14.000000000 -0700
+++ zentrack_2-5-5-1/includes/zenTrack.class	2005-05-01 23:59:36.000000000 -0700
@@ -1,4 +1,6 @@
 <? /* -*- Mode: C; c-basic-indent: 3; indent-tabs-mode: nil -*- ex: set tabstop=3 expandtab: */ 
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
 
 /* 
 **  zenTrack Class
@@ -16,7 +18,8 @@
 **  db.class (database access and retrieval)
 */
 
-include_once("$libDir/zen.class");  
+include_once("$libDir/zen.class");
+include_once("$libDir/ZenSessionManager.class");
 
 class zenTrack extends zen {
 
@@ -135,6 +138,10 @@
     // if $archive_flag = 1, then will look in archived tickets instead of 
     // active tickets table
 
+    // check the cached data
+    $t = $this->_session->getDataCache('tickets',$id);
+    if( $t ) { return $t; }
+
     $table = ($archive_flag)? 
       $this->table_tickets_archived : $this->table_tickets;
     $pid = $this->checkNum($pid);
@@ -145,6 +152,10 @@
         $this->getProjectHours($pid, $archive_flag);
         $vars["children"] = $this->getProjectChildren($pid, NULL, $archive_flag);
     }
+    
+    // store in data cache
+    $this->_session->storeDataCache('tickets',$id,$vars);
+    
     return($vars);
   }
 
@@ -171,6 +182,11 @@
     // $archive_flag retrieves tickets from archive db instead
     // of the ticket db
 
+    // check the cached data
+    $t = $this->_session->getDataCache('tickets',$id);
+    if( $t ) { return $t; }
+    
+    // load from database
     $id = $this->checkNum($id);
     $table = ($archive_flag)? 
       $this->table_tickets_archived : $this->table_tickets;
@@ -178,6 +194,10 @@
     $vals = $this->db_quickIndexed($query);
     $this->addDebug("get_ticket","result: ".(is_array($vals)?"success":"failed")
                     ."/".$query,3);
+                    
+    // add to the cache
+    $this->_session->storeDataCache('tickets',$id,$vals);
+                    
     return( $vals );
   }
   
@@ -262,25 +282,35 @@
     
     $tables = $this->table_tickets." t";
     if( $tf_pri ) {
-      $tbl = $this->table_tickets;
       $tblpri = $this->table_priorities;
       $tables .= ", $tblpri p";
       $sort = str_replace("priority", "ppri", $sort);
     }
 
-    if( !is_array($columns) )
+    if( !is_array($columns) ) {
       $columns = $tf_pri? 
          array('id', 'title', 't.priority priority', 'status',
                'description', 'otime', 'ctime', 'bin_id', 'type_id',
                'user_id', 'system_id', 'creator_id', 'tested', 'approved',
                'relations','project_id','est_hours','deadline','start_date',
                'wkd_hours','p.priority ppri') : array("*");
+    }
+    else if( $tf_pri ) {
+      if( !in_array("p.priority ppri", $columns) ) {
+        $columns[] = "p.priority ppri"; 
+      }
+    }
 
-    $where = ($tf_pri)? " WHERE t.priority = p.pid " : "";
     if( is_array($params) ) {
-      $where = $where? "$where AND " : "WHERE ";
-      $where .= $this->simpleWhere($params);
+      $where = $this->simpleWhere($params);
+    }
+    if( $tf_pri ) {
+      $where = " WHERE t.priority = p.pid ".($where? " AND $where" : "");      
     }
+    else {
+      $where = $where? "WHERE $where" : '';
+    }
+      
     $query = "SELECT ".join(",",$columns)." FROM $tables $where";
 
     if( $sort )
@@ -424,7 +454,7 @@
     $query2 .= "user_id IS NULL AND ticket_id = '".$ticket_id."' ";    
    
     // get the lists of recipients and merge them
-    $list = array_merge($this->db_list($query),$this->db_list($query2));
+    $list = $this->mergeArrays($this->db_list($query),$this->db_list($query2));
     // print a debug message
     $this->addDebug("get_notify_recipients","Found ".count($list)
                     ." recipients for ticket $ticket_id",3);
@@ -800,13 +830,12 @@
   }
 
 
-
   /**
-   * Return an array with the fields that can be used in behaviors
+   * Return an array with all the non-custom fields that can be used in behaviors
    *
    * @return array mapped translated_field_label -> field_name sorted by key
    */
-  function getBehaviorDestinationFieldsArray() {
+  function getStdBehaviorFieldsArray() {
     $field_list=array(
                tr("Title") => "title",
                tr("Priority") => "priority",
@@ -825,6 +854,18 @@
                tr("Estimated Hours") => "est_hours",
                tr("Deadline") => "deadline",
                tr("Start Date") => "start_date");
+    ksort($field_list);
+    return($field_list);
+  }
+
+
+  /**
+   * Return an array with the fields that can be used in behaviors
+   *
+   * @return array mapped translated_field_label -> field_name sorted by key
+   */
+  function getBehaviorDestinationFieldsArray() {
+    $field_list=$this->getStdBehaviorFieldsArray();
     $custom=$this->getCustomFields(1);
     foreach($custom as $k => $v) {
       $field_list["{$v}"]=$k;
@@ -926,6 +967,35 @@
     $query = "SELECT * FROM ".$this->table_varfield." WHERE ticket_id = $ticket_id";
     return $this->db_quickIndexed($query);
   }
+  
+  /**
+   * Collect variable field information for several tickets
+   *
+   * @param array $ids contains ticket ids
+   * @param array $columns contains (string)column_name, if only some columns are desired
+   * @return array containg ticket_id => array( fields... )
+   */
+   function getVarfieldsForTickets( $ids, $columns = false ) {
+     $ids = $this->cleanInput("int", $ids);
+     $skip_id = $columns && !in_array('ticket_id',$columns);
+     if( $columns ) {
+       $cols = !$skip_id? '' : 'ticket_id';
+       foreach($columns as $c) {
+         if( $cols ) { $cols .= ','; }
+         $cols .= $c;
+       }
+     }
+     else { $cols = "*"; }
+     $query = "SELECT $cols FROM ".$this->table_varfield." WHERE ticket_id in (".join(",",$ids).")";
+     $vals = $this->db_queryIndexed($query);
+     $vars = array();
+     for($i=0; $i < count($vals); $i++) {
+       $k = $vals[$i]['ticket_id'];
+       if( $skip_id ) { unset($vals[$i]['ticket_id']); }
+       $vars["$k"] = $vals[$i];
+     }
+     return $vars;
+   }
 
 
   /**
@@ -940,13 +1010,39 @@
     $ticket_id = $this->checkNum($ticket_id);
     $user_id = $this->checkNum($user_id);
     $a = $this->settings['varfield_tab_name'];
-    $log_entry = $a? 'Updated '.ucfirst(strtolower($a)).' fields' : 'Update Custom Fields';
+    $log_entry = $a? "Updated ".ucfirst(strtolower($a))." fields\n" : "Updated Custom Fields";
     $oldVals = $this->getVarfieldVals($ticket_id);
     foreach($field_values as $key=>$val) {
-      if( strpos($key, 'date') > 0 && $val == 0 ) { $val = 'NULL'; }
-      else if( strpos($key, 'number') > 0 && is_null($val) ) { $val = 'NULL'; }
+      $v1=$oldVals["$key"];
+      $v2=$val;
+      $fm =& new ZenFieldMap($this);
+      $label = $fm->getLabel("ticket_edit",$key);
+      if( strpos($key, 'date') > 0 ) {
+        if ( is_null($oldVals["$key"]) || $oldVals["$key"] == 0 ) {
+          $v1 = 'NULL';
+        } else { 
+          $v1 = $this->showDateTime($oldVals["$key"]);
+        }
+        if ( is_null($val) || $val == 0 ) {
+          $v2 = 'NULL';
+        } else { 
+          $v2 = $this->showDateTime($val);
+        }
+      }
+      else if( strpos($key, 'number') > 0 ) {
+        if( is_null($oldVals["$key"]) ) {
+          $v1 = 0;
+        } else {
+          $v1 = $oldVals["$key"];
+        }
+        if( is_null($val) ) {
+          $v2 = 0;
+        } else {
+          $v2 = $val;
+        }
+      }
       // find out if value was updated, check strlen so that 0 != '', and so forth
-      if( $val != $oldVals["$key"] ) { $log_entry .= "$key updated: "+$val+"\n"; }
+      if( $v1 != $v2 ) { $log_entry .= "{$label} changed from [$v1] to [$v2]\n"; }
     }
     $res = $this->db_update( $this->table_varfield, "ticket_id", $ticket_id, $field_values );
     if( $res && $this->settings['log_edit'] == 'on' ) {
@@ -1079,8 +1175,10 @@
    *
    * @param array $behavior array containing the behavior's properties
    * @param array $group array containing the group properties
+   * @param array $validBins bins that the current user can access
+   * @param array $mode create, edit, or view (for bin/user/ticket access)
    */
-   function getBehaviorFileSet( $behavior, $group ) {
+   function getBehaviorFileSet( $behavior, $group, $validBins ) {
      // generate file contents
      $fn = $this->libDir."/user_data/{$group['name_of_file']}";
      $vals = array();
@@ -1091,13 +1189,20 @@
      $contents = file($fn);
      
      // determine which column contains the value so that we don't have
-     // to do this during each iteration
+     // to do this during each iteration.  We will also buffer the possible
+     // values for each column now, so that we can check them while iterating
+     // the values (without mutliple db calls)
+     $possibleValues = array();
      $valueColumnIndex = null;
      foreach($behavior['fields'] as $f) {
        if( $f['field_name'] == 'value_column' ) {
           $valueColumnIndex = $f['field_value']-1;
-          break;
+          $fn = $behavior['field_name'];
+       }
+       else {
+          $fn = $f['field_name'];
        }
+       $possibleValues[$fn] = $this->getValsForTicketField( $fn, $validBins );
      }
      
      // blow up and burn in fiery death
@@ -1109,6 +1214,7 @@
      }
      
      // get the index for columns to be read
+     $rowCount=0;
      foreach($contents as $lineOfData) {
        $dataRow = explode("\t",trim($lineOfData));
        $key = $this->_genMatchesKey($behavior, $group, $dataRow);
@@ -1127,21 +1233,81 @@
              continue;
            }
            if( $field['field_name'] != 'value_column' ) {
+             $v = $dataRow[$i];
+             if( strlen($v) ) {
+               // attempt to retrieve the valid id and label for this field based
+               // on the value provided here.
+               $w = $this->_getValFromSet($possibleValues, $field['field_name'], $v);
+               if( !strlen($w) ) {
+                  $this->addDebug('getBehaviorFileSet', "The requested match value "
+                    ." ($v) appears to be invalid", 2);
+               }
+               else {
+                  $v = $w[0];
+               }
+             }
              $vals[$key]['matches'][] = array('field_name'     => $n, 
-                                              'field_operator' => 'eq',
-                                              'field_value'    => $dataRow[$i]);
+                  'field_operator' => 'eq',
+                  'field_value'    => $v);
            }
          }
        }
        
        // add the value to our data set
-       $vals[$key]['values'][] = $dataRow[$valueColumnIndex];
+       $d = $dataRow[$valueColumnIndex];
+       if( !strlen($d) ) {
+         $this->addDebug('getBehaviorFileSet', "$key: file missing value column at line $rowCount", 1);
+       }
+       else {
+         $v = $this->_getValFromSet($possibleValues, $behavior['field_name'], $d);
+         $vals[$key]['values'][] = $v? array('field_value'=>$v[0],'label'=>$v[1]) : $d;
+         $this->addDebug('getBehaviorFileSet', "$key: adding value '".($v? $v[0].'->'.$v[1]: $d)."'", 3);
+       }
      }
-     
+
      return $vals;
    }
    
   /**
+   * Extract value from an indexed array of id/label pairs.
+   *
+   * @param array $vals the set containing rows of id/label pairs
+   * @param int $key the associative array to look in
+   * @param mixed $value an id OR a label (can search either way)
+   * @return mixed array containing (id, label) or null (if not found)
+   */
+   function _getValFromSet( $vals, $key, $value ) {
+     if( !strlen($value) ) {
+       $this->addDebug('_getValFromSet', "$vals, $key, $value: value empty, nothing to fetch", 2);
+       return null; 
+     }
+     if( !array_key_exists("$key", $vals) || !strlen($vals["$key"]) ) {
+       $this->addDebug('_getValFromSet', "$vals, $key, $value: '$key' not a valid key(data type)", 3);
+       return null;
+     }
+     if( preg_match('/^[0-9]+$/', $value) ) {
+       // this is an id
+       if( !array_key_exists("$value", $vals["$key"]) ) {
+         $this->addDebug('_getValFromSet', "id \$vals['{$key}']['{$value}'] not found, probably invalid", 1);
+          return null; 
+       }
+       else {
+         return array($value, $vals[$key]["$value"]);
+       }
+     }
+     else {
+       // this is a label
+       foreach($vals["$key"] as $k=>$v) {
+         if( strtolower($v) == strtolower($value) ) {
+            return array($k,$v); 
+         }
+       }
+       $this->addDebug('_getValFromSet', "id \$vals['{$key}']['{$value}'] not found, probably invalid", 1);
+       return null;
+     }
+   }
+   
+  /**
    * Create a unique identifier for a data set used by behaviors
    *
    * @param array $behavior
@@ -1152,7 +1318,7 @@
       $key .= 'G'.$behavior['group_id'];
       for($i=0; $i<count($behavior['fields']); $i++) {
         if( $behavior['fields'][$i]['field_name'] != 'value_column' ) {
-          $k = $behavior['fields'][$i]['field_value'];
+          $k = $behavior['fields'][$i]['field_value']-1;
           $key .= ":$i-".$dataRow[ $k ];
         }
       }
@@ -1389,6 +1555,69 @@
   }
 
 
+  /**
+   * How many references to the given data group exist in the database
+   *
+   * @param integer $group_id The id of the group being queried
+   * @return integer
+   */
+  function queryReferencesToDataGroup( $group_id ) {
+    $qty=0;
+    $query = "SELECT count(*) FROM ".$this->table_varfield_idx
+           . " where field_value='$group_id'"
+           . " and field_name like 'custom_menu%'";
+    $qty = $this->db_get($query);
+    $query = "SELECT count(*) FROM ".$this->table_behavior
+           . " where group_id=$group_id";
+    $qty += $this->db_get($query);
+    return ( $qty );
+  }
+
+  /**
+   * Disables all references of the given data group
+   *
+   * @param integer $group_id The id of the group being deleted
+   */
+  function disableReferencesToDataGroup( $group_id ) {
+    $query = "UPDATE ".$this->table_varfield_idx
+           . " set use_for_project=0, use_for_ticket=0, field_value=NULL"
+           . " where field_value='$group_id'"
+           . " and field_name like 'custom_menu%'";
+    $res = $this->db_result($query);
+    $this->addDebug('disableReferencesToDataGroup', 
+        "Disable variable fields [$res]{$query}", $res? 3 : 1); 
+    $query = "UPDATE ".$this->table_behavior
+           . " set is_enabled=0, group_id=0"
+           . " where group_id=$group_id";
+    $res = $this->db_result($query);
+    $this->addDebug('disableReferencesToDataGroup', 
+      "Disable behaviors [$res]{$query}", $res? 3 : 1);
+  }
+
+  /**
+   * Changes all references of the old data group to a new data group
+   *
+   * @param integer $old_group_id The id of the group being deleted
+   * @param integer $new_data_group The id of the group that is replacing it
+   */
+  function moveReferencesToDataGroup( $old_group_id, $new_data_group ) {
+    $query = "UPDATE ".$this->table_varfield_idx
+           . " set field_value = '$new_data_group'"
+           . " where field_value = '$old_group_id'"
+           . " and field_name like 'custom_menu%'";
+    $res = $this->db_result($query);
+    $this->addDebug('moveReferencesToDataGroup', 
+        "Move variable fields [$res]{$query}", $res? 3 : 1);     
+    $query = "UPDATE ".$this->table_behavior
+           . " set group_id = $new_data_group"
+           . " where group_id = $old_group_id";
+    $res = $this->db_result($query);
+    $this->addDebug('moveReferencesToDataGroup', 
+        "Move behaviors [$res]{$query}", $res? 3 : 1);     
+  }
+
+
+
 
   /*
    *  SEARCH FUNCTIONS 
@@ -1440,7 +1669,8 @@
   }
 
   function search_tickets( $params, $andor = 'AND', 
-                           $archive_flag = 0, $order_by = 'status DESC, priority DESC' ) {
+                           $archive_flag = 0, $order_by = 'status DESC, priority DESC',
+                           $limit = false ) {
     // search through tickets for given text
     // acceptable params are:
     // params is an indexed array with two elements:
@@ -1492,10 +1722,15 @@
     $this->addDebug("search_ticketsQuery:",$query,3);
     // return(  $this->db_queryIndexed($query) );      
     //paging feature
-    $numtoshow = $this->settings['paging_max_rows'];
+    $numtoshow = $limit? $limit : $this->settings['paging_max_rows'];
     $start = $pageNumber * $numtoshow;
     $this->total_records = $this->db_getrowcount($tables, $where);
-    return($this->db_getlimitedIndex($query,$numtoshow,$start));
+    if( $limit === 0 ) {
+      return $this->db_queryIndexed($query);
+    }
+    else {
+      return($this->db_getlimitedIndex($query,$numtoshow,$start));
+    }
   }
 
   function _hasCustomFields($params) {
@@ -1560,6 +1795,7 @@
     $this->delete_log($pid, NULL, $archive_flag);
     $table = ($archive_flag)? $this->table_tickets_archived : $this->table_tickets;
     $query = "DELETE FROM $table WHERE id = $pid";
+    $this->_session->clearDataCache('tickets',$id);
     return( $this->db_result($query) );
   }
 
@@ -1578,8 +1814,10 @@
       for( $i=0; $i<count($children); $i++ ) {
         $this->close_ticket($children[$i]);    
       }
+      $this->_session->clearDataCache('tickets',$id);
       return( $this->change_status($pid, 'CLOSED', $params) );    
     }
+    return false;
   }
 
 
@@ -1621,17 +1859,17 @@
       }
       $logParams["bin_id"] = $bin_id;
       if( $comments )
-        $logParams["entry"] = htmlentities($comments);   
+        $logParams["entry"] = $this->ffv($comments);   
       $res = $this->add_log($id, $logParams);
     }
     if( $res && $this->settings["email_accept"] == "on" ) {
       $recipients = $this->get_notify_recipients($id);
       if( is_array($recipients) && count($recipients) ) {
-        $subject = $this->ptrans("ticket #?: accepted by ?",array($id,$name));
-        $emailParams["Assigned by"] = $this->formatName($user_id);
+        $subject = $this->ptrans("ticket #?: accepted by ?",array($id,$this->formatName($user_id)));
+        $emailParams["Accepted by"] = $this->formatName($user_id);
         if( $comments )
-          $emailParams["body"] = htmlentities($comments);
-        $emailParams["tid"] = (is_array($ticket))? $ticket : $id;
+          $emailParams["body"] = $this->ffv($comments);
+        $emailParams["tid"] = $id;
         $message = $this->formatEmailMessage($emailParams);
         $this->sendEmail($recipients,$subject,$message,$user_id);
       }
@@ -1664,7 +1902,7 @@
                          );
       $logParams["bin_id"] = $t["bin_id"];
       if( $comments )
-        $logParams["entry"] = htmlentities($comments);
+        $logParams["entry"] = $this->ffv($comments);
       $this->add_log($id, $logParams);    
     }     
     if( $t["tested"] != 1 ) {
@@ -1681,7 +1919,7 @@
         $subject = $this->ptrans("Ticket #?: closed",array($id));
         $emailParams["Close Time"] = $this->showDateTime($this->currTime);
         if( $comments )
-          $emailParams["body"] = htmlentities($comments);
+          $emailParams["body"] = $this->ffv($comments);
         $emailParams["tid"] = $t;
         $message = $this->formatEmailMessage($emailParams);
         $this->sendEmail($recipients,$subject,$message,$user_id);
@@ -1746,7 +1984,7 @@
         $emailParams["Assigned by"] = $this->formatName($user_id);
         $emailParams["Assigned to"] = $name;
         if( $comments )
-          $emailParams["body"] = htmlentities($comments);
+          $emailParams["body"] = $this->ffv($comments);
         $emailParams["tid"] = $id;
         $message = $this->formatEmailMessage($emailParams);
         $this->sendEmail($recipients,$subject,$message,$user_id);
@@ -1785,6 +2023,7 @@
     return $res;
   }
 
+/*
   function close_ticket( $id, $user_id = '', $hours = '', $comments = '' ) {
     // closes the ticket (sets the status to CLOSED)
     // if there is testing or approval yet required, then
@@ -1809,7 +2048,7 @@
 		      "ctime"   =>  $this->currTime
 		      );
       if( strlen($user_id) ) {
-	$params["user_id"] = $user_id;
+	     $params["user_id"] = $user_id;
       }
       $res = $this->update_ticket($id, $params);
       if( $this->settings["log_close"] == "on" ) {
@@ -1831,22 +2070,22 @@
 	$this->add_log($id, $logParams);    
       }
       if( $this->settings["email_closed"] == "on" ) {
-	// send email
-	$recipients = $this->get_notify_recipients($id);
+	     // send email
+	     $recipients = $this->get_notify_recipients($id);
         // make sure the manager gets a notification
         $vals = $this->fetch_bin_role_emails($t['bin_id'],$this->getRoleId('manager'));
         $this->checkIncludedRecipients($recipients,$vals);
         // create email
-	if( is_array($recipients) && count($recipients) ) {
-	  $bin = $t["bin_id"];
-	  $subject = $this->ptrans("Ticket #?: closed",array($id));
-	  $emailParams["Close Time"] = $this->showDateTime($this->currTime);
-	  if( $comments )
-	    $emailParams["body"] = $comments;
-	  $emailParams["tid"] = $t;
-	  $message = $this->formatEmailMessage($emailParams);
-	  $this->sendEmail($recipients,$subject,$message,$user_id);       
-	}
+	     if( is_array($recipients) && count($recipients) ) {
+	       $bin = $t["bin_id"];
+	       $subject = $this->ptrans("Ticket #?: closed",array($id));
+	       $emailParams["Close Time"] = $this->showDateTime($this->currTime);
+	       if( $comments )
+	         $emailParams["body"] = $comments;
+	       $emailParams["tid"] = $t;
+	       $message = $this->formatEmailMessage($emailParams);
+	       $this->sendEmail($recipients,$subject,$message,$user_id);       
+	     }
       } 
     } else if( ($t["tested"] == 1 || $t["approved"] == 1) 
 	       && $t["status"] == "OPEN" ) {
@@ -1857,25 +2096,25 @@
 		      );
       $res = $this->update_ticket($id, $params);
       if( $this->settings["log_pending"] == "on" ) {
-	// make a log entry
-	$logParams = array(
+	     // make a log entry
+	     $logParams = array(
 			   "action"   =>  'PENDING',
 			   "ticket_id" =>  $id,
 			   "entry"    =>  $entry
 			   );
-	if( $user_id ) {
-	  $logParams["user_id"] = $user_id;
-	}
-	$logParams["bin_id"] = $t["bin_id"];      
-	if( $hours )
-	  $logParams["hours"] = $hours;
-	if( $comments )
-	  $logParams["entry"] = $comments;
-	$this->add_log($id, $logParams);    
+	     if( $user_id ) {
+	       $logParams["user_id"] = $user_id;
+	     }
+	     $logParams["bin_id"] = $t["bin_id"];      
+	     if( $hours )
+	       $logParams["hours"] = $hours;
+	     if( $comments )
+	       $logParams["entry"] = $comments;
+	     $this->add_log($id, $logParams);    
       }  
       if( $this->settings["email_pending"] == "on" ) {
-	// send an email
-	$recipients = $this->get_notify_recipients($id);
+  	     // send an email
+	     $recipients = $this->get_notify_recipients($id);
         // make sure the testers/managers gets a notification
         if( $t['tested'] == 1 ) {
           $vals = $this->fetch_bin_role_emails($t['bin_id'], $this->getRoleId('tester'));
@@ -1885,20 +2124,151 @@
         }        
         $this->checkIncludedRecipients($recipients, $vals);
         // create email
-	if( is_array($recipients) && count($recipients) ) {
-	  $bin = $t["bin_id"];
-	  $subject = $this->ptrans("Ticket #?: closed",array($id));
-	  $emailParams["Close Time"] = $this->showDateTime($this->currTime);
-	  if( $comments )
-	    $emailParams["body"] = htmlentities($comments);
-	  $emailParams["tid"] = $id;
-	  $message = $this->formatEmailMessage($emailParams);
-	  $this->sendEmail($recipients,$subject,$message,$user_id);
-	} 
+	     if( is_array($recipients) && count($recipients) ) {
+	       $bin = $t["bin_id"];
+	       $subject = $this->ptrans("Ticket #?: closed",array($id));
+	       $emailParams["Close Time"] = $this->showDateTime($this->currTime);
+	       if( $comments )
+	         $emailParams["body"] = $this->ffv($comments);
+	       $emailParams["tid"] = $id;
+	       $message = $this->formatEmailMessage($emailParams);
+	       $this->sendEmail($recipients,$subject,$message,$user_id);
+	     } 
       } 
     }
     return($res);
   }
+*/
+
+
+    /**
+     * closes the ticket (sets the status to CLOSED)
+     * if there is testing or approval yet required, then
+     * simply sets status to pending.
+     * however, if both of these are completed, then
+     * closes out the ticket
+     *
+     * @param int $id Ticket's ID (can also be the an array with the whole information of the ticket (indexed by field names)
+     * @param int $user_id ID of the user who is closing the ticket
+     * @param float $hours Amount of time to be added to the ticket's worked hours
+     * @param string $comments Comments to add in the tickets log.
+     **/
+  function close_ticket( $id, $user_id = '', $hours = '', $comments = '' ) {
+    $id = $this->checkNum($id);
+    if( $user_id ) { $user_id = $this->checkNum($user_id); }
+
+    // get ticket info
+    if( is_array($id) ) {
+      $t = $id;
+      $id = $t["id"];
+    }
+    else {
+      $t = $this->get_ticket($id);
+    }
+    if( $this->check_status($t,"READY") ) {
+      // if ticket is ready to close, then close it
+      $params = array(
+            "status"  =>  'CLOSED'
+            );
+      if( ! $t["ctime"] ) {
+        $params["ctime"]=$this->currTime;
+      }
+      if( $this->settings["retain_owner_closed"] != "on") {
+        $params["user_id"] = NULL;
+      }
+      $res = $this->update_ticket($id, $params);
+      if( $this->settings["log_close"] == "on" ) {
+        // create a log entry
+        $logParams = array(
+            "action"   =>  'CLOSED',
+            "ticket_id" =>  $id
+            );
+        // get the params
+        if( $user_id ) {
+          $logParams["user_id"] = $user_id;
+        }
+        $logParams["bin_id"] = $t["bin_id"];
+        if( $hours )
+          $logParams["hours"] = $hours;
+        if( $comments )
+          $logParams["entry"] = $comments;
+        // send the log
+        $this->add_log($id, $logParams);
+      }
+      if( $this->settings["email_closed"] == "on" ) {
+        // send email
+        $recipients = $this->get_notify_recipients($id);
+        // make sure the manager gets a notification
+        $vals = $this->fetch_bin_role_emails($t['bin_id'],$this->getRoleId('manager'));
+        $this->checkIncludedRecipients($recipients,$vals);
+        // create email
+        if( is_array($recipients) && count($recipients) ) {
+          $bin = $t["bin_id"];
+          $subject = $this->ptrans("Ticket #?: closed",array($id));
+          $emailParams["Close Time"] = $this->showDateTime($this->currTime);
+          if( $comments )
+            $emailParams["body"] = $comments;
+          $emailParams["tid"] = $t;
+          $message = $this->formatEmailMessage($emailParams);
+          $this->sendEmail($recipients,$subject,$message,$user_id);
+        }
+      }
+    } else if( ($t["tested"] == 1 || $t["approved"] == 1)
+              && $t["status"] == "OPEN" ) {
+      // update status to pending
+      $params["status"]='PENDING';
+      if( $this->settings["retain_owner_pending"] != "on") {
+        $params["user_id"] = NULL;
+      }
+      if( ! $t["ctime"]  && $this->settings["ctime_on_pending"] == "on" ) {
+        $params["ctime"]=$this->currTime;
+      }
+      $res = $this->update_ticket($id, $params);
+      if( $this->settings["log_pending"] == "on" ) {
+        // make a log entry
+        $logParams = array(
+             "action"   =>  'PENDING',
+             "ticket_id" =>  $id,
+             "entry"    =>  $entry
+             );
+        if( $user_id ) {
+          $logParams["user_id"] = $user_id;
+        }
+        $logParams["bin_id"] = $t["bin_id"];
+        if( $hours )
+          $logParams["hours"] = $hours;
+        if( $comments )
+          $logParams["entry"] = $comments;
+        $this->add_log($id, $logParams);
+      }
+      if( $this->settings["email_pending"] == "on" ) {
+        // send an email
+        $recipients = $this->get_notify_recipients($id);
+        // make sure the testers/managers gets a notification
+        if( $t['tested'] == 1 ) {
+          $vals = $this->fetch_bin_role_emails($t['bin_id'], $this->getRoleId('tester'));
+        }
+        if( $t['tested'] != 1 || !is_array($vals) ) {
+          $vals = $this->fetch_bin_role_emails($t['bin_id'], $this->getRoleId('manager'));
+        }
+        $this->checkIncludedRecipients($recipients, $vals);
+        // create email
+        if( is_array($recipients) && count($recipients) ) {
+          $bin = $t["bin_id"];
+          $subject = $this->ptrans("Ticket #?: closed",array($id));
+          $emailParams["Close Time"] = $this->showDateTime($this->currTime);
+          if( $comments )
+            $emailParams["body"] = $this->ffv($comments);
+          $emailParams["tid"] = $id;
+          $message = $this->formatEmailMessage($emailParams);
+          $this->sendEmail($recipients,$subject,$message,$user_id);
+        }
+      }
+    }
+    return($res);
+  }
+
+
   
   function log_ticket( $id, $user_id, $action = 'LOG', $hours = '', $comments = '' ) {
     // create an entry in the ticket log to track hours
@@ -1945,10 +2315,20 @@
     if( $user_id ) { $user_id = $this->checkNum($user_id); }
 
     $t = $this->get_ticket($id);      
-    $params = array(
-                    "bin_id"  => $newBin,
-                    "user_id" => 'NULL'
-                    );
+    $params["bin_id"] = $newBin;
+    if ($this->settings["retain_owner_move"] != "on") {
+      $params["user_id"] = NULL;
+    } else {
+      $currentOwner=$this->checkNum($t['user_id']);
+      $ownerAccess = $this->get_access($currentOwner,0);
+      if( ! (strlen($ownerAccess["$newBin"]) > 0) ) {
+        $params["user_id"] = NULL;
+      } else {
+        if( $ownerAccess["$newBin"] < $this->settings["level_user"] ) {
+          $params["user_id"] = NULL;
+        }
+      }
+    }
     $res = $this->update_ticket($id, $params);
     if( $res && $this->settings["log_move"] == "on" ) {
       $logParams["action"] = "MOVED";
@@ -2036,7 +2416,8 @@
         $message = $this->formatEmailMessage($eParams);
         $this->sendEmail($recipients,$subject,$message,$user_id);
       }
-    }      
+    } 
+    $this->_session->clearDataCache('tickets',$id);
     return($res);
   }
 
@@ -2184,7 +2565,7 @@
         $subject = $this->ptrans("Ticket #?: closed",array($id));
         $emailParams["Close Time"] = $this->showDateTime($this->currTime);
         if( $comments )
-          $emailParams["body"] = htmlentities($comments);
+          $emailParams["body"] = $this->ffv($comments);
         $emailParams["tid"] = $id;
         $message = $this->formatEmailMessage($emailParams);
         $this->sendEmail($recipients,$subject,$message,$user_id);
@@ -2238,6 +2619,7 @@
       }
       $this->assign_ticket($id,$user_id);
       return( 1 );
+      $this->_session->clearDataCache('tickets',$id);
     }
   }
 
@@ -2297,10 +2679,13 @@
       $this->set_notify_list($id,$notify_list);
 
       // create a log entry
+      $log_entry=$params["user_id"]?tr("Assigned to [?-?]",array($params["user_id"],$this->formatName($params["user_id"])))
+                                   :tr("Unassigned");
       $lParams = array(
                        "action"   =>   "CREATED",
                        "user_id"   =>   $params["creator_id"],
-                       "bin_id"    =>   $params["bin_id"]
+                       "bin_id"    =>   $params["bin_id"],
+                       "entry"     =>   $log_entry
                        );
       if( $log_notes ) {
         $lParams["entry"] = $log_notes;
@@ -2323,7 +2708,7 @@
           $subject = $this->ptrans("Ticket #?: created",array($id));
           $emailParams["Open Time"] = $this->showDateTime($this->currTime);
           if( $comments )
-            $emailParams["body"] = htmlentities($comments);
+            $emailParams["body"] = $this->ffv($comments);
           $emailParams["tid"] = $id;
           $message = $this->formatEmailMessage($emailParams);
           $this->sendEmail($recipients,$subject,
@@ -2354,6 +2739,7 @@
     }
     $query = "DELETE FROM $table WHERE $where";
     $this->addDebug("delete_ticket",$query,2);
+    $this->_session->clearDataCache('tickets',$id);
     return( $this->db_result($query) );
   }
 
@@ -2399,10 +2785,11 @@
     $query = "UPDATE ".$this->table_tickets." SET $set WHERE id = $id";
     $this->update_notify_list($t,$params);
     $this->addDebug("update_ticket",$query,3);
+    $this->_session->clearDataCache('tickets',$id);
     return $this->db_result($query);
   }      
 
-  function edit_ticket( $id, $user_id, $params ) {
+  function edit_ticket( $id, $user_id, $params, $reason="" ) {
     if( is_array($id) ) {
       $t = $id;
       $tid = $t['id'];
@@ -2414,15 +2801,53 @@
     $id = $this->checkNum($id);
     $res = $this->update_ticket($id, $params);
     if( $res && $this->settings['log_edit'] == 'on' ) {
-      $log_entry = 'Ticket edited:\n\n';
+      $log_entry = "Ticket edited:\n\n";
       foreach($params as $key=>$val) {
         // check each field to see if it was updated
         if( $t["$key"] && $t["$key"] != $val ) {
-          $v1 = strlen($val) > 50? substr($val, 0, 50)."..." : $val;
-          $v2 = strlen($t["$key"]) > 50? substr($t["$key"], 0, 50)."..." : $val;
-          $log_entry .= "{$key} changed from [$v1] to [$v2]\n";
+          $v1 = strlen($t["$key"]) > 50? substr($t["$key"], 0, 50)."..." : $t["$key"];
+          $v2 = strlen($val) > 50? substr($val, 0, 50)."..." : $val;
+          switch ("$key") {
+            case "bin_id":     $d1 = $this->getBinName($v1);
+                               $d2 = $this->getBinName($v2);
+                               break;
+            case "system_id":  $d1 = $this->getSystemName($v1);
+                               $d2 = $this->getSystemName($v2);
+                               break;
+            case "type_id":    $d1 = $this->getTypeName($v1);
+                               $d2 = $this->getTypeName($v2);
+                               break;
+            case "priority":   $d1 = $this->getPriorityName($v1);
+                               $d2 = $this->getPriorityName($v2);
+                               break;
+            case "user_id":
+            case "creator_id": $d1 = $this->formatName($v1);
+                               $d2 = $this->formatName($v2);
+                               break;
+            case "otime":
+            case "ctime":
+            case "deadline":
+            case "start_date": $v1=$this->showDateTime($v1);
+                               $v2=$this->showDateTime($v2);
+            default:           $d1 = "";
+                               $d2 = "";
+                               if (strpos($key,"custom_date")===0) {
+                                 $v1=$this->showDateTime($v1);
+                                 $v2=$this->showDateTime($v2);
+                               }
+                               break;
+          }
+          if (strlen($d1)>0) $d1="-".$d1;
+          if (strlen($d2)>0) $d2="-".$d2;
+          $fm =& new ZenFieldMap($this);
+          $label = $fm->getLabel("ticket_edit",$key);
+          $log_entry .= "{$label} changed from [$v1$d1] to [$v2$d2]\n";
         }
       }
+      if(strlen($reason)) {
+        $log_entry.= "\nReason:\n";
+        $log_entry.= $reason;
+      }
       $this->add_log( $tid, array('user_id'   => $user_id,
                                   'action'    => 'EDIT',
                                   'entry'     => $log_entry,
@@ -2633,6 +3058,7 @@
     $query = "DELETE FROM ".$this->table_users." WHERE $where";
     $this->addDebug("delete_user()Query",$query,2);
     $this->delete_access($user_id);
+    $this->_session->clearDataType('userbins');
     return( $this->db_result($query) );
   }
 
@@ -2665,6 +3091,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_users." SET $set WHERE user_id = $user_id";
     $this->addDebug("update_user()Query",$query,2);
+    $this->_session->clearDataType('userbins');
     return( $this->db_result($query) );
   }
 
@@ -2691,6 +3118,7 @@
       if( $res )
       $i++;
     }
+    $this->_session->clearDataType('userbins');
     return($i);
   }
 
@@ -2701,6 +3129,7 @@
 
     $user_id = $this->checkNum($user_id);
     $this->delete_access( $user_id );
+    $this->_session->clearDataType('userbins');
     return( $this->add_access($user_id, $params) );
   }
 
@@ -2729,10 +3158,17 @@
     }
     $query = "DELETE FROM ".$this->table_access." WHERE $where";
     $this->addDebug("delete_access()Query",$query,2);
+    $this->_session->clearDataType('userbins');
     return( $this->db_result($query) );
   }
 
   function get_prefs( $user_id, $pref = '' ) {
+    // try to retrieve from session
+    $prefSet = $this->_session->getDataType('prefs');
+    if( isset($prefSet) && isset($prefSet["U$user_id"]) ) { return $prefSet["U$user_id"]; }
+    if( !isset($prefSet) ) { $prefSet = array(); }
+    
+    // retrieve from database
     $user_id = $this->checkNum($user_id);
     $query = "SELECT * FROM ".$this->table_preferences
       ." WHERE user_id = $user_id";
@@ -2747,12 +3183,18 @@
         $vals["$n"] = $v["prefval"];
       }
     }
+    
+    // store in session
+    $prefSet["U$user_id"] = $vals;
+    $this->_session->storeDataType("prefs",$prefSet);
+    
     return $vals;
   }
 
   function update_prefs( $user_id, $params, $prefname = '' ) {
     $user_id = $this->checkNum($user_id);
     $this->delete_prefs($user_id, $prefname);
+    $this->_session->clearDataType('prefs');
     return $this->add_prefs($user_id,$params);
   }
 
@@ -2775,6 +3217,7 @@
       }
       $this->addDebug("add_prefs","$res/$query",3);
     }
+    $this->_session->clearDataType('prefs');    
     return( $i );
   }
 
@@ -2788,6 +3231,7 @@
     }
     $res = $this->db_result($query);
     $this->addDebug("delete_prefs","$res/$query",3);
+    $this->_session->clearDataType('prefs');
     return( $res );
   }
 
@@ -2811,31 +3255,37 @@
 
   function add_bin( $params ) {
     // add a new bin to the bins table
+    $this->_session->clearDataType('bins');
     return( $this->db_insert( $this->table_bins, $params ) );
   }
 
   function add_priority( $params ) {
     // add a new priorty
+    $this->_session->clearDataType('priorities');    
     return( $this->db_insert( $this->table_priorities, $params ) );
   }
 
   function add_setting( $params ) {
     // add a new setting into the db
+    $this->_session->clearDataType('settings');
     return( $this->db_insert($this->table_settings, $params) );
   }
 
   function add_system( $params ) {
     // add a new system to the db
+    $this->_session->clearDataType('systems');
     return( $this->db_insert( $this->table_systems, $params ) );      
   }
 
   function add_task( $params ) {
     // add a new task to the system
+    $this->_session->clearDataType('tasks');
     return( $this->db_insert( $this->table_tasks, $params) );
   }
 
   function add_type( $params ) {
     // add a new ticket type
+    $this->_session->clearDataType('types');
     return( $this->db_insert($this->table_types, $params) );
   }
 
@@ -2845,6 +3295,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_varfield_idx." SET $set WHERE field_name = '$field_name'";
     $this->addDebug("update_custom_field_idx()Query",$query,2);
+    $this->_session->clearCustomFields();
     return( $this->db_result($query) );
   }
 
@@ -2854,6 +3305,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_bins." SET $set WHERE bid = $bid";
     $this->addDebug("update_bin()Query",$query,2);
+    $this->_session->clearDataType('bins');
     return( $this->db_result($query) );
   }
 
@@ -2863,6 +3315,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_priorities." SET $set WHERE pid = $pid";
     $this->addDebug("update_priority()Query",$query,2);
+    $this->_session->clearDataType('priorities');
     return( $this->db_result($query) );
   }
 
@@ -2872,6 +3325,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_settings." SET $set WHERE setting_id = $setting_id";
     $this->addDebug("update_setting()Query",$query,2);
+    $this->_session->clearDataType('settings');
     return( $this->db_result($query) );
   }
 
@@ -2882,6 +3336,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_systems." SET $set WHERE sid = $sid";
     $this->addDebug("update_system()Query",$query,2);
+    $this->_session->clearDataType('systems');
     return( $this->db_result($query) );      
   }
 
@@ -2891,6 +3346,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_tasks." SET $set WHERE task_id = $task_id";
     $this->addDebug("update_task()Query",$query,2);
+    $this->_session->clearDataType('tasks');
     return( $this->db_result($query) );            
   }
 
@@ -2900,6 +3356,7 @@
     $set = $this->makeInsertVals($params,1);
     $query = "UPDATE ".$this->table_types." SET $set WHERE type_id = $type_id";
     $this->addDebug("update_type()Query",$query,2);
+    $this->_session->clearDataType('types');
     return( $this->db_result($query) );            
   }
 
@@ -3475,6 +3932,9 @@
     case "ZENTRACK_USERS":
     case "USERS":
       return "user_id,lname,fname,initials";
+    case "ZENTRACK_FIELD_MAP":
+    case "FIELD_MAP":
+      return "field_name,field_label";
     }
     return null;
   }
@@ -3500,6 +3960,9 @@
     case "ZENTRACK_USERS":
     case "USERS":
       return $this->formatName($vals);
+    case "ZENTRACK_FIELD_MAP":
+    case "FIELD_MAP":
+      return $vals['field_label'];
     }
     return null;
   }
@@ -3521,6 +3984,9 @@
     case "ZENTRACK_USERS":
     case "USERS":
       return "lname, fname";
+    case "ZENTRACK_FIELD_MAP":
+    case "FIELD_MAP":
+      return "sort_order, field_name";
     }
     return null;
   }
@@ -3575,10 +4041,69 @@
         return 'type_id';
       case 'USERS':
         return 'user_id';
+      case "FIELD_MAP":
+        return 'field_map_id';
       default:
         return '';
     }
   }
+  
+  /**
+   * Using a field from ZENTRACK_TICKETS only, this will return
+   * the appropriate table of the data type.  If the field provided
+   * is not a data type id, then null will be returned.
+   *
+   * Note that this method can also handle the special cases for user_id
+   * and for ticket_id.  It uses the validBins array and collects a list of
+   * valid users and tickets (or projects) for the items in question.
+   */
+  function getValsForTicketField( $dataTypeId, $validBins ) {
+    $vals = array();
+    switch( strtolower($dataTypeId) ) {
+      case "priority":
+        $vals = $this->priorities;
+        break;
+      case "bin_id":
+        $vals = $this->bins;
+        break;
+      case "type_id":
+        $vals = $this->types;
+        break;
+      case "system_id":
+        $vals = $this->systems;
+        break;
+      case "creator_id":
+      case "user_id":
+        if( !$validBins ) { return null; }
+        $users = $this->get_users( $validBins, "level_user" );
+        $vals = array();
+        for($i=0; $i<count($users); $i++) {
+          $u = $users[$i];
+          $vals["{$u['user_id']}"] = $this->formatName($u,1);
+        }
+        break;
+      case "id":
+        if( !$validBins ) { return null; }
+        $tickets = $this->get_tickets(
+          array('bin_id'=>$validBins)
+        );
+        for($i=0; $i<count($tickets); $i++) {
+          $t = $tickets[$i];
+          $vals["{$t['id']}"] = $t['title'];
+        }
+        break;
+      case "project_id":
+        $tickets = $this->get_tickets(
+          array('type_id'=>$this->projectTypeIds(),'bin_id'=>$bins)
+        );
+        break;
+      default:
+        return null;
+    }
+    $this->addDebug('getValsForTicketField()', "dataTypeId=$dataTypeId, $mode=$mode, "
+      .count($bins)." bins, ".count($vals)." results",3);
+    return $vals;
+  }
 
   function get_report_id( $n ) {
     // this function needs help
@@ -3642,6 +4167,18 @@
     // this function caches results for efficiency, so repeating
     // calls for the same user will not result slow the system
 
+    // set what we have in the session
+    $userBins = $this->_session->getDataType('userbins');
+    if( !isset($userBins) ) { $userBins = array(); }
+    if( !isset($userBins["U$user_id"]) ) { $userBins["U$user_id"] = array(); }
+    if( isset($userBins["U$user_id"]["L$level"]) ) { return $userBins["U$user_id"]["L$level"]; }
+    
+    // insure that our session cache doesn't become excessive
+    if( count($userBins) > 5 ) {
+      array_shift($userBins);
+    }
+    
+    // load this user/level into the cache
     $user_id = $this->checkNum($user_id);
     $access = $this->getAccess($user_id);
     $user   = $this->getUser($user_id);
@@ -3660,9 +4197,15 @@
         }
       }
     }
+
+    // store results in session
+    $userBins["U$user_id"]["L$level"] = $vars;
+    $this->_session->storeDataType('userbins', $userBins);
+
+    // debug and return results
     $adp = (is_array($vars))? 
       join(",",$vars) : "-none-";
-    $this->addDebug("getUsersBins()results",$adp,3);
+    $this->addDebug("getUsersBins", "user bins loaded from database: ".$adp,3);
     return $vars;
   }
   
@@ -3814,7 +4357,7 @@
       if( $ticket["user_id"] != $user_id ) {
         if( !$c["override"] 
             || ( strlen($access["$bin_id"]) 
-                 && $access["bin_id"] < $this->settings["level_super"] )
+                 && $access["$bin_id"] < $this->settings["level_super"] )
             || ( !strlen($access["$bin_id"]) 
                  && $user["access_level"] < $this->settings["level_super"])
                  ) {
@@ -3923,7 +4466,7 @@
                                 "owner"    => 1,
                                 "access"   => 1,
                                 "status"   => array('OPEN'),
-                                "override" => 0,
+                                "override" => 1,
                                 "egate"    => 1,
                                 "level"    => $this->settings["level_user"]
                                 );
@@ -4043,7 +4586,7 @@
                                "owner"    => 0,
                                "access"   => 1,
                                "status"   => array('PENDING'),
-                               "override" => 0,
+                               "override" => 1,
                                "egate"    => 1,
                                "level"    => $this->settings["level_test"]
                                );
@@ -4098,6 +4641,29 @@
     $bins = $this->getBins(0,0);
     return( isset($bins["$id"])? $bins["$id"] : "" );
   }
+  
+  function getSystemName($id) {
+    // returns the name of a system
+    // from the given system id
+    $systems = $this->getSystems(0,0);
+    return( isset($systems["$id"])? $systems["$id"] : "" );
+  }
+  
+  function getPriorityName($id) {
+    // returns the name of a priority
+    // from the given priority id
+    $priorities = $this->getPriorities(0,0);
+    return( isset($priorities["$id"])? $priorities["$id"] : "" );
+  }
+  
+  /**
+   * Returns a single custom field definition
+   */
+   function getCustomField( $field_name ) {
+     // this lookup is cached, so it is not expensive
+     $vals = $this->getCustomFields(2);
+     return $vals["$field_name"];
+   }
 
   /**
    * returns information about custom fields definition
@@ -4115,71 +4681,63 @@
    * @return array of custom fields
    */
   function getCustomFields($indexedMode = 1, $filterUse = "", $filterShow = "") {
-    // we create an associative array if $indexedMode, otherwise it is just a list 
-    if ( $indexedMode ) {
-      $query = "SELECT field_name, field_label FROM ".$this->table_varfield_idx; 
-    }
-    else { 
-      $query = "SELECT * FROM ".$this->table_varfield_idx; 
-    }
-
-    // initialize connector, which will switch to 
-    // AND after the first query parameter is added
-    $connector = " WHERE ";
-
-    // we filter based on whether this custom field is used
-    // in tickets or projects
-    switch ( strtoupper(substr($filterUse,0,1)) ) {
-      case "P":
-        $query .= $connector . " use_for_project = 1 ";
-        $connector = " AND ";
-        break;
-      case "T":
-        $query .= $connector . " use_for_ticket = 1 ";
-        $connector = " AND ";
-        break;
-    }
-
-    // we filter based on the location we are viewing the custom
-    // field from, so that we only recieve fields which have been
-    // configured to appear in this location
-    switch ( strtoupper(substr($filterShow,0,1)) ) {
-      case "S":
-        $query .= $connector . " show_in_search = 1 ";
-        $connector = " AND ";
-        break;
-      case "L":
-        $query .= $connector . " show_in_list = 1 ";
-        $connector = " AND ";
-        break;
-      case "C":
-        $query .= $connector . " show_in_custom = 1 ";
-        $connector = " AND ";
-        break;
-      case "D":
-        $query .= $connector . " show_in_detail = 1 ";
-        $connector = " AND ";
-        break;
-      case "N":
-        $query .= $connector . " show_in_new = 1 ";
+    // try to retrieve from memory first
+    $vars = $this->_session->getCustomFields();
+    if( !is_array($vars) ) {
+      $query = "SELECT * FROM ".$this->table_varfield_idx." ORDER BY sort_order, field_label";
+      $this->addDebug("getCustomFields", "Generating variable fields: ".$query, 3);
+      
+      // all columns from db, indexed by field name
+      $vars = $this->db_queryIndexed($query);
       
+      // store session vals
+      $this->_session->storeCustomFields($vars);
+    }
+    
+    // if this is the default set, we are done
+    if( !$indexedMode && !strlen($filterUse) && !strlen($filterShow) ) {
+      return $vars;
     }
-    $query .= " ORDER BY sort_order, field_label";
 
-    $this->addDebug("getCustomFields", $query, 3);
+    // try to retrieve the subset from the global cache
+    $key = "$indexedMode:$filterUse:$filterShow";
+    $vals = $this->_session->getDataCache('customset',$key);
+    if( $vals ) { return $vals; }
     
-    if ( $indexedMode ) {
-      $vals = array();
-      $vars = $this->db_query($query);
-      for($i=0; $i<count($vars); $i++) {
-        $k = $vars[$i][0];
-        $vals["$k"] = $vars[$i][1];
+    // now retrieve the specific values desired and return
+    $vals = array();
+    $use = $filterUse? strtoupper(substr($filterUse,0,1)) : '';
+    $show = $filterShow? strtoupper(substr($filterShow,0,1)) : '';
+    for($i=0; $i<count($vars); $i++) {
+      $v = $vars[$i];
+      // we filter based on whether this custom field is used
+      // in tickets or projects
+      if( $use == 'P' && $v['use_for_project'] < 1 ) { continue; }
+      if( $use == 'T' && $v['use_for_ticket'] < 1 ) { continue; }
+      if( $show == 'S' && $v['show_in_search'] < 1 ) { continue; }
+      if( $show == 'L' && $v['show_in_list'] < 1 ) { continue; }
+      if( $show == 'C' && $v['show_in_custom'] < 1 ) { continue; }
+      if( $show == 'D' && $v['show_in_detail'] < 1 ) { continue; }
+      if( $show == 'N' && $v['show_in_new'] < 1 ) { continue; }
+      
+      // create the appropriate array values
+      if ( $indexedMode == 1 ) {
+        // indexed key=>label pairs
+        $vals["{$v['field_name']}"] = $v['field_label'];
+      }
+      else if( $indexedMode == 2 ) {
+        $vals["{$v['field_name']}"] = $v;
+      }
+      else {
+        $vals[] = $v;
       }
-      return( $vals );
-    } 
-    else {
-      return( $this->db_queryIndexed($query) );
     }
+    
+    // store our set in globals for the time
+    // this is particularly useful when calling rows one at a time
+    $this->_session->storeDataCache('customset',$key,$vals);
+    
+    return( $vals );
   }
 
   /**
@@ -4200,15 +4758,24 @@
    */
   function getBins($flag = 0,$active = 1) {
     if( !$flag ) {
+      // try loading from session
+      $vals = $this->_session->getDataType('bins');
+      if( $vals ) { return $vals; }
+      
+      // query database if needed
       $query = "SELECT bid, name FROM ".$this->table_bins;
       if( $active )
-        $query .= " WHERE active = $active";       
-      $vars = $this->db_query($query);
+        $query .= " WHERE active = $active";
+      $vars = $this->db_query($query." ORDER BY priority DESC, name");
       foreach($vars as $v) {
         $vals["$v[0]"] = $v[1];
       }
+      
+      // store in session before we finish
+      $this->_session->storeDataType('bins',$vals);
       return($vals);
     } else {
+      // never store or retrieve complete info from session
       $query = "SELECT * FROM ".$this->table_bins;
       if( $active )
         $query .= " WHERE active = $active";
@@ -4216,7 +4783,7 @@
       return( $this->db_queryIndexed($query) );
     }
   }
-
+  
   /**
    * returns whether a zen->settings["field"] is an On/Off type
    *
@@ -4328,15 +4895,23 @@
     // and alphebetized      
 
     if( !$flag ) {
+      // try loading from session
+      $vals = $this->_session->getDataType('tasks');
+      if( $vals ) { return $vals; }
+
       $query = "SELECT task_id, name, priority FROM ".$this->table_tasks;
       if( $active )
         $query .= " WHERE active = $active";
-      $vars = $this->db_query($query);
+      $vars = $this->db_query($query." ORDER BY priority DESC, name");
       if( is_array($vars) ) {
         foreach($vars as $v) {
           $vals["$v[0]"] = $v[1];
         }
       }
+      
+      // place in session before we finish
+      $this->_session->storeDataType('tasks',$vals);
+      
       return $vals;
     } else {
       $where = ($active)? " WHERE active = $active" : "";
@@ -4352,6 +4927,10 @@
     // an array of names indexed by id
 
     if( !$flag ) {
+      // try loading from session
+      $vals = $this->_session->getDataType('systems');
+      if( $vals ) { return $vals; }
+
       $query = "SELECT sid, name FROM ".$this->table_systems;
       if( $active )
         $query .= " WHERE active = $active ORDER BY priority DESC, name";
@@ -4361,6 +4940,10 @@
           $vals["$v[0]"] = $v[1];
         }
       }
+      
+      // store in session
+      $this->_session->storeDataType('systems',$vals);
+      
       return($vals);
     } else {
       $where = ($active)? " WHERE active = $active" : "";
@@ -4376,14 +4959,22 @@
     // list sorted by priority
 
     if( !$flag ) {
+      // try loading from session
+      $vals = $this->_session->getDataType('priorities');
+      if( $vals ) { return $vals; }
+      
       $query = "SELECT pid,priority,name FROM ".$this->table_priorities;
       if( $active )
         $query .= " WHERE active = $active";
-      $vars = $this->db_query($query);
+      $vars = $this->db_query($query." ORDER BY priority DESC, name");
       for($i=0; $i<count($vars); $i++) {
         $p = $vars[$i][0];
         $vals["$p"] = $vars[$i][2];
       }
+      
+      // store in session
+      $this->_session->storeDataType('priorities',$vals);
+      
       return($vals);
     } else {
       $where = ($active)? " WHERE active = $active" : "";
@@ -4405,15 +4996,22 @@
     }
     return $pri;
   }
-
+  
   function getSettings($flag = 0) {
     // pulls the variables from the settings table
     // into an indexed array.
     // if flag is set, then it retrieves all
     // data for the settings into an array
     // otherwise, just sets a string equal to the value
-    global $rootUrl;        
-
+    
+    // attempt to retrieve from the session if possible
+    if( !$flag ) {
+      $settings = $this->_session->getDataType('settings');
+      if( $settings ) { return $settings; }
+    }
+    
+    // load from the database
+    global $rootUrl;
     $fields = ($flag)? "*" : "name, value";
     if( $flag )
       $order = " ORDER BY name";
@@ -4421,8 +5019,8 @@
       $order = "";
     $query = "SELECT $fields FROM ".$this->table_settings." $order";
     $vars = $this->db_queryIndexed($query);
-    if( isset($rootUrl) && $rootUrl != "" ) {
-      foreach($vars as $v) {
+    foreach($vars as $v) {
+      if( isset($rootUrl) && $rootUrl != "" ) {
         if( preg_match("@^url_@",$v["name"]) ) {
           if(preg_match("@/$@", $rootUrl) && preg_match("@^/@", $v["value"]) ) {
             preg_replace("@/$@", $rootUrl) . $v["value"];
@@ -4433,10 +5031,18 @@
             $v["value"] = $rootUrl . $v["value"];
           }
         }
-        $vals["{$v['name']}"] = ($flag)? $v : $v["value"];
       }
-      return($vals);
+      $vals["{$v['name']}"] = ($flag)? $v : $v["value"];
     }
+    
+    $this->addDebug('getSettings', "Retrieved ".count($vals)." settings from database", 3);
+    
+    // store vals in session
+    if( !$flag ) {
+      $this->_session->storeDataType('settings',$vals);      
+    }
+    
+    return($vals);
   }
 
   function getTypeName($id) {
@@ -4451,8 +5057,11 @@
     // indexed array, otherwise, just
     // a list of names ordered by priority
     // and alphebetized
-
     if( !$flag ) {
+      // try loading from session
+      $vals = $this->_session->getDataType('types');
+      if( $vals ) { return $vals; }
+      
       $query = "SELECT type_id,name FROM ".$this->table_types;
       if( $active )
         $query .= " WHERE active = $active ORDER BY priority DESC, name";
@@ -4462,6 +5071,10 @@
           $vals["$v[0]"] = $v[1];
         }
       }
+      
+      // store in session
+      $this->_session->storeDataType('types',$vals);
+      
       return($vals);
     } else {
       $where = ($active)? " WHERE active = $active" : "";
@@ -4617,6 +5230,7 @@
     include("$file");
 
     $this->zen();
+    $this->_session =& new ZenSessionManager($this);
     $this->DB( $this->database_host, $this->database_login, 
                $this->database_password, $this->database_instance);
 
@@ -4917,7 +5531,7 @@
     return $id;
   }
   
-  function get_open_tickets($id,$type) {
+/*   function get_open_tickets($id,$type,$orderby='otime DESC') {
     // get open tickets of a contact
     
     $ids2 = array(); //arry for person ids
@@ -4969,8 +5583,47 @@
     }
     
     return($tickets);
+  } */
+  
+  /**
+   * Returns a list of tickets associated with a given company
+   *
+   * @param int $company_id an id from the zentrack_company.company_id field
+   * @param string $order_by see includes/sorting.php
+   */
+  function getTicketsByCompany($company_id, $sort) {
+    // collect a list of tickets belonging to any contact within the current company
+    // (or simply belonging to the company itself)
+    $id = $this->checkNum($company_id);
+    $query = "SELECT ticket_id FROM ZENTRACK_RELATED_CONTACTS c, ZENTRACK_EMPLOYEE e"
+        ." WHERE (cp_id = '$id' AND c.type='1')"
+        ." OR (c.type='2' AND c.cp_id = e.person_id AND e.company_id = '$id')";
+    $ids = array_unique($this->db_list($query));
+    $this->addDebug("getTicketsByCompany","[".count($ids)."]".$query,3);
+    // skip query if there are no ids to retrieve
+    if( !count($ids) ) { return array(); }
+    // using our list of ids, call the get_tickets method normally 
+    return $this->get_tickets( array('id'=>$ids), $sort );
   }
    
+  /**
+   * Returns a list of tickets associated with a given contact
+   *
+   * @param int $company_id an id from the zentrack_employee.person_id field
+   * @param string $sort see includes/sorting.php
+   */
+  function getTicketsByPerson($person_id, $sort) {
+    // collect a list of tickets matching the current contact
+    $id = $this->checkNum($person_id);
+    $query = "SELECT ticket_id FROM ZENTRACK_RELATED_CONTACTS WHERE cp_id = '".$id."' AND type ='2'";
+    $ids = array_unique($this->db_list($query));
+    $this->addDebug("getTicketsByEmployee","[".count($ids)."]".$query,3);
+    // skip query if there are no ids to retrieve
+    if( !count($ids) ) { return array(); }
+    // using our list of ids, call the get_tickets method normally 
+    return $this->get_tickets( array('id'=>$ids), $sort );
+  }
+
   function get_contact_all() {
     // get all companys for the droplists
     $query = "SELECT company_id,title,office FROM ZENTRACK_COMPANY ORDER BY title asc";
@@ -5051,9 +5704,11 @@
   //paging feature
   function build_geturl()
    {
-    list($fullfile, $voided) = explode("?", $_ENV['REQUEST_URI']);
-    $cgi = $_ENV['REQUEST_METHOD'] == 'GET' ? $_GET : $_POST;
+    list($fullfile, $voided) = explode("?", $_SERVER['REQUEST_URI']);
+    $cgi = $_SERVER['REQUEST_METHOD'] == 'GET' ? $_GET : $_POST;
 
+    if( !$fullfile ) { $fullfile = $_SERVER['SCRIPT_NAME']; }
+    
     reset ($cgi);
     while (list($key, $value) = each($cgi)) {
       if (( $key != "username" ) && ($key != "passphrase") ){
@@ -5147,7 +5802,15 @@
        $array[] = $next;
      }
      return $array;
-  }  
+  }
+  
+  
+  /** 
+   * Returns an instance of the session manager
+   *
+   * @return ZenSessionManager
+   */
+   function &getSessionManager() { return $this->_session; }
   
   /*
   **  VARIABLES TO CONFIGURE (in config file)
@@ -5185,6 +5848,7 @@
   var $table_attachments;
   var $actions;
   var $table_bins;
+  var $table_feild_map;
   var $table_logs;   
   var $table_logs_archived;
   var $table_preferences;
@@ -5199,11 +5863,14 @@
   var $table_tickets_archived;
   var $table_types;
   var $table_users;
-  var $table_translation_strings;
-  var $table_translation_words;
   var $table_notify_list;
+  var $table_behavior;
+  var $table_behavior_detail;
+  var $table_group;
+  var $table_group_detail;
+  var $table_varfield;
   var $table_varfield_idx;
-
+   
   var $cleanTempReports;
   var $reportImageWidth;
   var $reportImageHeight;
@@ -5233,6 +5900,9 @@
   // bug reports
   var $bugFrom;
   var $bugTo;
+  
+  // manages session and globals cache data, instance of ZenSessionManager
+  var $_session;
 }
 
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/www/actions/action_header.php zentrack_2-5-5-1/www/actions/action_header.php
--- zentrack_2-5-0-1/www/actions/action_header.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/action_header.php	2005-03-11 07:37:39.000000000 -0800
@@ -23,6 +23,21 @@
     include("../index.php");
     exit;
   }
+  
+  // check to insure that this user has access
+  // and this ticket allows the requested action
+  // to be completed
+  $ticket = $zen->get_ticket($id);
+  $tid = $ticket["type_id"];
+  if( in_array($tid,$zen->projectTypeIDs()) ) {
+    $ticket["children"] = $zen->getProjectChildren($id, 
+	    array("id,title,status,est_hours,wkd_hours"));
+    list($ticket["est_hours"],$ticket["wkd_hours"]) = $zen->getProjectHours($id);
+    $page_type = "project";
+  }  else {
+    $page_type = "ticket";
+  }
+  
   // use the filename to 
   // determine the action
   $basename = strtolower(preg_replace("@.*/([a-zA-Z0-9_-]+)\.php@", "\\1", $SCRIPT_NAME));
@@ -39,19 +54,6 @@
     $action = "view";
   }
   
-  // check to insure that this user has access
-  // and this ticket allows the requested action
-  // to be completed
-  $ticket = $zen->get_ticket($id);
-  $tid = $ticket["type_id"];
-  if( in_array($tid,$zen->projectTypeIDs()) ) {
-    $ticket["children"] = $zen->getProjectChildren($id, 
-	    array("id,title,status,est_hours,wkd_hours"));
-    list($ticket["est_hours"],$ticket["wkd_hours"]) = $zen->getProjectHours($id);
-    $page_type = "project";
-  }  else {
-    $page_type = "ticket";
-  }
   $setmode = "system";
 
   // find out if this is the ticket's creator (special conditions apply)
@@ -69,8 +71,9 @@
   }
 
   // set up page paremeters
-  $page_title = tr("Ticket #?", array($id));
+  $page_title = $page_type == "project"? tr("Project #?", array($id)) : tr("Ticket #?", array($id));
   $page_section = "Ticket #$id";
-  $expand_tickets = 1;
+  if( $page_type == 'project' ) { $expand_projects = 1; }
+  else { $expand_tickets = 1; }
 
 ?>
diff -Naur zentrack_2-5-0-1/www/actions/addToNotify.php zentrack_2-5-5-1/www/actions/addToNotify.php
--- zentrack_2-5-0-1/www/actions/addToNotify.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/addToNotify.php	2004-11-16 06:03:02.000000000 -0800
@@ -116,12 +116,6 @@
   
   include("$libDir/nav.php");
   
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
-    include("$templateDir/projectView.php");
-  } else {
-    include("$templateDir/ticketView.php");     
-  }
-  
-  include("$libDir/footer.php");
-  
-}?>
\ No newline at end of file
+  include("$rootWWW/ticket.php");
+
+}?>
diff -Naur zentrack_2-5-0-1/www/actions/agreement_edit.php zentrack_2-5-5-1/www/actions/agreement_edit.php
--- zentrack_2-5-0-1/www/actions/agreement_edit.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/agreement_edit.php	2004-11-22 13:19:04.000000000 -0800
@@ -3,7 +3,7 @@
   **  Action: edit ticket
   */
   include_once("../header.php");
-  $page_title = tr("Agreement #?", $id);
+  $page_title = tr("Agreement #?", array($id));
   $expand_agreement = 1;
   
   
@@ -12,7 +12,7 @@
   //add item button action
   if ($test=="test") {
 	
-	$description1 = nl2br(htmlspecialchars($description1));
+	$description1 = nl2br($zen->ffv($description1));
 	$agree_id = "0";
 	$create_time = time();
 
@@ -60,4 +60,4 @@
   include("$templateDir/editAgreementForm.php");
 
   include("$libDir/footer.php");
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/www/actions/close.php zentrack_2-5-5-1/www/actions/close.php
--- zentrack_2-5-0-1/www/actions/close.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-5-5-1/www/actions/close.php	2005-05-01 23:59:39.000000000 -0700
@@ -12,50 +12,61 @@
   include("action_header.php");
   
   if( $actionComplete == 1 ) {
-    $input = array(
-		   "id"       => "int",
-		   "comments" => "html"
-		   );
-    $required = array_keys($input);
-    $input["hours"] = "num";
-    $zen->cleanInput($input);
-    foreach($required as $r) {
-      if( !$$r ) {
-	$errs[] = tr(" ? is required", array($r));
-      }
-    }
+/*
+    $ticket = $zen->get_ticket($id);
+    $varfields = $zen->getVarfieldVals($id);
+    extract($varfields);
+    extract($ticket);
+*/
+    if (!isset($hours)) $hours=0;
+    if (!isset($comments)) $comments="";
+
+    $view = 'ticket_close';
+    include("$libDir/validateFields.php");
     
-    if( $zen->inProjectTypeIDs($ticket["type_id"]) ) {
-      $children = $zen->getProjectChildren($id,'id,type,status');
-      if( is_array($children) ) {
-	foreach($children as $c) {
-	  if( $c["status"] != "CLOSED" ) {
-	    $errs[] = tr("? ? is not completed.", array($zen->types[$c['type_id']], $c['id']));
-	  }
-	}
+    if( !$errs ) {
+      if( $zen->inProjectTypeIDs($ticket["type_id"]) ) {
+        $children = $zen->getProjectChildren($id,'id,type,status');
+        if( is_array($children) ) {
+          foreach($children as $c) {
+            if( $c["status"] != "CLOSED" ) {
+              $errs[] = tr("? ? is not completed.", array($zen->types[$c['type_id']], $c['id']));
+            }
+          }
+        }
       }
     }
-    
     if( !$errs ) {
+     $params = array();
+     // create an array of existing fields
+     foreach(array_keys($fields) as $f) {
+       $params["$f"] = $$f;
+     }
+
       $res = $zen->close_ticket($id, $login_id, $hours, $comments);
-      if( $res ) {
-	add_system_messages(tr("Ticket ? has been closed", array($id)));
-	$setmode = "details";
-	include("../ticket.php");
-	exit;
-	//header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
-      } else {
-	$errs[] = tr("System error: Ticket ? could not be closed",array($id)).$zen->db_error;
+      if( !$res ) {
+        $errs[] = tr("Could not close ticket."). " ".$zen->db_error;
+      } else if( $varfields && count($varfield_params) ) {
+        // update the variable field entries for this ticket
+        $res = $zen->updateVarfieldVals($id, $varfield_params);
+        if( !$res ) {
+          add_system_mesages(tr("? ? closed, but variable fields could not be saved", array(tr('Ticket'),$id)));
+        } else {
+          add_system_messages(tr("Ticket ? has been closed", array($id)));
+        }
       }
+      $setmode="details";
+    }
+    if( $errs ) {
+      add_system_messages( $errs, 'Error' );
     }
-    if( $errs )
-      add_system_messages( $errs, 'Error' );     
   }
-  
+
   include("$libDir/nav.php");
-  
-  if( $actionComplete == 1 )
-    $ticket = $zen->get_ticket($id);
+
+  $ticket = $zen->get_ticket($id);
+  $varfields = $zen->getVarfieldVals($id);
+  extract($varfields);
   extract($ticket);
   if( strtolower($zen->types["$type_id"]) == "project" ) {
      include("$templateDir/projectView.php");
diff -Naur zentrack_2-5-0-1/www/actions/contact_edit.php zentrack_2-5-5-1/www/actions/contact_edit.php
--- zentrack_2-5-0-1/www/actions/contact_edit.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/contact_edit.php	2004-11-23 10:34:15.000000000 -0800
@@ -3,7 +3,7 @@
   **  Action: edit ticket
   */
   include_once("../header.php");
-  $page_title = tr("Contact #?", $id);
+  $page_title = tr("Contact #?", array($id));
   $expand_contact = 1;
   
   
diff -Naur zentrack_2-5-0-1/www/actions/edit.php zentrack_2-5-5-1/www/actions/edit.php
--- zentrack_2-5-0-1/www/actions/edit.php	2004-08-24 01:48:00.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/edit.php	2005-03-11 07:37:39.000000000 -0800
@@ -3,7 +3,9 @@
   **  Action: edit ticket
   */
   include("action_header.php");
-  $page_tile = tr("Edit Ticket");
+  
+  
+  $page_title = tr("Edit Ticket");
   $onLoad = array("behavior_js.php?formset=ticketForm");
   include("$libDir/nav.php");
 
diff -Naur zentrack_2-5-0-1/www/actions/editProjectSubmit.php zentrack_2-5-5-1/www/actions/editProjectSubmit.php
--- zentrack_2-5-0-1/www/actions/editProjectSubmit.php	2003-03-06 10:18:01.000000000 -0800
+++ zentrack_2-5-5-1/www/actions/editProjectSubmit.php	2005-02-28 12:02:31.000000000 -0800
@@ -13,6 +13,7 @@
 
   // set the type to project
   $type = "project";
+  $page_type = 'project';
 
   include("editTicketSubmit.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/www/actions/editSubmit.php zentrack_2-5-5-1/www/actions/editSubmit.php
--- zentrack_2-5-0-1/www/actions/editSubmit.php	2004-08-13 01:01:47.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/editSubmit.php	2005-02-28 12:02:32.000000000 -0800
@@ -8,7 +8,7 @@
   
   include("action_header.php");
 
-  $page_tile = tr("Commit Edited Ticket");
+  $page_title = tr("Commit Edited Ticket");
   $expand_tickets = 1;
 
   // initiate default values
@@ -37,19 +37,28 @@
 		  "deadline"    => "int",
 		  "start_date"  => "int"
 		  );
- $required = array(
-		   "title",
-		   "priority",
-		   "description",
-		   "bin_id",
-		   "type_id",
-		   "system_id"
-		   );
+      
+  $fields = $map->getFieldMap('ticket_edit');
+  $required = array();
+  foreach($fields as $f=>$field) {
+    if( $field['is_required'] ) {
+      $required[] = $f;
+    }
+  }
+
+ // $required = array(
+		   // "title",
+		   // "priority",
+		   // "description",
+		   // "bin_id",
+		   // "type_id",
+		   // "system_id"
+		   // );
   $zen->cleanInput($fields);
   // check for required fields
   foreach($required as $r) {
-     if( !$$r ) {
-	$errs[] = tr("? is a required field", array(ucfirst($r)));
+     if( !strlen($$r) ) {
+       $errs[] = tr("? is a required field", array(ucfirst($r)));
      }
   }
   if( !$errs ) {
@@ -77,6 +86,7 @@
      add_system_messages($errs);
      include("$libDir/nav.php");
      $zen->print_errors($errs);
+     $view = "ticket_edit";
      include("$templateDir/newTicketForm.php");
      include("$libDir/footer.php");
   }
diff -Naur zentrack_2-5-0-1/www/actions/email.php zentrack_2-5-5-1/www/actions/email.php
--- zentrack_2-5-0-1/www/actions/email.php	2004-10-12 22:49:08.000000000 -0700
+++ zentrack_2-5-5-1/www/actions/email.php	2005-03-21 09:55:55.000000000 -0800
@@ -73,7 +73,13 @@
            // Generate log entry with list of email addresses
            $entry = "Ticket emailed to ";
            foreach ($recipients as $v) {
-             $entry .= $v . ", ";
+             if ($zen->checkNum($v) >0) {
+               $user_info=$zen->get_user($v);
+               $v1="[".$v." - ".$user_info["email"]."]";
+             } else {
+               $v1=$v;
+             }
+             $entry .= $v1 . ", ";
            }
            $entry = substr($entry, 0, -2);
            $logParams["entry"] = $entry;
diff -Naur zentrack_2-5-0-1/www/actions/print.php zentrack_2-5-5-1/www/actions/print.php
--- zentrack_2-5-0-1/www/actions/print.php	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-5-5-1/www/actions/print.php	2004-11-01 11:19:22.000000000 -0800
@@ -200,7 +200,7 @@
         if (get_magic_quotes_runtime()) {
            $d = stripslashes($d);
         }
-        $d = nl2br(htmlspecialchars($d));
+        $d = nl2br($zen->ffv($d));
         
         echo $d;
       ?>
@@ -276,7 +276,7 @@
    if (get_magic_quotes_runtime()) {
        $e = stripslashes($e);
    }
-   $e = nl2br(htmlentities($e));
+   $e = nl2br($zen->ffv($e));
    print ($l["entry"])? 
 	  $zen->showDateTime($l["created"])."  "
 	  .$l["action"]."-"
diff -Naur zentrack_2-5-0-1/www/addAgreementSubmit.php zentrack_2-5-5-1/www/addAgreementSubmit.php
--- zentrack_2-5-0-1/www/addAgreementSubmit.php	2004-09-03 08:41:49.000000000 -0700
+++ zentrack_2-5-5-1/www/addAgreementSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -14,7 +14,7 @@
     exit;
   }
 
-  $page_tile = tr("Commit New Agreement");
+  $page_title = tr("Commit New Agreement");
   $expand_agreements = 1;
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/www/addContactSubmit.php zentrack_2-5-5-1/www/addContactSubmit.php
--- zentrack_2-5-0-1/www/addContactSubmit.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-5-5-1/www/addContactSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -14,7 +14,7 @@
     exit;
   }
 
-  $page_tile = tr("Commit New Project");
+  $page_title = tr("Commit New Project");
   $expand_contacts = 1;
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/www/addContacteSubmit.php zentrack_2-5-5-1/www/addContacteSubmit.php
--- zentrack_2-5-0-1/www/addContacteSubmit.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-5-5-1/www/addContacteSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -14,7 +14,7 @@
     exit;
   }
 
-  $page_tile = tr("Commit New Project");
+  $page_title = tr("Commit New Project");
   $expand_contacts = 1;
 
   // initiate default values
diff -Naur zentrack_2-5-0-1/www/addProjectSubmit.php zentrack_2-5-5-1/www/addProjectSubmit.php
--- zentrack_2-5-0-1/www/addProjectSubmit.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/www/addProjectSubmit.php	2005-05-01 23:59:39.000000000 -0700
@@ -9,15 +9,17 @@
   include("header.php");
   
   if( !$zen->checkAccess($login_id,$bin_id,"create") ) {
-    $page_tile = "Access Error";
+    $page_title = "Access Error";
     $msg = "<p class='hot'>" . tr("You do not have permission to create tickets in this bin.") . "</p>\n"; 
     include("$libDir/nav.php");     
     include("$libDir/footer.php");
     exit;
   }
   
-  $page_tile = tr("Commit New Project");
+  $page_title = tr("Commit New Project");
   $expand_projects = 1;
+  $page_type = "project";
+  $view = 'project_create';
   
   // initiate default values
   $otime = time();  // set time ticket opened
@@ -29,37 +31,14 @@
   }
   
   $type_id = $zen->projectTypeID();
-  $description = nl2br(htmlspecialchars($description));
+  $description = nl2br($zen->ffv($description));
+  
+  include("$libDir/validateFields.php");
   
-  $fields = array(
-  "title"       => "text",
-  "priority"    => "int",
-  "description" => "ignore",
-  "otime"       => "int",
-  "bin_id"       => "int",
-  "type_id"      => "int",
-  "user_id"      => "int",
-  "system_id"    => "int",
-  "tested"      => "int",
-  "approved"    => "int",
-  "relations"   => "text",
-  "project_id"   => "int",
-  "est_hours"   => "num",
-  "deadline"    => "int",
-  "start_date"  => "int"
-  );
-  $required = array(
-  "title",
-  "priority",
-  "description",
-  "bin_id",
-  "type_id",
-  "system_id"
-  );
   $zen->cleanInput($fields);
   // check for required fields
   foreach($required as $r) {
-    if( !$$r ) {
+    if( !strlen($$r) ) {
       $errs[] = tr("required field missing:") . " " . ucfirst($r);
     }
   }
@@ -75,25 +54,13 @@
     $id = $zen->add_ticket($params);
     // check for errors
     if( !$id ) {
-      $errs[] = tr("Could not create ticket.") . " " .$zen->db_error;
+      $errs[] = tr("Could not create project.") . " " .$zen->db_error;
     }
     else {
-      // parse variable fields which appear in new ticket screen, 
-      // store them in $varfield_params
-      // insure that all requirements are met before proceeding
-      // with the ticket save process
-      $customFieldsArray = false;
-      if( !$errs ) {
-        $customFieldsArray = $zen->getCustomFields(0, 'Project', 'New');
-        if( $customFieldsArray && count($customFieldsArray) ) {
-          include("$libDir/parseVarfields.php");
-        }
-      }
-      
-      if( $customFieldsArray && count($varfield_params) ) {
+      if( $varfields && count($varfield_params) ) {
         $res = $zen->updateVarfieldVals($id, $varfield_params, $login_id, $bin_id);
         if( !$res ) {
-          $errs[] = tr("? created, but variable fields could not be saved", tr('Project'));
+          $errs[] = tr("? created, but variable fields could not be saved", array(tr('Project')));
         }
       }      
     }
@@ -107,7 +74,8 @@
     $onLoad[] = "behavior_js.php?formset=ticketForm";
     include("$libDir/nav.php");
     $zen->print_errors($errs);
-    include("$templateDir/newProjectForm.php");
+    $view = "project_create";
+    include("$templateDir/newTicketForm.php");
     include("$libDir/footer.php");
   }
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/www/addSubmit.php zentrack_2-5-5-1/www/addSubmit.php
--- zentrack_2-5-0-1/www/addSubmit.php	2004-09-08 01:22:42.000000000 -0700
+++ zentrack_2-5-5-1/www/addSubmit.php	2005-05-01 23:59:39.000000000 -0700
@@ -10,14 +10,17 @@
   include_once("./header.php");
   
   if( !$zen->checkAccess($login_id,$bin_id,"create") ) {
-    $page_tile = tr("Access Error");
+    $page_title = tr("Access Error");
     $msg = "<p class='hot'>" . tr("You do not have permission to create tickets in this bin.") . "</p>\n"; 
     include("$libDir/nav.php");     
     include("$libDir/footer.php");
     exit;
   }
   
-  $page_tile = tr("Commit New Ticket");
+  $page_type = 'ticket';
+  $view = 'ticket_create';
+  
+  $page_title = tr("Commit New Ticket");
   $expand_tickets = 1;
   
   // initiate default values
@@ -29,53 +32,9 @@
     $start_date = $zen->dateParse($start_date);
   }
   
-  $description = htmlspecialchars($description);
-  
-  $fields = array(
-  "title"       => "text",
-  "priority"    => "int",
-  "description" => "ignore",
-  "otime"       => "int",
-  "bin_id"       => "int",
-  "type_id"      => "int",
-  "user_id"      => "int",
-  "system_id"    => "int",
-  "tested"      => "int",
-  "approved"    => "int",
-  "relations"   => "text",
-  "project_id"   => "int",
-  "est_hours"   => "num",
-  "deadline"    => "int",
-  "start_date"  => "int"
-  );
-  $required = array(
-  "title",
-  "priority",
-  "description",
-  "bin_id",
-  "type_id",
-  "system_id"
-  );
-  $zen->cleanInput($fields);
-  
-  // check for required fields
-  foreach($required as $r) {
-    if( !$$r ) {
-      $errs[] = tr("Required field missing:") . " " . ucfirst($r);
-    }
-  }
-  
-  // parse variable fields which appear in new ticket screen, 
-  // store them in $varfield_params
-  // insure that all requirements are met before proceeding
-  // with the ticket save process
-  $customFieldsArray = false;
-  if( !$errs ) {
-    $customFieldsArray = $zen->getCustomFields(0, $page_type, 'New');
-    if( $customFieldsArray && count($customFieldsArray) ) {
-      include("$libDir/parseVarfields.php");
-    }
-  }
+  $description = $zen->ffv($description);
+
+  include("$libDir/validateFields.php");
   
   if( !$errs ) {
     // create an array of existing fields
@@ -91,10 +50,10 @@
     $id = $zen->add_ticket($params);
     
     // update the variable field entries for this ticket
-    if( $id && $customFieldsArray && count($varfield_params) ) {
+    if( $id && $varfields && count($varfield_params) ) {
       $res = $zen->updateVarfieldVals($id, $varfield_params);
       if( !$res ) {
-        $errs[] = tr("? created, but variable fields could not be saved", tr('Ticket'));
+        $errs[] = tr("? created, but variable fields could not be saved", array(tr('Ticket')));
       }      
     }
     
@@ -116,7 +75,8 @@
     $onLoad[] = "behavior_js.php?formset=ticketForm";
     include("$libDir/nav.php");
     $zen->print_errors($errs);
+    $view = "ticket_create";
     include("$templateDir/newTicketForm.php");
     include("$libDir/footer.php");
   }
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/www/admin/access.php zentrack_2-5-5-1/www/admin/access.php
--- zentrack_2-5-0-1/www/admin/access.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/access.php	2005-02-09 05:56:15.000000000 -0800
@@ -65,7 +65,7 @@
   }
 
   // show the page
-  $page_tile = tr("Admin Section");
+  $page_title = tr("Admin Section");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
   if( $user_id && !$skip ) {
diff -Naur zentrack_2-5-0-1/www/admin/addBehaviorSubmit.php zentrack_2-5-5-1/www/admin/addBehaviorSubmit.php
--- zentrack_2-5-0-1/www/admin/addBehaviorSubmit.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/addBehaviorSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = tr("Add Behavior Submit");
+  $page_title = tr("Add Behavior Submit");
 
   if( !$active )
     $active = 0;
diff -Naur zentrack_2-5-0-1/www/admin/addGroupSubmit.php zentrack_2-5-5-1/www/admin/addGroupSubmit.php
--- zentrack_2-5-0-1/www/admin/addGroupSubmit.php	2004-10-11 16:35:29.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/addGroupSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = tr("New Group Submit");
+  $page_title = tr("New Group Submit");
 
   if( !$active )
   $active = 0;
@@ -40,7 +40,7 @@
       $d = preg_replace('/([A-Z])/', ' \\1', $d);
       $d = str_replace('_', ' ', $d);
       $d = ucwords($d);
-      $errs[] = tr("$d is required");
+      $errs[] = tr("? is required",array($d));
     }
   }
 
@@ -62,9 +62,15 @@
       if( $group_id ) {
         $vars = $zen->generateDataGroupInfo( array($group_id) );
         $_SESSION['data_groups'][$group_id] = $vars[$group_id];
-        $msg = tr("Group '?' (ID=?) was added successfully. ? to edit this group's entries.",
-        array($NewGroupName, $group_id, "--link--" . tr("Click Here") . "</a>", $NewGroupName));
-        $msg = str_replace("--link--", "<br><a href='$rootUrl/admin/editGroupDetails.php?group_id=$group_id'>", $msg);
+
+        // print useful messages for user
+        $msg = tr("Group '?' was updated successfully.", array($NewGroupName));
+        if( $NewEvalType == 'Matches' ) {
+          $msg .= tr("? to customize this group's entries.",array("--link--"));
+          $msg = str_replace("--link--",
+            "<br><a href='$rootUrl/admin/editGroupDetails.php?group_id=$group_id'>"
+            .tr("Click Here")."</a>",$msg);
+        }
       } else {
         $errs[] = tr("System Error: Could not add ? to the system", array($NewGroupName));
       }
diff -Naur zentrack_2-5-0-1/www/admin/addUser.php zentrack_2-5-5-1/www/admin/addUser.php
--- zentrack_2-5-0-1/www/admin/addUser.php	2003-03-27 09:55:52.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/addUser.php	2005-02-09 05:56:15.000000000 -0800
@@ -9,7 +9,7 @@
   
   include("admin_header.php");
 
-  $page_tile = tr("New User");
+  $page_title = tr("New User");
 
   include("$libDir/nav.php");
 
diff -Naur zentrack_2-5-0-1/www/admin/addUserSubmit.php zentrack_2-5-5-1/www/admin/addUserSubmit.php
--- zentrack_2-5-0-1/www/admin/addUserSubmit.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/addUserSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = "New User Submit";
+  $page_title = "New User Submit";
 
   if( !$active )
     $active = 0;
diff -Naur zentrack_2-5-0-1/www/admin/admin_header.php zentrack_2-5-5-1/www/admin/admin_header.php
--- zentrack_2-5-0-1/www/admin/admin_header.php	2003-05-20 11:53:04.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/admin_header.php	2005-03-31 15:25:39.000000000 -0800
@@ -7,8 +7,8 @@
   $page_title = tr("Administration");
 
   $system_name = $zen->settings["system_name"];
-  if( $login_level < $zen->settings["level_settings"] ) {
-     $page_tile = "Access Error";    
+  if( $zen->checkNum($login_level) < $zen->settings["level_settings"] ) {
+     $page_title = "Access Error";    
      $msg = "<p class='hot'>" . tr("You do not have access to administrate zenTrack.") . "</p>\n"; 
      include("$libDir/nav.php");     
      include("$libDir/footer.php");
diff -Naur zentrack_2-5-0-1/www/admin/config.php zentrack_2-5-5-1/www/admin/config.php
--- zentrack_2-5-0-1/www/admin/config.php	2003-03-27 09:55:53.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/config.php	2005-02-09 05:56:15.000000000 -0800
@@ -67,7 +67,7 @@
   }
 
   if( !$skip ) {
-    $page_tile = tr("? Settings", array($zen->settings["system_name"]));
+    $page_title = tr("? Settings", array($zen->settings["system_name"]));
     include("$libDir/nav.php");
     $zen->printErrors($errs);
     include("$templateDir/configSettingsForm.php");
diff -Naur zentrack_2-5-0-1/www/admin/deleteGroup.php zentrack_2-5-5-1/www/admin/deleteGroup.php
--- zentrack_2-5-0-1/www/admin/deleteGroup.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/deleteGroup.php	2004-11-26 05:35:28.000000000 -0800
@@ -0,0 +1,45 @@
+<?
+  /*
+  **  DELETE GROUP
+  **  
+  **  Deletes a zenTrack Data Group
+  **
+  */
+  
+  
+  include("admin_header.php");
+  $group_id = $zen->checkNum($group_id);
+  $tmpltForm = "$templateDir/groupForm.php";
+  if( $group_id && $zen->demo_mode == "on" ) {
+    $msg = tr("The action completed successfully.  The data group was not actually deleted, because this is a demo site");
+  } else if ( $group_id && $TODO != "CANCEL" ) {
+    if ( $TODO == "DISABLE" ) {
+      $zen->disableReferencesToDataGroup($group_id);
+    } else if ( $TODO == "MOVE" ) {
+      $new_data_group = $zen->checkNum($new_data_group);
+      $zen->moveReferencesToDataGroup($group_id, $new_data_group);
+    }
+    $qty = $zen->queryReferencesToDataGroup($group_id);
+    if ( $qty == 0 ) {
+      $res = $zen->removeDataGroup($group_id);
+      if ( !$res ) {
+        $errs[] = tr("The data group (?) could not be found/deleted successfully", array($group_id));
+      } else {
+        $msg = tr("The data group (?) was successfully removed", array($group_id));
+        unset($_SESSION['data_groups']["$group_id"]);
+      }
+    } else {
+     $tmpltForm = "$templateDir/referencedGroupForm.php"; 
+    }
+  } else {
+    $msg = tr("The data group (?) WAS NOT removed", array($group_id));
+  }
+
+  $page_title = tr("Delete Data Group");
+  include("$libDir/nav.php");
+  $zen->printErrors($errs);
+  include($tmpltForm);
+  include("$libDir/footer.php");
+
+
+?>
diff -Naur zentrack_2-5-0-1/www/admin/editBehaviorSubmit.php zentrack_2-5-5-1/www/admin/editBehaviorSubmit.php
--- zentrack_2-5-0-1/www/admin/editBehaviorSubmit.php	2004-08-13 10:43:45.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/editBehaviorSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = tr("Edit Behavior Submit");
+  $page_title = tr("Edit Behavior Submit");
 
   if( !$active )
     $active = 0;
@@ -45,24 +45,24 @@
       $msg = tr("Process successful.  Behavior was not updated, because this is a demo site.");
     } else {
       $updflds = array(
-                  "behavior_name" => $NewBehaviorName,
-                  "group_id"      => $NewGroupId,
-                  "is_enabled"    => $NewIsEnabled,
-                  "sort_order"    => $NewSortOrder,
-                  "field_name"    => $NewFieldName,
-                  "field_enabled" => $NewFieldEnabled,
-                  "match_all"     => $NewMatchAll
-                       );
+      "behavior_name" => $NewBehaviorName,
+      "group_id"      => $NewGroupId,
+      "is_enabled"    => $NewIsEnabled,
+      "sort_order"    => $NewSortOrder,
+      "field_name"    => $NewFieldName,
+      "field_enabled" => $NewFieldEnabled,
+      "match_all"     => $NewMatchAll
+      );
       $res = $zen->updateBehavior($behavior_id,$updflds);
       if( $res ) {
-	$msg = tr("Behavior ? was updated successfully. ? to customize behavior ?'s details.",
-		  array($NewBehaviorName,
-			"--link--",
-			$NewBehaviorName));
-	$msg = str_replace("--link--","<br><a href='$rootUrl/admin/editBehaviorDetails.php?behavior_id=$behavior_id'>"
-			   .tr("Click Here")."</a>",$msg);
+        $msg = tr("Behavior ? was updated successfully. ? to customize behavior ?'s details.",
+        array($NewBehaviorName,
+        "--link--",
+        $NewBehaviorName));
+        $msg = str_replace("--link--","<br><a href='$rootUrl/admin/editBehaviorDetails.php?behavior_id=$behavior_id'>"
+        .tr("Click Here")."</a>",$msg);
       } else {
-	$errs[] = tr("System Error: Could not update ?", array($NewBehaviorName));
+        $errs[] = tr("System Error: Could not update ?", array($NewBehaviorName));
       }
     }
   }
diff -Naur zentrack_2-5-0-1/www/admin/editGroupSubmit.php zentrack_2-5-5-1/www/admin/editGroupSubmit.php
--- zentrack_2-5-0-1/www/admin/editGroupSubmit.php	2004-10-11 16:35:29.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/editGroupSubmit.php	2005-02-09 05:56:15.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = tr("Edit Group Submit");
+  $page_title = tr("Edit Group Submit");
 
   if( !$active )
     $active = 0;
@@ -40,7 +40,7 @@
       $d = preg_replace('/([A-Z])/', ' \\1', $d);
       $d = str_replace('_', ' ', $d);
       $d = ucwords($d);
-      $errs[] = tr("$d is required");
+      $errs[] = tr("? is required",array($d));
     }
   }
   
diff -Naur zentrack_2-5-0-1/www/admin/editProjectSubmit.php zentrack_2-5-5-1/www/admin/editProjectSubmit.php
--- zentrack_2-5-0-1/www/admin/editProjectSubmit.php	2003-03-06 10:18:01.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/editProjectSubmit.php	2005-02-28 12:02:32.000000000 -0800
@@ -13,6 +13,7 @@
 
   // set the type to project
   $type = "project";
+  $page_type = "project";
 
   include("editTicketSubmit.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/www/admin/editTicket.php zentrack_2-5-5-1/www/admin/editTicket.php
--- zentrack_2-5-0-1/www/admin/editTicket.php	2004-08-04 04:52:18.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/editTicket.php	2005-02-09 05:56:15.000000000 -0800
@@ -9,7 +9,7 @@
   
   
   include("admin_header.php");
-  $page_tile = tr("Edit Ticket");
+  $page_title = tr("Edit Ticket");
   $onLoad = array("behavior_js.php?formset=ticketForm");
   include("$libDir/nav.php");
 
diff -Naur zentrack_2-5-0-1/www/admin/editUser.php zentrack_2-5-5-1/www/admin/editUser.php
--- zentrack_2-5-0-1/www/admin/editUser.php	2003-03-27 09:55:53.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/editUser.php	2005-02-09 05:56:15.000000000 -0800
@@ -9,7 +9,7 @@
   
   include("admin_header.php");
 
-  $page_tile = "Edit User";
+  $page_title = "Edit User";
   include("$libDir/nav.php");
 
   $user = $zen->get_user($user_id);
diff -Naur zentrack_2-5-0-1/www/admin/editUserSubmit.php zentrack_2-5-5-1/www/admin/editUserSubmit.php
--- zentrack_2-5-0-1/www/admin/editUserSubmit.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-5-5-1/www/admin/editUserSubmit.php	2005-02-09 05:56:16.000000000 -0800
@@ -8,7 +8,7 @@
   */
   
   include("admin_header.php");
-  $page_tile = tr("Edit User Submit");
+  $page_title = tr("Edit User Submit");
 
   if( !$active )
     $active = 0;
diff -Naur zentrack_2-5-0-1/www/admin/fieldMap.php zentrack_2-5-5-1/www/admin/fieldMap.php
--- zentrack_2-5-0-1/www/admin/fieldMap.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/fieldMap.php	2005-05-04 14:39:36.000000000 -0700
@@ -0,0 +1,178 @@
+<?
+
+  /*
+  **  EDIT FIELD MAP
+  **  
+  **  Edit/create/delete/sort entries in the field map
+  **
+  */
+  
+  include("admin_header.php");
+  $page_title = tr("Edit Field Map");
+  include("$libDir/nav.php");
+  function fmGetSet( $name, $key, $type = '' ) {
+    // don't make updates on rows that don't exist (we may skip some fields occasionally
+    if( !array_key_exists($name, $_POST) ) {
+      return;
+    }
+    // get the updates array
+    global $updates;
+    global $zen;
+    // process the type
+    $t = substr($type,0,1);
+    // handle fields which don't get posted (booleans which are not checked)
+    if( !array_key_exists($key, $_POST[$name]) ) { 
+      $updates[$name][$key] = $t == 'b'? 0 : null;
+      return;
+    }
+    // format the value
+    switch( $t ) {
+      case "i": //int
+        $v = $zen->checkNum($_POST[$name][$key]);
+        break;
+      case "b": //boolean
+        $v = $_POST[$name][$key]? 1 : 0;
+        break;
+      case "t": //text
+        $v = strip_tags($_POST[$name][$key]);
+        break;
+      default:
+        $v = $_POST[$name][$key];
+    }
+    $updates[$name][$key] = $v;
+  }
+  
+  if( !$view || !in_array($view, array_keys($GLOBALS['zt_field_dependencies']['views'])) ) {
+    $view = 'ticket_create';
+  }
+  
+  if( $TODO == 'save' && $zen->demo_mode == "on" ) {
+    $errs[] = "Your operation was completed, but you cannot edit the field map on a demo site.";
+  }
+  else if( $TODO == 'save' ) {
+    $deletes = array();
+    $inserts = array();
+    $vprops = getFmViewProps($view);
+
+    // copy values for editing
+    $allFields = $map->getFieldMap();
+    $updates = $allFields[$view];
+    unset($allFields);
+    //Zen::printArray($_POST, 'POST_VALS');
+    
+    $fields = $map->listFieldsForView($view);
+    foreach($fields as $f) {
+      // collect field properties
+      $field = $map->getFieldFromMap($view, $f);
+      $tprops = getFmTypeProps($field['field_type']);
+      
+      // remove deleted sections
+      if( $field['field_type'] == 'section' && !isset($_POST[$f]) ) {
+        $deletes[$f] = $field['field_map_id'];
+      }
+      // skip rows that aren't sent
+      else if( !isset($_POST[$f]) ) { continue; }
+      
+      // field_label
+      fmGetSet($f, 'field_label', 'text');
+      // is_visible
+      fmGetSet($f, 'is_visible', 'boolean');
+
+      // num_cols
+      fmGetSet($f, 'num_cols', 'int');
+      
+      // num_rows
+      if( !$tprops['multiple'] && !$vprops['multiple'] ) {
+        $updates[$f]['num_rows'] = 1;
+      }
+      else { fmGetSet($f, 'num_rows', 'int'); }
+
+      // the rest does not apply to sections
+      if( $field['field_type'] == 'section' ) { continue; }
+      
+      // properties for this field
+      $fprops = getFmFieldProps($view, ZenFieldMap::fieldName($f));
+
+      // field_type is automagic for view_only
+      if( $vprops['view_only'] ) { $updates[$f]['field_type'] = 'label'; }
+      // we don't give the user an option on the form, so don't bother here either
+      else if( count($fprops['types']) == 1 ) { $updates[$f]['field_type'] = $fprops['types'][0]; }
+      else if( array_key_exists('field_type', $_POST[$f]) &&
+               !in_array($_POST[$f]['field_type'], $fprops['types']) ) {
+        // here we have a problem, someone has tried to set a type that is
+        // not valid
+        $errs[] = "$f cannot be set to field_type '".$_POST[$f]['field_type']."'";
+      }
+      // otherwise we post it normally
+      else if( array_key_exists('field_type', $_POST[$f]) )
+        { fmGetSet($f, 'field_type'); }
+      
+      // is_required
+      if( $vprops['view_only'] ) { $updates[$f]['is_required'] = false; }
+      else if( $view == 'search_form' ) { $updates[$f]['is_required'] = false; }
+      else if( $fprops['always_required'] ) { $updates[$f]['is_required'] = true; }
+      else { fmGetSet($f, 'is_required', 'boolean'); }
+      
+      // default_val has some special considerations
+      if( !$vprops['view_only'] ) {
+        if( $fprops['default'] ) { fmGetSet($f, 'default_val'); }
+      }
+    }
+    
+    foreach($_POST as $k=>$v) {
+      if( strpos($k, 'section') === 0 && $vprops['sections'] && !array_key_exists($k,$updates) ) {
+        // skip section0, it's a template
+        if( $k == 'section0' ) { continue; }
+        // add the style
+        $inserts[$k] = array(
+          "field_name"  => $k,
+          "field_label" => strip_tags($_POST[$k]['field_label']),
+          "is_visible"  => $_POST[$k]['is_visible']? 1 : 0,
+          "which_view"  => $view,
+          "sort_order"  => 500,
+        );
+      }
+    }
+
+    // set the sort order
+    $i = 1;
+    asort($_POST['orderset']);
+    foreach( $_POST['orderset'] as $k=>$v ) {
+      if( array_key_exists($k, $updates) ) {
+        $updates[$k]['sort_order'] = $i++;
+      }
+      else if( array_key_exists($k, $inserts) ) {
+        $inserts[$k]['sort_order'] = $i++;
+      }
+    }
+
+    $total = count($updates) + count($inserts) + count($deletes);
+    if( !$total && !$errs ) {
+      $errs[] = "Nothing to update";
+    }
+    if( !$errs ) {
+      $res = $map->updateFieldMap($view, $updates, $inserts, $deletes);
+      print "<p><b>$res[0] of $res[1] updates were saved</b></p>\n";
+    }
+    
+    //cfalonso changed the following line with the next 3 because it didn't work properly:
+    //$fields = $updates;
+    $fields = $map->getFieldMap($view);
+    //Zen::printArray($orderset,'RECEIVED ORDERSET');
+    //Zen::printArray($updates,'UPDATES');
+    //Zen::printArray($inserts,'INSERTS');
+    //Zen::printArray($deletes,'DELETES');
+    
+  }
+  else {
+    $fields = $map->getFieldMap($view);
+  }
+  
+  $zen->printErrors($errs);
+
+  include("$templateDir/fieldMapForm.php");
+  
+  include("$libDir/footer.php");
+
+
+?>
diff -Naur zentrack_2-5-0-1/www/admin/index.php zentrack_2-5-5-1/www/admin/index.php
--- zentrack_2-5-0-1/www/admin/index.php	2003-03-27 09:55:53.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/index.php	2005-02-09 05:56:16.000000000 -0800
@@ -8,7 +8,7 @@
   
   
   include("admin_header.php");
-  $page_tile = tr("Admin Section");
+  $page_title = tr("Admin Section");
   include("$libDir/nav.php");
   include("$templateDir/adminMenu.php");
   include("$libDir/footer.php");
diff -Naur zentrack_2-5-0-1/www/admin/listUsers.php zentrack_2-5-5-1/www/admin/listUsers.php
--- zentrack_2-5-0-1/www/admin/listUsers.php	2003-03-27 09:55:53.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/listUsers.php	2005-02-09 05:56:16.000000000 -0800
@@ -8,7 +8,7 @@
   
   
   include("admin_header.php");
-  $page_tile = tr("Search for Users");
+  $page_title = tr("Search for Users");
   include("$libDir/nav.php");
 
   if( !$TODO ) {
diff -Naur zentrack_2-5-0-1/www/admin/resetPassword.php zentrack_2-5-5-1/www/admin/resetPassword.php
--- zentrack_2-5-0-1/www/admin/resetPassword.php	2003-03-27 09:55:53.000000000 -0800
+++ zentrack_2-5-5-1/www/admin/resetPassword.php	2005-02-09 05:56:16.000000000 -0800
@@ -26,7 +26,7 @@
     $errs[] = tr("No user id was recieved");
   }
 
-  $page_tile = tr("Reset Password");
+  $page_title = tr("Reset Password");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
   include("$templateDir/adminMenu.php");
diff -Naur zentrack_2-5-0-1/www/assignedProjects.php zentrack_2-5-5-1/www/assignedProjects.php
--- zentrack_2-5-0-1/www/assignedProjects.php	2003-03-21 10:37:35.000000000 -0800
+++ zentrack_2-5-5-1/www/assignedProjects.php	2005-05-01 23:59:39.000000000 -0700
@@ -9,12 +9,14 @@
   include("header.php");
 
   $page_type = "project";
+  $view = 'project_list';
+
   $params = array(
 		  "type_id"  => $zen->projectTypeIDs(),
 		  "status"  => array("OPEN","PENDING"),
 		  "user_id"  => $login_id
 		  );
-  $page_tile = tr("Projects");
+  $page_title = tr("Projects");
   $page_section = "Projects";
   if( $login_bin ) {
      $page_section .= " - ".$zen->bins["$login_bin"];
@@ -22,6 +24,7 @@
   $expand_projects = 1;
   include("$libDir/nav.php");
 
+  
   if( $login_bin ) {
     $params["bin_id"] = $login_bin;
   } else {
@@ -29,6 +32,7 @@
   }
   if( is_array($params) )
     $tickets = $zen->get_tickets($params);
+    
   include("$templateDir/listTickets.php");
 
   include("$libDir/footer.php");
diff -Naur zentrack_2-5-0-1/www/assignedTickets.php zentrack_2-5-5-1/www/assignedTickets.php
--- zentrack_2-5-0-1/www/assignedTickets.php	2004-09-09 17:04:59.000000000 -0700
+++ zentrack_2-5-5-1/www/assignedTickets.php	2005-03-08 13:09:36.000000000 -0800
@@ -8,6 +8,10 @@
   
   include("header.php");
 
+  $view = 'ticket_list';
+  $map = new ZenFieldMap($zen);
+  $fields = $map->getFieldMap($view);
+
   $page_title = tr("Tickets assigned") . ": $login_name";
   $expand_tickets = 1;
   include("$libDir/nav.php");
@@ -18,6 +22,7 @@
   if( $login_bin > 0 ) {
     $params["bin_id"] = $login_bin;
   }
+
   $tickets = $zen->get_tickets($params);
   include("$templateDir/listTickets.php");
   include("$libDir/paging.php"); //Addition for paging
diff -Naur zentrack_2-5-0-1/www/behavior_js.php zentrack_2-5-5-1/www/behavior_js.php
--- zentrack_2-5-0-1/www/behavior_js.php	2004-10-13 20:39:14.000000000 -0700
+++ zentrack_2-5-5-1/www/behavior_js.php	2005-04-13 09:11:44.000000000 -0700
@@ -74,6 +74,10 @@
         print ");\n";
       }      
     }
+    
+    $mode = $zen->checkAlpha($_GET['mode']);
+    if( !$mode ) { $mode = 'view'; }
+    $userBins = $zen->getUsersBins($login_id,"level_$mode");  
   
 ?>
 //<pre>
@@ -184,7 +188,7 @@
       if( $group && $group['eval_type'] == 'File' ) {
         // this is a file group, we have a more complex match here, since
         // one behavior can map to many sets of matches.
-        $sets = $zen->getBehaviorFileSet( $b, $group );
+        $sets = $zen->getBehaviorFileSet( $b, $group, $userBins, $mode );
         if( $sets && count($sets) ) {
           foreach($sets as $setid=>$vals) {
             genBehaviorFields($bid, $vals['matches'], &$fieldMap, $setid); 
@@ -297,6 +301,7 @@
   return false;
 }
 
+
 /**
  * Execute a behavior.  We flag all fields changed and insure
  * that they cannot be recursively edited by behaviors (to prevent
@@ -339,6 +344,19 @@
   // disable/enable field as appropriate
   fieldObj.disabled = behavior.disabled? true : false;
 
+  // disable/enable calendar icon and popup as appropriate
+  if (fieldObj.getAttribute('hascalendar')) {
+    var calendarIcon=document.getElementById(fieldObj.getAttribute('hascalendar'));
+    if (fieldObj.disabled) {
+      calendarIcon.src="images/disabled-cal.gif";
+      calendarIcon.oldonclick=calendarIcon.onclick;
+      calendarIcon.onclick=function() {return false;};
+    } else {
+      calendarIcon.src="images/cal.gif";
+      calendarIcon.onclick=calendarIcon.oldonclick;
+    }
+  }
+
   if( fieldObj.disabled ) {
     mClassX(fieldObj, 'inputDisabled');
   }
@@ -377,8 +395,11 @@
     // so we unencode it here and then replace occurences
     // of {form} with the form name
     var f = 'window.document.'+fieldObj.form.getAttribute('name');
+    var fn = f+'.'+fieldObj.name
     var s = unescape(group.evalText);
-    var vals = evalJsString( unescape(group.evalText).replace( /{form}/ig, f) );
+    s = s.replace( /\{form\}.\{field\}/ig, "{field}" );
+    s = s.replace( /{form}/ig, f);
+    var vals = evalJsString( s.replace(/{field}/ig, fn) );
 
     // clear any existing values from fields array
     group.fields = new Array();
@@ -407,17 +428,45 @@
   }
   behaviorDebug(3, "(setFormValsUsingGroup)updating "+fieldObj.name
 		+" using "+group.name+"["+fieldObj.type+"] with setid="+setid+" and values=["+v+"]");
+  // To be used for hidden, text, etc: set the oldPos value if the fieldObj.value is in the list
+  // (unless we do it, the first element of the list will always be assigned to the field, no matter if the fieldObj.value is in the list)
+  var oldPos = -1;
+  if ( fieldObj.value != null && typeof fieldObj.value != "undef" ) {
+    for(var i=0; i < fields.length && oldPos == -1; i++) {
+      if ( fields[i].value == fieldObj.value ) {
+        oldPos=i;
+      }
+    }
+  }
+  if ( oldPos == -1) {
+    for(var i=0; i < fields.length && oldPos == -1; i++) {
+      if (fields[i].label == fieldObj.value) {
+        oldPos=i;
+      }
+    }
+  }
+  if ( oldPos == -1) {
+    oldPos=0;
+    behaviorDebug(3, "(setFormValsUsingGroup)Did not recognize field value for "+fieldObj.name+" ("+fieldObj.value+")");
+  } else {
+    behaviorDebug(3, "(setFormValsUsingGroup)Recognized field value for "+fieldObj.name+" as ["+fields[oldPos].value+"]"+fields[oldPos].label);
+  }
   switch( fieldObj.type ) {
     case "checkbox":
       if( fields[0].value ) {
         fieldObj.checked = true;
       }
       break;
+    case "hidden":
+      var labelText = document.getElementById(fieldObj.name+"LabelText");
+      if( labelText ) {
+        labelText.innerHTML = fields[oldPos].label;
+      }
     case "button":
     case "submit":
     case "text":
     case "textarea":
-      fieldObj.value = fields[0].value;
+      fieldObj.value = fields[oldPos].value;
       break;
     case "select":
     case "select-one":
@@ -425,17 +474,20 @@
       if( fieldObj.selectedIndex && fieldObj.options && fieldObj.options.length > 0 ) {
         // store the currently selected value and try to reproduce in a minute
         var oldValue = fieldObj.options[ fieldObj.selectedIndex ].value;
+        behaviorDebug(3, "(setFormValsUsingGroup)storing oldValue="+oldValue);
       }
+      behaviorDebug(3, "(setFormValsUsingGroup)storing oldValue="+oldValue); 
       fieldObj.length = 0;
       for(var i=0; i < fields.length; i++) {
         var f = fields[i];
-        behaviorDebug(3, "(setFormValsUsingGroup)Setting option "+i+" to ["+f.label+"]"+f.value);
+        behaviorDebug(3, "(setFormValsUsingGroup)Setting option "+i+" to ["+f.value+"]"+f.label);
         fieldObj.options[i] = new Option();
         fieldObj.options[i].text = f.label;
         fieldObj.options[i].value = f.value;
         // try to set to the same value if possible
         if( f.value == oldValue ) {
-          fieldObj.options[i].selected = true;
+//          fieldObj.options[i].selected = true;
+          fieldObj.selectedIndex=i;
         }
       }
       break;
@@ -469,6 +521,7 @@
 function clearBehaviorFlags() {
   behaviorDebug(3, "(clearBehaviorFlags)all clear");
   behaviorFlags = new Array();
+  behaviorHistoryMap = new Array();
 }
 
 /**
@@ -562,7 +615,7 @@
   }
 
   fieldVal = getFormFieldValue(formField,behaviorMapField);
-  if( fieldVal ) { fieldVal = fieldVal.toLowerCase(); }
+  if( fieldVal && fieldVal.toLowerCase ) { fieldVal = fieldVal.toLowerCase(); }
 
   // store result
   var res = false;
@@ -709,7 +762,7 @@
     behaviorDebug(3, "(pageLoadedBehavior)loading form: "+behaviorFormSet[x].getAttribute('name'));
     for( var i=0; i < behaviorFormSet[x].elements.length; i++ ) {
       if( fieldMap[ behaviorFormSet[x].elements[i].name ] ) {
-	setBehaviorOnChange( behaviorFormSet[x].elements[i] );
+        setBehaviorOnChange( behaviorFormSet[x].elements[i] );
       }
       runFieldBehaviors( behaviorFormSet[x].elements[i] );
     }
@@ -723,8 +776,14 @@
  * Generate a function to handle onchange events for us
  */
 function setBehaviorOnChange( formElement ) {
-  var oldFun = formElement.onchange;
-  formElement.onchange = genBehaviorFunction( formElement, oldFun );
+  if( formElement.type == 'checkbox' ) {
+    var oldFun = formElement.onclick;
+    formElement.onclick = genBehaviorFunction( formElement, oldFun );
+  }
+  else {
+    var oldFun = formElement.onchange;
+    formElement.onchange = genBehaviorFunction( formElement, oldFun );
+  }
 }
 
 /**
@@ -748,7 +807,7 @@
 function getFormFieldValue( formField, behaviorMapField ) {
   switch( formField.type ) {
   case "checkbox":
-    return formField.checked? 'true' : 'false';
+    return formField.checked? 1 : 0;
   case "radio":
     for(var i=0; i < formField.length; i++) {
       if( formField[i].checked ) { return formField[i].value; }
@@ -816,4 +875,4 @@
   }
 ?>
 
-//</pre>
\ No newline at end of file
+//</pre>
diff -Naur zentrack_2-5-0-1/www/contact.php zentrack_2-5-5-1/www/contact.php
--- zentrack_2-5-0-1/www/contact.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-5-5-1/www/contact.php	2005-04-25 05:44:12.000000000 -0700
@@ -61,12 +61,16 @@
       if($pid){
 	    	include("$templateDir/contact_personBox.php"); 
 	    	if($overview=="tickets") {
-		    	//show open tickets
-					$tickets = $zen->get_open_tickets($id,"2");
+          //collect field map info
+          $view = 'ticket_list';
+          $fields = $map->getFieldMap($view);
+		    	//sort tickets
+          include("$libDir/sorting.php");
+          // collect open tickets
+          $tickets = $zen->getTicketsByPerson($id, join(',',$orderby));
+					//$tickets = $zen->get_open_tickets($id,"2");
 					
-					if ($tickets) {
-						include("$templateDir/listTickets.php");
-					}
+          include("$templateDir/listTickets.php");
 	    	}
 	    	
       } else {
@@ -82,13 +86,16 @@
 	  				include("$templateDir/agreement_list.php");
   				}
 				} elseif ($overview=="tickets") {
+          //collect field map info
+          $view = 'ticket_list';
+          $fields = $map->getFieldMap($view);
+          // sort tickets
+          include("$libDir/sorting.php");
 					//show open tickets
-					$tickets = $zen->get_open_tickets($id,"1");
-					
+					//$tickets = $zen->get_open_tickets($id,"1");
+          $tickets = $zen->getTicketsByCompany($id,join(',',$orderby));
 					echo "<br>";
-					if ($tickets) {
-						include("$templateDir/listTickets.php");
-					}
+          include("$templateDir/listTickets.php");
 				} else {
 					//show the related contacts
 					$parms = array(1 => array(1 => "company_id", 2 => "=", 3 => $id),
diff -Naur zentrack_2-5-0-1/www/exportSearch.php zentrack_2-5-5-1/www/exportSearch.php
--- zentrack_2-5-0-1/www/exportSearch.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/www/exportSearch.php	2005-02-09 05:56:15.000000000 -0800
@@ -0,0 +1,143 @@
+<?
+  include("header.php");
+  
+  //print "<pre>\n";  //debug
+  $nolimit = 1;
+  include("$templateDir/searchResults.php");
+  
+  // some data for testing
+  //$tickets = array(
+  //   array( "title" => "title 1", "content" => "some content", "number" => 123 ),
+  //   array( "title" => "title,2", "content" => "some \"content\"", "number" => 1.25 ),
+  //   array( "title" => "title 3", "content" => "some \n more \n content", "number" => null )
+  //);
+
+  // creates the csv file header, comment out for debugging
+  //header("Content-type: application/vnd.ms-excel");
+  header("Content-disposition:  attachment; filename=".date("Y-m-d").".csv");
+  
+  // creates readable column names
+  function prepareColumnNames( $keys ) {
+    $fields = $GLOBALS['customFields'];
+    $vals = array();
+    foreach( $keys as $k ) {
+      if( in_array($k, $fields) ) {
+        $vals[] = $fields[$k];
+      }
+      else {
+        switch($k) {
+          case 'id':
+            $vals[] = 'ID';
+            break;
+          case 'project_id':
+            $vals[] = "Project";
+            break;
+          case 'otime':
+            $vals[] = "Opened";
+            break;
+          case 'ctime':
+            $vals[] = "Closed";
+            break;
+          default:
+            $vals[] = ucwords(str_replace('_', ' ',str_replace('_id', '', $k)));
+        }
+      }
+    }
+    //print_r($vals);
+    return $vals;
+  }
+  
+  // print a readable value in place of database junk
+  function humanReadableValue( $key, $val ) {
+    global $zen;
+    $fields = $GLOBALS['fields'];
+    if( array_key_exists($key, $fields) && $fields[$key] && array_key_exists($val, $fields[$key]) ) {
+      return $fields[$key][$val];
+    }
+    else {
+      switch( $key ) {
+        case 'otime':
+        case 'ctime':
+        case 'start_date':
+        case 'deadline':
+          return strlen($val)? $zen->showDate($val) : '';
+        case 'tested':
+        case 'approved':
+          return $val == 1? 'no' : $val == 2? 'yes' : 'n/a';
+        default:
+          return $val;
+      }
+    }
+  }
+  
+  // iterate over an array of values and create a row of csv data
+  function getCsvRow( $values, $headings = false ) {
+    // skip empty rows
+    if( !is_array($values) ) { return "\n"; }
+    $text = "";
+    $i=1;
+    foreach($values as $k=>$v) {
+      // escape content for each cell
+      if( !$headings ) { $v = humanReadableValue($k,$v); }
+      $text .= getCsvCell($v);
+      if( $i < count($values) ) {
+        // print comma if this is not the last cell
+        $text .= ",";
+      }
+      $i++;
+    }
+    // finish off row and return
+    return $text."\n";
+  }
+  
+  // escape content
+  function getCsvCell( $text ) {
+    // replaces " with ""
+    // replaces \n with a space
+    // encloses in quotes to fix commas
+    return "\"".str_replace('"', '""', str_replace("\n", "|", str_replace("\r", "|", $text)))."\"";
+  }
+  
+  if( is_array($tickets) && count($tickets) ) {
+    // we have content
+    
+    // find out which bins this user can view
+    $userBins = $zen->getUsersBins($login_id);
+    
+    //print "<b>USER BINS</b>\n"; //debug
+    //print_r($userBins); //debug
+    
+    // get names for custom fields
+    $customFields = $zen->getCustomFields(1);
+    $GLOBALS['customFields'] = $customFields;
+    
+    // begin by collecting names of all the possible values
+    $fields = array();
+    foreach( array_keys($tickets[0]) as $k ) {
+      if( $k != 'id' && $k != 'ticket_id' ) {
+        $fields[$k] = $zen->getValsForTicketField($k, $userBins);
+      }
+    }
+    $GLOBALS['fields'] = $fields;
+    
+    //print "<b>FIELDS</b>\n"; //debug
+    //print_r($fields); //debug
+
+    // print column headings
+    print "\n";
+    print getCsvRow( prepareColumnNames(array_keys($tickets[0])), true );
+    print "\n\n";
+    
+    // print the ticket contents
+    $i=1;
+    foreach($tickets as $t) {
+      print getCsvRow($t);
+    }
+  }
+  else {
+    // we have no content
+    print "\n,,,No results for your search\n";
+  }
+  
+  //print "</pre>\n"; //debug
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/www/header.php zentrack_2-5-5-1/www/header.php
--- zentrack_2-5-0-1/www/header.php	2005-05-08 13:03:30.683363200 -0700
+++ zentrack_2-5-5-1/www/header.php	2005-05-08 13:58:09.578182400 -0700
@@ -7,18 +7,17 @@
   /* DO NOT PUT ANYTHING, INCLUDING SPACES, OUTSIDE OF THE <? ?> marks */
 
   /*
-  **  T H E S E   T W O   M U S T    B E   S E T ! ! !
+  **  THE INCLUDES DIRECTORY
   **
-  **  OR ZENTRACK WILL NOT RUN PROPERLY
-  **  Don't use trailing slashes
+  **  Use the complete system path from the root directory
+  **  Do not use a trailing slash
+  **  Use only a forward slash "/" since a backslash "\" has special meaning in php.
+  **
+  **  Valid samples:
+  **    $libDir = "c:/private_folder/includes";
+  **    $libDir = "/var/hidden/localhost/zentrack/includes";
   */
-
-  // the directory where zentrack includes are stored
-  // use the complete system path
-  $libDir = "/web/zentrack/includes";
-
-  // the directory where zentrack www docs are kept
-  $rootUrl = "http://www.yourhost.com/zentrack";
+  $libDir = "/not_web_directory/zentrack/includes";
 
   /*
   **
@@ -27,7 +26,8 @@
   **  Valid SQL Types:
   **     mysql
   **     mssqlpo
-  **     oci8po (oracle >= 8i)
+  **     odbc_mssql (see below)
+  **     oci8po (see below)
   **     postgres (postgres >= 7)
   **     (see http://phplens.com/lens/adodb/docs-adodb.htm#drivers for more)
   */
@@ -37,44 +37,59 @@
   $Db_Pass      = "test";       //password
   $Db_Host      = "localhost";  //host of database (localhost doesn't work with sqlserver)
 
-   // ORACLE USERS! the order of items may be changed
-   // it may be that the entry will be:
-   //      $Db_Host: "serverip:port#"
-   //      $Db_Login: "scott"
-   //      $Db_Pass:  "tiger"
-   //      $Db_Instance: "servicename"
-   // or:
-   //      $Db_Host: ""
-   //      $Db_Login: "scott"
-   //      $Db_Pass:  "tiger"
-   //      $Db_Instance: "TNSName"
-   // hints for these entries:
-   // - for Oracle 8 and later, use "oci8po" as database_type
-   // - if using an Oracle Names Server, leave database_instance blank and put
-   //   the database alias into database_host
-   // - the same applies if you want to use a whole TNS connection string
-   // - to connect to a local instance, you may leave the database_host blank
-   // also... you may need to uncomment the following for oracle to work properly:
-   //   putenv("ORACLE_SID=ORACLE"); 
-   // the database instance
-   //   putenv("ORACLE_HOME=/opt/oracle/oracle/8.0.3"); 
-   // the oracle installation directory
-   //   putenv("TNS_ADMIN=/opt/oracle/product/8.1.5/network/admin"); 
-   // the directory of the tnsnames.ora file
+  // SQL SERVER >= 2000
+  // Here is a sample config
+  //$Db_Type = "odbc_mssql"; //sql type
+  //$Db_Instance = null; //db name
+  //$Db_Login = "test"; //username
+  //$Db_Pass = "test"; //password
+  //$Db_Host = "Driver={SQL Server};Server=123.321.123.321;Database=Zentrack;";
+
+  // ORACLE USERS! the order of items may be changed
+  // it may be that the entry will be:
+  //      $Db_Host: "serverip:port#"
+  //      $Db_Login: "scott"
+  //      $Db_Pass:  "tiger"
+  //      $Db_Instance: "servicename"
+  // or:
+  //      $Db_Host: ""
+  //      $Db_Login: "scott"
+  //      $Db_Pass:  "tiger"
+  //      $Db_Instance: "TNSName"
+  // hints for these entries:
+  // - for Oracle 8 and later, use "oci8po" as database_type
+  // - if using an Oracle Names Server, leave database_instance blank and put
+  //   the database alias into database_host
+  // - the same applies if you want to use a whole TNS connection string
+  // - to connect to a local instance, you may leave the database_host blank
+  // also... you may need to uncomment the following for oracle to work properly:
+  //   putenv("ORACLE_SID=ORACLE"); 
+  // the database instance
+  //   putenv("ORACLE_HOME=/opt/oracle/oracle/8.0.3"); 
+  // the oracle installation directory
+  //   putenv("TNS_ADMIN=/opt/oracle/product/8.1.5/network/admin"); 
+  // the directory of the tnsnames.ora file
 
   /*
   ** DEMO MODE AND DEBUG OUTPUT 
   **
   ** This will solve many of your troubles...
   ** please turn it on, and copy and paste
-  ** the output into any support requests
-  **
+  ** useful portions of the output into any 
+  ** support requests
+  ** 
+  **  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
+  **  VERY VERY VERY VERY IMPORTANT!!!!!!!
+  **  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
+  **
+  ** Debugging is not for production use.  Use it during
+  ** setup and then be sure to turn it off.  It provides
+  ** information about your system that is not for public
+  ** consumption.
   */
-  //the overview of system settings, 0=off, 1=on
-  $Debug_Overview = 1;
 
   //set this from 0=off, 1=errors, 2=warnings, 3=notices(all)
-  $Debug_Mode = 1;  
+  $Debug_Mode = 0;  
 
   //set this to "on" prevents users from doing anything you don't
   //want them doing on a demo site
@@ -118,11 +133,20 @@
    // setlocale(LC_TIME, "de_DE");  // german
    // setlocale(LC_TIME, "es_ES");  // spanish
 
+  // the base url used to reach zentrack
+  // you should only need to edit this if the auto-config fails
+  $rootUrl = 'http://'.$_SERVER['HTTP_HOST'] . preg_replace( '@^'.str_replace("\\", "/", realpath(strtolower($_SERVER['DOCUMENT_ROOT']))).'@', '', str_replace("\\", "/", realpath(strtolower(dirname(__FILE__)))));
+  //$rootUrl = "http://www.yourhost.com/zentrack"; //uncomment and edit if the previous line fails
+
+  // the directory where the www files are stored
+  // you should only need to edit this if the auto-config fails
+  $rootWWW = dirname(__FILE__);
+  //$rootWWW = "/web/zentrack/www"; //uncomment and edit if the previous line fails
 
   /*
   **  LEAVE THIS PART ALONE
   */
-  $rootWWW = dirname(__FILE__);  
+  define('ZT_DEFINED', true);
   include_once("$libDir/headerInc.php");
   
 }?>
\ No newline at end of file
diff -Naur zentrack_2-5-0-1/www/help/english/admin/admin_header.php zentrack_2-5-5-1/www/help/english/admin/admin_header.php
--- zentrack_2-5-0-1/www/help/english/admin/admin_header.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/www/help/english/admin/admin_header.php	2004-11-16 05:14:31.000000000 -0800
@@ -7,7 +7,7 @@
   
   $adminUrl = $helpUrl."/admin";
   
-  $script = basename($_ENV['SCRIPT_NAME']);
+  $script = basename($_SERVER['SCRIPT_NAME']);
   if( $script == 'varfields.php' ) {
      $page_name = 'Variable Fields';
   }
diff -Naur zentrack_2-5-0-1/www/help/english/admin/data_groups.php zentrack_2-5-5-1/www/help/english/admin/data_groups.php
--- zentrack_2-5-0-1/www/help/english/admin/data_groups.php	2004-10-12 22:49:08.000000000 -0700
+++ zentrack_2-5-5-1/www/help/english/admin/data_groups.php	2005-03-09 09:49:08.000000000 -0800
@@ -139,7 +139,13 @@
     
     <p>The special property <b>{form}</b> can be used as a pointer to the current
     form object (it gets translated to window.document.formName during 
-    evaluation).</p>
+    evaluation).  This is useful for pointing to other fields in the form
+    using javascript.</p>
+    
+    <p>The special property <b>{field}</b> can be used as a pointer to the current
+    field object (it gets translated to window.document.formName.fieldName).
+    This can be useful for using the same javascript in multiple behaviors
+    (behaviors are discussed in the next section).
     
     <p>The javascript code is expected to create an array named <b>x</b> which
     will contain a <b>simple array</b> of values or an <b>array of objects</b>
diff -Naur zentrack_2-5-0-1/www/help/english/admin/settings.php zentrack_2-5-5-1/www/help/english/admin/settings.php
--- zentrack_2-5-0-1/www/help/english/admin/settings.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/www/help/english/admin/settings.php	2005-02-23 12:45:02.000000000 -0800
@@ -96,6 +96,15 @@
         </td>
       </tr>
       <tr>
+        <td class='bars'>edit_reason_required</td>
+        <td class='bars'>
+          Editing existing ticket information can be logged setting log_edit to ON.
+          But if you need to require the user to explain why the edition took place
+          you need to set edit_reason_required to ON too. (If log_edit is set to OFF
+          then edit_reason_required is ignored).
+        </td>
+      </tr>
+      <tr>
         <td class='bars'>paging_max_rows</td>
         <td class='bars'>
           Controls the number of rows of data displayed in searches and lists
diff -Naur zentrack_2-5-0-1/www/help/english/users/user_header.php zentrack_2-5-5-1/www/help/english/users/user_header.php
--- zentrack_2-5-0-1/www/help/english/users/user_header.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-5-5-1/www/help/english/users/user_header.php	2004-11-16 05:14:31.000000000 -0800
@@ -9,8 +9,8 @@
 ?>
 <p class='bigBold' align='center'>
 <?=
-  basename($_ENV['SCRIPT_NAME']) == 'index.php'?
+  basename($_SERVER['SCRIPT_NAME']) == 'index.php'?
      'Overview' : 
-     ucwords(str_replace('_', ' ', str_replace('.php','',basename($_ENV['SCRIPT_NAME']))));
+     ucwords(str_replace('_', ' ', str_replace('.php','',basename($_SERVER['SCRIPT_NAME']))));
 ?>
 </p>
diff -Naur zentrack_2-5-0-1/www/help/help_header.php zentrack_2-5-5-1/www/help/help_header.php
--- zentrack_2-5-0-1/www/help/help_header.php	2004-09-09 16:30:28.000000000 -0700
+++ zentrack_2-5-5-1/www/help/help_header.php	2004-11-16 05:14:31.000000000 -0800
@@ -30,7 +30,7 @@
     $helpBase = $GLOBALS['helpBase'];
 
     // find out where we are in the list
-    $thisPage = basename($_ENV['SCRIPT_NAME']);
+    $thisPage = basename($_SERVER['SCRIPT_NAME']);
     $keys = array_keys($list);
     $lastPage = null;
     $nextPage = null;
@@ -139,4 +139,4 @@
    $GLOBALS['usersTOC'] = $usersTOC;
    $GLOBALS['adminTOC'] = $adminTOC;
         
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-0-1/www/helpers/projectSearchbox.php zentrack_2-5-5-1/www/helpers/projectSearchbox.php
--- zentrack_2-5-0-1/www/helpers/projectSearchbox.php	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-5-5-1/www/helpers/projectSearchbox.php	2005-03-11 07:37:39.000000000 -0800
@@ -12,6 +12,7 @@
   }
   $userBins = $zen->getUsersBins($login_id,"level_view");
   $users = $zen->get_users( $userBins, "level_view" );
+  $onechoice = isset($_GET['onechoice']) || isset($_POST['onechoice']);
 ?><html>
 <head>
   <title><? echo tr("Search Projects"); ?></title>
@@ -24,6 +25,9 @@
 <form method='post' action='<?=$rootUrl?>/helpers/projectSearchbox.php'>
 <input type='hidden' name='return_form' value='<?=$zen->ffv($return_form)?>'>
 <input type='hidden' name='return_field' value='<?=$zen->ffv($return_field)?>'>
+<? if( $onechoice ) { ?>
+  <input type='hidden' name='onechoice' value='1'>
+<? } ?>
 <table width='<?=$table_width?>' align='center'>
 <tr><td class='titleCell' align='center' colspan='2'><?php echo tr("Search Tickets"); ?></td></tr>
 <tr>
@@ -150,12 +154,12 @@
      for(i=0; i<document.helperForm.elements.length; i++) {
        element = document.helperForm.elements[i];
        if( element.type == "checkbox" ) {
-	 if( curcheck == false ) {
-	   element.checked = true;
-	 }
-	 else {
-	   element.checked = false;
-	 }
+         if( curcheck == false ) {
+           element.checked = true;
+         }
+         else {
+           element.checked = false;
+         }
        }     
      }
      curcheck = (curcheck == false)? true : false;
@@ -166,14 +170,15 @@
      var val = "";
      for(i=0; i<document.helperForm.elements.length; i++) {
        element = document.helperForm.elements[i];
-       if( element.type == "checkbox" && element.checked == true && element.value != "skip" ) {
-	 if( val == "" )
-	   val = element.value;
-	 else
-	   val += ","+element.value;
+       if( element.type == "<?=$onechoice? 'radio' : 'checkbox'?>" 
+          && element.checked == true && element.value != "skip" ) {
+         if( val == "" )
+           val = element.value;
+         else
+           val += ","+element.value;
        } 
      }
-     opener.document.<?=$return_form?>.<?=$return_field?>.value = val;
+     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
      window.self.close();
      return false;
    }
@@ -222,7 +227,9 @@
 ?>
 <tr>
   <td class='subTitle'>
+  <? if( $onechoice ) { print "&nbsp;"; } else { ?>
     <input type='checkbox' name='allcheck' value='skip' onClick='checkAll()' class='searchbox'>
+  <? } ?>
   </td>
   <td class='subTitle'>
     <?php echo tr("ID"); ?>
@@ -238,8 +245,14 @@
    foreach($results as $r) {
      $row = ($row == "cell")? "bars" : "cell";
      print "<tr>\n";
-     print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
+     if( $onechoice ) {
+       print "\t<td class='$row'><input type='radio' name='values' "
        ." value='{$r['id']}'></td>\n";
+     }
+     else {
+       print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
+         ." value='{$r['id']}'></td>\n";
+     }
      print "\t<td class='$row'>{$r['id']}</td>\n";
      print "\t<td class='$row'>{$r['title']}</td>\n";
      print "\t<td class='$row'>".$zen->getBinName($r["bin_id"])."</td>\n";
diff -Naur zentrack_2-5-0-1/www/helpers/ticketSearchbox.php zentrack_2-5-5-1/www/helpers/ticketSearchbox.php
--- zentrack_2-5-0-1/www/helpers/ticketSearchbox.php	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-5-5-1/www/helpers/ticketSearchbox.php	2005-03-11 07:37:39.000000000 -0800
@@ -15,6 +15,7 @@
   }
   $userBins = $zen->getUsersBins($login_id,"level_view");
   $users = $zen->get_users( $userBins, "level_view" );
+  $onechoice = isset($_GET['onechoice']) || isset($_POST['oncchoice']);
 ?><html>
 <head>
   <title><?php echo tr("Search Tickets"); ?></title>
@@ -27,6 +28,9 @@
 <form method='post' action='<?=$rootUrl?>/helpers/ticketSearchbox.php'>
 <input type='hidden' name='return_form' value='<?=$zen->ffv($return_form)?>'>
 <input type='hidden' name='return_field' value='<?=$zen->ffv($return_field)?>'>
+<? if( $onechoice ) { ?>
+  <input type='hidden' name='onechoice' value='1'>
+<? } ?>
 <table width='<?=$table_width?>' align='center'>
 <tr><td class='titleCell' align='center' colspan='2'><?php echo tr("Search Tickets"); ?></td></tr>
 <tr>
@@ -193,14 +197,15 @@
      var val = "";
      for(i=0; i<document.helperForm.elements.length; i++) {
        element = document.helperForm.elements[i];
-       if( element.type == "checkbox" && element.checked == true && element.value != "skip" ) {
-	 if( val == "" )
-	   val = element.value;
-	 else
-	   val += ","+element.value;
+       if( element.type == "<?=$onechoice? 'radio' : 'checkbox'?>" 
+          && element.checked == true && element.value != "skip" ) {
+         if( val == "" )
+           val = element.value;
+         else
+           val += ","+element.value;
        } 
      }
-     opener.document.<?=$return_form?>.<?=$return_field?>.value = val;
+     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
      window.self.close();
      return false;
    }
@@ -249,7 +254,9 @@
 ?>
 <tr>
   <td class='subTitle'>
+  <? if( $onechoice ) { print "&nbsp;"; } else { ?>
     <input type='checkbox' name='allcheck' value='skip' onClick='checkAll()' class='searchbox'>
+  <? } ?>
   </td>
   <td class='subTitle'>
     <?php echo tr("ID"); ?>
@@ -265,8 +272,14 @@
    foreach($results as $r) {
      $row = ($row == "cell")? "bars" : "cell";
      print "<tr>\n";
-     print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
+     if( $onechoice ) {
+       print "\t<td class='$row'><input type='radio' name='values' "
        ." value='{$r['id']}'></td>\n";
+     }
+     else {
+       print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
+         ." value='{$r['id']}'></td>\n";
+     }
      print "\t<td class='$row'>{$r['id']}</td>\n";
      print "\t<td class='$row'>{$r['title']}</td>\n";
      print "\t<td class='$row'>".$zen->getBinName($r["bin_id"])."</td>\n";
diff -Naur zentrack_2-5-0-1/www/helpers/userSearchbox.php zentrack_2-5-5-1/www/helpers/userSearchbox.php
--- zentrack_2-5-0-1/www/helpers/userSearchbox.php	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-5-5-1/www/helpers/userSearchbox.php	2005-03-11 07:37:39.000000000 -0800
@@ -6,6 +6,7 @@
   if( $search_bins ) {
     $search_param["homebin"] = $search_bins;
   }
+  $onechoice = isset($_GET['onechoice']) || isset($_POST['onechoice']);
 ?><html>
 <head>
   <title><?php echo tr("Search Users"); ?></title>
@@ -16,6 +17,9 @@
 
 <? if( !isset($dosearch) || !is_array($search_param) ) { ?>
 <form method='post' action='<?=$rootUrl?>/helpers/userSearchbox.php'>
+<? if( $onechoice ) { ?>
+<input type='hidden' name='onechoice' value='1'>
+<? } ?>
 <input type='hidden' name='return_form' value='<?=$zen->ffv($return_form)?>'>
 <input type='hidden' name='return_field' value='<?=$zen->ffv($return_field)?>'>
 <table width='<?=$table_width?>' align='center'>
@@ -117,16 +121,21 @@
    function saveValues() {
      var i;
      var val = "";
+     //var s = "";//debug
      for(i=0; i<document.helperForm.elements.length; i++) {
        element = document.helperForm.elements[i];
-       if( element.type == "checkbox" && element.checked == true && element.value != "skip" ) {
-	 if( val == "" )
-	   val = element.value;
-	 else
-	   val += ","+element.value;
-       } 
+       if( element.type == "<?=$onechoice? 'radio' : 'checkbox'?>" 
+            && element.checked == true && element.value != "skip" ) {
+         if( val == "" )
+           val = element.value;
+         else
+           val += ","+element.value;
+         //s += "selected "+element.name+": "+element.type+"\n";//debug
+       }
+       //else { s += "skipped "+element.name+": "+element.type+"\n"; }//debug
      }
-     opener.document.<?=$return_form?>.<?=$return_field?>.value = val;
+     //alert(s);//debug
+     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
      window.self.close();
      return false;
    }
@@ -164,7 +173,9 @@
 ?>
 <tr>
   <td class='subTitle'>
+  <? if( !$onechoice ) { ?>
     <input type='checkbox' name='allcheck' value='skip' onClick='checkAll()' class='searchbox'>
+  <? } else { print "&nbsp;"; } ?>
   </td>
   <td class='subTitle'>
     <?php echo tr("ID"); ?>
@@ -180,8 +191,14 @@
    foreach($results as $r) {
      $row = ($row == "cell")? "bars" : "cell";
      print "<tr>\n";
-     print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
-       ." value='{$r['user_id']}'></td>\n";
+     if( !$onechoice ) {
+       print "\t<td class='$row'><input type='checkbox' name='values[$i]' "
+        ." value='{$r['user_id']}'></td>\n";
+     }
+     else {
+       print "\t<td class='$row'><input type='radio' name='values' "
+        ." value='{$r['user_id']}'></td>\n";
+     }
      print "\t<td class='$row'>{$r['user_id']}</td>\n";
      print "\t<td class='$row'>".$zen->formatName($r,1)."</td>\n";
      print "\t<td class='$row'>".$zen->getBinName($r['homebin'])."</td>\n";
diff -Naur zentrack_2-5-0-1/www/images/disabled-cal.gif zentrack_2-5-5-1/www/images/disabled-cal.gif
--- zentrack_2-5-0-1/www/images/disabled-cal.gif	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-5-5-1/www/images/disabled-cal.gif	2005-02-21 06:47:57.000000000 -0800
@@ -0,0 +1,5 @@
+GIF89a               }  }    UU    (( 
+   (h(Dd(P$d   