diff -Naur zentrack_2-5-5-2/includes/ZenContext.class zentrack_2-6-pre1/includes/ZenContext.class
--- zentrack_2-5-5-2/includes/ZenContext.class	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/ZenContext.class	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,37 @@
+<?
+/**
+ * ZenContext: a generic container for properties to be passed between objects
+ *
+ * This class is intended to be abstract and extended by specific instances for
+ * use, such as ZenFieldMapRenderContext
+ *
+ * @abstract
+ */
+class ZenContext {
+  function ZenContext($vals = null) {
+    $this->_vals = is_array($vals)? $vals : array();
+  }
+  
+  function set($prop, $val) {
+    $this->_debug('get', "Setting $prop to ".Zen::dval($val), 3);
+    $this->_vals[$prop] = $val;
+  }
+  
+  function get($prop) {
+    if( !array_key_exists($prop, $this->_vals) ) {
+      $this->_debug('get', "Invalid property: $prop", 3);
+      return null;
+    }
+    return $this->_vals[$prop];
+  }
+  
+  function _debug( $method, $msg, $lvl ) {
+    $zen = $GLOBALS['zt_zen'];
+    if( $zen ) {
+      $zen->addDebug("ZenContext::$method", $msg, $lvl);
+    }
+  }
+  
+  var $_vals;
+}
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/ZenFieldMap.class zentrack_2-6-pre1/includes/ZenFieldMap.class
--- zentrack_2-5-5-2/includes/ZenFieldMap.class	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/ZenFieldMap.class	2005-10-20 11:23:44.000000000 -0700
@@ -13,40 +13,6 @@
 define("ZTFIELD_DATE",7);
 define("ZTFIELD_SECTION",8);
 
-/** 
- * Returns properties for a view
- * <ul>
- *  <li>disabled - (boolean)this view doesn't use field_map yet
- *  <li>view_only - (boolean)this view does not have input fields, just text
- *  <li>has_behaviors - (boolean)this view has behaviors
- *  <li>admin_view - (boolean)this is an admin screen
- *  <li>multiple - (boolean)this view allows multiple selections (overrides field->multiple)
- *  <li>sections - (boolean)true if this view can support sections
- * </ul>
- *
- * @param string $view if omitted, all views are returned
- */
-function getFmViewProps( $view = null ) {
-  if( !$view ) {
-    // return the entire set
-    $set = array();
-    $list = array_keys($GLOBALS['zt_field_dependencies']['views']);
-    foreach($list as $l) {
-      $set[$l] = getFmViewProps($l);
-    }
-    return $set;
-  }
-  // fetch an individual view
-  $vals = $GLOBALS['zt_field_dependencies']['views'][$view];
-  if( !is_array($vals) ) { return false; }
-  $vars = array();
-  $indices = array("disabled", "view_only", "has_behaviors", "admin_view", "multiple", "sections");
-  for($i=0; $i < count($vals); $i++) {
-    $vars[ $indices[$i] ] = $vals[$i];
-  }
-  return $vars;
-}
-
 /**
  * Returns properties for a field:
  * <ul>
@@ -55,13 +21,14 @@
  *  <li>multiple - (boolean)may have multiple entries (view can override this)
  *  <li>always_required - (boolean)true if this field is required by system
  *  <li>default - (boolean)true if this field can use default values
-    <li>data_type - (string) contains 'int', 'string', 'date', 'boolean', or 'float'
+ *  <li>data_type - (string) contains 'int', 'string', 'date', 'boolean', or 'float'
  * </ul>
  *
  * @param string $view
  * @param string $field if omitted, returns all fields formatted for a given view
  */
 function getFmFieldProps( $view, $field = null ) {
+  global $map;
   $field = ZenFieldMap::fieldName($field);
   if( !$field ) {
     // return all fields for a view
@@ -73,9 +40,10 @@
     return $set;
   }
   // return a single field
-  $vprops = getFmViewProps($view);
+  if( !array_key_exists($field, $GLOBALS['zt_field_dependencies']['fields']) ) {
+    return false;
+  }
   $vals = $GLOBALS['zt_field_dependencies']['fields'][$field];
-  if( !is_array($vals) ) { return false; }
   $vars = array();
   // the distance between "types" and "admin_view" is important for
   // the details listed below
@@ -88,14 +56,14 @@
       foreach($vals[$i] as $v) {
         $set[] = ZenFieldMap::getTypeString($v);
       }
-      if( $vprops['admin_view'] && $vals[$i+2] ) {
+      if( $map->getViewProp($view,'admin_view') && $vals[$i+2] ) {
         foreach($vals[$i+2] as $v) {
           $set[] = ZenFieldMap::getTypeString($v);
         }
       }
       $vars[ $indices[$i] ] = $set;
     }
-    else if( $vprops['multiple'] && $indices[$i] == 'multiple' ) {
+    else if( $map->getViewProp($view,'multiple') && $indices[$i] == 'multiple' ) {
       $vars[ $indices[$i] ] = true;
     }
     else {
@@ -143,13 +111,13 @@
   "fields" => array(//       searchable,  types                 , data_type,  admin_view, multiple, always_required, default
     "id"              => array(   true,   array(1)              , 'int'    ,      null, false,  true,  false),
     "title"           => array(   true,   array(1,2)            , 'text' ,        null, false,  true,   true),
-    "priority"        => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
-    "status"          => array(   true,   array(1,3,4,6)        , 'string' ,      null, false,  true,  false),
+    "priority"        => array(   true,   array(0,1,3,6)        , 'int'    ,      null, false,  true,   true),
+    "status"          => array(   true,   array(0,1,3,6)        , 'string' ,      null, false,  true,  false),
     "description"     => array(   true,   array(1,2)            , 'text' ,        null, false,  false,  true),
     "otime"           => array(   true,   array(1)              , 'date'   ,  array(7), false,  true,  false),
     "ctime"           => array(   true,   array(1)              , 'date'   ,  array(7), false,  false,  false),
     "bin_id"          => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
-    "type_id"         => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
+    "type_id"         => array(   true,   array(1,3,6)          , 'int'    ,      null, false,  true,   true),
     "user_id"         => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  false,  true),
     "system_id"       => array(   true,   array(1,3,4,6)        , 'int'    ,      null, false,  true,   true),
     "creator_id"      => array(  false,   array(1)              , 'int'    ,  array(4), false,  true,  false),
@@ -166,28 +134,37 @@
     "custom_boolean"  => array(   true,   array(1,3,5,6)        , 'boolean',      null, false,  false,  true),
     "custom_date"     => array(   true,   array(1,7)            , 'date'   ,      null, false,  false,  true),
     "custom_menu"     => array(   true,   array(1,3,6)          , 'string' ,      null, false,  false,  true),
+    "custom_multi"    => array(   true,   array(1,3)            , 'string' ,      null, true ,  false,  true),
     "custom_text"     => array(  false,   array(1,2)            , 'text'   ,      null, false,  false,  true),
     "hours"           => array(  false,   array(2)              , 'float'  ,      null, false,  false,  true),
     "comments"        => array(  false,   array(2)              , 'text'   ,      null, false,  false,  true)
   ),
   
-  "views" => array(//           disabled, view_only, has_behaviors, admin_view, multiple, sections
-    "ticket_create"   => array(    false,    false,      true, false, false, true  ), 
-    "project_create"  => array(    false,    false,      true, false, false, true  ),
-    "ticket_edit"     => array(    false,    false,      true,  true, false, true  ), 
-    "project_edit"    => array(    false,    false,      true,  true, false, true  ),
-    "ticket_list"     => array(    false,     true,     false, false, false, false ),
-    "project_list"    => array(    false,     true,     false, false, false, false ),
-    "search_form"     => array(    false,    false,      true,  true, true , false ),
-    "search_list"     => array(    false,     true,     false, false, false, false ),
-    "ticket_close"    => array(    false,    false,      true, false, false, true  ), 
-    "ticket_title"    => array(     true,     true,     false, false, false, false ),
-    "project_title"   => array(     true,     true,     false, false, false, false ),
-    "ticket_detail"   => array(     true,     true,     false, false, false, true  ),
-    "project_detail"  => array(     true,     true,     false, false, false, true  ),
-    "ticket_custom"   => array(     true,    false,      true, false, false, true  ),
-    "project_custom"  => array(     true,    false,      true, false, false, true  )
-  ),
+  // "views" => array(//           disabled, view_only, has_behaviors, admin_view, multiple, sections, any_option, access_level
+    // "ticket_close"    => array(    false,    false,      true, false, false, true,  false, 'level_user' ), 
+    // "ticket_create"   => array(    false,    false,      true, false, false, true,  false, 'level_create' ), 
+    // "ticket_custom"   => array(    false,    false,      true, false, false, true,  false, 'level_view' ),
+    // "ticket_edit"     => array(    false,    false,      true,  true, false, true,  false, 'level_edit' ), 
+    // "ticket_list"     => array(    false,     true,     false, false, false, false, false, 'level_view' ),
+    // "ticket_options"  => array(    false,    false,     false, false, false, false, true , 'level_view' ),
+    // "ticket_view_top" => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_1"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_2"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_3"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_4"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_5"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_6"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_7"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "ticket_tab_8"    => array(    false,     true,     false, false, false,  true, false, 'level_view' ),
+    // "project_close"   => array(    false,    false,      true, false, false, true,  false, 'level_user' ), 
+    // "project_create"  => array(    false,    false,      true, false, false, true,  false, 'level_create_proj' ),
+    // "project_custom"  => array(    false,    false,      true, false, false, true,  false, 'level_view' ),
+    // "project_edit"    => array(    false,    false,      true,  true, false, true,  false, 'level_edit' ),
+    // "project_list"    => array(    false,     true,     false, false, false, false, false, 'level_view' ),
+    // "project_options" => array(    false,    false,     false, false, false, false, true , 'level_view' ),
+    // "search_form"     => array(    false,    false,      true,  true, true , false, true , 'level_view' ),
+    // "search_list"     => array(    false,     true,     false, false, false, false, false, 'level_view' )
+  // ),
   
   "types" => array(//   choices| multirows
     "hidden"   => array(  false, false ),
@@ -204,6 +181,8 @@
 );
 $GLOBALS['zt_field_dependencies'] = $ztf;
 
+include_once("$libDir/ZenContext.class");
+
 /**
  * Stores information about the fields and how they are rendered on different
  * view.
@@ -222,6 +201,114 @@
   }
   
   /**
+   * Return name and properties of each tab in the ticket view
+   */
+  function getTabs( $type, $login_id, $bin_id ) {
+    $tabs = array();
+    foreach($this->getViewProps() as $k=>$v) {
+      if( !preg_match("@^{$type}_tab_[0-9]$@", $k) ) { continue; }
+      if( $this->_zen->checkAccess($login_id, $bin_id, $this->getViewProp($k,'access_level')) ) {
+        $tabs["$k"] = array();
+        foreach($v as $key=>$val) {
+          $tabs["$k"]["$key"] = $this->getViewProp($k,$key);
+        }
+      }
+    }
+    return $tabs;
+  }
+  
+  /** 
+   * Returns properties for a view
+   * <ul>
+   *  <li>disabled - (boolean)this view doesn't use field_map yet
+   *  <li>view_only - (boolean)this view does not have input fields, just text
+   *  <li>has_behaviors - (boolean)this view has behaviors
+   *  <li>admin_view - (boolean)this is an admin screen
+   *  <li>multiple - (boolean)this view allows multiple selections (overrides field->multiple)
+   *  <li>sections - (boolean)true if this view can support sections
+   *  <li>any_option - (boolean)true if menus should include -any- option (for searching, etc)
+   * </ul>
+   *
+   * @param string $view if omitted, all views are returned
+   */
+  function getViewProps( $view = null ) {
+    if( !$this->_viewProps ) {
+      // attempt to retrieve from session
+      $vp = $this->_session->find('view_map');
+      if( is_array($vp) ) {
+        $this->_zen->addDebug('ZenFieldMap->getViewProps', "Loading from session[".count($vp)."]", 3);
+        $this->_viewProps = $vp;
+      }
+      else {
+        // if not in session, load from database
+        $query = "SELECT * FROM ZENTRACK_VIEW_MAP ORDER BY which_view, vm_order";
+        $this->_viewProps = array();
+        $vals = $this->_zen->db_queryIndexed($query);
+        $this->_zen->addDebug('ZenFieldMap->getViewProps', "Loading from db[".count($vals)."]: ".$query, 3);
+        foreach($vals as $v) {
+          $vw = $v['which_view'];
+          $field = $v['vm_name'];
+          if( !array_key_exists($vw, $this->_viewProps) ) {
+            // intialize the view array
+            $this->_viewProps["$vw"] = array();
+          }
+          $this->_viewProps["$vw"]["$field"] = $v;
+        }
+        $this->_session->store('view_map', $this->_viewProps);
+      }
+    }
+    return $view? $this->_viewProps["$view"] : $this->_viewProps;
+  }
+  
+  /**
+   * Update the properties of a view (in the view map).  This will insure that
+   * only fields which should be editable have been updated.
+   *
+   * @param array updates (String)field_name => (mixed)vm_val
+   */
+  function updateViewProps($view, $updates) {
+    $props = $this->getViewProps($view);
+    $res = array(0,0);
+    foreach($updates as $k=>$v) {
+      // if the field is invalid, skip it
+      if( !array_key_exists($k, $props) ) {
+        $this->_zen->addDebug('ZenFieldMap::updateViewProps', "Invalid field specified: $k", 1);
+        continue;
+      }
+      // get some vals
+      $id = $props[$k]['view_map_id'];
+      $type = $props[$k]['vm_type'];
+      $val = $this->getViewProp($view,$k,'vm_val');
+      // if the field cannot be updated, skip it
+      if( $type == 'hidden' || $type == 'label' ) { continue; }
+      // if the value hasn't changed, don't bother
+      if( $v == $val ) { continue; }
+      // otherwise, check for 'load' and set an appropriate value
+      if( $type == 'load' ) {
+        // all of this is to avoid errors caused by trying to call
+        // join() on an array
+        if( $v && $val && join(',',$v) == join(',',$val) ) {
+          continue;
+        }
+        if( !$v ) { $vals = array('vm_val'=>null); }
+        else { $vals = array('vm_val'=> join(",",$v)); }
+      }
+      else {
+        $vals = array('vm_val'=>$v);
+      }
+      $set = $this->_zen->makeInsertVals($vals, 1);
+      $query = "UPDATE ZENTRACK_VIEW_MAP SET $set WHERE view_map_id = {$id}";
+      $r = $this->_zen->db_result($query);
+      $this->_zen->addDebug('ZenFieldMap::updateViewProps', "$id[$r]: $query", $res? 3 : 1);
+      $res[1]++;
+      if( $r ) { $res[0]++; }
+    }
+    $this->_session->clear('view_map');
+    $this->_viewProps = false;
+    return $res;
+  }
+  
+  /**
    * Consults the field map and constructs a list of (String)field_name which
    * represents all of the fields which exist in this view. (note that some
    * of these may be hidden fields
@@ -235,6 +322,10 @@
        return null;
      }
      $map = $this->getFieldMap($view);
+     if( !$map ) {
+       $this->_zen->addDebug('listFieldForView', "Invalid view: ".$view, 1);
+       return array(); 
+     }
      $this->_zen->addDebug('listFieldsForView', "Found ".count($map)." entries for view '$view'", 3);
      return array_keys($map);
    }
@@ -251,6 +342,26 @@
       return $map[$view][$field_name];
     }
     
+    /**
+     * Returns a single property from a field in the map
+     */
+   function getFieldProp( $view, $field, $prop ) {
+     $map = $this->getFieldMap($view);
+     if( !$map ) {
+       $this->_zen->addDebug('getFieldProp', "Invalid view: {$view}->{$field}->{$prop}", 1);
+       return null;
+     }
+     if( !array_key_exists($field, $map) ) {
+       $this->_zen->addDebug('getFieldProp', "Invalid field: {$view}->{$field}->{$prop}", 1);
+       return null;
+     }
+     if( !array_key_exists($prop, $map[$field]) ) {
+       $this->_zen->addDebug('getFieldProp', "Prop not found: {$view}->{$field}->{$prop}", 3);
+       return null;
+     }
+     return $map[$field][$prop];
+   }
+    
   /**
    * Returns the label specified for the field in question
    */
@@ -262,7 +373,7 @@
   new Function: */
   function getLabel( $view, $field_name) {
     $field = $this->getFieldFromMap($view,is_array($field_name)?$field_name['field_name']:$field_name);
-    return $field['field_label']? $field['field_label'] : $field['field_name'];
+    return $field['field_label']? tr($field['field_label']) : tr($field['field_name']);
   }
   
   /**
@@ -279,14 +390,16 @@
   function getTextValue( $view, $field_name, $value ) {
     $this->_zen->addDebug("getTextValue", "rendering $view, $field_name, $value", 3);
     $field = $this->getFieldFromMap($view,$field_name);
-    if( strlen($value) && $field['is_visible'] && $field['field_type'] != 'hidden' ) {
+    $userBins = $this->_zen->getUsersBins($_SESSION['login_id']);
+    if( $field['is_visible'] && $field['field_type'] != 'hidden' ) {
+      if( !strlen($value) ) { return '&nbsp;'; }
       switch($this->fieldName($field_name)) {
         case "priority":
         case "status":
         case "bin_id":
         case "type_id":
         case "system_id":
-          $vals = $this->getChoices($view,$field_name);
+          $vals = $this->_zen->getValsForTicketField($field_name,$userBins);
           if( isset($vals["$value"]) ) { return $this->_zen->ffv(tr($vals["$value"])); }
           else {
             $this->_zen->addDebug("getTextValue", "Unable to find choices for {$view}->{$field_name}", 1);
@@ -298,7 +411,7 @@
           return $this->_zen->ffv($name,$field['num_cols']);
         case "tested":
         case "approved":
-          $val = $value == 1? tr('No') : $value == 2? tr('Yes') : tr('n/a');
+          $val = $value == 1? tr('Required') : ($value == 2? tr('Complete') : tr('n/a'));
           return $this->_zen->ffv($val,$field['num_cols']);
         case "otime":
         case "ctime":
@@ -310,7 +423,7 @@
           }
           if( $value == 'NULL' ) { $value = ''; }
           if( $value == 0 ) { $value = ""; }
-          return strlen($value)? $this->_zen->showDateTime($value) : '';
+          return $this->_zen->showDateTime($value);
         case "custom_boolean":
           $val = $value == 1? tr('Yes') : tr('No');
           return $this->_zen->ffv($val,$field['num_cols']);
@@ -318,10 +431,13 @@
         case "title":
         case "custom_text":
           return $this->_zen->ffvText($value);
+        case "custom_multi":
+//          return str_replace("\t", "; ", $value);
+          return implode("; ", $value);
         default:
-          $val = $this->_zen->ffv($value, $field['num_cols']);
+          $val = $this->_zen->ffvText(str_replace("\t",";",$value), $field['num_cols']);
           $this->_zen->addDebug("getTextValue", "rendering default: $val", 3);
-          return $this->_zen->ffv($value, $field['num_cols']);
+          return $val;
       }
     }
     // it's hidden, return nothing
@@ -332,22 +448,38 @@
    * Consults the field map to determine what sort of field we have, loads
    * this information, and renders the field to the screen appropriately.
    *
-   * @param string $view corresponds to which_view field
-   * @param string $field_name the field's name
-   * @param mixed $value the field's current value
-   * @param $override_name if provided, will override the name=".." property of this input field 
+   * @param ZenFieldMapRenderContext $context
    * @return string containing html to render
    */
-  function renderTicketField( $view, $form_name, $field_name, $value = null, $override_name = null ) {
-//    $this->_zen->addDebug("renderTicketField", "rendering $view, $form_name, $field_name, $value, $override_name", 1);//debug
+  function renderTicketField( $context ) {
     global $templateDir;
     global $rootUrl;
     
+    $view = $context->view();
+    
+    $form_name = $context->form();
+    $field_name = $context->field();
+    $value = $context->value();
+    $override_name = $context->name();
+    $override_as_label = $context->force_label();
+    $field_events = $context->events();
+    
     // collect field properties
     $field = $this->getFieldFromMap($view,$field_name);
     $typeint = $this->getTypeInt($field['field_type']);
     $typename = $field['field_type'];
     
+    // override properties if appropriate
+    if( $context->columns() ) { $field['num_cols'] = $context->columns(); }
+    if( $context->rows()    ) { $field['num_rows'] = $context->rows();    }
+    if( $context->label()   ) { $field['label']    = $context->label();   }
+    if( $context->multiple()) { $field['multiple'] = $context->multiple();}
+    
+    if ($typeint != ZTFIELD_SECTION && $typeint != ZTFIELD_HIDDEN && $override_as_label == 1) {
+      $typeint = ZTFIELD_LABEL;
+      $typename =  "label";
+    }
+    
     // don't waste time on spacers
     if( $typeint == ZTFIELD_SECTION ) {
       $vals = array('label'=>tr($field['field_label']));
@@ -356,35 +488,53 @@
 
     // collect system properties
     $fprops = getFmFieldProps($view, $field_name);
-    $vprops = getFmViewProps($view);
     $tprops = getFmTypeProps($typename);
     
     // see if this is a 'viewonly' screen, if so, no form fields needed
-    if( $vprops["view_only"] ) { return $this->getTextValue($view,$field_name,$value); }
+    if( $this->getViewProp($view, 'view_only') ) { return $this->getTextValue($view,$field_name,$value); }
     
     // collect template props
     $vals = array();
-    $vals["view"] = $view;
-    $vals["form_name"] = $form_name;
-    $vals["templateDir"] = $templateDir;
-    $vals["rooturl"] = $rootUrl;
-    $vals['date_format'] = $this->_zen->popupDateFormat();
-    $vals["field_name"] = $this->_zen->ffv(strlen($override_name)>0? $override_name : $field_name);
+    $vals["view"]         = $view;
+    $vals["form_name"]    = $form_name;
+    $vals["templateDir"]  = $templateDir;
+    $vals["rooturl"]      = $rootUrl;
+    $vals['date_format']  = $this->_zen->popupDateFormat();
+    $vals["field_name"]   = $this->_zen->ffv($override_name);
+    $vals["field_events"] = $field_events;
     
     if( !isset($value) && ($view=="ticket_create" || $view=="project_create"
-         || $view == 'search_form' )) {
+         || $view == 'search_form' || preg_match('@(ticket|project)_list_filters@',$view) )) {
       // if there is no value and this is a create page or search page then we will
       // retrieve a default value to use instead
       $vals["field_value"] = $this->getDefaultValue($view,$field_name);
     } else if( $typeint == ZTFIELD_DATE && !preg_match('/[^0-9]/', $value) ) {
       // if it is a date and we have a numeric value, then we will parse it to
       // a date right here
-      
+      //$vals['field_value'] = $this->_zen->showDate($value);
+      $vals["field_value"] = strlen($value)? $this->_zen->showDateTime($value) : '';
+    } else if( strpos($vals["field_name"], 'custom_multi') !== false ) {
+/*
+      $tok=strtok($value,"\t");
+      $vals["field_value"]=array();
+      while ($tok !== false) {
+        $vals["field_value"][] = $this->_zen->ffv($tok, $field['num_cols']);
+        $tok = strtok("\t");
+      }
+*/
+      $vals["field_value"]=array();
+      if ( is_array($value) ) {
+        foreach($value as $element) {
+          $vals["field_value"][] = $this->_zen->ffv($element, $field['num_cols']);
+        }
+      } else {
+        $vals["field_value"][] = $this->_zen->ffv($value, $field['num_cols']);
+      }
     } else {
       $vals["field_value"] = $this->_zen->ffv($value);
     }
     $vals["field_label"] = $this->getTextValue($view,$field_name,$value);
-    $vals["field_max"] = $field['num_cols'];
+    $vals["field_max"] = $context->maxlength()? $context->maxlength() : $field['num_cols'];
     if( $tprops["has_choices"] ) {
       $vals["field_choices"] = $this->getChoices($view,$field_name);
     }
@@ -395,8 +545,19 @@
     else { $vals['field_cols'] = $field['num_cols'] > 50? 50 : $field['num_cols']; }
     $vals['field_rows'] = $field['num_rows'];
     
-    $vals['field_multiple'] = $view == 'search_form' && $typeint == ZTFIELD_MENU && $field['num_rows'] > 1? "multiple" : "";
-    if( $vals['field_multiple'] && $typename == 'menu' ) {
+//    $vals['field_multiple'] = $view == 'search_form' && $typeint == ZTFIELD_MENU && $field['num_rows'] > 1? "multiple" : "";
+//    $vals['field_multiple'] = (
+//                                ( $view == 'search_form' || strpos($field_name,'custom_multi')===0 )
+//                                && $typeint == ZTFIELD_MENU && $field['num_rows'] > 1
+//                              ) ? "multiple" : "";
+    $vals['field_multiple'] = ( $context->multiple()
+                                ||
+                                ( $view == 'search_form' && $typeint == ZTFIELD_MENU && $field['num_rows'] > 1 )
+                                || 
+                                ( strpos($field_name,'custom_multi')===0 )
+                              ) ? "multiple" : "";
+
+    if( $vals['field_multiple'] ) {
       $vals['field_name'] .= "[]";
     }
 
@@ -430,7 +591,7 @@
       }
       $vals["search_url"] = $rootUrl."/helpers/{$s}Searchbox.php?"
         ."return_form=$form_name&return_field={$vals['field_name']}";
-      if( !$fprops["multiple"] && !$vprops["multiple"] ) {
+      if( !$fprops["multiple"] && !$this->getViewProp($view,'multiple') ) {
         $vals['search_url'] .= "&onechoice=1";
       }
     }
@@ -439,7 +600,21 @@
     if( strpos($field_name,'custom_')===0 ) {
       $f = $this->_zen->getCustomField($field_name);
       if( $f['js_validation'] ) {
-        $vals['field_events'] = "onblur='{$f['js_validation']}'";
+        if( $vals['field_events'] ) {
+          if( preg_match("/onblur=(['\"])([^'\"]+)['\"]/", $vals['field_events'], $matches) ) {
+            $q = $matches[1];
+            $v = str_replace($q, "\\$q", $f['js_validation']);
+            if( !preg_match('@;$@', $v) ) { $v .= ';'; }
+            $val = "onblur='{$v};{$matches[2]}'";
+            $vals['field_events'] = preg_replace("/onblur=['\"]([^'\"]+)['\"]/", $val, $vals['field_events']);
+          }
+          else {
+            $vals['field_events'] .= " onblur=".$zen->fixJsVal($f['js_validation']);
+          }
+        }
+        else {
+          $vals['field_events'] = "onblur=".$zen->fixJsVal($f['js_validation']);
+        }
       }
       if( strpos($field_name,'custom_date') === 0 ) {
         if( $vals['field_value'] == 'NULL' ) { $vals['field_value'] = ''; }
@@ -467,6 +642,22 @@
         }
       }
     }
+
+    if ( $typename == 'label' && strpos($field_name,"multi")>0 ) {
+      $typename = "multilabel";
+      $vals["field_choices"] = $this->getChoices($view,$field_name);
+    }
+
+    if ( $typename == "hidden" && strpos($field_name,"multi")>0 ) {
+      $typename = "multihidden";
+      $vals["field_choices"] = $this->getChoices($view,$field_name);
+      //Prevent loosing current values in hidden fields:
+      foreach ($vals["field_value"] as $value) {
+        if ( ! in_array($value, $vals["field_choices"]) ) {
+          $vals["field_choices"][$value]=$value;
+        }
+      }
+    }
     
     // parse and return 
     return $this->_template($templateDir, $typename, $vals);
@@ -480,7 +671,13 @@
      $this->_zen->addDebug("_template", "Rendering $templateDir/fields/$typename.template", 3);
      $templateFile = "$templateDir/fields/$typename.template";
      $template = new zenTemplate($templateFile);
+     
+     $vals['field_value'] = $this->_zen->ffv($vals['field_value']);
+     
      $template->values($vals);
+//print "<pre>";
+//print_r($vals);
+//print "</pre>";
      return $template->process();     
    }
   
@@ -505,7 +702,12 @@
     $set = array();
     for($i=0; $i<count($vals); $i++) {
       $v = $vals[$i];
-      if( !array_key_exists($v['which_view'], $set) ) { $set[ $v['which_view'] ] = array(); }
+      if ( !array_key_exists($v['which_view'], $set) ) {
+        $set[ $v['which_view'] ] = array();
+      }
+//      if (strpos($v['field_name'],"custom_multi")===0) {
+//        $v['field_name'].="[]";
+//      }
       $set[ $v['which_view'] ] [ $v['field_name'] ] = $v;
     }
     $this->_zen->addDebug("getFieldMap", "Loaded $i rows into field_map from database",3);
@@ -629,8 +831,7 @@
       
     $field = $this->getFieldFromMap($view, $field_name);
     $fprops = getFmFieldProps($view, $field_name);
-    $vprops = getFmViewProps($view);
-    $bins = $this->_zen->getUsersBins($_SESSION['login_id']);
+    $bins = $this->_zen->getUsersBins($_SESSION['login_id'], $this->getViewProp($view, 'access_level'));
     
     switch( $this->fieldName($field_name) ) {
       case "bin_id":
@@ -641,7 +842,7 @@
         }
         break;
       case "status":
-        $vals = array('OPEN'=>"Open",'PENDING'=>"Pending",'CLOSED'=>"Closed");
+        $vals = array('OPEN'=>tr("Open"),'PENDING'=>tr("Pending"),'CLOSED'=>tr("Closed"));
         break;
       case "id":
       case "title":
@@ -650,6 +851,7 @@
       case "user_id":
       case "system_id":
       case "creator_id":
+      case "project_id":
         $vals = $this->_zen->getValsForTicketField($field_name, $bins);
         break;
       case 'custom_boolean':
@@ -657,11 +859,11 @@
         break;      
       case "tested":
       case "approved":
-        $vals = $vprops["admin_view"]?
-          array('0'=>'n/a', '2'=>'Yes', '1'=>'No') : array('1'=>'Yes', '2'=>'No');
+        $vals = array('1'=>tr('Required'), '2'=>tr('Completed'));
         break;
       default:
-        if( strncmp("custom_menu",$this->fieldName($field_name),11)==0 ) {
+        if(  strncmp("custom_menu",$this->fieldName($field_name),11)==0 
+          || strncmp("custom_multi",$this->fieldName($field_name),12)==0 ) {
           $pts = explode("_", $view, 2);
 //          $vars = $this->_zen->getCustomField($field_name);
 //          $set = genDataGroupChoices($vars['field_value']);
@@ -679,9 +881,29 @@
     
     $this->_zen->addDebug('_getChoices', "Generated ".count($vals)." choices for {$view}->{$field_name}", 3);
     
-    if( $view == 'search_form' && $field['num_rows'] == 1 ) {
-      $vals = Zen::mergeArrays( array('' => '-any-'), $vals );
+    if( $field_name == 'type_id' && preg_match('@^(project|view)_@', $view, $matches) ) {
+      // remove project types from ticket views and ticket types from
+      // project views
+      $newvals = array();
+      $isproj = $matches[1] == 'project';
+      foreach($vals as $k=>$v) {
+        if( ($is_proj && $this->_zen->inProjectTypeIDs($k)) ||
+        (!$is_proj && !$this->_zen->inProjectTypeIDs($k)) ) {
+          $newvals[$k] = $v;
+        }
+      }
+      $vals = $newvals;
+    }
+    
+    if( $this->getViewProp($view, 'any_option') && $field['num_rows'] == 1 ) {
+      $vals = Zen::mergeArrays( array('' => tr('-any-')), $vals );
       //$vals = array_merge(array(''=>'-any-'),$vals);
+    } else if ( $field['is_required']==0 && $field['field_type'] == 'menu') {
+      $vals = Zen::mergeArrays( array('' => tr('-none-')), $vals );
+    }
+    else if( !$field['is_required'] && $field['num_rows'] == 1 ) {
+      $vals = Zen::mergeArrays( array(''=>'-----'), $vals );
+      //$vals = array_merge(array(''=>'-----'), $vals);
     }
     if( !isset($this->_fieldVals[$view]) ) { $this->_fieldVals[$view] = array(); }
     $this->_fieldVals[$view][$field_name] = $vals;
@@ -769,6 +991,53 @@
          return null;
      }     
    }
+   
+   /**
+    * Returns the value (from fmx_val) for a given view property
+    *
+    * @param string $view
+    * @param string $prop
+    * @return mixed value of the property (boolean, string or array)
+    */
+   function getViewProp( $view, $prop ) {
+     $vals = $this->getViewProps($view);
+     if( !$vals || !$view ) {
+       $this->_zen->addDebug('getViewProp', "Invalid view $view, unable to retrieve $prop", 1);
+       return null;
+     }
+     if( !array_key_exists($prop, $vals) ) {
+       $this->_zen->addDebug('getViewProp', "Property not found: {$view}->{$prop}", 3);
+       return null;
+     }
+     $val = $vals["$prop"]["vm_val"];
+     if( $prop == 'preload' || $prop == 'postload' ) {
+       // preload and postload are special cases, always return an array
+       $val = $val? explode(",",$val) : array();
+     }
+     return $val;
+   }
+   
+   /**
+    * Returns a list of possible choices for preload/postload options
+    *
+    * @static
+    * @param $libDir includes directory
+    * @return array of (String)name values
+    */
+  function getLoadOptions( $templateDir ) {
+    $opts = array();
+    $dh = opendir($templateDir);
+    while( $file = readdir($dh) ) {
+      if( preg_match('@^ticket_load_([a-zA-Z0-9]+)[.]php$@', $file, $matches) ) {
+        $opts[] = $matches[1];
+      }
+    }
+    return $opts;
+  }
+
+  function listMultiFields() {
+    return array ('custom_multi1', 'custom_multi2');
+  }
   
   /** @var array $_map an array of (string)view -> array( (string)field_name->(array)values... ) */
   var $_map;
@@ -782,6 +1051,56 @@
   /** @var zenTrack $_zen */
   var $_zen;
   
+  /** @var array $_viewProps properties for all views */
+  var $_viewProps;
+  
+}
+
+class ZenFieldMapRenderContext extends ZenContext {
+  function ZenFieldMapRenderContext($vals = null) {
+    $this->ZenContext($vals);
+  }
+  
+  
+  /** Sets the view (required) */
+  function view() { return $this->get('view'); }
+  
+  /** The field name from the field map (not the one to appear in the form, required) */
+  function field() { return $this->get('field'); }
+  
+  /** The form name (required) */
+  function form() { return $this->get('form'); }  
+  
+  /** Overrides the field_name used in the form field */
+  function name() { return $this->get('name')? $this->get('name') : $this->get('field'); }
+  
+  /** If set, this overrides the fields num_cols value */
+  function columns() { return $this->get('columns'); }
+  
+  /** If set, this overrides the fields num_rows value */
+  function rows() { return $this->get('rows'); }
+  
+  /** If set, overrides the fields max length (from num_cols) */
+  function maxlength() { return $this->get('maxlength'); }
+  
+  /** Appends text into field, such as onclick or onmouseover events */
+  function events() { return $this->get('events'); }
+  
+  /** Applies a stylesheet class to the field */
+  function cssStyle() { return $this->get('cssStyle'); }
+  
+  /** Sets the default value to use */
+  function value() { return $this->get('value'); }
+  
+  /** Overrides the fields label text */
+  function label() { return $this->get('label')? $this->get('label') : $this->name(); }
+  
+  /** Overrides the fields setting for allowing multiple entries */
+  function multiple() { return $this->get('multiple'); }
+  
+  /** Overrides the field_type and makes it a label */
+  function force_label() { return $this->get('force_label'); }
+  
 }
 
 ?>
diff -Naur zentrack_2-5-5-2/includes/ZenHistoryManager.class zentrack_2-6-pre1/includes/ZenHistoryManager.class
--- zentrack_2-5-5-2/includes/ZenHistoryManager.class	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/ZenHistoryManager.class	2005-07-29 12:13:14.000000000 -0700
@@ -0,0 +1,103 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+
+/**
+ * Manages history of visited items in ZT
+ */
+class ZenHistoryManager {
+  
+  /** 
+   * Construct a history manager
+   *
+   * @param zenTrack $zen
+   */
+  function ZenHistoryManager(&$zen) {
+    global $login_id;
+    $this->_session =& $zen->getSessionManager();
+    $this->_max = $zen->getSetting('recently_viewed_max');
+    $this->_zen =& $zen;
+    $this->_user = $login_id;
+  }
+  
+  /**
+   * Store an item in the history manager
+   * @param String $type
+   * @param int $id
+   * @param String $label
+   */
+  function storeItem( $type, $id, $label ) {
+    $list = $this->getList($type);
+    
+    // see if our item appears in the array
+    $loc = -1;
+    $count = 0;
+    foreach($list as $k=>$v) {
+      if( $k == $id ) { 
+        $loc = $count;
+        break;
+      } 
+      $count++;
+    }
+    
+    // if this item is already first in the list
+    // there is nothing left to do
+    if( $loc == 0 ) {
+      $this->_zen->addDebug("ZenHistoryManager->storeItem", "Item already appears first in $type history: $id - $label", 3);
+      return; 
+    }
+
+    $this->_zen->addDebug("ZenHistoryManager->storeItem", "Adding item to $type history: $id - $label", 3);
+    
+    // place item in beginning of list
+    $newlist = array("$id"=>$label);
+    
+    // add items from original list until it is full
+    $count = 1;
+    foreach($list as $k=>$v) {
+      // remove item if it already appears in list (it will be at the top now)
+      if( $k == $id ) { continue; }
+      // limit the size of our list
+      if( ++$count > $this->_max ) { break; }
+      // place old items into the history
+      $newlist["$k"] = $v;
+    }
+    $list = $newlist;
+    
+    // store new list
+    $this->_session->store("history_$type", $list);
+    $this->_zen->update_pref( $this->_user, "history_$type", join(",",array_keys($list)) );
+  }
+   
+  /**
+   * Retrieve a list of items from the history manager
+   *
+   * @param String $type
+   * @return Array associative array of (int)id => (String)label
+   */
+  function getList( $type ) {
+    // check the session
+    $list = $this->_session->find("history_$type");
+    if( !$list ) {
+      // try to get our list from user prefs
+      $pref = $this->_zen->get_prefs($this->_login_id, "history_$type");
+      if( $pref ) {
+        // build key/value set from the string of ids
+        $list = $this->_zen->listTitles($type, explode(",",$pref));
+        $this->_session->store("history_$type", $list);
+      }
+      else {
+        $list = array();
+      }
+    }
+    return $list;
+  }
+   
+  var $_zen;
+  var $_max;
+  var $_session;
+  var $_login_id;
+
+}
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/ZenHotKeys.class zentrack_2-6-pre1/includes/ZenHotKeys.class
--- zentrack_2-5-5-2/includes/ZenHotKeys.class	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/ZenHotKeys.class	2005-10-21 04:21:31.000000000 -0700
@@ -0,0 +1,544 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+class ZenHotKeys {
+  
+  function ZenHotKeys( &$zen ) {
+    $this->_zen =& $zen;
+    $this->_keys = array();
+    $this->_fxns = array();
+    $this->_idx = array();
+    $this->_tabs = array();
+    $this->_keysRendered = array();
+    $this->_lh = '';
+    $this->_alternate = $zen->getSetting('hotkeys_alternate_hints');
+    $this->_alreadyLoaded = array();
+    
+    //todo load registered hot keys from database for the 'all' section
+    //todo and assign them here
+    $c = 1;
+    $this->assign('ALT+'.$c++, 'Projects',    "KeyEvent.createLoadUrl('{rootUrl}/projects.php')", '', true);
+    $this->assign('ALT+'.$c++, 'Tickets',     "KeyEvent.createLoadUrl('{rootUrl}/index.php')", '', true);
+    if( $this->_zen->settingOn('allow_contacts') ) {
+      $this->assign('ALT+'.$c++, 'Contacts',    "KeyEvent.createLoadUrl('{rootUrl}/contacts.php')", '', true);
+    }
+    $this->assign('ALT+'.$c++, 'Options',     "KeyEvent.createLoadUrl('{rootUrl}/options.php')", '', true);  
+    $this->assign('ALT+'.$c++, 'Help',        "KeyEvent.createLoadUrl('{rootUrl}/help/index.php')", '', true);  
+    $this->assign('ALT+'.$c++, 'Admin',       "KeyEvent.createLoadUrl('{rootUrl}/admin/index.php')", '', true);  
+    $this->assign('ALT+P', 'New Project', "KeyEvent.createLoadUrl('{rootUrl}/newProject.php')", '', true);  
+    $this->assign('ALT+T', 'New Ticket',  "KeyEvent.createLoadUrl('{rootUrl}/newTicket.php')", '', true);  
+    $this->assign('ALT+C', 'New Contact', "KeyEvent.createLoadUrl('{rootUrl}/newContact.php')", '', true);
+    
+    $this->newFxn('quickFocus', 'window.document.quickIdForm.idText.focus(); quickHighlight("window.document.quickIdForm.idText","searchHelpBox");', '', true);
+    $this->assign('ALT+S', 'Search',   "quickFocus()", 'Enter a ticket id or summary', true);
+    $this->assign('ALT+V', 'Advanced Search', "KeyEvent.createLoadUrl('{rootUrl}/search.php')", "Advanced ticket search", true);
+  }
+  
+  /** Prepares hot keys for a given section of the app */
+  function loadSection( $sect ) {
+    $sect = strtolower($sect);
+    if( in_array($sect, $this->_alreadyLoaded) ) {
+      $this->_zen->addDebug('loadSection', "$sect already loaded", 3);
+      return;
+    }
+    $this->_alreadyLoaded[] = $section;
+    
+    //todo load registered hot keys from database and assign here
+    $this->_zen->addDebug('loadSection', "Attempting to load section: $sect", 3);
+    
+    //this is a quick hack for the time being
+    if( $sect == 'admin' ) {
+      $this->assign('ALT+N',  'New User',        "KeyEvent.createLoadUrl('{rootUrl}/admin/addUser.php')");
+      $this->assign('ALT+U',  'Edit Users',      "KeyEvent.createLoadUrl('{rootUrl}/admin/listUsers.php')");
+      $this->assign('ALT+E',  'Edit Tickets',    "KeyEvent.createLoadUrl('{rootUrl}/admin/editTicket.php')");
+      $this->assign('ALT+F',  'Edit Field Map',  "KeyEvent.createLoadUrl('{rootUrl}/admin/fieldMap.php')");
+      $this->assign('ALT+B',  'Bins',            "KeyEvent.createLoadUrl('{rootUrl}/admin/bins.php')");
+      $this->assign('ALT+R',  'Priorities',      "KeyEvent.createLoadUrl('{rootUrl}/admin/priorities.php')");
+      $this->assign('ALT+S',  'Systems',         "KeyEvent.createLoadUrl('{rootUrl}/admin/systems.php')");
+      $this->assign('ALT+A',  'Tasks',           "KeyEvent.createLoadUrl('{rootUrl}/admin/tasks.php')");
+      $this->assign('ALT+Y',  'Types',           "KeyEvent.createLoadUrl('{rootUrl}/admin/types.php')");
+      $this->assign('ALT+G',  'Data Groups',     "KeyEvent.createLoadUrl('{rootUrl}/admin/groups.php')");
+      $this->assign('ALT+H',  'Behaviors',       "KeyEvent.createLoadUrl('{rootUrl}/admin/behaviors.php')");
+      $this->assign('ALT+O',  'Configuration',   "KeyEvent.createLoadUrl('{rootUrl}/admin/config.php')");
+    }
+    else if( $sect == 'actionbar' ) {
+      $actions = $this->_zen->getActions();
+      foreach($actions as $k=>$v) {
+        if( $v['button'] && $v['key'] ) {
+          if( $k == 'print' ) {
+            $this->assign($v['key'], "Action: {$v['label']}", "printWindow");
+            continue;
+          }
+          $this->assign($v['key'], "Action: {$v['label']}", 
+            "KeyEvent.createLoadUrl('{rootUrl}/actions/$k.php?id={id}')", $v['label']);
+        }
+      }
+    }
+    else if( $sect == 'action_approve' ) {
+      $f = "window.document.forms['approveForm']";
+      $this->assign('ALT+O', "Comments", "{$f}.elements['comments'].select()");
+      $this->assign('ALT+A', "Approve", "{$f}.submit()");
+    }
+    else if( $sect == 'action_assign' ) {
+      $f = "window.document.forms['assignForm']";
+      $this->assign('ALT+R', "Recipient", "{$f}.elements['user_id'].focus()");
+      $this->assign('ALT+O', "Comments or Instructions", "{$f}.elements['comments'].select()");
+      $this->assign('ALT+A', "Assign", "{$f}.submit()");
+    }
+    else if( $sect == 'action_close' ) {
+      $this->assign('ALT+H', 'Field: hours', "window.document.forms['ticketTabForm'].elements['hours'].select()", "Hours");
+      $this->assign('ALT+O', 'Field: comments', "window.document.forms['ticketTabForm'].elements['comments'].select()", "Comments");
+      $this->assign('ALT+L', 'Close', "window.document.forms['ticketTabForm'].submit()");
+    }
+    else if( $sect == 'action_contacts' ) {
+      $this->assign('ALT+N', 'Create New Contact', "window.document.forms['newContactForm'].submit()");
+      $this->assign('ALT+A', 'Add Contact', "window.document.forms['ContactsAddForm'].submit()");
+      $this->assign('ALT+D', 'Drop Contacts', "window.document.forms['dropContactsForm'].submit()");
+      $this->assign('ALT+Y', 'Field: company_id', "window.document.forms['ContactsAddForm'].elements['company_id'].focus()", "Company");
+      $this->assign('ALT+E', 'Field: person_id', "window.document.forms['ContactsAddForm'].elements['person_id'].focus()", "Person");
+    }
+    else if( $sect == 'action_notify' ) {
+      $f = "window.document.forms['notifyAddForm']";
+      $this->assign('ALT+R', "Enter Registered Users", "{$f}.elements['user_accts'].select()");
+      $this->assign('ALT+U', "Add an Unregistered User", "{$f}.elements['unreg_name'].select()");
+      $this->assign('ALT+O', "Add a Contact", "{$f}.elements['company_id'].focus()");
+      $this->assign('ALT+A', "Add Recipients", "{$f}.submit()");
+    }
+    else if( $sect == 'action_email' ) {
+      $f = "window.document.forms['emailForm']";
+      $this->newFxn('emailFormToggle', "var obj = {$f}.elements['method']; var newVal = arguments[0]; for(var i=0; i < obj.length; i++) { if( obj[i].value == newVal ) { obj[i].checked = true; break; } }");
+      $this->assign('ALT+U', 'Select a User', "{$f}.elements['users_to_email[]'].focus();",
+        "Select one or more users, use CTRL or SHIFT key for multiples");
+      $this->assign('ALT+M', 'Manually Enter Addresses', "{$f}.elements['custom_email_addresses'].select();",
+        "Manually enter an email address, use commas to separate multiple addresses");
+      $this->assign('ALT+O', 'Comments or Instructions', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+E', 'Send Email', "{$f}.submit()");
+      $this->assign('ALT+L', 'send option: link',  "emailFormToggle(1)");
+      $this->assign('ALT+Y', 'send option: summary', "emailFormToggle(2)");
+      $this->assign('ALT+G', 'send option: log',  "emailFormToggle(3)");
+    }
+    else if( $sect == 'action_log' ) {
+      $f = "window.document.forms['logForm']";
+      $this->assign('ALT+Y', 'Select an Activity', "{$f}.elements['log_action'].focus()");
+      $this->assign('ALT+H', 'Enter Hours Worked', "{$f}.elements['hours'].select()");
+      $this->assign('ALT+O', 'Log Entry / Comments', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+A', 'Save Log', "{$f}.submit()");
+    }
+    else if( $sect == 'action_move' ) {
+      $f = "window.document.forms['moveForm']";
+      $this->assign('ALT+B',  'New Bin', "{$f}.elements['newBin'].focus()");
+      $this->assign('ALT+O',  'Comments', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+M',  'Move',  "{$f}.submit()");
+    }
+    else if( $sect == 'action_reject' ) {
+      $f = "window.document.forms['rejectForm']";
+      $this->assign('ALT+O', 'Reason', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+R', 'Reject', "{$f}.submit()");
+    }
+    else if( $sect == 'action_relate' ) {
+      $f = "window.document.forms['relateTicketForm']";
+      $this->assign('ALT+I', 'Enter Ticket IDs', "{$f}.elements['relations'].select()");
+      $this->assign('ALT+O', 'Comments', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+R', 'Relate', "{$f}.submit()");
+    }
+    else if( $sect == 'action_reopen' ) {
+      $f = "window.document.forms['reopenForm']";
+      $this->assign('ALT+O', 'Comments or Instructions', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+R', 'Reopen', "{$f}.submit()");
+    }
+    else if( $sect == 'action_test' ) {
+      $f = "window.document.forms['testForm']";
+      $this->assign('ALT+H', 'Hours Worked', "{$f}.elements['hours'].select()");
+      $this->assign('ALT+O', 'Comments or Instructions', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+E', 'Testing Complete', "{$f}.submit()");
+    }
+    else if( $sect == 'action_upload' ) {
+      $f = "window.document.forms['addAttachmentForm']";
+      $this->assign('ALT+U', 'Select a File to Upload', "{$f}.elements['userfile'].focus()");
+      $this->assign('ALT+E', 'Description of Attachment', "{$f}.elements['comments'].select()");
+      $this->assign('ALT+A', 'Add Attachment', "{$f}.submit()");
+    }
+    else if( $sect == 'action_yank' ) {
+      $this->assign('ALT+O', 'Reason', "window.document.forms['pullForm'].elements['comments'].select()");
+      $this->assign('ALT+U', 'Pull', "window.document.forms['pullForm'].submit()");
+    }
+    else if( $sect == 'agreement_view' ) {
+      $this->assign('ALT+E', 'Edit', "window.document.forms['editAgreementForm'].submit()");
+      $msg = Zen::fixJsHtml(tr("Are you sure you want to archive this agreement?"),"'");
+      $this->assign('ALT+A', 'Archive', "confirmSubmit(window.document.forms['archiveAgreementForm'],$msg)");
+      $msg = Zen::fixJsHtml(tr("Are you sure you want to delete this agreement?"),"'");
+      $this->assign('ALT+D', 'Delete', "confirmSubmit(window.document.forms['deleteAgreementForm'],$msg)");
+    }
+    else if( $sect == 'agreement_form' ) {
+      $f = "window.document.forms['agreementForm']";
+      $this->assign('ALT+A', "Add Item",     "rerouteAgreementForm('addItems')");
+      $this->assign('ALT+O', "Drop Items",   "rerouteAgreementForm('removeItems')");
+      $this->assign('ALT+R', "Create",       "{$f}.submit()");
+      $this->assign('ALT+M', "Agreement ID", "{$f}.elements['contractnr'].select()");
+      $this->assign('ALT+E', "Description",  "{$f}.elements['description'].select()");
+    }
+    else if( $sect == 'contacts' ) {
+      $this->assign('ALT+N',  'Find',           "KeyEvent.createLoadUrl('{rootUrl}/searchContacts.php')");
+      $this->assign('ALT+B',  'Browse',         "KeyEvent.createLoadUrl('{rootUrl}/agreements.php')");
+      $this->assign('ALT+G',  'New Agreement',  "KeyEvent.createLoadUrl('{rootUrl}/newAgreement.php')");
+    }
+    else if( $sect == 'contacts_new_menu' ) {
+      $this->assign('ALT+Y',  'New Company',    "KeyEvent.createLoadUrl('{rootUrl}/newContact.php?mode2=1')");
+      $this->assign('ALT+N',  'New Person',     "KeyEvent.createLoadUrl('{rootUrl}/newContact.php?mode2=2')");
+    }
+    else if( $sect == 'contacts_view' ) {
+      $this->assign('ALT+D',  'Edit',    "KeyEvent.createLoadUrl('{rootUrl}/actions/contact_edit.php?cid={id}')");
+      $this->assign('ALT+L',  'Delete',  "KeyEvent.createLoadUrl('{rootUrl}/actions/contact_delete.php?cid={id}')");
+      $this->assign('ALT+E',  'Add Employee',  "KeyEvent.createLoadUrl('{rootUrl}/actions/contact_employee.php?cid={id}')");
+      $this->assign('ALT+A',  'Add Agreement',  "KeyEvent.createLoadUrl('{rootUrl}/actions/contact_agreement.php?cid={id}')");
+      $this->assign('ALT+I',  'View Tickets', "KeyEvent.createLoadUrl('{rootUrl}/contact.php?overview=tickets&cid={id}')");
+      $this->assign('ALT+Y',  'View Employees',  "KeyEvent.createLoadUrl('{rootUrl}/contact.php?cid={id}&overview=contact')");
+      $this->assign('ALT+M',  'View Agreements',  "KeyEvent.createLoadUrl('{rootUrl}/contact.php?cid={id}&overview=agreement')");
+    }
+    else if( $sect == 'contacts_view_employee' ) {
+      $this->assign('ALT+E',  'Edit',         "window.document.forms['edit_form'].submit()");
+      $msg = Zen::fixJsVal(tr("Are you sure you want to delete this contact?"));
+      $this->assign('ALT+D',  'Delete',       "confirmSubmit(window.document.forms['delete_form'],$msg)");
+      $this->assign('ALT+I',  'View Tickets', "window.document.forms['view_form'].submit()");
+    }
+    else if( $sect == 'contacts_list' ) {
+      $tabs = array('all',"abc","def","ghi","jkl","mno","pqrs","tuv","wxyz","!19");
+      foreach($tabs as $t) {
+        $c = 0;
+        $k = false;
+        while(!$k || (array_key_exists($k,$this->_keys) && $c < strlen($t))) {
+          $k = strtoupper(substr($t,$c,1));
+          if( $k == '!' ) { $k = false; }
+          $c++;
+        }
+        $this->assign($k, $t, "updateUrl('setmode','$t')");
+      }
+      $this->assign('ALT+O', "Company",  "updateUrl('overview', 'company')"  );
+      $this->assign('ALT+E', "External", "updateUrl('overview', 'external')" );
+      $this->assign('ALT+I', "Internal", "updateUrl('overview', 'internal')" );
+    }
+    else if( $sect == 'log' ) {
+      $this->assign('ALT+L',  'Show All Logs',  "window.document.getElementById('systemLogFilterCheckbox').click()");
+    }
+    else if( $sect == 'login' ) {
+      $f = "window.document.forms['loginForm']";
+      $this->newFxn("loginAutoCheck", "{$f}.elements['save_my_password'].checked = !window.document.forms['loginForm'].elements['save_my_password'].checked;");
+      $this->assign('ALT+L',   'Log On',         "{$f}.submit()");
+      $this->assign('ALT+A',   "In the future, log me in automatically (using a cookie)", "loginAutoCheck()");
+      $this->assign('ALT+N',   'Login Name',     "{$f}.elements['username'].select()");
+      $this->assign('ALT+W',   'Password',       "{$f}.elements['passphrase'].select()");
+    }
+    else if( $sect == 'options' ) {
+      $this->assign('ALT+L',  'Log Off',        "KeyEvent.createLoadUrl('{rootUrl}/index.php?logoff=1')", "Log out of ".$this->_zen->getSetting('system_name'));
+    }
+    else if( $sect == 'paging' ) {
+      $this->assign('ALT+E',  "Prev",           "window.location = window.document.getElementById('pagingPrevLink').href");
+      $this->assign('ALT+X',  "Next",           "window.location = window.document.getElementById('pagingNextLink').href");
+    }
+    else if( $sect == 'project_tasks' ) {
+      $this->assign('ALT+A', "Add Ticket to Project", "window.document.forms['newTicketHotkey'].submit()");
+      $this->assign('ALT+R', "Create Sub-Project", "window.document.forms['newProjectHotkey'].submit()");
+    }
+    else if( $sect == 'search_form' ) {
+      $f = "window.document.forms['searchForm']";
+      $this->assign('ALT+E', "Search",  "{$f}.submit()");
+      $this->assign('ALT+O', "Containing", "{$f}.elements['search_text'].select()");
+      $this->assign('ALT+U', "Summary", "{$f}.elements['search_fields[title]'].click()");
+      $this->assign('ALT+D', "Description", "{$f}.elements['search_fields[description]'].click()");
+    }
+    else if( $sect == 'tab_attachments' ) {
+      $this->assign('ALT+D', 'Delete Attachments', "window.document.forms['deleteAttachmentForm'].submit()");
+      $this->assign('ALT+A', 'Add Attachment', "window.document.forms['addAttachmentForm'].submit()");
+    }
+    else if( $sect == 'tab_contacts' ) {
+      $this->assign('ALT+N', 'Create New Contact', "window.document.forms['newContactForm'].submit()");
+      $this->assign('ALT+A', 'Add Contact', "window.document.forms['ContactsAddForm'].submit()");
+      $this->assign('ALT+D', 'Drop Contacts', "window.document.forms['dropContactsForm'].submit()");
+      $this->assign('ALT+Y', 'Field: company_id', "window.document.forms['ContactsAddForm'].elements['company_id'].focus()", "Company");
+      $this->assign('ALT+E', 'Field: person_id', "window.document.forms['ContactsAddForm'].elements['person_id'].focus()", "Person");
+    }
+    else if( $sect == 'tab_notify' ) {
+      $this->assign('ALT+D', "Drop Recipients", "window.document.forms['dropNotifyForm'].submit()");
+      $this->assign('ALT+A', "Add Recipients", "window.document.forms['notifyAddForm'].submit()");
+    }    
+    else if( $sect == 'ticket_fields_editable' ) {
+      $this->assign('ALT+A', 'Save', "window.document.forms['ticketTabForm'].submit()");
+    }
+    else if( $sect == 'ticket_view' || $sect == 'project_view' ) {
+      $map = $GLOBALS['zt_map'];
+      preg_match('@(ticket|project)@', $sect, $matches);
+      $t = $matches[1];
+      for($i=1; $i<=8; $i++) {
+        $view = "{$t}_tab_{$i}";
+        if( $map->getViewProp($view, 'visible') ) {
+          $label = $map->getViewProp($view,'label');
+          $this->assign($i, $label, "KeyEvent.createLoadUrl('{rootUrl}/ticket.php?id={id}&setmode=$view')");
+        }
+      }
+    }
+  }
+  
+  function newFxn( $name, $code ) {
+    if( array_key_exists($name, $this->_fxns) ) {
+      $this->_zen->addDebug('ZenHotKeys->newFxn', "The fxn '$name' already exists", 1);
+      return;
+    }
+    $this->_zen->addDebug('ZenHotKeys->assign', "Added fxn '$name'", 3);
+    $this->_fxns["$name"] = $code;
+  }
+  
+  function getFxnName($key) {
+    return str_replace('KeyEvent.createLoadUrl', 'KeyEvent.loadUrl', $this->_keys[$key]['fxn']);
+  }
+
+  /** 
+   * Adds a hot key to the list.  The fxn param accepts the following special
+   * placeholders:
+   * <ul>
+   *  <li>{rootUrl} - replaced with the value of $rootUrl in www/header.php
+   *  <li>{id} - replaced with the current ticket/project/contact/agreement id (if any)
+   * </ul>
+   *
+   * @param String $key a hot key such as 'ALT+SHIFT+Y'
+   * @param String $label name of the hot key
+   * @param String $fxn name of function to call when hot key is pressed
+   * @param String $description tooltip text (defaults to label)
+   */
+  function assign( $key, $label, $fxn, $description = '', $global = false ) {
+    global $id; global $rootUrl;
+    
+    $key = strtoupper($key);
+    if( array_key_exists($key, $this->_keys) ) {
+      $this->_zen->addDebug('ZenHotKeys->assign', "The key '$key' already exists", 1);
+      return;
+    }
+
+    if( array_key_exists($label, $this->_idx) ) {
+      $this->_zen->addDebug('ZenHotKeys->assign', "The label '$label' already exists for key '".$this->_idx["$label"]."', this hotkey cannot be looked up by label accurately", 2);
+    }
+    else {
+      $this->_idx["$label"] = $key;
+    }
+    
+    if( !$description ) { $description = $label; }
+    $fxn = str_replace("{rootUrl}", $rootUrl, $fxn);
+    $fxn = str_replace("{id}", $id, $fxn);
+    
+    $this->_zen->addDebug('ZenHotKeys->assign', "Added key '$key' for label '$label' and fxn '$fxn'", 3);
+    $this->_keys["$key"] = array('label'=>$label, 'fxn'=>$fxn, 'description'=>$description, 'global'=>$global);
+  }
+  
+  function disableAction( $key ) {
+    $this->_keys["$key"]["fxn"] = 'doNothing';
+  }
+  
+  /**
+   * Return the hot key for a given label (the section must be loaded unless
+   * this label appears in 'all')
+   *
+   * @param String $label
+   * @return String the key for this label
+   */
+  function find( $label ) {
+    if( !array_key_exists("$label", $this->_idx) ) { return false; }
+    return $this->_idx["$label"];
+  }
+  
+  
+  /** Returns a tooltip for a given label */
+  function tt( $label ) {
+    $key = $this->find($label);
+    if( !$key ) {
+      $this->_zen->addDebug('ZenHotKeys->tt', "Invalid label '$label'", 1);
+      return $label;
+    }
+    return $this->tooltip($key, $override_text = '');
+  }
+  
+  /** Returns a parsed/translated label for a given label */
+  function ll( $label, $override_text = '', $supress_key = false ) {
+    $key = $this->find($label);
+    if( !$key ) {
+      $this->_zen->addDebug('ZenHotKeys->ll', "Invalid label '$label'", 1);
+      return $override_text? $override_text : $label;
+    }
+    return $this->label($key, $override_text, $supress_key);
+  }
+  
+  /** 
+   * Return a tooltip message for a given key, this will be translated and
+   * the hot key will be appended
+   */
+  function tooltip( $key ) {
+    $key = strtoupper($key);
+    return $this->_zen->ffv(tr($this->_keys["$key"]["description"])." ($key)");
+  }
+  
+  /**
+   * Return description for a given key, translated and escaped
+   *
+   * If the description is the same as the label, it will be skipped.
+   */
+  function description( $key ) {
+    $key = strtoupper($key);
+    $x = $this->_keys["$key"];
+    if( $x["description"] == $x["label"] ) { return "&nbsp;"; }
+    return $this->_zen->ffv(tr($x["description"]));
+  }
+  
+  /** 
+   * Return a label for a given key, this will be translated
+   * and the hot key will be underlined if possible
+   */
+  function label( $key, $override_text = '' ) {
+    $key = strtoupper($key);
+    $char = $this->_getChar($key);
+    $lchar = strtolower($char);
+    $label = $override_text? tr($override_text) : tr($this->_keys["$key"]["label"]);
+    $label = preg_replace('@^(Action|Field): @', '', $label);
+    $label = str_replace('_', ' ', $label);
+    $pos = strpos($label, $char);
+    if( $pos === false ) { $pos = strpos($label, $lchar); $char = $lchar; }
+    $len = strlen($label);
+    if( $pos === 0 ) {
+      // matched at beginning of string
+      $txt = "<u>{$char}</u>".substr($label,1);
+    }
+    else if( $pos > 0 && $pos == $len-1 ) {
+      // matched at end of string
+      $txt = substr($label,0,$len-1)."<u>{$char}</u>";
+    }
+    else if( $pos > 0 ) {
+      // matched inside the string
+      $txt = substr($label,0,$pos)."<u>{$char}</u>".substr($label,$pos+1);
+    }
+    else {
+      // no match, just return the label
+      //return $label."<sub class='note'>$char</sub>";
+      $txt = $label;
+    }
+    //if( !$supress_key ) { $txt .= $this->renderAccessKey($key); }
+    $txt .= $this->addZenTab($key);
+    return $txt;
+  }
+  
+  /**
+   * Renders any custom functions defined here.
+   */
+  function renderFunctions() {
+    if( !count($this->_fxns) ) { return; }
+    foreach( $this->_fxns as $k=>$v ) {
+      print "function $k() {\n";
+      print $v;
+      print "}\n\n";
+    }
+     
+  }
+  
+  /** 
+   * Create javascript code needed for
+   * hot keys to function.  Depends on the keyevents.js file
+   *
+   * This is meant to be used inside of the onload fxn for the page.   */
+  function renderKeys() {
+    if( !count($this->_keys) ) { return; }
+    foreach( $this->_keys as $k=>$v ) {
+      if( $this->_getAccessKey($k) || array_key_exists($k,$this->_keysRendered) ) { continue; }
+      $this->_keysRendered[$k] = 1;
+      $f = $v['fxn'];
+      if( strpos($f,'KeyEvent.createLoadUrl')===false ) { $f = Zen::fixJsVal($f); }
+      print "\tKeyEvent.register($f, '$k');\n";
+    }
+    foreach( $this->_tabs as $t=>$k ) {
+      print "\tZenTabs.singleton.register('keySub_$t');\n";
+    }
+  }
+  
+  /**
+   * create javascript code needed for
+   * accesskey functions
+   */
+  function renderAccessKeys() {
+    $keys = array();
+    foreach($this->_keys as $k=>$v) {
+      print $this->renderAccessKey($k);
+    }
+  }
+  
+  /**
+   * Render a single access key, done this way so that they will focus near
+   * the appropriate field, when possible
+   */
+  function renderAccessKey( $k ) {
+    $v = $this->_keys[$k];
+    if( array_key_exists($k,$this->_keysRendered) ) { return; }
+    if( $key = $this->_getAccessKey($k) ) {
+      $this->_keysRendered[$k] = 1;
+      $fxn_parsed = Zen::fixJsHtml($v['fxn']);
+      $fxn_parsed = str_replace('KeyEvent.createLoadUrl', 'KeyEvent.loadUrl', $fxn_parsed);
+      return "<input type='button' {$key}' name='accessKeyButton{$key}' value='' accesskey='{$key}' class='accesskeys' onclick=$fxn_parsed>";
+    }
+    return null;
+  }
+  
+  /** Returns letter used to access this key if it is an accesskey */
+  function _getAccessKey( $key ) {
+    preg_match('@^ALT[+](\w)$@', $key, $matches);
+    return count($matches)>1? $matches[1] : false;
+  }
+  
+  /** Splits a key and returns the letter to be used */
+  function _getChar( $key ) {
+    return preg_replace('@^.*[+]@', '', $key);
+  }
+  
+  function getChar( $key ) {
+    return $this->_getChar($key);
+  }
+  
+  /** Creates html output to display help info */
+  function renderHelp() {
+    print "<table width='300' border='0' cellspacing='1' cellpadding='2'><tr><td class='titleCell'>Hot Key</td><td class='titleCell'>Function</td></tr>";
+    $keys = $this->_keys;
+    uasort($keys, 'sortHotKeyTable');
+    foreach( $keys as $k=>$v ) {
+      print "<tr><td class='hotKeyCell'>$k</td><td class='hotKeyCell'>"
+      .$this->label($k)."</td></tr>";
+    }
+    print "</table>\n";
+  }
+  
+  /** Store a key that will be used to display subtext on tabs */
+  function addZenTab( $key ) {
+    $count = 1;
+    $id = $key.$count++;
+    while( array_key_exists($id, $this->_tabs) ) {
+      $id = $key.$count++;
+    }
+    $this->_tabs[$id] = $key;
+    $this->_lh = $this->_alternate? $this->_lh == 'High'? 'Low' : 'High' : "High";
+    return "<div id='keySub_$id' class='keySub{$this->_lh}'>$key</div>";
+  }
+  
+  function addZenTabByLabel($label) {
+    $this->addZenTab($this->find($label));
+  }
+  
+  var $_alternate;
+  var $_lh;
+  var $_fxns;
+  var $_zen;
+  var $_keys;
+  var $_idx;
+  var $_alreadyLoaded;
+  var $_tabs;
+  var $_keysRendered;
+}
+
+/** Must be declared outside of class to work with php */
+function sortHotKeyTable( $a, $b ) {
+  $a['label'] = preg_replace('@^(Action|Field): @', '', $a['label']);
+  $b['label'] = preg_replace('@^(Action|Field): @', '', $b['label']);
+  return strnatcmp($a['label'], $b['label']);
+}
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/ZenSessionManager.class zentrack_2-6-pre1/includes/ZenSessionManager.class
--- zentrack_2-5-5-2/includes/ZenSessionManager.class	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/ZenSessionManager.class	2005-10-20 11:23:44.000000000 -0700
@@ -121,7 +121,8 @@
     if( isset($GLOBALS) && isset($GLOBALS['ztDataCache']) && isset($GLOBALS['ztDataCache'][$type]) ) {
       if( isset($id) ) {
         $this->_zen->addDebug("getDataCache", "$type-$id: retrieved");
-        return isset($GLOBALS['ztDataCache']["id$id"])? $GLOBALS['ztDataCache']["id$id"] : false;
+        return isset($GLOBALS['ztDataCache'][$type])
+          && isset($GLOBALS['ztDataCache'][$type]["id$id"])? $GLOBALS['ztDataCache'][$type]["id$id"] : false;
       }
       $this->_zen->addDebug("getDataCache", "$type: retrieved");
       return $GLOBALS['ztDataCache'][$type];
@@ -147,7 +148,7 @@
       }
       else {
         $this->_zen->addDebug("storeDataCache", "Storing cache for {$type}->{$id}",3);
-        $GLOBALS['ztDataCache'][$type][$id] = $vals; 
+        $GLOBALS['ztDataCache'][$type]["id$id"] = $vals; 
       }
     }
   }
@@ -198,7 +199,7 @@
   function clearCustomFields() {
     if( isset($_SESSION) ) {
       $this->_zen->addDebug("clearCustomFields", "Clearing cache", 3);
-      $_SESSION['ztVarfields'] = false;
+      unset($_SESSION['ztVarfields']);
     }
   }
   
@@ -213,4 +214,4 @@
 
  }
 
-?>
\ No newline at end of file
+?>
diff -Naur zentrack_2-5-5-2/includes/configVars.php zentrack_2-6-pre1/includes/configVars.php
--- zentrack_2-5-5-2/includes/configVars.php	2005-10-21 04:22:48.054403700 -0700
+++ zentrack_2-6-pre1/includes/configVars.php	2005-10-21 04:43:18.481322000 -0700
@@ -57,6 +57,7 @@
    $this->table_group_detail     = 'ZENTRACK_GROUP_DETAIL';
    $this->table_varfield         = 'ZENTRACK_VARFIELD';
    $this->table_varfield_idx     = 'ZENTRACK_VARFIELD_IDX';
+   $this->table_varfield_multi   = 'ZENTRACK_VARFIELD_MULTI';
 
    //pre-constructed strings
    $this->table_translation_strings = 'ZENTRACK_TRANSLATION_STRINGS'; 
@@ -116,4 +117,4 @@
   
   // address to put in to field for bug reports
   $this->bugTo = 'bugs@zentrack.net';
-}?>
\ No newline at end of file
+}?>
diff -Naur zentrack_2-5-5-2/includes/editCustomSubmit.php zentrack_2-6-pre1/includes/editCustomSubmit.php
--- zentrack_2-5-5-2/includes/editCustomSubmit.php	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/editCustomSubmit.php	2005-07-14 13:07:11.000000000 -0700
@@ -6,21 +6,38 @@
   $required = array();
   // the TODO is saved, even if the save failed
   $TODO = 'SAVED';
-  
+
+  if( $zen->inProjectTypeIDs($type_id) ) {
+    $view="project_custom";
+  } else {
+    $view="ticket_custom";
+  }
   include("$libDir/validateFields.php");
-  
   if( !$errs ) {
     if( count($varfield_params) ) {
       // update the ticket info
       $res = $zen->updateVarfieldVals($id,$varfield_params);
     }
+    // check for errors
+    if( !$res ) {
+      $errs[] = tr("System Error").": ".tr("Ticket could not be edited.")." ".$zen->db_error;
+    }
+  }
 
+/*
+  if( !$errs ) {
+      $varfields = $zen->getCustomFields(0,$page_type, 'Custom Tab'); 	 
+      include("$libDir/parseVarfields.php"); 	 
+    }
+  if( !$errs ) {
+    // update the ticket info
+    $res = $zen->updateVarfieldVals($id,$varfield_params);
     // check for errors
     if( !$res ) {
       $errs[] = tr("System Error").": ".tr("Ticket could not be edited.")." ".$zen->db_error;
     }
   }
-  
+*/  
   $setmode = 'custom';
 
   if( !$errs ) {
@@ -28,7 +45,7 @@
     $save_message = tr("Fields updated successfully");
      //header("Location:$rootUrl/ticket.php?id=$id&setmode=Custom");
     $setmode = "custom";
-    if( $zen->inProjectTypeIDs($bin_id) ) {
+    if( $zen->inProjectTypeIDs($type_id) ) {
       include("../project.php");
     } else {
       include("../ticket.php");
@@ -37,7 +54,7 @@
   } else {
      include_once("$libDir/nav.php");
      $zen->printErrors($errs);
-     if( $zen->inProjectTypeIDs($bin_id) )
+     if( $zen->inProjectTypeIDs($type_id) )
        include("$templateDir/projectView.php");
      else
        include("$templateDir/ticketView.php");
diff -Naur zentrack_2-5-5-2/includes/editTicketSubmit.php zentrack_2-6-pre1/includes/editTicketSubmit.php
--- zentrack_2-5-5-2/includes/editTicketSubmit.php	2005-05-08 14:14:53.000000000 -0700
+++ zentrack_2-6-pre1/includes/editTicketSubmit.php	2005-10-20 11:23:44.000000000 -0700
@@ -8,7 +8,6 @@
   }
 
   $page_title = tr("Commit Edited Ticket");
-  $expand_admin = 1;
 
   // initiate default values
   if( !$tested )
@@ -27,7 +26,13 @@
      $params = array();
      // create an array of existing fields
      foreach(array_keys($fields) as $f) {
+       // can't edit the status
+       if( $f == 'status' ) { continue; }
+       // put the value into the updates array
        $params["$f"] = $$f;
+       if( $f == 'title' && strlen($params["$f"]) > 50 ) {
+         $params["$f"] = substr($params["$f"],0,50);
+       }
      }
      // update the ticket info
      $res = $zen->edit_ticket($id,$login_id,$params,$edit_reason);
@@ -44,9 +49,9 @@
   }
   
   if( !$errs ) {
-    add_system_messages(tr("Edited ticket #?", array($id)));
+    $msg = tr("Edited ticket #?", array($id));
     //header("Location:$rootUrl/ticket.php?id=$id&setmode=Details");
-    $setmode = "Details";
+    $setmode = "";
     if( $is_project ) {
       include("../project.php");
     } else {
diff -Naur zentrack_2-5-5-2/includes/egate_utils.php zentrack_2-6-pre1/includes/egate_utils.php
--- zentrack_2-5-5-2/includes/egate_utils.php	2005-05-04 09:01:07.000000000 -0700
+++ zentrack_2-6-pre1/includes/egate_utils.php	2005-10-20 11:23:44.000000000 -0700
@@ -200,7 +200,7 @@
   include_once('Mail/mimeDecode.php');
   
   // make sure we are using the email interface
-  if( $zen->settings["email_interface_enabled"] != "on" ) {
+  if( !$zen->settingOn("email_interface_enabled") ) {
     egate_log("ERROR: email ignored, email_interface_enabled = off",1);
     egate_log_write();
     exit;
@@ -444,7 +444,7 @@
     } else {
       // try to divine the action anyways, even though the format wasn't correct
       // start by removing [zenBot] tag
-      $test = preg_replace("/\[".$zen->settings['bot_name']."]/","",$params->headers["subject"]);
+      $test = preg_replace("/\[".$zen->getSetting('bot_name')."]/","",$params->headers["subject"]);
       if( strlen($test) ) {
 	// look for an id
 	if( preg_match("/#([0-9]+)/", $subject, $matches) ) {
@@ -545,7 +545,7 @@
 	      egate_log("could not locate owner by id '$v', skipped",2);
 	    }
 	  }
-	  else if( strpos('@', $v) > 0 ) {
+	  else if( strpos($v, '@') > 0 ) {
 	    $user = find_user_id('',$v);
 	    if( $user ) {
 	      $vals['user_id'] = $user['user_id'];
@@ -656,7 +656,7 @@
 	// add user to notify list if they create
 	// a ticket through the egate system
 	// and default_notify_creator == "on"
-	if( $user_id == $egate_user["user_id"] && $zen->settings["default_notify_creator"] == "on" ) {
+	if( $user_id == $egate_user["user_id"] && $zen->settingOn("default_notify_creator") ) {
 	  $zen->add_to_notify_list( $id, array("name"=>$name,"email"=>$email) );
 	}
 	return $id;
@@ -1515,22 +1515,18 @@
 	$txt .= $temp->process();
       }
 
-      $subject = "[".$zen->settings["bot_name"]."] ".$subject;
+      $subject = "[".$zen->getSetting("bot_name")."] ".$subject;
 
       // send messages
       $i=0;
       $from = $egate_user["email"];
       $bcc = $egate_bcc_address? "Bcc:$egate_bcc_address\r\n" : "";
       foreach($recipients as $r) {
-	if( is_array($r) && count($r) && $r["email"] != $egate_user["email"] ) {
-	  $to = ($r["name"])? "\"{$r['name']}\" <{$r['email']}>" : $r['email'];
-	  $res = mail($to,$subject,$txt,"From:$from\r\nReply-to:$from\r\n$bcc");
-	  if( $res )
-	    $i++;
-	}
-	else {
-	  egate_log("return recipient was blank, skipping reply email");
-	}
+        if( is_array($r) && count($r) && $r["email"] != $egate_user["email"] ) {
+        $res = mail($r['email'],$subject,$txt,"From:$from\r\nReply-to:$from\r\n$bcc");
+        if( $res )
+          $i++;
+        }
       }
       return $i;
     }
diff -Naur zentrack_2-5-5-2/includes/footer.php zentrack_2-6-pre1/includes/footer.php
--- zentrack_2-5-5-2/includes/footer.php	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/footer.php	2005-10-20 11:23:44.000000000 -0700
@@ -3,17 +3,24 @@
    
 
    <!--- BEGIN FOOTER --->
-  
-  
+   
+   </td></tr></table>
   
   </td>
   </tr>
   <tr>
-    <td class="titleCell" height="25"><img src="<?=$imageUrl?>/empty.gif" width="2" height="25"></td>
+    <td class="titleCell" height="<?=$nav_bar_height?>" colspan='<?=$nav_col_span?>'><img src="<?=$imageUrl?>/empty.gif" width="1" height="1"></td>
 </tr>
 </table>
 
 <br clear="all">
+<? $hotkeys->renderAccessKeys(); ?>
+<script type='text/javascript'>
+<?=$hotkeys->renderFunctions()?>
+function loadRenderKeys() {
+  <?=$hotkeys->renderKeys()?>
+}
+</script>
 
 <!--
 <p>&nbsp;</p>
@@ -38,12 +45,44 @@
       if( $zen->debug ) {
         $debug_text .= "<tr><td class='mainContent'>\n";
         $debug_text .= "<p><b>MESSAGES</b></p>\n";
-         $debug_text .= "<span class='note'>\n";
+        $debug_text .= "<table align='center'><tr>";
+        $c = '';//isset($_SESSION['check_error'])? 'checked' : '';
+        $debug_text .= "<td><input type='radio' id='debugFilterChoice1' "
+                      ."name='debugFilter' $c onclick='toggleDebug(\"error\")'>"
+                      ."&nbsp;<label for='debugFilterChoice1'>"
+                      .tr("Errors")."</label></td>";
+        if( $Debug_Mode > 1 ) {
+          $c = '';//isset($_SESSION['check_warning'])? 'checked' : '';
+          $debug_text .= "<td><input type='radio' id='debugFilterChoice2' "
+                        ."name='debugFilter' $c onclick='toggleDebug(\"warning\")'>"
+                        ."&nbsp;<label for='debugFilterChoice2'>"
+                        .tr("Warnings")."</label></td>";
+        }
+        else {
+          $debug_text .= "<td><input type='radio' name='debugFilter' disabled='disabled' class='disabled'>&nbsp;<span class='note'>".tr("Warnings")."</span></td>";
+        }
+        if( $Debug_Mode > 2 ) {
+          $c = '';//isset($_SESSION['check_note'])? 'checked' : '';
+          $debug_text .= "<td><input type='radio' id='debugFilterChoice3' "
+                        ."name='debugFilter' $c onclick='toggleDebug(\"note\")'>"
+                        ."&nbsp;<label for='debugFilterChoice3'>"
+                        .tr("Notes")."</label></td>";
+        }
+        else {
+          $debug_text .= "<td><input type='radio' name='debugFilter' disabled='disabled' class='disabled'>&nbsp;<span class='note'>".tr("Notes")."</span></td>";
+        }
+        $c = 'checked';
+        $debug_text .= "<td><input type='radio' id='debugFilterChoice4' "
+                      ."name='debugFilter' $c onclick='toggleDebug(\"all\")'>"
+                      ."&nbsp;<label for='debugFilterChoice4'>"
+                      .tr("All")."</label></td>";
+        $debug_text .= "</tr></table>";
+         $debug_text .= "<div class='note' id='debugContent'>\n";
          ob_start();
          $zen->printDebugMessages();
          $debug_text .= ob_get_contents();
          ob_clean();
-         $debug_text .= "</span>\n";
+         $debug_text .= "</div>\n";
          $debug_text .= "</td></tr>\n";
       }
   
@@ -61,8 +100,9 @@
      $debug_text .= "HTTP_COOKIE: $HTTP_COOKIE<br>\n";
      $debug_text .= "SERVER_SOFTWARE: {$_SERVER['SERVER_SOFTWARE']}<br>\n";
      $debug_text .= "PHP Version: ".phpversion()."<br>\n";
-     $debug_text .= "zenTrack Version: ".$zen->settings["version_xx"]."<br>\n";
+     $debug_text .= "zenTrack Version: ".$zen->getSetting("version_xx")."<br>\n";
      $debug_text .= "rootUrl: $rootUrl<br>\n";
+     $debug_text .= "section: ".getZtSection()."<br>\n";
      $debug_text .= "database: ".$zen->database_type."/".$zen->database_host."<br>\n";
      $debug_text .= "settings count: ".count($zen->settings)."<br>\n";
      $debug_text .= "bins: ".(count($zen->bins)? join(",",$zen->bins) : 'NO BINS FOUND, DID YOU RUN THE SEED_YOURDB.SQL SCRIPT?')."<br>\n";
@@ -118,6 +158,8 @@
     $debug_text = preg_replace('/database_password=[^"\' ]+/', 'database_password=xxxx', $debug_text);
     $debug_text = preg_replace('/[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+[.][a-zA-Z0-9_.-]+/', 'xxxx@xxxx.xxx',$debug_text);
     $debug_text = preg_replace('@(https?://|www[.])[a-zA-Z0-9_-]+[.]([a-zA-Z]{2,4})@', '\\1xxxx.\\2', $debug_text);
+    $debug_text = preg_replace('@(https?://)[0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}@', '\\1xxx.xxx.xxx.xxx', $debug_text);
+    $debug_text = preg_replace('/zentrackKey=([^, "\']+)/', 'zentrackKey=xxxxx', $debug_text);
     print $debug_text;
     
     // used by behavior_js.php
@@ -136,6 +178,8 @@
   //}
 ?>
 
+<div id='hotKeyHelp'  class='hotKeyHelp invisible'><?=$hotkeys->renderHelp()?></div>
+
 </body>
 </html>
 
diff -Naur zentrack_2-5-5-2/includes/headerInc.php zentrack_2-6-pre1/includes/headerInc.php
--- zentrack_2-5-5-2/includes/headerInc.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/headerInc.php	2005-10-21 03:59:54.000000000 -0700
@@ -10,14 +10,14 @@
   ** IS THE header.php FILE IN THE www VIEWABLE DIRECTORY
   ** AND THE configVars.php FILE IN THE includes DIRECTORY
   **
-  ** abstracts advanced header functions from the 
+  ** abstracts advanced header functions from the
   ** configuration portion, for easier upgrades and
   ** less headaches
   **
   ** This page contains functions and variables which are universal
   ** to the site
   */
-  
+
   /**
   * ERROR REPORTING (security)
   */
@@ -25,60 +25,67 @@
   if( !$Debug_Mode ) {
     ini_set("display_errors", false);
   }
-  
+
   // fix problems with array indices and case of table columns
   define('ADODB_ASSOC_CASE',0);
-  
+
   /*
   ** SESSION MANAGEMENT
   */
   include_once("$libDir/session_start.php");
-  
+
   /*
   **  URL DETERMINATIONS
   */
-  
+
   $templateDir = "$libDir/templates";
   $listDir     = "$libDir/lists";
   $imageUrl    = "$rootUrl/images";
   $ticketUrl   = "$rootUrl/ticket.php";
   $projectUrl  = "$rootUrl/project.php";
-  
+
   /*
   **  BROWSER DETERMINATIONS
   */
-  
+
+  $page_browser = 'unkown';
   if( eregi("(\[en\]|netscape)", $HTTP_USER_AGENT) ) {
     $page_browser = "ns";
-  } else if( eregi("(Gecko)", $HTTP_USER_AGENT) ) {
+  } else if( eregi("Mozilla", $HTTP_USER_AGENT) ) {
     $page_browser = "mz";
   } else if( eregi("ie", $HTTP_USER_AGENT) ){
     $page_browser = "ie";
   }
-  
-  
+
+
   /*
   **  CLASS OBJECTS
   */
-  
+
   // if these change, they will need to be changed
   // in egate_utils.php as well!
   include_once("$libDir/translator.class");
   include_once("$libDir/zenTrack.class");
   include_once("$libDir/ZenFieldMap.class");
   include_once("$libDir/zenTemplate.class");
+  include_once("$libDir/ZenHotKeys.class");
   
   $zen = new zenTrack( $configFile );
   $map =& new ZenFieldMap($zen);
+  $hotkeys =& new ZenHotKeys($zen);
   
+  $GLOBALS['zt_zen'] = $zen;
+  $GLOBALS['zt_map'] = $map;
+  $GLOBALS['zt_hotkeys'] = $hotkeys;
+
   /**
   * Translator Object Initialization (mlively)
   */
-  // set language to default if unspecified 
+  // set language to default if unspecified
   if( !$login_language ) {
-    $login_language = $zen->settings["language_default"];
+    $login_language = $zen->getSetting("language_default");
   }
-  
+
   //Create the initialization array for the translator object
   //this data set also appears in the egate_utils.php script
   $translator_init = array(
@@ -90,7 +97,7 @@
   tr($translator_init);
   //save a bit on memory
   unset($translator_init);
-  
+
   function uptr($string, $vals = '') {
     $specials = array(
     '&AACUTE;' => '&Aacute;',
@@ -101,21 +108,19 @@
     '&NTILDE;' => '&Ntilde;'
     );
     $trad=strtoupper(tr($string,$vals));
-    foreach ($specials as $k => $v) {
-      $trad=str_replace($k,$v,$trad);
-    }
+    $trad = strtr($trad, $specials);
     return $trad;
   }
-  
+
   /*
   **  SOME FUNCTIONS FOR USE IN
   **  PAGE CONTENT
-  **  
+  **
   **  These are functions for tracking
   **  sessions and for system screen
   **  in the ticket viewing mode
   */
-  
+
   function add_system_messages( $msg, $code = 'Bold' ) {
     // stores the system messages
     // in a session variable so that they
@@ -124,12 +129,12 @@
     // if $code is set to Error, Highlight, or Bold
     // then the message will be formatted
     // according to the stylesheet .small[Error|Highlight|Bold] entries
-    
+
     if( !is_array($msg) )
     $msg = array($msg);
-    global $login_messages;     
+    global $login_messages;
     global $system_message_limit;
-    
+
     if( count($msg) >= $system_message_limit ) {
       unset($login_messages);
     }
@@ -139,11 +144,11 @@
       $login_messages = array_slice( $login_messages,0,
       ($system_message_limit - count($msg)) );
     }
-    foreach( $msg as $m ) {  
+    foreach( $msg as $m ) {
       array_unshift($login_messages, array($m,time(),$code) );
     }
   }
-  
+
   function print_system_messages($flag = '') {
     // prints all the system messages to
     // the screen
@@ -151,7 +156,7 @@
     // up until the first greyed entry (only print new entries)
     global $login_messages;
     global $zen;
-    
+
     if( is_array($login_messages) ) {
       $i = 0;
       foreach( $login_messages as $v ) {
@@ -166,47 +171,47 @@
         print "<br><span class='$style'>";
         print "[".$zen->showTime($v[1])."] ";
         print $v[0]."</span>\n";
-      }  
+      }
     } else {
       print "<span class='smallGrey'>No system messages</span>";
     }
   }
-  
+
   function clear_system_messages() {
     // deletes all system messages
     global $login_messages;
     unset($login_messages);
   }
-  
+
   function getVarfieldDataType( $varfieldName ) {
     $varfieldName = strtolower($varfieldName);
     if( preg_match('/^custom_([a-z]+)[0-9]+$/', $varfieldName, $matches) ) {
       return isset($matches[1])? $matches[1] : null;
     }
   }
-  
+
   function genVarfield( $formName, $varfield, $value = '' ) {
     // generates html form element to represent
     // the variable field array
     global $zen;
     global $rootUrl;
-    
+
     // clean data
     $value = $zen->ffv($value);
-    
+
     // determine the data type
     $type = getVarfieldDataType($varfield['field_name']);
-    
+
     $onblur = "";
     if( $varfield['js_validation'] ) {
       $onblur = " onblur='{$varfield['js_validation']}'";
     }
-    
+
     $key = $varfield['field_name'];
-    
+
     $zen->addDebug('headerInc', "genVarfield( '$formName', "
        +"'$varfield', '$value' ) using type=$type and key=$key", 3);
-    
+
     switch( $type ) {
       case "boolean":
         $inp = "<input type='checkbox' name='{$key}' "
@@ -225,8 +230,8 @@
         // format for use in date
         if( $value == 'NULL' ) { $value = ''; }
         if( $value == 0 ) { $value = ""; }
-        if( strlen($value) && preg_match("/^[0-9]+$/", $value) ) { 
-          $value = $zen->showDateTime($value); 
+        if( strlen($value) && preg_match("/^[0-9]+$/", $value) ) {
+          $value = $zen->showDateTime($value);
         }
         // create input field and date picker
         $inp = "<input type='text' name='{$key}' "
@@ -240,7 +245,7 @@
       case "number":
         if( $value == 'NULL' ) { $value = ''; }
         $inp = "<input type='text' name='{$key}' "
-        ." value='{$value}' size='10' maxlength='100'{$onblur}>\n";      
+        ." value='{$value}' size='10' maxlength='100'{$onblur}>\n";
         break;
       case "menu":
         $opts = genDataGroupChoices($varfield['field_value']);
@@ -268,7 +273,7 @@
     }
     return $inp;
   }
-  
+
   function genDataGroupChoices( $group_id, $use_default = true ) {
     if( isset($_SESSION['data_groups']["$group_id"]) ) {
       // get the fields for our group
@@ -279,7 +284,7 @@
         }
       }
     }
-    
+
     // generate a mock field
     if( $use_default ) {
       return array( array('field_value'=>'', 'label'=>'---') );
@@ -288,13 +293,13 @@
       return array();
     }
   }
-  
+
   if( isset($newbin) && $newbin == 'all' ) {
     unset($login_bin);
   } else if( isset($newbin) && $newbin && $zen->bins["$newbin"] && $zen->checkAccess($login_id,$newbin) ) {
     $login_bin = $newbin;
   }
-  
+
   // security
   $onLoad = array();
   $vars = array();
@@ -304,12 +309,12 @@
   if( isset($id) ) {
     $id = ereg_replace("[^0-9]", "", $id);
   }
-  
+
   // used to set table cell padding (since netscape cant handle padding-top/bottom)
-  $height_num = $zen->settings["font_size"] + 4;
-  
-  // function to retrieve the available languages from the translations/ dir  
-  function get_languages_available() { 
+  $height_num = $zen->getSetting("font_size") + 4;
+
+  // function to retrieve the available languages from the translations/ dir
+  function get_languages_available() {
     global $libDir;
     $dir = opendir("$libDir/translations");
     $vals = array();
@@ -322,71 +327,172 @@
     return $vals;
   }
   
-  /*
-  **  TICKET NAVIGATION TABS
-  */
-  
-  // these are for the ticket_box.php page.  They appear here so that
-  // individual pages may alter the specific tabs displayed by editing
-  // this array of values before running ticket_box.php
-  //
-  // $tabs are the nav boxes that will appear, and must correspond
-  // to a file called ticket_[name]Box.php which is included in
-  // includes/templates dir
-  $tabs = array(
-    "details"     => tr("Details"),
-    "custom"      => tr($zen->settings['varfield_tab_name']),
-    "log"         => tr("Log"),
-    "notify"      => tr("Notify"),
-    "contacts"    => tr("Contacts"),
-    "related"     => tr("Related"),     
-    "attachments" => tr("Attachments"),
-    "system"      => tr("System")
-  );
-  
+  /**
+   * Generate a div layer that imitates a submit button, but can have
+   * a hot key affect applied to it.
+   */
+   function renderDivButton($key, $onclick, $width=100, $label = null) {
+     $hotkeys = $GLOBALS['zt_hotkeys'];
+     $clickmouse = " onclick=\"{$onclick}; return false;\"\n";
+     print "<div style='width: {$width}px; text-align: center;' class='actionButtonDiv'\n"; 
+     print " $clickmouse";
+     print " onmouseover='mClassX(this, \"actionButtonDiv abdDown\", true)'\n";
+     print " onmouseout='mClassX(this, \"actionButtonDiv\")'\n";
+     print " title='".$hotkeys->tooltip($key)."'>\n";
+     print "<a href='#' $clickmouse\n";
+     print " onfocus='mClassX(this.parentNode, \"actionButtonDiv abdDown\", true)'\n";
+     print " onblur='mClassX(this.parentNode, \"actionButtonDiv\")'\n";
+     print ">".$hotkeys->label($key, $label, true)."</a>\n";
+     print "</div>\n";
+     print "<input type='submit' class='nodisplay'>\n";
+     print $hotkeys->renderAccessKey($key);
+   }
+   
+   function renderDivButtonFind( $label, $override_label = null, $onclick=null, $width=100 ) {
+     $hotkeys = $GLOBALS['zt_hotkeys'];
+     $key = $hotkeys->find($label);
+     if( !$onclick ) { $onclick = $hotkeys->getFxnName($key); }
+     return renderDivButton($key,$onclick,$width,$override_label);
+   }
+
+  /**
+   * Determines the current section based on the page being viewed:
+   * <ul>
+   *  <li>projects - in projects section
+   *  <li>tickets - in tickets section
+   *  <li>contacts - a contact related page
+   *  <li>help - in help section
+   *  <li>admin - in admin section
+   *  <li>options - in options section
+   *  <li>css - this is a css script
+   *  <li>js - this is a javascript
+   * </ul>
+   */
+   function getZtSection() {
+     if( !defined('ZT_SECTION') ) {
+       $section = null;
+        // check for the page_type variable
+        global $page_type;
+        if( isset($page_type) ) { $section = $page_type."s"; }
+        else {
+          // try to decipher the url for clues
+          global $SCRIPT_NAME;
+          global $rootUrl;
+          $ext = preg_replace("@^$rootUrl@", '', $SCRIPT_NAME);
+          $base = basename($SCRIPT_NAME);
+          if( preg_match('@styles[.]php@', $ext) ) {
+            $section = 'css';
+          }
+          else if( preg_match('@javascript[.]php@', $ext) ) {
+            $section = 'js';
+          }
+          else if( preg_match('@/help/@', $ext) ) {
+            $section = 'help';
+          }
+          else if( preg_match('@options.php@', $ext) || preg_match('@/misc/@', $ext) ) {
+            $section = 'options';
+          }
+          else if( preg_match('@(tickets?|index)[.]php@', $ext) ) {
+            $section = 'tickets';
+          }
+          else if( preg_match('@projects?[.]php@', $ext) ) {
+            $section = 'projects';
+          }
+          else if( preg_match('@options[.]php@', $ext) ) {
+            $section = 'options';
+          }
+        }
+       if( $section ) {
+         define('ZT_SECTION',$section);
+       }
+     }
+     return ZT_SECTION;
+   }
+
   /*
   **  ROLLOVER EFFECTS
   */
-  
-  $rollover_text = " onclick=\"mClk(this);\" onmouseout=\"mOut(this,'"
-    .$zen->settings["color_background"]."', '');\" "
-    ."onmouseover=\"mOvr(this,'"
-    .$zen->settings["color_bars"]."', '');\"";
-  
-  $rollover_greytext = " onclick=\"mClk(this);\" onmouseout=\"mOut(this,'"
-    .$zen->settings["color_bars"]."', '');\" "
-    ."onmouseover=\"mOvr(this,'"
-    .$zen->settings["color_background"]."', '');\"";
-  
-  $hotrollover_greytext = " onclick=\"mClk(this);\" onmouseout=\"mOut(this,'"
-    .$zen->settings["color_bars"]."', '');\" "
-    ."onmouseover=\"mOvr(this,'"
-    .$zen->settings["color_highlight"]."', '');\"";
-  
-  $hotrollover_text = "onclick=\"mClk(this);\" onmouseout=\"mOut(this,'"
-    .$zen->settings["color_background"]."', '');\" "
-    ."onmouseover=\"mOvr(this,'"
-    .$zen->settings["color_highlight"]."', '');\"";
-  
-  $nav_rollover_eff = " onmouseout=\"mOut(this,'"
-    .$zen->settings["color_title_background"]."','"
-    .$zen->settings["color_title_txt"]."');\" onmouseover=\"mOvr(this,'"
-    .$zen->settings["color_alt_background"]."','"
-    .$zen->settings["color_alt_text"]."');\" ";
-    
-  $nav_rollover_text = " onclick=\"mClk(this);\" ".$nav_rollover_eff;
-  
-  
+
+  $rollover_text = " onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" "
+    ."onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_background")."', '');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_bars")."', '');}\"";
+
+  $rollover_greytext = " onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" "
+    ."onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_bars")."', '');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_background")."', '');}\"";
+
+  $hotrollover_greytext = " onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" "
+    ."onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_bars")."', '');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_highlight")."', '');}\"";
+
+  $hotrollover_text = "onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" "
+    ."onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_background")."', '');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_highlight")."', '');}\"";
+
+  $heading_rollover = " onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_bar_darker")."','"
+    .$zen->getSetting("color_alt_text")."');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_alt_background")."','"
+    .$zen->getSetting("color_alt_text")."');}\" ";
+
+
+  $nav_rollover_eff = " onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_bar_darker")."');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_alt_background")."');}\" ";
+
+  $nav_rollover_text = " onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" ".$nav_rollover_eff;
+
+  $lnav_rollover = " onmouseout=\"if(window.document.body && mOut){mOut(this,'"
+    .$zen->getSetting("color_bars")."');}\" "
+    ."onmouseover=\"if(window.document.body && mOvr){mOvr(this,'"
+    .$zen->getSetting("color_alt_background")."');}\" "
+    ." onclick=\"if(window.document.body && mClk){mClk(this);return false;}\" ";
+    
+  $row_rollover_eff = 'onmouseout="if(window.document.body && mClassX){mClassX(this);}" 
+      onmouseover="if(window.document.body && mClassX){mClassX(this,\'altBars\',true);}"';
+
+  /**
+   * Returns true if a login is required to view the current page.
+   *
+   * Currently this returns false under the following conditions:
+   * <ul>
+   *  <li>ZT_HELP is defined
+   *  <li>$SCRIPT_NAME matches styles.php or behavior_js.php
+   * </ul>
+   */
+  function ztLoginRequired() {
+    $section = getZtSection();
+    return $section != 'help' && $section != 'js' && $section != 'css';
+  }
+  
+  function eLink($email) {
+    $zen = $GLOBALS['zen'];
+    if( !$email ) { return '&nbsp;'; }
+    if( !strpos($email,'@') ) { return $zen->ffv($email); }
+    list($name,$dom) = explode('@',$email);
+    return '<script>eLink('.$zen->fixJsVal($name).','.$zen->fixJsVal($dom).')</script>';
+  }
+
   /*
   **  USER AUTHENTICATION
   **
   **  determine if a login is required
   */
-  
-  if( !eregi("(/help/|styles[.]php|behavior_js[.]php)",$SCRIPT_NAME) ) {
+
+  if( ztLoginRequired() ) {
     include_once("$libDir/login.php");
-  }     
-  
+  }
+
   /**
   * Generate group info, since it takes several queries
   * This array is reset when a logoff occurs, so make sure this
@@ -395,12 +501,12 @@
   if( !array_key_exists('data_groups', $_SESSION) || !$_SESSION['data_groups'] ) {
     $_SESSION['data_groups'] = $zen->generateDataGroupInfo();
   }
-  
+
   /**
   * The list of valid log action types
   */
   $log_actions = $zen->getActivities();
-  
+
   // help links
   // determine which directory contains
   // our current translation (if one exists)
@@ -414,6 +520,6 @@
   }
   $helpUrl = "$helpBase/$helpLang";
   $helpDir = "$rootWWW/help/$helpLang";
-  
+
   // you can't have any spaces after this closing tag!
-}?>
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/leftMain.php zentrack_2-6-pre1/includes/leftMain.php
--- zentrack_2-5-5-2/includes/leftMain.php	2005-05-04 14:39:16.000000000 -0700
+++ zentrack_2-6-pre1/includes/leftMain.php	2005-09-09 13:28:23.000000000 -0700
@@ -1,6 +1,6 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 <div class="small" align="center"><b><?=$zen->showLongDate()?></b></div>
-<div class="small" align='center'><?=tr("version")?> <?=$zen->settings["version_xx"]?></div>
+<div class="small" align='center'><?=tr("version")?> <?=$zen->getSetting("version_xx")?></div>
 <?
   if( $zen->demo_mode == 'on' ) { print "<div class='small' align='center'>(demo mode)</div>"; }
 
@@ -25,7 +25,7 @@
 ?>
   
   
-<table width="100%" border=1 cellspacing=0 cellpadding=2 bgcolor='<?=$zen->settings["color_title_background"]?>'>
+<table width="100%" border=1 cellspacing=0 cellpadding=2 bgcolor='<?=$zen->getSetting("color_title_background")?>'>
   <? if( $login_id ) { include("$libDir/leftBins.php"); } ?>
   <tr>
   <td class="altCell" align=center>
@@ -39,8 +39,8 @@
   if ($login_level=="first_login" ) $err = 1;
 	  
   if ($login_level != 'first_login' &&
-      $login_level >= $zen->settings["level_contacts"] &&
-      $zen->settings['allow_contacts'] == 'on' ) {
+      $login_level >= $zen->getSetting("level_contacts") &&
+      $zen->settingOn('allow_contacts') ) {
   ?>
     <tr>
       <td class="altCell" align=center>
@@ -79,12 +79,12 @@
   </tr>  
   <? 
 //we check also if login_level is a number because in first login it will be 'first_login' what would give access to all.
-     if( $zen->checkNum($login_level) >= $zen->settings["level_reports"] ) {
+     if( $zen->checkNum($login_level) >= $zen->getSetting("level_reports") ) {
    include("$libDir/leftReports.php");
       } 
   ?>
   <? 
-     if( $zen->checkNum($login_level) >= $zen->settings["level_settings"] ) {
+     if( $zen->checkNum($login_level) >= $zen->getSetting("level_settings") ) {
    include("$libDir/leftAdmin.php");
       } 
   ?>
diff -Naur zentrack_2-5-5-2/includes/listFilters.php zentrack_2-6-pre1/includes/listFilters.php
--- zentrack_2-5-5-2/includes/listFilters.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/listFilters.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,153 @@
+<?
+  /**
+   ** APPLY FILTERS TO TICKET LISTS
+   **
+   ** This file is designed to be used with includes/templates/listFiltersForm.php
+   **
+   ** REQUIREMENTS
+   **    $view - the current view name
+   **    $page_type - 'ticket' or 'project'
+   **    $zen - zenTrack object
+   **    $map - ZenFieldMap object
+   **
+   ** RESULTS
+   **    $filter_params - indexed array of column->value to be passed into get_tickets()
+   **    $filter_params_withnulls - same as filter_params, but contains nulls (for use in form)
+   **/
+   
+   /////////////////////////
+   // PREPARE
+   /////////////////////////
+
+  // determine which filter set we should be using
+  $filter = "session_filters_{$page_type}";
+  $filterview = "{$view}_filters";
+
+  // first we try to load the params from the session
+  $params = $sm->find($filter);
+  
+  // used to determine if we will update the session after calculations
+  $updated = false;
+
+  /////////////////////////
+  // CONSTRUCT
+  /////////////////////////
+  
+  // then we construct filters from user settings and field map defaults
+  if( !$params || !count($params) ) {
+    // get field map which describes the filter values
+    $filtercols = $map->getFieldMap($filterview);
+    
+    $params = array();
+    $dt = '';
+    if( $filtercols && count($filtercols) > 0 ) {
+      // set our params using the filter values (if they have a default value)
+      foreach($filtercols as $k=>$v) {
+        if( $v['is_visible'] && !empty($v['default_val']) ) {
+          if( $k == 'priority' ) {
+            $params[$k] = is_array($v['default_val'])?
+               join(',',$v['default_val']) : $v['default_val'];
+          }
+          else {
+            $params[$k] = $v['default_val'];
+            $dt .= "|::$k = ".$_POST[$k]."::|";
+          }
+        }
+      }
+    }
+    
+    // if there is no default bin specified, we will try to use the current
+    // user's home bin
+    if( (!array_key_exists('bin_id', $params) || !isset($params['bin_id'])) && $login_bin > 0 ) {
+      $params['bin_id'] = $login_bin;
+      $dt .= "bin_id = $login_bin";
+    }
+    $updated = true;
+    $zen->addDebug('listFilters.php', "[$filter|$filterview]Constructing new filter parms: {$dt}", 2);
+  }
+  
+  /////////////////////////
+  // UPDATE FROM FORM
+  /////////////////////////
+  
+  // if there have been updates by the user, we will apply those to the session
+  if( $_POST['ticketFilterForm'] == 1 ) {
+    // get field map which describes the filter values
+    $filtercols = $map->getFieldMap($filterview);
+    $dt = '';
+    if( $filtercols && count($filtercols) > 0 ) {
+      // set our params using the form results
+      foreach($filtercols as $k=>$v) {
+        $pn = "filterForm_{$k}";
+        if( array_key_exists($pn, $_POST) ) {
+          $params[$k] = $_POST[$pn];
+          $dt .= "|::$k = ".$_POST[$pn]."::|";
+          $updated = true;
+        }
+      }
+    }
+    $zen->addDebug('listFilters.php', "[$filter|$filterview]Updating filter parms from form data: {$dt}", 2);
+  }
+  
+  /////////////////////////
+  // SAVE TO SESSION
+  /////////////////////////
+  if( $updated ) { $sm->store($filter, $params); }
+  
+  /////////////////////////
+  // VALIDATE AND CLEAN UP
+  /////////////////////////
+  if( $page_type == 'project' ) {
+    // if this is a project type, make sure we only show types of projects
+    if( !array_key_exists('type_id',$params) || empty($params['type_id']) ||
+        !$zen->inProjectTypeIDs($params['type_id']) ) {
+      $zen->addDebug('listFilters.php', "[$filter|$filterview]Using default project types", 3);
+      $params['type_id'] = $zen->projectTypeIDs();
+    }
+  }
+  else {
+    // if it is not a project type, hide projects
+    if( !array_key_exists('type_id', $params) || empty($params['type_id']) ||
+        $zen->inProjectTypeIDs($params['type_id']) ) {
+      $zen->addDebug('listFilters.php', "[$filter|$filterview]Using default ticket types", 3);
+      $params['type_id'] = $zen->notProjectTypeIDs();
+    }
+  }
+
+  if( array_key_exists('bin_id',$params) ) {
+    // validate the bins to make sure this user can view them
+    $userBins = $zen->getUsersBins($login_id);
+    $vals = is_array($params['bin_id'])? $params['bin_id'] : array($params['bin_id']);
+    foreach($vals as $v) {
+      if( strlen($v) && !in_array($v, $userBins) ) {
+        $zen->addDebug('listFilters.php', "[$filter|$filterview]Invalid bin_id $v, resetting filter parms", 1);
+        $params['bin_id'] = $userBins;
+        break;
+      }
+    }
+  }
+  else {
+    // set the bins to the default set for this user
+    $zen->addDebug('listFilters.php', "[$filter|$filterview]Using default bins", 3);
+    $params['bin_id'] = $zen->getUsersBins($login_id);
+  }
+  
+  /////////////////////////
+  // GENERATE FINALIZED VALS
+  /////////////////////////
+  $filter_params_withnulls = $params;
+  $filter_params = array();
+  foreach($params as $k=>$v) {
+    if( (is_array($v) && count($v)) || (!is_array($v) && strlen($v)) ) {
+      if( strpos($v,',') > 0 ) {
+        if( $k == 'status' || $map->getFieldProp($filterview,$k,'field_type') == 'searchbox' ) {
+          $filter_params[$k] = explode(',',$v);
+        }
+      }
+      else {
+        $filter_params[$k] = $v;
+      }
+    }
+  }
+  
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/login.php zentrack_2-6-pre1/includes/login.php
--- zentrack_2-5-5-2/includes/login.php	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/login.php	2005-10-20 11:23:44.000000000 -0700
@@ -11,6 +11,7 @@
   $_SESSION['data_groups'] = null;
   $autologin = false;
   setcookie("zentrackKey", "", time());
+  $_SESSION['login_id'] = null;
 }
 
 // auto-login via cookie
@@ -35,13 +36,14 @@
     // automatically log in users based on cookie values
     $login_id = $zen->login_user($zentrackUsername, $zentrackKey, true);
     if( $login_id ) {
+      $_SESSION['login_id'] = $login_id;
       // user login was valid so set session variables
       $login_level = $zen->user["access_level"];
       $login_name  = $zen->user["fname"]." ".$zen->user["lname"];
       $login_inits = $zen->user["initials"];
       $login_bin   = $zen->user["homebin"];
-      $prefs = $zen->get_prefs($login_id, "language");
-      if(isset($prefs["language"])) { $login_language = $prefs["language"]; }
+      $language = $zen->get_prefs($login_id, "language");
+      if($language) { $login_language = $language; }
       setcookie("zentrackUsername", $zentrackUsername, time()+2592000);
       setcookie("zentrackKey", $zentrackKey, time()+2592000);
       $skip = 1;
@@ -59,7 +61,8 @@
 }
 
 if( !$login_id ) {
-  if( isset($_SERVER['PHP_AUTH_USER']) && isset($_SERVER['PHP_AUTH_PW']) ) {
+  if( $zen->settingOn('use_system_auth') &&
+      isset($_SERVER['PHP_AUTH_USER']) && isset($_SERVER['PHP_AUTH_PW']) ) {
     // use htaccess authentication
     $username = $_SERVER['PHP_AUTH_USER'];
     $passphrase = $_SERVER['PHP_AUTH_PW'];
@@ -73,6 +76,7 @@
       // to a login screen where they can
       // change their passphrase, since it is
       // set to the default
+      $_SESSION['login_id'] = $login_id;
       $login_level = 'first_login';
       $login_name  = $zen->user["fname"]." ".$zen->user["lname"];
       setcookie("zentrackUsername", $username, time()+2592000);
@@ -92,12 +96,13 @@
       // and generate session variables, as well
       // as a cookie to save time logging in
       // in the future
+      $_SESSION['login_id'] = $login_id;
       $login_level = $zen->user["access_level"];
       $login_name  = $zen->user["fname"]." ".$zen->user["lname"];
       $login_inits = $zen->user["initials"];
       $login_bin   = $zen->user["homebin"];
-      $prefs = $zen->get_prefs($login_id, "language");
-      if(isset($prefs["language"])) { $login_language = $prefs["language"]; }
+      $lang_pref = $zen->get_prefs($login_id, "language");
+      if( $lang_pref ) { $login_language = $lang_pref; }
       setcookie("zentrackUsername", $username, time()+2592000);
       if( $autologin && $save_my_password ) {
         // if the user checks the log me in automagically box, we will set a userpref
diff -Naur zentrack_2-5-5-2/includes/nav.php zentrack_2-6-pre1/includes/nav.php
--- zentrack_2-5-5-2/includes/nav.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/nav.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,13 +1,71 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  function renderNavTab( $name, $page ) {
+    global $keyRegisterEvents;
+    global $nav_rollover_text;
+    global $hotkeys;
+    global $rootUrl;
+    global $imageUrl;
+    $keyRegisterEvents[] = array($name, $page);
+
+    $key = $hotkeys->find($name);
+    $title = $hotkeys->tooltip($key);
+
+    $txt = "<td height='25' title='$title' valign='middle'";
+    if( getZtSection() == strtolower($name) ) {
+      $class = "navTab navOn";
+    }
+    else {
+      $class = "navTab navOff";
+      $txt .= " $nav_rollover_text ";
+    }
+    $txt .= "class='$class'>";
+    $txt .= "<a class='$class' href='$rootUrl/$page'>".$hotkeys->label($key)."</a>\n";
+    $txt .= "</td><td width='4'><img src='{$imageUrl}/empty.gif' width='1' height='1' border='0'></td>\n";
+    return $txt;
+  }
+
+  // number of columns in nav table
+  $nav_col_span = 4;
+
+  // height of the separator between nav tabs and main content
+  $nav_bar_height = 12;
+
+  $nav_tabs =  renderNavTab('Projects', 'projects.php');
+  $nav_tabs .= renderNavTab('Tickets', 'index.php');
+  if ($login_level != 'first_login' &&
+    $login_level >= $zen->getSetting("level_contacts") &&
+    $zen->settingOn('allow_contacts') ) {
+    $nav_tabs .= renderNavTab('Contacts','contacts.php');
+  }
+  if( $login_id ) {
+    $nav_tabs .= renderNavTab('Options','options.php');
+  }
+  $nav_tabs .= renderNavTab('Help','help/index.php');
+  if( $zen->checkNum($login_level) >= $zen->getSetting("level_settings") ) {
+    $nav_tabs .= renderNavTab('Admin', 'admin/index.php');
+  }
+
+  // load hot key selections
+  $sect = getZtSection();
+  $load_section = $sect != 'undefined' && file_exists("$templateDir/nav_$sect.php");
+  if( $load_section ) { $hotkeys->loadSection($sect); }
+
+?>
 <html>
   <head>
   <title><?=$page_prefix.$page_title?></title>
   <LINK HREF="<?=$rootUrl?>/styles.php" REL="STYLESHEET" TYPE="text/css">
   <script language="javascript">
-    var imageUrl = "<?=$imageUrl?>";
+    var imageUrl = <?=$zen->fixJsVal($imageUrl)?>;
+    var rootUrl = <?=$zen->fixJsVal($rootUrl)?>;
+    var id = <?=$zen->fixJsVal(id)?>;
+    var hotkeyHelpDelay = <?=$zen->fixJsVal($zen->getSetting('hotkeys_help_delay'))?>;
+    var hotkeyHintDelay = <?=$zen->fixJsVal($zen->getSetting('hotkeys_hint_delay'))?>;
+    var loaded = false;
   </script>
-
   <script language="javascript" src="<?=$rootUrl?>/javascript.js"></script>
+  <script language="javascript" src="<?=$rootUrl?>/keyevent.js"></script>
   <script language="javascript" src="<?=$rootUrl?>/popcalendar.js"></script>
   <?
   for($i=0; $i<count($onLoad); $i++) {
@@ -15,59 +73,95 @@
     print "<script language='javascript' src='$rootUrl/$s'></script>\n";
   }
   ?>
+  <script type='text/javascript'>
+    var isIE = navigator.appName.indexOf('Microsoft') >= 0;
+    var debugOn = <?=$Debug_Mode > 0? 'true' : 'false'?>;
+    window.onload = function() {
+      loaded = true;
+      loadRenderKeys();
+      window.onblur = function() {
+        if( KeyEvent.hideHelp ) { KeyEvent.hideHelp(); }
+      }
+      if( isIE ) {
+        window.document.onkeydown = KeyEvent.getKey;
+        window.document.onkeyup = KeyEvent.cancelKey;
+      }
+      else {
+        window.document.onkeydown = KeyEvent.checkKey;
+        window.document.onkeypress = KeyEvent.keyPress;
+        window.document.onkeyup = KeyEvent.cancelKey;
+      }
+    }
+  </script>
 
   </head>
-  
+
 <body>
-<table width="800" cellpadding="2" cellspacing="1">
+<table width="100%" cellpadding="0" cellspacing="0">
   <tr>
-  <td valign="top" width="140" rowspan="3">
-<a href="<?=$rootUrl?>"><img 
-  src="<?=$imageUrl?>/zenTrack_logo.jpg" 
+  <td valign="bottom" width="140" height="30">
+<a href="<?=$rootUrl?>"><img
+  src="<?=$imageUrl?>/zenTrack_logo.jpg"
   border="0" width="140" height="30" alt="logo"></a>
-
-  <? include("$libDir/leftMain.php"); ?>
-  
   </td>
-  <td class="titleCell" width="15"
-        rowspan="4"><img src="<?=$imageUrl?>/empty.gif" width="15" height="2"></td>
-  <td width="645" height="25" class="titleCell">
-    <form action="<?=$rootUrl?>/ticket.php">
-    <table width="600" align="center" cellpadding="0" cellspacing="0">
-    <tr>
-     <td width="400" class="page_section" align="center">
-      <?=(isset($page_section))? strip_tags($page_section):"&nbsp;";?>
-     </td>
-     <td align="right" width="200">
-      <span class="small"><?=tr("Ticket ID")?>:</span>&nbsp;
-      <input class="searchbox" type="text" name="id" 
-        size="6" maxlength="12" title="<?=tr("Enter a ticket ID and press enter")?>">
-     </td>
-    </tr>
-    </table>
+  <td class='indent' valign='bottom' align='left'><table cellpadding='0' cellspacing='0' border='0'>
+    <tr><?= $nav_tabs ?></tr></table></td>
+  <td align='right'>
+     <form action="<?=$rootUrl?>/quickSearch.php" name='quickIdForm'>
+      <?=$hotkeys->ll("Search")?>:</span>&nbsp;
+      <input class="searchbox" type="text" name="idText"
+        size="15" maxlength="255" onfocus='openHelpBox(window.document.getElementById("searchBoxHelp"),this)' title="<?=$hotkeys->tt("Search")?>">
+        &nbsp;(<a class='small' href='<?=$rootUrl?>/search.php' title='<?=$hotkeys->tt('Advanced Search')?>'>
+          <?=$hotkeys->ll('Advanced Search', 'Advanced')?></a>)&nbsp;&nbsp;
+       <div id='searchBoxHelp' style='width:110px;height:75px;display:none;' class='helpBox'>
+       <?=tr("Enter a ticket ID or text to search for")?></div>
     </form>
   </td>
+  <td>
+    <div class='small' align='center'><b><?=$zen->showLongDate()?></b></div>
+    <div class='small' align='center'><?=tr("version")?>
+      <?=$zen->getSetting("version_xx")?>
+      <? if( $zen->demo_mode == 'on' ) { print "<div class='small' align='center'>(demo mode)</div>"; } ?>
+    </div>
+  </td>
+  </tr>
+  <tr>
+    <td width='100%' colspan='<?=$nav_col_span?>' class='titleCell' height='<?=$nav_bar_height?>' align='right'><img
+      src='<?=$imageUrl?>/empty.gif' width='1' height='1'></td>
   </tr>
   <tr>
-  <td valign="top" height="400" class='mainContent'>
-  
-  <? 
+  <td valign="top" height="400" colspan='<?=$nav_col_span?>' class='mainContent navpad'>
+
+  <?
+    // include left nav menu if one is appropriate
+    print "<table width='100%' cellpadding='0' cellspacing='0'><tr>\n";
+    if( $load_section ) {
+      ?>
+
+      <!-- ********* \LEFT NAV MENU\ ********* -->
+
+      <td height='400' width='110' valign='top' align='center' class='navCell'>
+      <table width='110' height='100%' class='slimPad'>
+      <?
+      include("$templateDir/nav_$sect.php");
+      print "</table>\n";
+      print "</td>\n";
+      print "\n      <!-- ********* /LEFT NAV MENU/ ********* -->\n\n";
+    }
+
+    print "<td valign='top' height='400' class='gutter'>\n";
+
     // print out any system messages
     // which are queued up for display
     if( $msg && !is_array($msg) ) {
        $msg = array($msg);
     }
-    if( is_array($msg) && count($msg) ) { 
-       print "&nbsp;<p><b>\n";
+    if( is_array($msg) && count($msg) ) {
        foreach($msg as $m) {
-          print "$m<br>";   
+          print "<div class='highlight indent'>".$zen->ffv($m)."</div>";
        }
-       print "</b></p>\n";
        $msg = array();
     }
   ?>
-  
+
   <!-- END OF NAVIGATION -->
-  
-  
-  
diff -Naur zentrack_2-5-5-2/includes/paging.php zentrack_2-6-pre1/includes/paging.php
--- zentrack_2-5-5-2/includes/paging.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/paging.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,9 +1,11 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+   $hotkeys->loadSection('paging');
+?>
 <!--- BEGIN Paging --->
 
 <table width='100%'>
 <tr>
-   <td  align="right" valign='bottom' style="background:<?=$zen->settings["color_bars"]?>;">
+   <td  align="right" valign='bottom' style="background:<?=$zen->getSetting("color_bars")?>;">
      <?
        $links = $zen->get_links("all", "off");
        for ($y = 0; $y < count($links); $y++) {
diff -Naur zentrack_2-5-5-2/includes/parseVarfields.php zentrack_2-6-pre1/includes/parseVarfields.php
--- zentrack_2-5-5-2/includes/parseVarfields.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/parseVarfields.php	2005-10-14 12:15:52.000000000 -0700
@@ -57,4 +57,4 @@
     }    
   }
   
-}?>
\ No newline at end of file
+}?>
diff -Naur zentrack_2-5-5-2/includes/priorityColors.php zentrack_2-6-pre1/includes/priorityColors.php
--- zentrack_2-5-5-2/includes/priorityColors.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/priorityColors.php	2005-09-09 13:28:23.000000000 -0700
@@ -66,10 +66,10 @@
 $lowp = 99999;
 $hip = -1;
 
-$lc = $zen->settings["color_priority_low"];
-$mc = $zen->settings["color_priority_med"];
-$hc = $zen->settings["color_priority_hi"];
-$mp = $zen->settings["priority_medium"];
+$lc = $zen->getSetting("color_priority_low");
+$mc = $zen->getSetting("color_priority_med");
+$hc = $zen->getSetting("color_priority_hi");
+$mp = $zen->getSetting("priority_medium");
 
 $pri_list = $zen->getPriorities(1);
 foreach ($pri_list as $v) {
diff -Naur zentrack_2-5-5-2/includes/session_save.php zentrack_2-6-pre1/includes/session_save.php
--- zentrack_2-5-5-2/includes/session_save.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/session_save.php	2005-10-20 11:23:44.000000000 -0700
@@ -8,17 +8,28 @@
   ** in every place that we call one of these values
   */
 
+  $skips = array('ztDataCache', 'ztVarfields', 'ztMiscCache', 'ztDataTypes');
+  
+  $vals = array();
   if( is_array($_SESSION) ) {
     foreach($session_vars as $s) {
-      $x = $$s;
-      $_SESSION["$s"] = $x;
+      $vals[$s] = $$s;
+    }
+    if( $vals ) {
+      foreach($vals as $k=>$v) {
+        $_SESSION[$k] = $v;
+      }
     }
   }
   else if( is_array($HTTP_SESSION_VARS) ) {
     foreach($session_vars as $s) {
-      $x = $$s;
-      $HTTP_SESSION_VARS["$s"] = $x;
+      $vals[$s] = $$s;
+    }
+    if( $vals ) {
+      foreach($vals as $k=>$v) {
+        $_SESSION[$k] = $v;
+      }
     }
   }
 
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/session_start.php zentrack_2-6-pre1/includes/session_start.php
--- zentrack_2-5-5-2/includes/session_start.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/session_start.php	2005-10-21 03:59:54.000000000 -0700
@@ -13,10 +13,11 @@
   */
 
 // start the session
+session_cache_limiter('public'); 
 session_start();     
 
 if( $_GET['clear_session_cache'] ) {
-  $_SESSION = array(); 
+  session_unset();
 }
 
 // ... except the following list
@@ -78,28 +79,23 @@
 		      "ticket_mode");
 
 if( is_array($_SESSION) ) {
-  foreach($session_vars as $s) {
-    if( strlen($_SESSION["$s"]) ) {
-      $$s = $_SESSION["$s"];
-    }
-    else {
-      $$s = "";
-    }
+  $vals = $_SESSION;
+  foreach($session_vars as $k) {
+    $$k = isset($vals[$k])? $vals[$k] : null;
   }
 }
 else if( is_array($HTTP_SESSION_VARS) ) {
-  foreach($session_vars as $s) {
-    if( strlen($HTTP_SESSION_VARS["$s"]) ) {
-      $$s = $HTTP_SESSION_VARS["$s"];
-    }
-    else {
-      $$s = "";
-    }
+  $vals = $HTTP_SESSION_VARS;
+  foreach($session_vars as $k) {
+    $$k = isset($vals[$k])? $vals[$k] : null;
   }
 }
 else {
   die("Sessions are not enabled properly on this system.  zenTrack is exiting.");
 }
 
+//header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
+//header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); // Date in the past
+
 // you can't have any spaces after this closing tag!
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/sorting.php zentrack_2-6-pre1/includes/sorting.php
--- zentrack_2-5-5-2/includes/sorting.php	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/sorting.php	2005-10-20 11:23:44.000000000 -0700
@@ -18,7 +18,7 @@
     // make sure our sorting field is valid
     $tempsort = strpos($newsort, " DESC") > 0?
         str_replace(" DESC", "", $newsort) : $newsort;
-    if( !array_key_exists($tempsort, $GLOBALS['zt_field_dependencies']['fields']) ) {
+    if( !getFmFieldProps($view, $tempsort) ) {
       $zen->addDebug('sorting.php', "Invalid column '$tempsort'", 1);
       $newsort = false;
     }
@@ -43,5 +43,7 @@
     $sm->store('ztorderby', $orderby);
     $zen->addDebug("sorting.php", "search order set to ".join(',',$orderby),2);
   }
+  
+  $sortstring = join(',',$orderby);
 
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/actions/approve.php zentrack_2-6-pre1/includes/templates/actions/approve.php
--- zentrack_2-5-5-2/includes/templates/actions/approve.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/actions/approve.php	2005-10-11 04:48:19.000000000 -0700
@@ -0,0 +1,32 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+
+<form name='approveForm' method="post" action="<?=$SCRIPT_NAME?>">
+<input type="hidden" name="id" value="<?=$id?>">
+<input type="hidden" name="actionComplete" value="1">
+
+<table class='formTable' cellpadding="4" cellspacing="1" border="0">
+<tr>
+ <td colspan='2' class='subTitle'><?=tr("Approve Ticket")?>
+   &nbsp;&nbsp;
+   <span class='note'><?=tr("Approve ticket and close")?></span>
+ </td>
+</tr>
+<tr>
+  <td class="bars">
+     <?=$hotkeys->ll("Comments")?>
+	   <div class="note">(<?=tr("optional")?>)</div>
+  </td>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt("Comments or Instructions")?>"><?=
+      $zen->ffvText($comments)?></textarea>
+  </td>
+</tr>
+<tr>
+  <td class="subTitle" colspan='2'>
+  <? renderDivButton($hotkeys->find('Approve'), "window.document.approveForm.submit()", 150); ?>
+  </td>
+</tr>
+<tr>
+</table>
+
+</form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/assign.php zentrack_2-6-pre1/includes/templates/actions/assign.php
--- zentrack_2-5-5-2/includes/templates/actions/assign.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/assign.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,25 +1,21 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form name='assignForm' method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table class='formTable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Assign Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Assign the ticket to a new user")?>)</span>
+ <td class='subTitle' colspan='2'><?=uptr("Assign Ticket")?>
+   &nbsp;&nbsp;<span class="note">(<?=tr("Assign this ticket to a new user")?>)</span>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
-   <?=tr("Select a Recipient")?>
+ <td class="bars">
+   <?=$hotkeys->ll("Recipient")?>
  </td>
-</tr>
-<tr>
- <td>
-<select name="user_id">
+ <td class='bars'>
+<select name="user_id" title="<?=$hotkeys->tt("Recipient")?>">
 <?
   //$bins = $zen->getUsersBins($login_id,"level_assign");
   // ticket can only be assigned to users who may access
@@ -29,8 +25,8 @@
   if( is_array($bins) && is_array($users) ) {
     foreach($users as $v) {
       if( $v["user_id"] != $login_id ) {
-	$sel = ($v["user_id"] == $user_id)? "selected" : "";
-	print "<option value='$v[user_id]' $sel>".$zen->formatName($v,1)."</option>\n";
+        $sel = ($v["user_id"] == $user_id)? "selected" : "";
+        print "<option value='$v[user_id]' $sel>".$zen->formatName($v,1)."</option>\n";
       }
     }
   }
@@ -39,31 +35,24 @@
   }
 ?>
 </select>
-  </td>			     
-</tr>
-<tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?> <span class="small">(<?=tr("optional")?>)</span>
   </td>
 </tr>
 <tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
+  <td class="bars">
+     <?=$hotkeys->ll("Comments or Instructions")?><div class="small">(<?=tr("optional")?>)</div>
   </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    <?=tr("Click button to assign")?>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title='<?=$hotkeys->tt("Comments or Instructions")?>'><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" ASSIGN " class="submit">
-<p class='note'><?=tr("Note").":".tr("Only users who have permission to work on tickets in the current bin are listed.")?></p>
+  <td class="subTitle" colspan='2'>
+  <? renderDivButton($hotkeys->find('Assign'), "window.document.forms['assignForm'].submit()"); ?>
   </td>
 </tr>
 <tr>
 </table>
+<p class='note'><?=tr("Note").":".tr("Only users who have permission to work on tickets in the current bin are listed.")?></p>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/close.php zentrack_2-6-pre1/includes/templates/actions/close.php
--- zentrack_2-5-5-2/includes/templates/actions/close.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/close.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,68 +1,19 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-  $view = 'ticket_close';
-  $fields = $map->getFieldMap($view);
-  $hidden_fields = array();
-  $visible_fields = array();
-  foreach($fields as $f=>$field) {
-    if( !$field['is_visible'] ) { $hidden_fields["$f"] = $field; }
-    else {
-      $visible_fields["$f"] = $field;
-    }
-  }
-?>
-
-<form method="post" name="ticketForm" action="<?=$SCRIPT_NAME?>" onSubmit='return validateTicketForm()'>
-<?
-foreach($hidden_fields as $f=>$field) {
-  //$view, $form_name, $field_name, $value = null, $prefix = ''
-  print $map->renderTicketField($view, 'ticketForm', $f, $$f);
-}
-?>
-<input type="hidden" name="id" value="<?=$zen->ffv($id)?>">
-<input type="hidden" name="actionComplete" value="1">
-
-<table width="450" cellpadding="4" cellspacing="1" border="0">
-<tr>
- <td colspan='2'>
-   <span class="bigBold"><?=tr("Close Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Set status to closed/pending")?>)</span>
- </td>
-</tr>
-<?
-
-foreach($visible_fields as $f=>$field) {
-  if( $field['field_type'] == 'section' ) {
-    print "<tr><td colspan='2' class='subTitle'>";
-    print $map->renderTicketField($view, 'ticketForm', $f);
-    print "</td></tr>\n";
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+  /**
+   * TEMPLATE FOR CLOSING TICKET
+   *
+   * This template just wraps a generic form generating tool
+   */
+  $formview = 'ticket_close';
+  $formName = 'ticketForm';
+  $actionName = $SCRIPT_NAME;
+  $formTitle = 'Close Ticket';
+  if( $ticket['tested'] == 1 || $ticket['approved'] == 1 ) {
+    $formDesc = "<span class='note'>".tr("Ticket will move to pending status (for testing/approval)")."</span>";
   }
   else {
-    print "<tr><td class='bars' width='30%'>";
-    print $map->getLabel($view, $f);
-    print "</td><td class='bars'>";
-    print $map->renderTicketField($view, 'ticketForm', $f, $$f);
-    print "</td></tr>\n";
+    $formDesc = "<span class='note'>".tr("Ticket will move to a closed status")."</span>";
   }
-}
-
-?>
-
-<tr>
-  <td class="titleCell" colspan='2'>
-    <?=tr("Click button to close")?>
-  </td>
-</tr>
-<tr>
-  <td colspan='2'>
-    <input type="submit" value=" <?=uptr("Close")?> " class="submit">
-  </td>
-</tr>
-<tr>
-</table>
-</form>			     
-<?
-  include_once("$libDir/templates/validateTicketForm.php");
-?>
+  $submitName = 'Close';
+  include("$templateDir/ticket_tab_form.php");
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/actions/contacts.php zentrack_2-6-pre1/includes/templates/actions/contacts.php
--- zentrack_2-5-5-2/includes/templates/actions/contacts.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/contacts.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,66 +1,54 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
   /**
    * creates a form for adding entries to the contact list
    */
+
+  // collect contact data
+	$companies = $zen->get_contact_all();	
+	if (empty($company_id)) {
+		$parms = array(array("company_id", "=", "0"));
+	} else {
+		$parms = array(array("company_id", "=", $company_id));
+	}
+	$sort = "lname asc";
+	$people = $zen->get_contacts($parms,"ZENTRACK_EMPLOYEE",$sort);
+
+  $company_title = $company_id;
+  // determine column span
+  $colspan = 1;
+  if( $companies || $people ) {
+    $colspan = 2;
+  } 
 ?>
 
 
 <script type="text/javascript">
 function printpopup(varialbe)
 {
-location.href ="<?=$_SERVER['SCRIPT_NAME']?>?id=<?=$id?>&company_id="+varialbe
+location.href ="<?=$_SERVER['SCRIPT_NAME']?>?id=<?=$id?>&company_id="+varialbe+"&setmode=<?=$zen->ffv($setmode)?>";
 }
 </script>
 
 <form method='post' action='<?=$zen->ffv($SCRIPT_NAME)?>' name='ContactsAddForm'>
 <input type='hidden' name='id' value='<?=$id?>'>
 <input type='hidden' name='actionComplete' value='1'>
+<input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
 
-<table width="50%" cellpadding="4" cellspacing="1" border="0">
+<table cellpadding="4" width='300' cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=tr("Add a Contact")?></span>
- </td>
+ <td class='subTitle' colspan='<?=$colspan?>'><?=tr("Add a Contact")?></td>
 </tr>
-<?
-  // collect contact data
-	$companies = $zen->get_contact_all();	
-	if (empty($company_id)) {
-		$parms = array(1 => array(1 => "company_id", 2 => "=", 3 => "0"),
-		);
-	} else {
-		$parms = array(1 => array(1 => "company_id", 2 => "=", 3 => $company_id),
-		);
-	}
-	$sort = "lname asc";
-	$people = $zen->get_contacts($parms,"ZENTRACK_EMPLOYEE",$sort);
-
-  $company_title = $company_id;
-  
-  // determine column span
-  $colspan = 1;
-  if( $companies || $people ) {
-    $colspan = 2;
-  }
-  
-  
+ 
+  <?
 	if (is_array($companies)||count($companies)) {
 	?>
 <tr>
-<td class='titleCell' colspan='<?=$colspan?>'>
-<?
-echo tr("Select a contact");
-?>
-</td>
-</tr>
-<tr>
-
-   <td class='bars'><?=tr("Company")?></td>
+   <td class='bars'><?=$hotkeys->ll("Field: company_id","Company")?></td>
     <td class='bars'>
 
-		<select name="company_id" onChange="printpopup(document.forms['ContactsAddForm'].company_id.value)">
+		<select name="company_id" 
+      title="<?=$hotkeys->tt("Field: company_id")?>"
+      onChange="printpopup(document.forms['ContactsAddForm'].company_id.value)">
   	<option value=''>--<?=tr("none")?>--</option>
 		<?
 		foreach($companies as $p) {
@@ -78,16 +66,16 @@
 	</select>
   
     </td>
+</tr>
 	<?
 	}
 	
 	if (is_array($people)||count($people)) {
   ?>
-  </tr>
   <tr>
-    <td class='bars'><?= tr("Person") ?></td>
+    <td class='bars'><?= $hotkeys->ll("Field: person_id","Person") ?></td>
     <td class='bars'>
-		<select name="person_id">
+		<select name="person_id" title="<?=$hotkeys->tt("Field: person_id")?>">
   	<option value=''>--<?=tr("none")?>--</option>
 		<?
 		foreach($people as $p) {
@@ -100,6 +88,7 @@
     if( $company_id ) { print '<br>'.tr("(Employees of '?' only)", $company_title); } 
   ?>
     </td>
+  </tr>
 	<?
 	}
   else if( $company_id ) {
@@ -117,23 +106,13 @@
   }
   
   if( !$people && !$companies ) {
-    print tr("There are no contacts to add.");
+    print "<tr><td>". tr("There are no contacts to add.") ."</td></tr>";
   }
+  else {
 	?>
-  
-  <br>&nbsp;
-</td>
-</tr>
-
-<? if( $people || $companies ) { ?>
-<tr>
-  <td class="titleCell" colspan='<?=$colspan?>'>
-    <?=tr("Click button to add contact")?>
-  </td>
-</tr>
 <tr>
-  <td>
-    <input type="submit" value="<?=uptr("Add")?>" class="submit" >
+  <td class="subTitle" colspan='<?=$colspan?>'>
+    <? renderDivButton($hotkeys->find('Add Contact'), "window.document.forms['ContactsAddForm'].submit()"); ?>
   </td>
 </tr>
 <? } ?>
@@ -142,6 +121,6 @@
 </form>
 
 <p>&nbsp;
-<form action='<?=$rootUrl?>/newContact.php' target="_BLANK">
-  <input type='submit' class='actionButtonContact' value=' <?=tr("Create New Contact")?> '>
+<form action='<?=$rootUrl?>/newContact.php' target="_BLANK" name='newContactForm'>
+  <? renderDivButton($hotkeys->find('Create New Contact'), "window.document.forms['newContactForm'].submit()", 150); ?>
 </form>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/email.php zentrack_2-6-pre1/includes/templates/actions/email.php
--- zentrack_2-5-5-2/includes/templates/actions/email.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/email.php	2005-10-21 04:21:31.000000000 -0700
@@ -15,24 +15,23 @@
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table width="450" class='formtable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=tr("Email Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Send ticket to specified recipients")?>)</span>
+ <td class='subTitle'><?=tr("Email Ticket")?>
+   &nbsp;&nbsp;<span class='note'>(<?=tr("Send ticket to specified recipients")?>)</span>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
+ <td class="bars">
    <input type='radio' name='emethod' value='1' 
    <?=(!isset($emethod) || $emethod == 1)? 'CHECKED' : ''?>
-   > <?=tr("Select a User")?>
+   > <?=$hotkeys->ll("Select a User")?>
  </td>
 </tr>
 <tr>
- <td>
+ <td class='bars'>
 <select name="users_to_email[]" multiple size=4
+  title="<?=$hotkeys->tt("Select a User")?>"
   onFocus="checkAbox(document.emailForm.emethod[0])"
   >
 <?
@@ -52,54 +51,48 @@
   </td>			     
 </tr>
 <tr>
- <td class="titleCell">
-   <input type='radio' name='emethod' value='2' 
-   <?=($emethod == 2)? 'CHECKED' : ''?>
-   > <?=tr("OR manually enter email addresses, seperated by commas")?>
+ <td class="bars">
+   <input type='radio' name='emethod' value='2' <?=($emethod == 2)? 'CHECKED' : ''?>>
+   <?=$hotkeys->ll("Manually Enter Addresses", "OR manually enter email addresses, seperated by commas")?>
  </td>
 </tr>
 <tr>
- <td>
+ <td class='bars'>
    <input type="text" onFocus="checkAbox(document.emailForm.emethod[1])"
-   name="custom_email_addresses" value="<?=strip_tags($custom_email_addresses)?>" 
-   size="50" maxlength="500">
+   name="custom_email_addresses" value="<?=$zen->ffv($custom_email_addresses)?>" 
+   size="50" maxlength="500" title="<?=$hotkeys->tt("Manually Enter Addresses")?>">
   </td>			     
 </tr>
 <tr>
-  <td class="titleCell">
-   <?=tr("Comments or Instructions")?>
+  <td class="bars">
+   <?=$hotkeys->ll("Comments or Instructions")?>
     &nbsp;<span class="small">(<?=tr("optional")?>)</span>
   </td>
 </tr>
 <tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt('Comments or Instructions')?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
+  <td class="bars">
     <?=tr("Choose one of the following options")?>
   </td>
 </tr>
 <tr>
-  <td>
+  <td class='bars'
    <input type="radio" name="method" value="1" <?=($method == 1)? "checked" : "";?>>
-   &nbsp;<?=tr("Send a link to this ticket only")?><br>
+   &nbsp;<?=$hotkeys->ll('send option: link', "Send a link to this ticket only")?><br>
    <input type="radio" name="method" value="2" <?=($method == 2 || !isset($method))? "checked" : "";?>>
-   &nbsp;<?=tr("Send a summary of the ticket")?><br>
+   &nbsp;<?=$hotkeys->ll('send option: summary', "Send a summary of the ticket")?><br>
    <input type="radio" name="method" value="3" <?=($method == 3)? "checked" : "";?>>
-   &nbsp;<?=tr("Send a summary, and the ticket's log")?>
+   &nbsp;<?=$hotkeys->ll('send option: log', "Send a summary, and the ticket's log")?>
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Click button to send email")?>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Email")?> " class="submit">
+  <td class="subTitle">
+  <? renderDivButton($hotkeys->find('Send Email'), "window.document.forms['emailForm'].submit()"); ?>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/estimate.php zentrack_2-6-pre1/includes/templates/actions/estimate.php
--- zentrack_2-5-5-2/includes/templates/actions/estimate.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/estimate.php	2005-10-20 11:23:44.000000000 -0700
@@ -4,7 +4,6 @@
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<ul>
 <table width="450" cellpadding="4" cellspacing="1" border="0">
 <tr>
  <td>
@@ -35,6 +34,5 @@
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/log.php zentrack_2-6-pre1/includes/templates/actions/log.php
--- zentrack_2-5-5-2/includes/templates/actions/log.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/log.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,26 +1,24 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form name='logForm' method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
+<input type='hidden' name='setmode' value="<?=$zen->ffv($page_mode)?>">
 
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table width="600" class='formtable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Log")?></span>
-   <br>
-   <span class="small">(<?=tr("Create a log entry, or log hours worked")?>)</span>
+ <td class='subTitle'>
+   <?=tr("Log")?>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
-   <?=tr("Select an activity")?>
+ <td class="bars">
+   <?=$hotkeys->ll("Select an Activity")?>
  </td>
 </tr>
 <tr>
- <td>
-<select name="log_action">
+ <td class='bars'>
+<select name="log_action" title="<?=$hotkeys->tt("Select an Activity")?>">
   <?
     foreach( $log_actions as $a ) {
        print ($a == $log_action || (!$log_action && $a == 'LOG') )?
@@ -32,38 +30,34 @@
   </td>			     
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Enter the hours worked for this entry")?> <span class="small">(<?=tr("accepts up to 2 decimal places")?>)</span>
+  <td class="bars">
+    <?=$hotkeys->ll("Enter Hours Worked")?> <span class="small">(<?=tr("accepts up to 2 decimal places")?>)</span>
   </td>
 </tr>
 <tr>
   <td>
-    <input type="text" name="hours" size="4" maxlength="8" value="<?=$zen->ffv($hours)?>">
+    <input type="text" name="hours" size="4" maxlength="8"
+        title="<?=$hotkeys->tt("Enter Hours Worked")?>"
+        value="<?=$zen->ffv($hours)?>">
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?>
+  <td class="bars">
+     <?=$hotkeys->ll("Log Entry / Comments")?>
   </td>
 </tr>
 <tr>
   <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      $zen->ffv(stripslashes($comments))?></textarea>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->ll("Log Entry / Comments")?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Click button to create log")?>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Log")?> " class="submit">
+  <td class="subTitle">
+  <? renderDivButtonFind("Save Log"); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/move.php zentrack_2-6-pre1/includes/templates/actions/move.php
--- zentrack_2-5-5-2/includes/templates/actions/move.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/move.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,58 +1,52 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+  $hotkeys->loadSection('move');
+?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form method="post" name='moveForm' action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table width="450" cellpadding="4" cellspacing="1" border="0" class='formTable'>
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Move Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Send ticket to another bin")?>)</span>
+ <td class='subTitle' colspan='2'><?=uptr("Move Ticket")?>
+ &nbsp;&nbsp;<span class='note'>(<?=tr("Send ticket to another bin")?>)</span>
  </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Comments")?> <span class="small">(<?=tr("optional")?>)</span>
+  <td class="bars">
+     <?=$hotkeys->ll("New Bin")?>
   </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td>
-    <select name='newBin'>
+  <td class='bars'>
+    <select name='newBin' title='<?=$hotkeys->tt("New Bin")?>'>
      <?
-	$userBins = $zen->getUsersBins($login_id,"level_move");
-	if( is_array($userBins) ) {
-	  foreach($userBins as $v) {
-	    $n = $zen->bins["$v"];
-	    print "<option value='$v'>$n</option>\n";
-	  }
-	} else {
-	  print "<option value=''>--".tr("none")."--<option>\n";
-	}
+      $userBins = $zen->getUsersBins($login_id,"level_move");
+      if( is_array($userBins) ) {
+        foreach($userBins as $v) {
+          $n = $zen->bins["$v"];
+          print "<option value='$v'>$n</option>\n";
+        }
+      } else {
+        print "<option value=''>--".tr("none")."--<option>\n";
+      }
      ?>
     </select>
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Click button to move ticket")?>
+  <td class="bars">
+     <?=$hotkeys->ll("Comments")?> <span class="small">(<?=tr("optional")?>)</span>
+  </td>
+  <td class='bars' title='<?=$hotkeys->tt('Comments')?>'>
+    <textarea cols="50" rows="4" name="comments"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Move")?> " class="submit">
+  <td class="subTitle" colspan='2'>
+    <? renderDivButton($hotkeys->find('Move'), 'window.document.moveForm.submit()'); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/notify.php zentrack_2-6-pre1/includes/templates/actions/notify.php
--- zentrack_2-5-5-2/includes/templates/actions/notify.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/notify.php	2005-10-20 11:23:44.000000000 -0700
@@ -9,32 +9,31 @@
 <script type="text/javascript">
 function printpopup(variable)
 {
-  location.href ="<?=$zen->ffv($SCRIPT_NAME)."?id=".$id ?>&company_id="+variable
+  location.href ="<?=$zen->ffv($SCRIPT_NAME)."?id=".$id ?>&company_id="+variable+"&setmode=<?=$zen->ffv($page_mode)?>";
 }
 </script>
 
 <form method='post' action='<?=$zen->ffv($SCRIPT_NAME)?>' name='notifyAddForm'>
 <input type='hidden' name='id' value='<?=$zen->ffv($id)?>'>
 <input type='hidden' name='actionComplete' value='1'>
+<input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
 
-<table width="550" cellpadding="4" cellspacing="1" border="0">
+<table width="600" class='formtable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=tr("Add Notify Recipient")?></span>
-   <br>
-   <span class="small">(<?=tr("Add recipients to the notify list for this ticket")?>)</span>
+ <td class='subTitle' colspan='2'>
+   <?=tr("Add Notify Recipients")?>
  </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Enter registered users")?>
+  <td class="bars bold">
+     <?=$hotkeys->ll("Enter Registered Users")?>
   </td>
 </tr>
 <tr>
-  <td>
+  <td class='bars'>
 <?
   // make a user textarea and search button
-  print "<textarea cols='20' rows='4' name='user_accts'>\n";
+  print "<textarea cols='40' rows='1' name='user_accts'>\n";
   print (isset($user_accts))? $zen->ffv($user_accts) : "";
   print "</textarea>\n";
   $onclick = "onClick='return popupWindowScrolls"
@@ -49,40 +48,40 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Or add an unregistered user")?>
+  <td class="bars bold">
+     <?=$hotkeys->ll("Add an Unregistered User")?>
   </td>
 </tr>
 <tr>
-  <td class='subTitle'>
-    <?=tr("Name")?>
+  <td class='bars'>
+    <table>
+    <tr>
+      <td class='bars'>
+        <?=tr("Name")?>
+      </td>
+      <td class='bars'>
+        <input type='text' name='unreg_name' size='20' maxlength='255' 
+               value='<?=$zen->ffv($unreg_name)?>'>
+      </td>
+      <td class='bars'>
+        <?=tr("Email")?>
+      </td>
+      <td class='bars'>
+        <input type='text' name='unreg_email' size='20' maxlength='255' 
+               value='<?=$zen->ffv($unreg_email)?>'>
+      </td>
+    </tr>
+    </table>
   </td>
 </tr>
+  <? if( $zen->settingOn('allow_contacts') ) { ?>
 <tr>
-  <td>
-    <input type='text' name='unreg_name' size='20' maxlength='255' 
-           value='<?=$zen->ffv($unreg_name)?>'>
+  <td class="bars bold">
+     <?=$hotkeys->ll("Add a Contact")?>
   </td>
 </tr>
 <tr>
-  <td class='subTitle'>
-    <?=tr("Email")?>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type='text' name='unreg_email' size='20' maxlength='255' 
-           value='<?=$zen->ffv($unreg_email)?>'>
-  </td>
-</tr>
-  <? if( $zen->settings['allow_contacts'] == 'on' ) { ?>
-<tr>
-  <td class="titleCell">
-     <?=tr("Or add a contact")?>
-  </td>
-</tr>
-<tr>
-<td class='subTitle'>
+<td class='bars'>
 <br>
 <?
   print tr("Company:");
@@ -97,49 +96,44 @@
       $sel = ($p["company_id"] == $company_id)? " selected" : "";
       $val =($p['office'])? strtoupper($p['title']) . " ," 
             . $p['office'] : strtoupper($p['title']);
-      print "<option value='$p[company_id]' $sel>".$val."</option>\n";
+      print "<option value='$p[company_id]' $sel>".$zen->ffv($val)."</option>\n";
     }
 ?>
   </select>
 <?
   }
   if (empty($company_id)) {
-    $parms = array(1 => array(1 => "company_id", 2 => "=", 3 => "0"));
+    $parms = array(array("company_id", "=", "0"));
   } else {
-    $parms = array(1 => array(1 => "company_id", 2 => "=", 3 => $company_id));
+    $parms = array(array("company_id", "=", $company_id));
   }
 	
   $sort = "lname asc";
   $company = $zen->get_contacts($parms,"ZENTRACK_EMPLOYEE",$sort);
 	
   if (is_array($company)||count($company)) {
-    echo tr("Or Person:");
+    echo "&nbsp;". tr("Or Person:");
 ?>
     <select name="person_id">
       <option value=''>--<?=tr("none")?>--</option>
 	<?
 	  foreach($company as $p) {
             $val =($p['fname'])?ucfirst($p[lname])." ,".ucfirst($p[fname]):ucfirst($p[lname]);
-	    print "<option value='$p[person_id]' >".$val."</option>\n";
+	    print "<option value='$p[person_id]' >".$zen->ffv($val)."</option>\n";
           }
 	?>
     </select>
     <br><br>
 <?
   } //if( is_array($company).. )
-  } //if( $zen->settings['allow_contacts']... )
+  } //if( $zen->getSetting('allow_contacts')... )
 ?>
 	
 </td>
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Click button to add recipients")?>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Add")?> " class="submit">
+  <td class="subTitle">
+  <? renderDivButtonFind('Add Recipients'); ?>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/reject.php zentrack_2-6-pre1/includes/templates/actions/reject.php
--- zentrack_2-5-5-2/includes/templates/actions/reject.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/reject.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,41 +1,31 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form method="post" name='rejectForm' action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<ul>
 <table width="450" cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Reject Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Return ticket to sender")?>)</span>
+ <td class='subTitle' colspan='2'><?=tr("Reject Ticket")?>
+   &nbsp;&nbsp;
+   <span class="note">(<?=tr("Return ticket to sender")?>)</span>
  </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Reason")?> <span class="highlight">(<?=tr("required")?>)</span>
+  <td class="bars">
+     <?=$hotkeys->ll("Reason")?> <span class="highlight">(<?=tr("required")?>)</span>
   </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    <?=tr("Click button to reject")?>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt("Reason")?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Reject")?> " class="submit">
+  <td class="subTitle" colspan='2'>
+    <? renderDivButton($hotkeys->find("Reject"),"window.document.forms['rejectForm'].submit()"); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/relate.php zentrack_2-6-pre1/includes/templates/actions/relate.php
--- zentrack_2-5-5-2/includes/templates/actions/relate.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/relate.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,56 +1,53 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<? 
+  if( !ZT_DEFINED ) { die("Illegal Access"); } 
+  if( is_array($relations) ) {
+    $relations = join(',',$relations);
+  }
+?>
 
 <form method="post" action="<?=$SCRIPT_NAME?>" name='relateTicketForm'>
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
+<input type="hidden" name="setmode" value="<?=$page_mode?>">
 
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table width="600" class='formtable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Relate Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Associate this ticket with others")?>)</span>
+ <td class='subTitle'>
+   <?=tr("Relate Ticket")?>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
-   <?=tr("Enter Ticket IDs")?>
+ <td class="bars">
+   <?=$hotkeys->ll("Enter Ticket IDs")?>
  </td>
 </tr>
 <tr>
- <td>
-    <textarea cols='20' rows='4' 
-	name='relations'><?=strip_tags($relations)?></textarea>
+ <td class='bars'>
+    <textarea cols='20' rows='4' title="<?=$hotkeys->tt("Enter Ticket IDs")?>" 
+      name='relations'><?=$zen->ffv($relations)?></textarea>
      &nbsp;<input type='button' class='searchbox' value=' ... ' 
 	onClick='popupWindowScrolls("<?=$rootUrl?>/helpers/ticketSearchbox.php?return_form=relateTicketForm&return_field=relations","popupHelper",375,500)'>
      <br><span class='note'> <?=tr("Enter ticket ids, separated by commas")?></span>
   </td>			     
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?> 
+  <td class="bars">
+     <?=$hotkeys->ll("Comments")?> 
 	&nbsp;<span class="small">(<?=tr("optional")?>)</span>
   </td>
 </tr>
 <tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
+  <td class='bars'
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt("Comments")?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td class="titleCell">
-    <?=tr("Click button to assign relations")?>
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Relate")?> " class="submit">
+  <td class="subTitle">
+  <? renderDivButtonFind('Relate'); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/reopen.php zentrack_2-6-pre1/includes/templates/actions/reopen.php
--- zentrack_2-5-5-2/includes/templates/actions/reopen.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/reopen.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,42 +1,32 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form name='reopenForm' method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table class='formTable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Reopen Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Open ticket closed in error")?>)</span>
+ <td colspan='2' class='subTitle'><?=tr("Reopen Ticket")?>
+   &nbsp;&nbsp;
+   <span class="note">(<?=tr("Reopen ticket to continue work")?>)</span>
  </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?>
-	&nbsp;<span class="small">(<?=tr("required")?>)</span>
+  <td class="bars">
+     <?=$hotkeys->ll("Comments or Instructions")?>
+	   <br><span class="note">(<?=tr("required")?>)</span>
   </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    <?=tr("Click button to open")?>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt("Comments or Instructions")?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Reopen")?> " class="submit">
+  <td class="subTitle" colspan='2'>
+     <? renderDivButton($hotkeys->find('Reopen'), "window.document.forms['reopenForm'].submit()"); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/template zentrack_2-6-pre1/includes/templates/actions/template
--- zentrack_2-5-5-2/includes/templates/actions/template	2002-04-30 03:11:12.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/template	1969-12-31 16:00:00.000000000 -0800
@@ -1,59 +0,0 @@
-
-<form method="post" action="<?=$SCRIPT_NAME?>">
-<input type="hidden" name="id" value="<?=$id?>">
-<input type="hidden" name="actionComplete" value="1">
-
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
-<tr>
- <td>
-   <span class="bigBold">MOVE TICKET</span>
-   <br>
-   <span class="small">(Move the ticket to a new location)</span>
- </td>
-</tr>
-<tr>
- <td class="titleCell">
-   Select a new bin
- </td>
-</tr>
-<tr>
- <td>
-<select name="newBin">
-<?
-  foreach($zen->bins as $k=>$v) {
-    if( $k != $bin_id && $zen->checkAccess($login_id, $k) ) {
-      $sel = ($k == $newBin)? "selected" : "";
-      print "<option value='$k' $sel>$v</option>\n";
-    }
-  }
-?>
-</select>
-  </td>			     
-</tr>
-<tr>
-  <td class="titleCell">
-     Comments or Instructions <span class="small">(optional)</span>
-  </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    Click button to send
-  </td>
-</tr>
-<tr>
-  <td>
-    <input type="submit" value=" MOVE " class="submit">
-  </td>
-</tr>
-<tr>
-</table>
-</ul>
-
-</form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/actions/test.php zentrack_2-6-pre1/includes/templates/actions/test.php
--- zentrack_2-5-5-2/includes/templates/actions/test.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/test.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,47 +1,47 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form name='testForm' method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table class='formTable' cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Test Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Set testing to completed on ticket")?>)</span>
+ <td colspan='2' class='subTitle'><?=tr("Test Ticket")?>
+   &nbsp;&nbsp;
+   <?
+   print "<span class='note'>";
+   if( $ticket['approved'] == 1 ) {
+     print tr("Ticket will be sent for approval");
+   }
+   else {
+     print tr("Ticket status will be changed to closed");
+   }
+   print "</span>";
+   ?>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
-   <?=tr("Enter hours worked")?>
+ <td class="bars">
+   <?=$hotkeys->ll("Hours Worked")?>
  </td>
-</tr>
-<tr>
- <td>
-   <input type="text" name="hours" size="4" maxlength="8" value="<?=strip_tags($hours)?>">
+ <td class='bars'>
+   <input type="text" name="hours" size="4" maxlength="8" value="<?=$zen->ffv($hours)?>"
+    title="<?=$hotkeys->tt("Hours Worked")?>">
   </td>			     
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Comments or Instructions")?>
-	&nbsp;<span class="small">(<?=tr("optional")?>)</span>
+  <td class="bars">
+     <?=$hotkeys->ll("Comments or Instructions")?>
+	   <div class="note">(<?=tr("optional")?>)</div>
   </td>
-</tr>
-<tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    Click button to complete testing
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments" title="<?=$hotkeys->tt("Comments or Instructions")?>"><?=
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=tr("Tested")?> " class="submit">
+  <td class="subTitle" colspan='2'>
+  <? renderDivButton($hotkeys->find('Testing Complete'), "window.document.testForm.submit()", 150); ?>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/upload.php zentrack_2-6-pre1/includes/templates/actions/upload.php
--- zentrack_2-5-5-2/includes/templates/actions/upload.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/upload.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,50 +1,44 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form enctype="multipart/form-data" action="<?=$SCRIPT_NAME?>" method="post">
-  <input type="hidden" name="MAX_FILE_SIZE" value="<?=$zen->settings["attachment_max_size"]?>">
+<form name='addAttachmentForm' enctype="multipart/form-data" action="<?=$SCRIPT_NAME?>" method="post">
+  <input type="hidden" name="MAX_FILE_SIZE" value="<?=$zen->getSetting("attachment_max_size")?>">
   <input type="hidden" name="id" value="<?=$id?>">
-  <input type="hidden" name="log_id" value="<?=strip_tags($log_id)?>">
+  <input type="hidden" name="log_id" value="<?=$zen->checkNum($log_id)?>">
   <input type="hidden" name="actionComplete" value="1">
+  <input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
 
 <ul>
 <table width="450" cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Upload Attachment")?></span>
-   <br>
-   <span class="small">(<?=tr("create an attachment for this ticket")?>)</span>
+ <td class='subTitle'>
+   <?=uptr("Upload Attachment")?>
  </td>
 </tr>
 <tr>
- <td class="titleCell">
-   <?=tr("Select a file to upload")?>
+ <td class="bars">
+   <?=$hotkeys->ll("Select a File to Upload")?>
  </td>
 </tr>
 <tr>
- <td>
-   <input type="file" name="userfile" size="40">
- </td>			     
+ <td class='bars'>
+   <input type="file" name="userfile" size="40" title="<?=$hotkeys->tt("Select a File to Upload")?>">
+ </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     <?=tr("Description of Attachment")?>
+  <td class="bars">
+     <?=$hotkeys->ll("Description of Attachment")?>
      &nbsp;<span class="small">(<?=tr("optional")?>)</span>
   </td>
 </tr>
 <tr>
-  <td>
-    <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags(stripslashes($comments))?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    <?=tr("Click button to upload file and attach to ticket")?>
+  <td class='bars'>
+    <textarea cols="50" rows="4" name="comments"
+        title="<?=$hotkeys->tt("Description of Attachment")?>"><?=$zen->ffv($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Attach")?> " class="submit">
+  <td class="subTitle">
+    <? renderDivButtonFind('Add Attachment'); ?>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-5-2/includes/templates/actions/yank.php zentrack_2-6-pre1/includes/templates/actions/yank.php
--- zentrack_2-5-5-2/includes/templates/actions/yank.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/actions/yank.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,41 +1,31 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form name='pullForm' method="post" action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="id" value="<?=$id?>">
 <input type="hidden" name="actionComplete" value="1">
 
-<ul>
-<table width="450" cellpadding="4" cellspacing="1" border="0">
+<table cellpadding="4" cellspacing="1" border="0">
 <tr>
- <td>
-   <span class="bigBold"><?=uptr("Yank Ticket")?></span>
-   <br>
-   <span class="small">(<?=tr("Pull ticket from the current owner")?>)</span>
+ <td class='subTitle' colspan='2'><?=uptr("Pull Ticket")?>
+   &nbsp;&nbsp;
+   <span class="note">(<?=tr("Take ticket from the current owner")?>)</span>
  </td>
 </tr>
 <tr>
-  <td class="titleCell">
-     Reason <span class="small">(<?=tr("optional")?>)</span>
+  <td class="bars">
+     <?=$hotkeys->ll("Reason")?><div class="note">(<?=tr("optional")?>)</div>
   </td>
-</tr>
-<tr>
   <td>
     <textarea cols="50" rows="4" name="comments"><?=
-      strip_tags($comments)?></textarea>
-  </td>
-</tr>
-<tr>
-  <td class="titleCell">
-    <?=tr("Click button to yank ticket")?>
+      $zen->ffvText($comments)?></textarea>
   </td>
 </tr>
 <tr>
-  <td>
-    <input type="submit" value=" <?=uptr("Yank")?> " class="submit">
+  <td class="subTitle" colspan='2'>
+   <? renderDivButton($hotkeys->find('Pull'),'window.document.pullForm.submit()'); ?>
   </td>
 </tr>
 <tr>
 </table>
-</ul>
 
 </form>			     
diff -Naur zentrack_2-5-5-2/includes/templates/adminMenu.php zentrack_2-6-pre1/includes/templates/adminMenu.php
--- zentrack_2-5-5-2/includes/templates/adminMenu.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/adminMenu.php	2005-10-21 03:59:54.000000000 -0700
@@ -1,45 +1,54 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<br>
-<ul>
-  
-  <b><?=tr("User Administration")?></b>
-  <ul>
-    <b><a href='<?=$rootUrl?>/admin/addUser.php'><?=tr("New User")?></a></b>
-    <br><span class="small">(<?=tr("Create a new user account")?>)</span>
-    <br><b><a href='<?=$rootUrl?>/admin/listUsers.php'><?=tr("Edit Users/Access")?></a></b>
-    <br><span class="small">(<?=tr("Edit user accounts and permissions.")?>)</span>
-  </ul>
+  <table width='80%'><tr><td>
+  <div class='menubox'>
+    <div><?=tr("User Administration")?></div>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/addUser.php'><?=tr("New User")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Create a new user account")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/listUsers.php'><?=tr("Edit Users/Access")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Edit user accounts and permissions.")?></span></p>
+  </div>
       
-  <br><b><?=tr("Ticket Administration")?></b>
-  <ul>
-    <b><a href='<?=$rootUrl?>/admin/editTicket.php'><?=tr("Edit Tickets")?></a></b>
-    <br><span class="small">(<?=tr("Edit ticket information")?>)</span>
-    <br><b><a href="<?=$rootUrl?>/admin/fieldMap.php"><?=tr("Edit Field Map")?></a></b>
-    <br><span class="small">(<?=tr("View specific display properties for fields")?></span>
-  </ul>
+  <div class='menubox'>
+    <div><?=tr("Ticket Administration")?></div>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/editTicket.php'><?=tr("Edit Tickets")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Edit ticket information")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href="<?=$rootUrl?>/admin/fieldMap.php"><?=tr("Edit Field Map")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("View specific display properties for fields")?></span></p>
+  </div>
 
-  <br><b><?=tr("Data Types")?></b>
-  <ul>
-      <b><a href='<?=$rootUrl?>/admin/bins.php'><?=tr("Edit Bins")?></a></b>
-      <br><span class="small">(<?=tr("Bins are departments or groups that tickets belong to.")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/priorities.php'><?=tr("Edit Priorities")?></a></b>
-      <br><span class="small">(<?=tr("Priorities represent the importance of an issue.")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/systems.php'><?=tr("Edit Systems")?></a></b>
-      <br><span class="small">(<?=tr("Systems represent a component or area the ticket is specific to.")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/tasks.php'><?=tr("Edit Tasks")?></a></b>
-      <br><span class="small">(<?=tr("Tasks represent types of log entries.")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/types.php'><?=tr("Edit Types")?></a></b>
-      <br><span class="small">(<?=tr("Types represent the type of ticket activity.")?>)</span>
-  </ul>
-  
-  <br><b><?=tr("Settings Administration")?></b>
-  <ul>
-      <b><a href='<?=$rootUrl?>/admin/groups.php'><?=tr("Edit Data Groups")?></a></b>
-      <br><span class="small">(<?=tr("Data groups are a list created from a data type")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/behaviors.php'><?=tr("Edit Behaviors")?></a></b>
-      <br><span class="small">(<?=tr("Behaviors let you specify how a field modification would affect other field of the current ticket.")?>)</span>
-      <br><b><a href='<?=$rootUrl?>/admin/config.php'><?=tr("Configuration Settings")?></a></b>
-      <br><span class="small">(<?=tr("Edit the zenTrack settings.  Consult the documentation before using this feature.")?>)</span>
-  </ul>
+  <div class='menubox'>
+    <div><?=tr("Data Types")?></div>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/bins.php'><?=tr("Edit Bins")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Bins are departments or groups that tickets belong to.")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/priorities.php'><?=tr("Edit Priorities")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Priorities represent the importance of an issue.")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/systems.php'><?=tr("Edit Systems")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Systems represent a component or area the ticket is specific to.")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/tasks.php'><?=tr("Edit Tasks")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Tasks represent types of log entries.")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/types.php'><?=tr("Edit Types")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Types represent the type of ticket activity.")?></span></p>
+  </div>
   
-</ul>
+  <div class='menubox'>
+    <div><?=tr("Settings Administration")?></div>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/groups.php'><?=tr("Edit Data Groups")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Data groups are a list created from a data type")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/behaviors.php'><?=tr("Edit Behaviors")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Behaviors let you specify how a field modification would affect other field of the current ticket.")?></span></p>
+    <p onclick='mClk(this)'>
+    <a href='<?=$rootUrl?>/admin/config.php'><?=tr("Configuration Settings")?></a>
+    &nbsp;&nbsp;<span class="note"><?=tr("Edit the zenTrack settings.  Consult the documentation before using this feature.")?></span></p>
+  </div>
+  </td></tr></table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/agreementView.php zentrack_2-6-pre1/includes/templates/agreementView.php
--- zentrack_2-5-5-2/includes/templates/agreementView.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/agreementView.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,36 +1,35 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 	<?
 	$sort = "dtime asc";
-	$parms = array(1 => array(1 => "status", 2 => "=", 3 => "1")
-);
-
+	$parms = array(array("status", "=", "1"));
 	$tickets = $zen->get_contacts($parms,"ZENTRACK_AGREEMENT",$sort);
-	
+	$img = $image? 
+    "&nbsp;<IMG SRC='$imageUrl/".$zen->ffv($image)."' border='0'>" : '';
 	
 if( is_array($tickets) && count($tickets) ) {
  
    ?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>' border="0">
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
-
-<td width="32" height="25" valign="middle" title="<?=tr("ID of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<table width="100%" cellspacing='1' cellpadding='2' class='formtable'>
+<tr><td class='subTitle' align='center' colspan='5'><?=tr("Agreements")?></td></tr>
+<tr>
+<td class='headerCell' title="<?=tr("ID of the agreement")?>">
+<?=tr("ID") . $img ?>
 </td>
 
-<td height="25" valign="middle" title="<?=tr("The nr of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Nr")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<td class='headerCell' title="<?=tr("The nr of the agreement")?>">
+<?=tr("Nr") . $img ?>
 </td>
 
-<td height="25" valign="middle" title="<?=tr("The title of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<td class='headerCell' title="<?=tr("The title of the agreement")?>">
+<?=tr("Title") . $img ?>
 </td>
 
-<td height="25" valign="middle" title="<?=tr("The company of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Company")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<td class='headerCell' title="<?=tr("The company of the agreement")?>">
+<?=tr("Company") . $img ?>
 </td>
 
-<td height="25" valign="middle" title="<?=tr("The expiration date of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Expiration Date")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<td class='headerCell' title="<?=tr("The expiration date of the agreement")?>">
+<?=tr("Expires") . $img ?>
 </td>
 
 </tr>
@@ -41,26 +40,27 @@
    foreach($tickets as $t) {    
 
       ?>
-   <tr  class='priority6' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' onMouseOver='mClassX(this, "priority6Over", true)' onMouseOut='mClassX(this, "priority6", false)'>
+   <tr  class='bars' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' 
+      <?=$row_rollover_eff?>>
    <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
-    <?=$t["agree_id"]?>
+    <?=$zen->ffv($t["agree_id"])?>
    </td>
    <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
-    <?=$t["contractnr"]?>
+    <?=$zen->ffv($t["contractnr"])?>
    </td>
    <td height="25" width="35%" valign="middle" <?=$td_ttl?>>
-   <?=$t["title"]?>
+   <?=$zen->ffv($t["title"])?>
    </td>
       <td height="25" width="25%" valign="middle" <?=$td_ttl?>><?
-   	 if ( !empty($t["company_id"])) {
-	 $contact = $zen->get_contact($t["company_id"],"ZENTRACK_COMPANY","company_id");
-	  if( is_array($contact) ) {
-      echo strtoupper($contact['title']);
-      if ($contact['title']){
-	      echo " " .strtolower($contact['office']);
+      if ( !empty($t["company_id"])) {
+        $contact = $zen->get_contact($t["company_id"],"ZENTRACK_COMPANY","company_id");
+        if( is_array($contact) ) {
+          echo strtoupper($contact['title']);
+          if($contact['title']){
+            print " " .$zen->ffv($contact['office']);
+          }
+        }	  
       }
-    }	  
-  }
    ?>
    </td>
    <td width="20%" valign="middle" <?=$td_ttl?>>
@@ -73,4 +73,8 @@
 ?>
 </table>
 <?
-}
\ No newline at end of file
+}
+else {
+  print "&nbsp;<blockquote>There are no agreements to view.</blockquote>\n";
+}
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/agreement_box.php zentrack_2-6-pre1/includes/templates/agreement_box.php
--- zentrack_2-5-5-2/includes/templates/agreement_box.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/agreement_box.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,150 +1,117 @@
 <?
 if( !ZT_DEFINED ) { die("Illegal Access"); }
 
-
 /*
 *Show the contacts that are connected to a company
 */
 //echo($company_id);
-if ($company_id>"0") {
-$company = $zen->get_contact($company_id,"ZENTRACK_COMPANY","company_id");
+$company_id = $zen->checkNum($company_id);
+$agree_id = $zen->checkNum($agree_id);
+if ($company_id > 0) {
+  $company = $zen->get_contact($company_id,"ZENTRACK_COMPANY","company_id");
 }
 
 if (is_array($company)) {
-
-$name ="<A HREF='".$rootUrl."/contact.php?cid=".$company['company_id']."'>".ucfirst($company["title"])." ".ucfirst($company["office"])."</A>";
+  $name ="<A HREF='".$rootUrl."/contact.php?cid=".$zen->checkNum($company['company_id'])."'>".$zen->ffv(ucfirst($company["title"]))." ".$zen->ffv(ucfirst($company["office"]))."</A>";
 }
 
 ?>
-   <table cellpadding="0" cellspacing="0" border="0">
+<table width='60%' class='formtable' cellpadding='2' cellspacing='1'>
   <tr>
-   <td class="ticketCell">
-   <table align="center" width='570' border="0">
-     <tr>
-       <td valign="top"><table border="0"
-          width="430" cellpadding="0" cellspacing="1">
-
-    <tr>
-	   <td class="titleCell" colspan="4"><p align="center"><?=$contractnr?></p></td>
-	  </tr>
-	  <tr>
-	   <td class="smallTitleCell" colspan="2" ><?=uptr("Info")?></td>
-	   <td class="smallTitleCell"  colspan="2" width="50%"><?=uptr("Dates")?></td>
-	  </tr>
-	  <tr>
-     <td class="small" width="20%"><?=tr("Title")?>:</td>
-	   <td class="small" width="30%"><?=$title?></td>
-	   <td class="small" width="20%"><?=tr("Start Date")?>:</td>
-	   <td class="small" width="30%"><?if($stime){echo $zen->showDate($stime);}?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"><?=tr("Company")?>:</td>
-	   <td class="small" width="30%"><?=$name?></td>
-	   <td class="small" width="20%"><?=tr("Expiration Date")?>:</td>
-	   <td class="small" width="30%"><?if($dtime){echo $zen->showDate($dtime);}?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"></td>
-	   <td class="small" width="30%"></td>
-	   <td class="small" width="20%"></td>
-	   <td class="small" width="30%"></td>
-	  </tr>
+   <td class="subTitle" colspan="4"><p align="center"><?=$zen->ffv($contractnr)?></p></td>
+  </tr>
+  <tr>
+   <td class="headerCell" colspan="2" ><?=tr("Info")?></td>
+   <td class="headerCell"  colspan="2" width="50%"><?=tr("Dates")?></td>
+  </tr>
+  <tr>
+   <td class="bars small" width="20%"><?=tr("Title")?>:</td>
+   <td class="bars small" width="30%"><?=$zen->ffv($title)?></td>
+   <td class="bars small" width="20%"><?=tr("Start Date")?>:</td>
+   <td class="bars small" width="30%"><?if($stime){echo $zen->showDate($stime);}?></td>
+  </tr>
+  <tr>
+   <td class="bars small" width="20%"><?=tr("Company")?>:</td>
+   <td class="bars small" width="30%"><?=$name?></td>
+   <td class="bars small" width="20%"><?=tr("Expiration Date")?>:</td>
+   <td class="bars small" width="30%"><?if($dtime){echo $zen->showDate($dtime);}?></td>
+  </tr>
 <?
  if(!empty($description)) {
 ?>
 	  <tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Description")?></td>
+	   <td class="headerCell" colspan="4"><?=tr("Description")?></td>
 	  </tr>
 	  <tr>
-	   <td class="small" colspan="4"><?=(get_magic_quotes_runtime())?nl2br(stripslashes($description)):nl2br($description); ?></td>
+	   <td class="bars small" colspan="4"><?=$zen->ffvText($description)?></td>
 	  </tr>
 <?
 }
+
+  print "<tr><td class='subTitle' colspan='4'><table width='100%' cellpadding='0' cellspacing='0'><tr>";
+  
+  print "<td>";
+  print "<form name='editAgreementForm' action='$rootUrl/actions/agreement_edit.php'>\n";
+  renderDivButtonFind("Edit");
+  print "<input type='hidden' name='id' value='$agree_id'>\n";
+  print "</form>\n";
+  print "</td>";
+  
+  if ($status=="1") {
+    $active = "0";
+    $value = "ARCHIVE";
+  } else {
+    $active = "1";
+    $value = "ACTIVATE";
+  }
+  
+  print "<td width='100%' align='center'>";
+  print "<form name='archiveAgreementForm' action='$rootUrl/actions/agreement_archive.php'>\n";
+  renderDivButtonFind('Archive');
+  print "<input type='hidden' name='id' value='$agree_id'>\n";
+  print "<input type='hidden' name='active' value='".$zen->ffv($active)."'>\n";
+  print "</form>\n";
+  print "</td>";
+  
+  print "<td>";
+  print "<form name='deleteAgreementForm' action='$rootUrl/actions/agreement_delete.php'>\n";
+  renderDivButtonFind("Delete");
+  print "<input type='hidden' name='id' value='$agree_id'>\n";
+  print "</form>\n";
+  print "</td>";
+  
+  print "</tr></table></td></tr>";
+?>
+</table>
+<?
 //show items
-$parms = array(1 => array(1 => "agree_id", 2 => "=", 3 => $agree_id),
-);
+$parms = array(array("agree_id", "=", $agree_id));
 $sort = "item_id asc";
-
 $items = $zen->get_contacts($parms,"ZENTRACK_AGREEMENT_ITEM",$sort);
+
+if (is_array($items) && count($items)) {
 ?>
+<br>
+<table width='60%' class='formtable' cellspacing='1' cellpadding='2'>
+<tr>
+	   <td class="subTitle" colspan="3"><?=tr("Items")?></td>
+</tr>
 <tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Items")?></td>
+  <td class='headerCell'><?=tr("ID")?></td>
+  <td class='headerCell'><?=tr("Name")?></td>
+  <td class='headerCell'><?=tr("Description")?></td>
 </tr>
-<tr><td colspan="4">
-<table>
 <?
-if (is_array($items)) {
-
-  $class = '';
   foreach($items as $t) {
-    $class = $class == 'bars'? 'cell' : 'bars';
     ?>
-    <tr class='<?=$class?>'>
+    <tr class='bars'>
     <td><?=$t["item_id"]?></td>
-    <td height="25" width="50%" align="middle">
-    <?=strtoupper($t["name1"])?>
-    </td>
-    <td height="25" width="50%" align="middle" >
-    <?=strtolower($t["description1"])?>
-    </td>
+    <td><?=$zen->ffv($t["name1"])?></td>
+    <td><?=$zen->ffv($t["description1"])?></td>
     </tr>
     <?
   }
-
-} else {
-  echo "<tr><td colspan='4'>No items are set</td></tr>" ;
-}?>
-</table>
-</td</tr>
-
-<?//end items
-?>
-	 </table>
-
-	 </td>
-   <td valign="top" width='75'>
-
-<table width="120" cellpadding="0" cellspacing="0" border="0">
-<?
-print "<tr>\n<form name='edit_form' action='$rootUrl/actions/agreement_edit.php'>\n";
-print "<td>\n";
-print "<input type='submit' class='actionButtonContact' value='EDIT'>\n";
-print "<input type='hidden' name='id' value='$agree_id'>\n";
-print "</td>\n</form>\n</tr>\n";
-
-if ($status=="1") {
-  $active = "0";
-  $value = "ARCHIVE";
-} else {
-  $active = "1";
-  $value = "ACTIVATE";
 }
 
-print "<tr>\n<form name='archief_form' action='$rootUrl/actions/agreement_archive.php'>\n";
-print "<td>\n";
-print "<input type='submit' class='actionButtonContact'  value='$value'";
-print " onClick='return confirm(\"";
-print tr("Are you sure you want to archive this agreement?");
-print "\")'";
-print ">\n";
-print "<input type='hidden' name='id' value='$agree_id'>\n";
-print "<input type='hidden' name='active' value='$active'>\n";
-print "</td>\n</form>\n</tr>\n";
-
-
-print "<tr>\n<form name='delete_form' action='$rootUrl/actions/agreement_delete.php'>\n";
-print "<td>\n";
-print "<input type='submit' class='actionButtonContact'  value='".uptr('delete')."'";
-print " onClick='return confirm(\"".tr("Are you sure you want to permanently delete this agreement?")."\")'";
-print ">\n";
-print "<input type='hidden' name='id' value='$agree_id'>\n";
-print "</td>\n</form>\n</tr>\n";
 ?>
-</table>
-     </td>
-     </tr>
-    </table>
-    </td>
-  </tr>
-</table>
-<br>
\ No newline at end of file
+</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/agreement_list.php zentrack_2-6-pre1/includes/templates/agreement_list.php
--- zentrack_2-5-5-2/includes/templates/agreement_list.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/agreement_list.php	2005-10-20 11:23:44.000000000 -0700
@@ -4,152 +4,83 @@
 /* 
 *Show the contacts that are connected to a company
 */
-
-if( is_array($contacts) ) {
-   
-		$link  = "$rootUrl/contact.php";
-   
-   foreach($contacts as $t) {      
-      ?>
-   <br>
-      <table cellpadding="0" cellspacing="0" border="0">
-  <tr>
-   <td class="ticketCell">
-   <table align="center" width='570' border="0">     
-     <tr>
-       <td valign="top"><table border="0"
-          width="430" cellpadding="0" cellspacing="1">
-          
-    <tr>
-	   <td class="titleCell" colspan="4"><p align="center"><?=$t["contractnr"]?></p></td>  
-	  </tr>
-	  <tr>
-	   <td class="smallTitleCell" colspan="2" ><?=uptr("Info")?></td>
-	   <td class="smallTitleCell"  colspan="2" width="50%"><?=uptr("Dates")?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%" colspan="2"><p align="center"><?=$t["title"]?></p></td> 
-	   <td class="small" width="20%"><?=tr("Start Date")?>:</td> 	   
-	   <td class="small" width="30%"><?if($t["stime"]){echo $zen->showDate($t["stime"]);}?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"></td> 
-	   <td class="small" width="30%"></td>  
-	   <td class="small" width="20%"><?=tr("Expiration Date")?>:</td>  
-	   <td class="small" width="30%"><?if($t["dtime"]){echo $zen->showDate($t["dtime"]);}?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"></td> 
-	   <td class="small" width="30%"></td> 
-	   <td class="small" width="20%"></td> 
-	   <td class="small" width="30%"></td> 
-	  </tr>
-<?
- if(!empty($t["description"])) {
-?>	  
-	  <tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Description")?></td>  
-	  </tr>
-	  <tr>
-	   <td class="small" colspan="4"><?=(get_magic_quotes_runtime())?nl2br(stripslashes($t["description"])):nl2br($t["description"]); ?></td>
-	  </tr>
-<?
-}
-//set default id
-$agree_id = $t["agree_id"];
-//set active
-$status = $t["status"];
-
-//show items
-$parms = array(1 => array(1 => "agree_id", 2 => "=", 3 => $agree_id),
-);
-$sort = "item_id asc";
-
-$items = $zen->get_contacts($parms,"ZENTRACK_AGREEMENT_ITEM",$sort);
-?>
-<tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Items")?></td> 
-</tr> 
-<tr><td colspan="4"> 
-<table>
-	   <?
-	     if (is_array($items)) {
-
-		
-	 			 foreach($items as $t) {      
-      		?>
-   					<tr  class='priority1'>
-   					<td><?=$t["item_id"]?></td>
-   					<td height="25" width="50%" align="middle">
-    				<?=strtoupper($t["name1"])?>
-   					</td>
-   					<td height="25" width="50%" align="middle" >
-   					<?=strtolower($t["description1"])?>
-   					</td>
-   					</tr>   
-   				<?   
-   				} 
-   		
-  		} else {
-	 				echo "<tr><td colspan='4'>No items are set</td></tr>" ;
-  		}?>
-</table>
-</td</tr>  	
-<?//end items
+$img = null;
+$agree_id = $zen->ffv($agree_id);
 ?>
-	 </table>
-	 
-	 </td>
-   <td valign="top" width='75'>
-       
-<table width="120" cellpadding="0" cellspacing="0" border="0">
+  <table width='600' cellpadding="0" cellspacing="1" border="0" class='formtable'>
+  <tr><td class='subTitle' colspan='6'><?=tr("Agreements")?></td></tr>
 <?
-			print "<tr>\n<form name='edit_form' action='$rootUrl/actions/agreement_edit.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' value='EDIT'>\n";
-			print "<input type='hidden' name='id' value='$agree_id'>\n";
-			print "</td>\n</form>\n</tr>\n";
-			
-			if ($status=="1") {
-				$active = "0";
-				$value = "TO ARCHIVE";
-			} else {
-				$active = "1";
-				$value = "MAKE ACTIVE";
-			}
-			
-			print "<tr>\n<form name='archief_form' action='$rootUrl/actions/agreement_archive.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact'  value='$value'";
-			print " onClick='return confirm(\"Are you sure you want to archive this agreement\")'";
-			print ">\n";
-			print "<input type='hidden' name='id' value='$agree_id'>\n";
-			print "<input type='hidden' name='active' value='$active'>\n";
-			print "</td>\n</form>\n</tr>\n";
-
-			
-  		print "<tr>\n<form name='delete_form' action='$rootUrl/actions/agreement_delete.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact'  value='DELETE'";
-			print " onClick='return confirm(\"Are you sure you want to permanently delete this contact\")'";
-			print ">\n";
-			print "<input type='hidden' name='id' value='$agree_id'>\n";
-			print "</td>\n</form>\n</tr>\n";
+if( is_array($contacts) ) {
 ?>
-</table>
-     </td>
-     </tr>
-    </table>
-    </td>
-  </tr>
-</table>
-   <?
-   
-   }      
-     
-   
+<tr>
+<td class='headerCell' title="<?=tr("ID of the agreement")?>">
+<?=tr("ID") . $img ?>
+</td>
+<td class='headerCell' title="<?=tr("The nr of the agreement")?>">
+<?=tr("Nr") . $img ?>
+</td>
+<td class='headerCell' title="<?=tr("The title of the agreement")?>">
+<?=tr("Title") . $img ?>
+</td>
+<td class='headerCell' title="<?=tr("The company of the agreement")?>">
+<?=tr("Company") . $img ?>
+</td>
+<td class='headerCell' title="<?=tr("The expiration date of the agreement")?>">
+<?=tr("Expires") . $img ?>
+</td>
+<td class='headerCell'><?=tr("Options")?></td>
+</tr>
+<?      
+  $link  = "$rootUrl/agreement.php";
+   	
+  foreach($contacts as $t) {
+    $aid = $zen->ffv($t['agree_id']);
+    $td_ttl = "title='".tr("Click here to view the Agreement")."' "
+             ."onclick='ticketClk(\"$link?id={$t['agree_id']}\",this.event)'";
+    ?>
+    <tr class='bars' <?=$row_rollover_eff?>>
+      <td <?=$td_ttl?>>
+        <?=$aid?>
+      </td>
+      <td <?=$td_ttl?>>
+        <?=$zen->ffv($t["contractnr"])?>
+      </td>
+      <td <?=$td_ttl?>>
+        <?=$zen->ffv($t["title"])?>
+      </td>
+      <td <?=$td_ttl?>><?
+        if ( !empty($t["company_id"])) {
+          $contact = $zen->get_contact($t["company_id"],"ZENTRACK_COMPANY","company_id");
+          if( is_array($contact) ) {
+            print $zen->ffv($contact['title']);
+            if($contact['title']){
+              print " " .$zen->ffv($contact['office']);
+            }
+          }	  
+        }
+      ?>
+      </td>
+      <td <?=$td_ttl?>>
+        <?=($t["dtime"])?$zen->showDate($t["dtime"]):"n/a";?>
+      </td>
+      <td class='bars small' width='60'>
+       <a class='pinIcon' href='<?=$rootUrl?>/actions/agreement_edit.php?id=<?=$aid?>'
+          title='<?=tr("Edit Agreement")?>'><img src='<?=$imageUrl?>/16x16/pin_green.png'
+          width='16' height='16' border='0' alt='<?=tr("Edit Agreement")?>'></a>
+       <a class='pinIcon' href='<?=$rootUrl?>/actions/agreement_archive.php?id=<?=$aid?>&active=<?=$t['status']? 0:1?>'
+          onclick='return confirm("<?=tr("Archive this agreement?")?>")'
+          title='<?=tr("Archive Agreement")?>'><img src='<?=$imageUrl?>/16x16/pin_yellow.png'
+          width='16' height='16' border='0' alt='<?=tr("Archive Agreement")?>'></a>
+       <a class='pinIcon' href='<?=$rootUrl?>/actions/agreement_delete.php?id=<?=$aid?>'
+          onclick='return confirm("<?=tr("Delete this agreement?")?>")'
+          title='<?=tr("Delete Agreement")?>'><img src='<?=$imageUrl?>/16x16/pin_red.png'
+          width='16' height='16' border='0' alt='<?=tr("Delete Agreement")?>'></a>
+      </td>
+    </tr>       
+    <?
+  }
 } else {
-  
-    print "<p>&nbsp;</p><ul><b>".tr('No contacts in this section.').".</b></ul>";
+    print "<tr><td class='bars' colspan='6'>".tr('No agreements found')."</td></tr>";
 } 
-?>
\ No newline at end of file
+?>
+</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/behaviorForm.php zentrack_2-6-pre1/includes/templates/behaviorForm.php
--- zentrack_2-5-5-2/includes/templates/behaviorForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/behaviorForm.php	2005-10-05 03:01:21.000000000 -0700
@@ -11,7 +11,7 @@
 <form method="post" action="<?=$rootUrl?>/admin/<?=$url?>BehaviorSubmit.php">
 <? if( $td ) { print "<input type='hidden' name='behavior_id' value='".strip_tags($behavior_id)."'>\n"; } ?>
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
   <?=$blurb?>
@@ -23,7 +23,7 @@
   </td>
 </tr>  
 <tr>
-  <td class="bars">
+  <td class="bars" width='125'>
     <?=tr("Behavior Name")?>*
   </td>
   <td class="bars">
@@ -32,7 +32,7 @@
 </tr>
 <tr>
   <td class="bars">
-    <?=tr("Active")?>*
+    <?=tr("Active")?>
   </td>
     <?
          $t = "\t<td class='bars'>";
@@ -62,10 +62,11 @@
 </tr>
 <tr>
   <td class="bars">
-    <?=tr("Sort Order")?>*
+    <?=tr("Sort Order")?>
   </td>
   <td class="bars">
     <input type="text" name="NewSortOrder" value="<?=strip_tags($behavior['sort_order'])?>" size="40" maxlength="255">
+    <div class='note'><?=tr("The sort order is critical.  If two behaviors conflict, the sort order decides which one gets to run and which one is ignored.")?></div>
   </td>
 </tr>
 <tr>
@@ -86,15 +87,15 @@
 </tr>
 <tr>
   <td class="bars">
-    <?=tr("Field is enabled")?>*
+    <?=tr("Field is enabled")?>
   </td>
-    <?
-         $t = "\t<td class='bars'>";
-         $te = "</td>\n";
+  <td class='bars'>
+  <?
          $sel = !$td || $behavior['field_enabled']? ' checked' : '';
-         print "$t<input type='checkbox' value='1' name='NewFieldEnabled'$sel>\n";
-         print "$te";
+         print "<input type='checkbox' value='1' name='NewFieldEnabled'$sel>\n";
     ?>
+    <div class='note'><?=tr("If the behavior runs, the field will be 
+    disabled/enabled based on this checkbox")?></div>
   </td>
 </tr>
 <tr>
diff -Naur zentrack_2-5-5-2/includes/templates/binForm.php zentrack_2-6-pre1/includes/templates/binForm.php
--- zentrack_2-5-5-2/includes/templates/binForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/binForm.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,116 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-      <br>
-      <p class='error'><?
-         $str = "<a href='$rootUrl/help/find.php?s=admin&p=varfields'>".tr('Documentation')."</a>";
-         print tr("Please refer to the ? before using this feature", array($str));
-       ?></p>
-
-      <ul>
-      <form name='binForm' action='<?=$SCRIPT_NAME?>' method='post'>
-      <input type='hidden' name='TODO' value=''>
-      <table cellpadding="2" cellspacing="1" class='plainCell'>
-	 <tr>
-	 <td class='titleCell' align='center' colspan='4'>
-	   <b>Edit the Active Bins</b>
-	 </td>
-	 </tr>
-	 <tr>
-	 <td width="30" class='cell' align='center'><b>ID</b></td>
-	 <td class='cell' align='center'><b>Bin Name</b></td>
-	 <td width="30" class='cell' align='center'><b>Order</b></td>
-	 <td width="30" class='cell' align='center'><b>Active</b></td>
-	 </tr>
-    <? 
-         $js_vals = array();
-         $num = count($vars) + $more;
-	 if( is_array($vars) ) {
-	   $j = 0;
-	   $t = "\t<td class='bars'>";
-	   $te = "</td>\n";
-	   foreach($vars as $v) {
-	     print "<tr>\n";
-	     $i = ($v["bid"])? $v["bid"] : "-new-";
-	     print "$t$i$te";
-	     print "<input type='hidden' name='newID[$j]' value='".$zen->ffv($v['bid'])."'>\n";
-	     print "$t<input type='text' name='newBin[$j]' "
-	       ." value='".$zen->ffv($v['name'])."' size='20' maxlength='25'>$te";
-	     print "$t<select name='newPri[$j]' "
-	       ." onChange='return checkBins($j, this)'>\n"
-	       .admin_number_pulldown( $num, $v["priority"] )."</select>\n$te";
-	     print "$t<input type='checkbox' name='newActive[$j]' value='1'";
-	     print ($v["active"])? " checked" : "";
-	     print ">$te";
-	     print "</tr>\n";
-	     $js_vals[] = ($v["priority"])? $v["priority"] : 0;
-	     $j++;
-	   }
-	 }
-	 for( $i=0; $i<$more; $i++ ) {
-	   print "<tr>\n";
-	   print $t."-new-".$te;
-	   print "<input type='hidden' name='newID[$j]' value=''>\n";
-	   print "$t<input type='text' name='newBin[$j]' "
-	     ." value='' size='20' maxlength='25'>$te";
-	   print "$t<select name='newPri[$j]' "
-	     ." onChange='checkBins($j, this)'>\n"
-	     .admin_number_pulldown( $num )."</select>\n$te";
-	   print "$t<input type='checkbox' name='newActive[$j]' value='1' checked>$te";
-	   print "</tr>\n";	   
-	   $js_vals[] = 0;
-	   $j++;
-	 }
-
-    ?>
-<tr>
-  <td class="titleCell" colspan="4">
-    <?=tr('Press MORE to create new bins')?>
-    <br>
-    <?=tr('Press LESS to remove blank rows')?>
-    <br>
-    <?=tr('Press Save to save changes')?>
-    <br>
-    <?=tr('Press Reset to return to original values')?>
-  </td>
-</tr>
-      <tr>
-	 <td class='cell' colspan='4'>
-	 <input type='submit' value='<?=uptr('More')?>' onClick="return setTodo('MORE')">
-         &nbsp;
-         <input type='submit' value='<?=uptr('less')?>' onClick="return setTodo('LESS')">
-	 &nbsp;
-	 <input type='submit' class='submit' value='<?=tr('Save')?>' onClick="return setTodo('Save')">
-	 &nbsp;
-	 <input type='submit' class='submitPlain' value='<?=tr('Reset')?>' onClick="return setTodo('Reset')">
-         </td>
-      </tr>
-      </table>
-      </ul>
-
-      <input type='hidden' name='more' value='<?=$more?>'>
-      </form>
-      <script language='javascript'>
-	 var i;
-         var ci;
-         var bin = [ <?=join(",",$js_vals)?> ];
-         function checkBins( num, f ) {
-	   if( num == "" )
-	     num = 0;
-	   val = f.selectedIndex+"";
-	   for( i=0; i<bin.length; i++ ) {
-	     if( i != num ) {
-	       if( bin[i] > 0 && bin[i] == val ) {
-		 alert("There is already a bin with that value.");
-		 f.selectedIndex = bin[num];
-		 return false;
-	       }
-	     }
-	   }
-	   bin[num] = val;
-	   return true;
-	 }
-
-	 function setTodo( val ) {
-	   document.binForm.TODO.value = val;
-	 } 	 
-      </script> 
-
diff -Naur zentrack_2-5-5-2/includes/templates/configForm.php zentrack_2-6-pre1/includes/templates/configForm.php
--- zentrack_2-5-5-2/includes/templates/configForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/configForm.php	2005-10-05 03:01:21.000000000 -0700
@@ -12,83 +12,125 @@
      <p><?=tr('Notes are special tickets which do not require any actions.').'  '.
 	       tr('They start their life closed, and do not need to be completed.').'  '. 
 	       tr('Use them only for tracking and documentation.')?></p>
-<? } else if( $type == 'priority' ) {?>
-   <p><?=tr("The priority order fields should all be filled in and should "
-           ."be consecutive (for proper coloring).")?>
-   <br><?=tr("Any fields which are disabled should have the order set to 0")?></p>
+         
+  <script type='text/javascript'>
+    function checkPriType( formObj ) {
+      var matched = false;
+      for( var i=0; i < formObj.elements.length; i++ ) {
+        var e = formObj.elements[i];
+        if( e.name && e.type && e.name.indexOf( 'newName' ) == 0 ) {
+          if( e.value.toLowerCase().indexOf('project') >= 0 ) {
+            matched = true;
+            break;
+          }
+        }
+      }
+      if( !matched ) {
+        return confirm("<?=tr("You have not set a 'Project' type, projects will not work correctly.  Choose 'cancel' to try again.")?>");
+      }
+      return true;
+    }
+  </script>
 <? } ?>
-	
       <ul>
-      <form name='configForm' action='<?=$SCRIPT_NAME?>' method='post'>
+      <form name='configForm' action='<?=$SCRIPT_NAME?>' <?=$type=='type'? " onsubmit='return checkPriType(this)'":""?> method='post'>
       <table cellpadding="2" cellspacing="1" class='plainCell'>
-	 <tr>
-	 <td class='titleCell' align='center' colspan='4'>
-	   <b><?=tr("Edit the Active ?s",array(ucfirst($type)))?></b>
+	 <tr toofar="toofar">
+	 <td class='titleCell' align='center' colspan='5'>
+     <?
+       $plural_type = tr($type == 'priority'? 'Priorities' : ucfirst($type)."s");
+     ?>
+	   <b><?=tr("Edit the Active ?",array($plural_type))?></b>
 	 </td>
 	 </tr>
-	 <tr>
+	 <tr toofar="toofar">
 	 <td width="30" class='cell' align='center'><b><?=tr("ID")?></b></td>
 	 <td class='cell' align='center'><b><?=tr("Name")?></b></td>
-	 <td width="30" class='cell' align='center'><b><?=tr("Order")?></b></td>
 	 <td width="30" class='cell' align='center'><b><?=tr("Active")?></b></td>
+	 <td width="30" class='cell' align='center'><b>&nbsp;</b></td>
 	 </tr>
     <? 
-         $js_vals = array();
-         $num = count($vars) + $more;
+   $j = count($vars)-1;
 	 if( is_array($vars) ) {
 	   $newtext = "-".tr("new")."-";
-	   $j = 0;
 	   $t = "\t<td class='bars'>";
 	   $te = "</td>\n";
 	   foreach($vars as $v) {
-	     print "<tr>\n";
+	     print "<tr id='$j'>\n";
 	     $i = ($v["$id_type"])? $v["$id_type"] : $newtext;
-	     print "$t$i$te";
+	     
+       // id cell
+       print "$t$i$te";
+       
+       // name cell
 	     print "<input type='hidden' name='newID[$j]' value='".$v[$id_type]."'>\n";
 	     print "$t<input type='text' name='newName[$j]' "
 	       ." value='$v[name]' size='20' maxlength='25'>$te";
-	   print "$t<input name='newPri[$j]' value='"
-        .$zen->checkNum($v['priority'])."' size='4' maxlength='4'>$te\n";
-	     print "$t<input type='checkbox' name='newActive[$j]' value='1'";
+         
+       // active cell
+       print "$t<input type='checkbox' name='newActive[$j]' onclick='checkVisible(this)' value='1'";
 	     print ($v["active"])? " checked" : "";
 	     print ">$te";
+       
+       
+       // priority cell
+       $txt = $t;
+         //$txt .= '['.$v['priority'].':'.$j.']';//debug
+        // up arrow
+        $txt .= "<a href='#' onClick='moveRowUp(this.parentNode);return false;'";
+        $txt .= " border='0' alt='Move Up' title='Move Up'><img src='$rootUrl/images/icon_arrow_up.gif'";
+        $txt .= " width='16' height='16' alt='Move Up' title='Move Up' border='0'></a>";
+        // down arrow
+        $txt .= "<a href='#' onClick='moveRowDown(this.parentNode);return false;'";
+        $txt .= " border='0' alt='Move Down' title='Move Down'><img src='$rootUrl/images/icon_arrow_down.gif'";
+        $txt .= " width='16' height='16' alt='Move Down' title='Move Down' border='0'></a>";
+        // control sort ordering by tracking what order these hidden fields arrive
+        $txt .= "<input type='hidden' name='newPri[$j]' value='".($j+1)."'>";
+        
+        // add new rows
+        $txt .= "<a href='#' onClick='addRow(this);return false;'";
+        $txt .= " border='0' alt='Add Section' title='Add Section'><img src='$rootUrl/images/icon_add.gif'";
+        $txt .= " width='16' height='16' alt='Add Section' title='Add Section' border='0'></a>";
+        $txt .= $te;
+       print $txt;
+
 	     print "</tr>\n";
-	     $js_vals[] = ($v["priority"])? $v["priority"] : 0;
-	     $j++;
+	     $j--;
 	   }
 	 }
-	 for( $i=0; $i<$more; $i++ ) { 
-	   print "<tr>\n";
-	   print $t.$newtext.$te;
-	   print "<input type='hidden' name='newID[$j]' value=''>\n";
-	   print "$t<input type='text' name='newName[$j]' "
-	     ." value='' size='20' maxlength='25'>$te";
-	   print "$t<input name='newPri[$j]' value='0' size='4' maxlength='4'>$te\n";
-	   print "$t<input type='checkbox' name='newActive[$j]' value='1' checked>$te";
-	   print "</tr>\n";	   
-	   $js_vals[] = 0;
-	   $j++;
-	 }
-
+   
+   // this cannot change from here out, it has to remain as-is
+   $sampleRowId = count($vars);
+   
     ?>
-<tr>
-  <td class="titleCell" colspan="4">
-    <?=tr("Press MORE to create new rows")?>
-    <br>
-    <?=tr("Press LESS to remove blank rows")?>
-    <br>
+<tr id='aSampleRow' style="display:none;">
+  <td class='bars'><?=$newtext?></td>
+  <input type='hidden' name='newID[<?=$sampleRowId?>]' value=''>
+  <td class='bars'><input type='text' name='newName[<?=$sampleRowId?>]' value='' size='20' maxlength='25'></td>
+  <td class='bars'><input type='checkbox' name='newActive[<?=$sampleRowId?>]' value='1' checked></td>
+  <td class='bars'>
+    <input type='hidden' name='newPri[<?=$sampleRowId?>]' value='<?=$sampleRowId?>'>
+    <a href='#' onClick='moveRowUp(this.parentNode);return false;'
+      border='0' alt='Move Up' title='Move Up'><img src='<?=$rootUrl?>/images/icon_arrow_up.gif'
+      width='16' height='16' alt='Move Up' title='Move Up' border='0'></a>
+    <a href='#' onClick='moveRowDown(this.parentNode);return false;' 
+      border='0' alt='Move Down' title='Move Down'><img src='<?=$rootUrl?>/images/icon_arrow_down.gif'
+      width='16' height='16' alt='Move Down' title='Move Down' border='0'></a>
+    <a href='#' onClick='addRow(this);return false;'
+      border='0' alt='Add Section' title='Add Section'><img src='<?=$rootUrl?>/images/icon_add.gif'
+      width='16' height='16' alt='Add Section' title='Add Section' border='0'></a>
+  </td>
+</tr>    
+<tr toofar="toofar" id="submitRow">
+  <td class="titleCell" colspan="5">
     <?=tr("Press Save to save changes")?>
     <br>
     <?=tr("Press Reset to return to original values")?>
   </td>
 </tr>
-      <tr>
-	 <td class='cell' colspan='4'>
+      <tr toofar="toofar">
+	 <td class='cell' colspan='5'>
          <input type='hidden' name='TODO' value=''>
-	 <input type='submit' value='<?=uptr("More")?>' onClick='return setToDo("MORE")'>
-         &nbsp;
-         <input type='submit' value='<?=uptr("Less")?>' onClick='return setToDo("LESS")'>	
-	 &nbsp;
 	 <input type='submit' class='submit' value='<?=uptr("Save")?>' onClick='return setToDo("Save")'>
 	 &nbsp;
 	 <input type='submit' class='submitPlain' value='<?=uptr("Reset")?>' onClick='return setToDo("Reset")'>
@@ -97,22 +139,163 @@
       </table>
       </ul>
 
-      <input type='hidden' name='more' value='<?=$more?>'>
       </form>
-      <script language='javascript'>
-      var i;
-      var ci;
-      var bin = [ <?=join(",",$js_vals)?> ];
-      function setToDo(val) {
-        document.configForm.TODO.value = val;
-        return true;
+<script language='javascript'>
+var i;
+var ci;
+var rowCount = <?=$sampleRowId+1?>;
+function setToDo(val) {
+  document.configForm.TODO.value = val;
+  return true;
+}
+
+function addRow( obj ) {
+  var newName = rowCount++;
+  var newSection = document.getElementById("aSampleRow").cloneNode(true);
+  newSection.setAttribute("id",newName);
+  for(var i=0; i < newSection.childNodes.length; i++) {
+    var sect = newSection.childNodes[i];
+    if( sect.hasChildNodes() && sect.childNodes.length > 0 ) {
+      for(var j=0; j < sect.childNodes.length; j++) {
+        var c = sect.childNodes[j];
+        if( c.type == 'text' || c.type == 'checkbox' || c.type == 'hidden' ) {
+          c.setAttribute('name', c.getAttribute('name').replace('<?=$sampleRowId?>',newName));
+          s += " - new name: "+c.name+"\n";
+          if ( c.name.indexOf('newPri') == 0 ) {
+            var v1, v2;
+            v1=parseFloat(document.configForm[ "newPri[" + obj.parentNode.parentNode.id + "]" ].value);
+            var previousRow = obj.parentNode.parentNode.previousSibling;
+            while( previousRow && previousRow.nodeName != "TR" ) {
+              previousRow = previousRow.previousSibling;
+            }
+            if( !previousRow || previousRow.getAttribute("toofar") ) {
+              v2=-1.0;
+            } else {
+              v2=parseFloat(document.configForm[ "newPri[" + previousRow.id + "]" ].value);
+            }
+            v=(v1 + v2) / 2.0;
+            c.setAttribute('value',v);
+          }
+        }
       }
-      </script> 
+    }
+  }
+  obj.parentNode.parentNode.parentNode.insertBefore(newSection, obj.parentNode.parentNode);
+  newSection.style.display = "";
+}
 
+//function removeRow( obj ) {
+//  if( !confirm("Remove this Section?") ) { return; }
+//  var thisNode = obj.parentNode.parentNode;
+//  thisNode.parentNode.removeChild(thisNode);
+//}
 
+function moveRowUp( tdCell ) {
+  var v1, v2;
+  var thisRow = tdCell.parentNode;
+  quickHighlightRow( thisRow, 'subTitle' );
+  var previousRow = thisRow.previousSibling;
+  var parentNode = thisRow.parentNode;
+  while( previousRow && previousRow.nodeName != "TR" ) {
+    previousRow = previousRow.previousSibling;
+  }
+  if( !previousRow || previousRow.getAttribute("toofar") ) {
+    parentNode.insertBefore(thisRow, document.getElementById("submitRow"));
+    //As this is now the last row, we can get the orderset value of it's new previous row
+    previousRow = thisRow.previousSibling;
+    while( (previousRow && previousRow.nodeName != "TR") || (previousRow && previousRow.id === "section0") ) {
+      previousRow = previousRow.previousSibling;
+    }
+    //And set the current row's orderset value to it's previous row orderset value - 1
+    v1=parseFloat(document.configForm[ "newPri[" + previousRow.id + "]" ].value);
+    document.configForm[ "newPri[" + thisRow.id + "]" ].value=v1-1;
+    return;
+  }
+  parentNode.insertBefore(thisRow, previousRow);
+  //If it didn't cross the edge of the table, we just swap the orderset values:
+  v1=parseFloat(document.configForm[ "newPri[" + thisRow.id + "]" ].value);
+  v2=parseFloat(document.configForm[ "newPri[" + previousRow.id + "]" ].value);
+  document.configForm[ "newPri[" + thisRow.id + "]" ].value=v2;
+  document.configForm[ "newPri[" + previousRow.id + "]" ].value=v1;
+}
 
+function quickHighlightRow( parentObj, s ) {
+  for(var i=0; i < parentObj.childNodes.length; i++) {
+    var obj = parentObj.childNodes[i];
+    obj.id = parentObj.id + '-'+i;
+    if( obj.nodeName != "TD" ) { continue; }
+    objName = obj.id;
+    if( obj.className ) {
+      obj.className = obj.className + ' ' + s;
+      setTimeout("var x = document.getElementById('"+objName+"'); x.className = x.className.substr(0,x.className.indexOf(' "+s+"'));",500);
+    }
+    else {
+      obj.setAttribute('class', obj.getAttribute('class') + ' ' + s);
+      setTimeout("var x = document.getElementById('"+objName+"'); x.setAttribute('class', x.getAttribute('class').substr(0,x.getAttribute('class').indexOf(' "+s+"')));",500);
+    }
 
+  }
+}
 
+function moveRowDown( tdCell ) {
+  var v1, v2;
+  var thisRow = tdCell.parentNode;
+  quickHighlightRow( thisRow, 'subTitle' );
+  var nextRow = thisRow.nextSibling;
+  var parentNode = thisRow.parentNode;
+  //while( nextRow && nextRow.nodeName != "TR" ) {
+  while( (nextRow && nextRow.nodeName != "TR") || (nextRow && nextRow.id === "section0") ) {
+    nextRow = nextRow.nextSibling;
+  }
+  if( !nextRow || nextRow.getAttribute("toofar") ) {
+    nextRow = thisRow;
+    thisRow = parentNode.firstChild;
+    while( thisRow.nodeName != "TR" || thisRow.getAttribute("toofar") ) {
+      thisRow = thisRow.nextSibling;
+    }
+    //We set the current row's orderset value to the first row's orderset + 1
+    v1=parseFloat(document.configForm[ "newPri[" + thisRow.id + "]" ].value);
+    document.configForm[ "newPri[" + nextRow.id + "]" ].value=v1+1;
+  } else {
+    //We swap the orderset values:
+    v1=parseFloat(document.configForm[ "newPri[" + thisRow.id + "]" ].value);
+    v2=parseFloat(document.configForm[ "newPri[" + nextRow.id + "]" ].value);
+    document.configForm[ "newPri[" + thisRow.id + "]" ].value=v2;
+    document.configForm[ "newPri[" + nextRow.id + "]" ].value=v1;
+  }
+  parentNode.insertBefore(nextRow, thisRow);
+}
 
+function toggleRowColor( checkBox ) {
+    // navigate to the TR tag for this row
+    var trTag = checkBox.parentNode.parentNode;
+
+    for(var i=0; i < trTag.childNodes.length; i++) {
+      var obj = trTag.childNodes[i];
+      if( obj.nodeName != "TD" ) { continue; }
+      // perform the class switch
+      if( obj.className ) {
+        // determine what we are setting the style to based on checkbox
+        obj.className = checkBox.checked?
+          obj.className.substr(0, obj.className.indexOf(" ")) + " bold" :
+          obj.className.substr(0, obj.className.indexOf(" ")) + " disabled";
+      }
+      else {
+        // determine what we are setting the style to based on checkbox
+        var oldStyle = obj.getAttribute('class');
+        obj.setAttribute('class', checkBox.checked?
+          oldStyle.substr(0, oldStyle.indexOf(" "))+" bold" :
+          oldStyle.substr(0, oldStyle.indexOf(" "))+" disabled" );
+      }
+    }
+}
 
+  function checkVisible( obj ) {
+    toggleRowColor( obj );
+    return true;
+  }
 
+  function getNamePrefix( name ) {
+    return name.substr(0, name.indexOf('['))
+  }
+</script>
diff -Naur zentrack_2-5-5-2/includes/templates/configSettingsForm.php zentrack_2-6-pre1/includes/templates/configSettingsForm.php
--- zentrack_2-5-5-2/includes/templates/configSettingsForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/configSettingsForm.php	2005-09-09 13:28:23.000000000 -0700
@@ -45,7 +45,7 @@
 	print "</select>\n";
       } else {
 	print "<input type='text' style='font-size:"
-	   .$zen->settings["font_size_small"]."px' name='newSettings[$k]' "
+	   .$zen->getSetting("font_size_small")."px' name='newSettings[$k]' "
            ." size='20' maxlength='100' value='".$zen->ffv($s["value"])."'>";
       }
       print "</td>";
diff -Naur zentrack_2-5-5-2/includes/templates/contactView.php zentrack_2-6-pre1/includes/templates/contactView.php
--- zentrack_2-5-5-2/includes/templates/contactView.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contactView.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,5 +1,4 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
 
   /*
   **  CONTACT VIEW
@@ -10,12 +9,71 @@
   */
 ?>
  
- <table width="640" cellspacing="1" cellpadding="2">
- <tr>
-    <td width="640" valign="top"><? include("$templateDir/contact_buttonBox.php"); ?></td>
+<table width="100%" class='barborder' cellspacing="0" cellpadding='0'>
+ <tr><td class='subTitle' align='center'>Contacts<?=$overview? " (".$zen->ffv(tr($overview)).")" : ''?></td></tr>
+  <tr>
+    <td class='indent padded' valign="top" align='center'><? include("$templateDir/contact_buttonBox.php"); ?></td>
   </tr>
+<tr>
+<td class='tbar indent tabpad lip'>
+<?
+  /*
+  ** SHOW THE NAVIGATION TABS
+  */
+  
+  print "<table cellpadding='0' cellspacing='0'><tr>\n";
+  print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
+  
+   $tabs = array(
+      "all",
+      "abc",
+      "def",
+      "ghi",     
+      "jkl",
+			"mno",
+			"pqrs",
+			"tuv",
+ 			"wxyz",
+			"!19" 
+      );
+      
+   $letters ="abcdefghijklmnopqrstuvwxyz";
+  
+  // set the page mode, for viewing tickets
+  if( $setmode && in_array($setmode, $tabs) || $setmode == 'all' ) {    
+    $page_mode = strtolower($setmode); 
+ 	} else {
+	  $page_mode = "abc";	
+ 	}
+
+  $i = 1;   
+  foreach( $tabs as $t ) {
+    $lt = strtolower($t);
+    if( $page_mode == $lt ) {
+      $class = 'class="tab on"';
+      $lclass = "tabsOn";
+    } else {
+      $class = "class='tab off' $nav_rollover_text";
+      $lclass = 'tabsOff';
+    }
+    
+    $ttl = $hotkeys->tt($t);
+    $label = $hotkeys->ll($t);
+    print "<td $class height='16' width='60' align='center' title='$ttl'>";
+    print "<a href='$rootUrl/contacts.php?setmode=$t&overview=$overview&ie=$ie' class='$lclass'>$label</a>";
+    print "</td>\n";
+    if( $i < count($tabs) ) {
+      print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
+    }
+     $i++;
+  }
+  print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
+?>
+</tr></table>
+</td>
+</tr>
   <tr>
-    <td width="640" valign="top">
+    <td valign="top" class='indent boxpad bottom'>
      <?
   		if ($setmode==all) {
 	  		include("$templateDir/contact_allBox.php");
diff -Naur zentrack_2-5-5-2/includes/templates/contact_!19Box.php zentrack_2-6-pre1/includes/templates/contact_!19Box.php
--- zentrack_2-5-5-2/includes/templates/contact_!19Box.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_!19Box.php	2005-10-20 11:23:44.000000000 -0700
@@ -11,12 +11,9 @@
 <?
 //echo $ie;
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => "<", 3 => "a"),
-);
+  $parms = array(array($title, "<", "a"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => "<", 3 => "a"),
-									2 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, "<", "a"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
diff -Naur zentrack_2-5-5-2/includes/templates/contact_allBox.php zentrack_2-6-pre1/includes/templates/contact_allBox.php
--- zentrack_2-5-5-2/includes/templates/contact_allBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_allBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,49 +1,47 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table width="645" cellpadding="0" cellspacing="0" border="0">
-<tr> 
-  <td class="ticketCell" height="300" valign="top">
-<br>
-<table width="600" align="center" cellpadding="2" cellspacing="2">
-   <tr>  
-     <td class='titleCell' align="center">
-       ALL    
-     </td>
-   </tr>  
-   <tr>
-     <td valign="top">
+
+<table width="100%" cellspacing='1' class='formtable'>
 <?
+if( $overview == 'company' ) {
+  include("$templateDir/listContactsHeading.php");
+}
+else {
+  include("$templateDir/listContacts2Heading.php");
+}
 //echo $ie;
 
 
 $sort = $title." asc";
-$ie=($overview=="intern")?2:1;
+$ie=($overview=="internal")?2:1;
+$letter = 'ALL';
   
   if ($overview=="company") {  
 		$tickets = $zen->get_contacts("",$tabel,$sort);
   } else {
-	  $parms = array(1 => array(1 => "inextern", 2 => "=", 3 => $ie)
-	  );	
+	  $parms = array(array("inextern", "=", $ie));	
 	  $tickets = $zen->get_contacts($parms,$tabel,$sort);
   }
-  
+  ?>
+    <tr>
+     <td class='headerCell' align="center" colspan='5'>
+       ALL
+     </td>
+    </tr>
+  <?  
   if( is_array($tickets) && count($tickets) ) {
-    
-	  if ($overview=="company"){
-     include("$templateDir/listContacts.php");
-    } else {
-	   include("$templateDir/listContacts2.php"); 
-    }
-   
+    $link  = "$rootUrl/contact.php";
+    $td_ttl = "title='".tr("Click here to view the Contact")."'";    
+	  
+   foreach($tickets as $t) {
+      if ($overview=="company"){
+       include("$templateDir/listContacts.php");
+      } else {
+       include("$templateDir/listContacts2.php"); 
+      }
+   }
   } else {
-     print tr("No contacts in this section.");
+      print "<tr><td class='bars' colspan='5'>".tr('No contacts found')."</td></tr>";
   }
-  $tickets = NULL;
-?>
-     </td>
-   </tr>
-</table>
-</td>
-</tr>
-</table>
 
-<br>  
\ No newline at end of file
+?>
+</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/contact_box.php zentrack_2-6-pre1/includes/templates/contact_box.php
--- zentrack_2-5-5-2/includes/templates/contact_box.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_box.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,77 +1,59 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table width="645" cellpadding="0" cellspacing="0" border="0">
-<tr> 
-<td valign="bottom">
+
+<table width="100%" cellspacing='1' class='formtable'>
 <?
+if( $overview == 'company' ) {
+  include("$templateDir/listContactsHeading.php");
+}
+else {
+  include("$templateDir/listContacts2Heading.php");
+}
+
   /*
-  ** SHOW THE NAVIGATION TABS
+  ** DETERMINE WHICH SCREEN TO SHOW AND SHOW IT
   */
-  
-  // set the page mode, for viewing tickets
-  if( $setmode ) {    
-    $page_mode = strtolower($setmode); 
- 	} else {
-	  $page_mode = "abc";	
- 	}
-
+  for($i=0; $i<strlen($page_mode); $i++) {
+    $l = substr($page_mode,$i,1);
+    $letter = strtoupper($l);
+    $n = strpos($letters,$l)+1;
+    if( $page_mode == '!19' ) {
+      $parms = array(array($title, "<", "a"));
+    }
+    else {
+      $parms = array();
+      $parms[] = array($title, ">=", $l);
+      if( $n < strlen($letters) ) {
+        $parms[] = array($title, "<", $letters{$n});
+      }
+    }
+    $sort = $title." asc";
+    if( $overview != 'company' ) {
+      $parms[] = array("inextern", "=", $ie);
+    }
+    $tickets = $zen->get_contacts($parms,$tabel,$sort);
+    ?>
+      <tr>
+       <td class='headerCell' align="center" colspan='5'>
+         <?=$letter?>
+       </td>
+      </tr>
+    <?
+    if( is_array($tickets) ) {
+      $link  = "$rootUrl/contact.php";
+      $td_ttl = "title='".tr("Click here to view the Contact")."'";
 
-  
-  print "<table cellpadding='0' cellspacing='0'><tr>\n";
-  print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
-  
-   $tabs = array(
-      "abc",
-      "def",
-      "ghi",     
-      "jkl",
-			"mno",
-			"pqrs",
-			"tuv",
- 			"wxyz",
-			"!19" 
-      );
-  
-      $i = 1;   
-  foreach( $tabs as $t ) {
-    $lt = strtolower($t);
-    if( $page_mode == $lt ) {
-      $class = 'tabOn';
-      $lclass = "tabsOn";
+     foreach($tickets as $t) {
+       if( $overview == 'company' ) {
+         include("$templateDir/listContacts.php");
+       }
+       else {
+         include("$templateDir/listContacts2.php");
+       }
+     }
     } else {
-      $class = 'tabOff';
-      $lclass = 'tabsOff';
+      print "<tr><td class='bars note' colspan='5'>".tr('No contacts for section ?', $letter)."</td></tr>";
     }
-    
-    print "<td class='$class' height='16' width='60' align='center'>";
-    print "<a href='$rootUrl/contacts.php?setmode=$t&overview=$overview&ie=$ie' class='$lclass'>$t</a></td>\n";
-    if( $i < count($tabs) ) {
-      print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
-    }
-     $i++;
   }
-print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
-?>
-</tr></table>
-</td>
-</tr>
-<tr> 
-  <td class="ticketCell" height="300" valign="top">
-  <br>  
-<?
 
-  /*
-  ** DETERMINE WHICH SCREEN TO SHOW AND SHOW IT
-  */
-  $name = "contact_".$page_mode."Box.php";
-  $name = ereg_replace("[.]{2}", "", $name);
-  // check for valid filename
-  if( !file_exists("$templateDir/$name") ) {
-    $name = "ticket_systemBox.php";
-    $this->addDebug("contact_box","Invalid filename $name declared... redirecting",1);
-  }
-  include("$templateDir/$name");
 ?>
-   <br>
-  </td>
-</tr>
-</table>
+</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/contact_buttonBox.php zentrack_2-6-pre1/includes/templates/contact_buttonBox.php
--- zentrack_2-5-5-2/includes/templates/contact_buttonBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_buttonBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,28 +1,28 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table width="120" cellpadding="0" cellspacing="0" border="0">
+<table cellpadding="0" cellspacing="0" border="0">
 <tr>
 <?
+  $hotkeys->loadSection('contacts_list');
       
       $actions = array(
 			"company",			
 			"external",		     
-			"internal",
-			"all"
+			"internal"
+			//"all"
 			);	
 
-			$st=($setmode =="all")?"abc":$setmode;
+			$st=($setmode =="all")?"abc":$zen->ffv($setmode);
 			
 	foreach($actions as $a) {
 		
 			$value = uptr($a);
-			
-			$ien=($a=="intern")?2:1;
-			$st=($a=="all")?"all":$st;
-			$ov=($a=="all")?$overview:$a;
+			$ien = ($a == "intern")? 2         : 1;
+			$st  = ($a == "all"   )? "all"     : $st;
+			$ov  = ($a == "all"   )? $overview : $a;
 				
 			print "\n<form name='".$a."_form' action='$rootUrl/contacts.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='$value' >\n";
+			print "<td width='120' align='center'>\n";
+			renderDivButtonFind(ucfirst($a));
 			print "<input type='hidden' name='ie' value='$ien'>\n";
 			print "<input type='hidden' name='setmode' value='$st'>\n";
 			print "<input type='hidden' name='overview' value='$ov'>\n";
diff -Naur zentrack_2-5-5-2/includes/templates/contact_list.php zentrack_2-6-pre1/includes/templates/contact_list.php
--- zentrack_2-5-5-2/includes/templates/contact_list.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_list.php	2005-10-20 11:23:44.000000000 -0700
@@ -5,95 +5,22 @@
 *Show the contacts that are connected to a company
 */
 
-if( is_array($contacts) ) {
-   
-		$link  = "$rootUrl/contact.php";
-   
-   foreach($contacts as $t) {      
-      ?>
-   <br>
-   <table cellpadding="0" cellspacing="0">
-  <tr>
-   <td class="ticketCell">
-   <table align="center" width='570'>     
-     <tr>
-       <td valign="top"><table border="0"
-          width="430" cellpadding="0" cellspacing="1">
-          
-    <tr>
-	   <td class="titleCell" colspan="4"><p align="center"><?= ucfirst($t["lname"]).", "; echo($t["fname"])? ucfirst($t["fname"]):ucfirst($t["initials"]);?> </p></td>  
-	  </tr>
-	  <tr>
-	   <td class="smallTitleCell" colspan="2" ><?=uptr("Info")?></td>
-	   <td class="smallTitleCell"  colspan="2" width="50%"><?=uptr("Numbers")?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"><?=tr("Jobtitle")?>:</td> 
-	   <td class="small" width="30%"><?=$t["jobtitle"]?></td>
-	   <td class="small" width="20%"><?=tr("Telephone no")?>:</td> 	   
-	   <td class="small" width="30%"><?=stripslashes($t["telephone"])?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"><?=tr("Department")?>:</td> 
-	   <td class="small" width="30%"><?=$t["department"]?></td>  
-	   <td class="small" width="20%"><?=tr("Mobile no")?>:</td>  
-	   <td class="small" width="30%"><?=stripslashes($t["mobiel"])?></td>
-	  </tr>
-	  <tr>
-	   <td class="small" width="20%"><?=tr("E-mail")?>:</td> 
-	   <td class="small" width="30%"><?if(!empty($t["email"])){?><A HREF="mailto:<?=stripslashes($t["email"])?>"><?=stripslashes($t["email"])?></A><? }?></td> 
-	   <td class="small" width="20%"></td> 
-	   <td class="small" width="30%"></td> 
-	  </tr>
-<?
- if(!empty($t["description"])) {
-?>	  
-	  <tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Commentary")?></td>  
-	  </tr>
-	  <tr>
-	   <td class="small" colspan="4"><?=(get_magic_quotes_runtime())?nl2br(stripslashes($t["description"])):nl2br($t["description"]); ?></td>
-	  </tr>
-<?
-}
+$colspan = $overview == 'extern'? 6 : 5;
 ?>
-	 </table>
-	 
-	 </td>
-   <td valign="top" width='75'>
-       
-<table width="120" cellpadding="0" cellspacing="0" border="0">
+<table width='600' cellpadding="0" cellspacing="1" class='formtable'>
+<tr><td colspan='<?=$colspan?>' class='subTitle'><?=tr("Employees")?></td></tr>
 <?
-      $idi = $t["person_id"] ;
-			
-			print "<tr>\n<form name='edit_form' action='$rootUrl/actions/contact_edit.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='EDIT'>\n";
-			print "<input type='hidden' name='pid' value='$idi'>\n";	;	
-			print "</td>\n</form>\n</tr>\n";
-
-  		print "<tr>\n<form name='delete_form' action='$rootUrl/actions/contact_delete.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='DELETE'";
-			print " onClick='return confirm(\"Are you sure you want to permanently delete this contact\")'";
-			print ">\n";
-			print "<input type='hidden' name='pid' value='$idi'>\n";
-			print "</td>\n</form>\n</tr>\n";
-?>
-</table>
-     </td>
-     </tr>
-    </table></td>
-  </tr>
-</table>
-   <?
+if( is_array($contacts) ) {
+   $show_list_options = true;
+   include("$templateDir/listContacts2Heading.php");
    
-   }      
-     
+   $link  = "$rootUrl/contact.php";
+   foreach($contacts as $t) {
+     include("$templateDir/listContacts2.php");
+   }
    
 } else {
-  
-    print "<p>&nbsp;</p><ul><b>".tr('No contacts in this section.').".</b></ul>";
+  print "<tr><td colspan='$colspan' class='bars'>".tr('No employees found').".</td></tr>";
 }
-print "<br>";  
-?>
\ No newline at end of file
+?>
+</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/contact_personBox.php zentrack_2-6-pre1/includes/templates/contact_personBox.php
--- zentrack_2-5-5-2/includes/templates/contact_personBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_personBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -4,101 +4,96 @@
 /* 
 *Show the contacts that are connected to a company
 */
+
+$hotkeys->loadSection('contacts_view_employee');
 ?>
-   <table cellpadding="0" cellspacing="0">
-  <tr>
-   <td class="ticketCell">
-   <table align="center" width='570'>     
-     <tr>
-       <td valign="top"><table border="0" width="430" cellpadding="0" cellspacing="1">      
+<table width='620'><tr><td>
+
+   <table class='formtable' width='500' cellpadding="0" cellspacing="1">
     <tr>
-	   <td class="titleCell" colspan="4"><p align="center"><?= ucfirst($lname).", "; echo($fname)? ucfirst($fname):ucfirst($initials);?> </p></td>  
+	   <td class="subTitle" colspan="4"><p align="center"><?= ucfirst($lname).", "; echo($fname)? ucfirst($fname):ucfirst($initials);?> </p></td>
 	  </tr>
 	  <tr>
-	   <td class="smallTitleCell" colspan="2" ><?=uptr("Info")?></td>
-	   <td class="smallTitleCell"  colspan="2" width="50%"><?=uptr("Numbers")?></td>
+	   <td class="headerCell" colspan="2" ><?=uptr("Info")?></td>
+	   <td class="headerCell" colspan="2" width="50%"><?=tr("Phone")?></td>
 	  </tr>
 	  <tr>
-	   <td class="small" width="20%"><?=tr("Jobtitle")?>:</td> 
-	   <td class="small" width="30%"><?=$jobtitle?></td>
-	   <td class="small" width="20%"><?=tr("Telephone no")?>:</td> 	   
-	   <td class="small" width="30%"><?=stripslashes($telephone)?></td>
+	   <td class="bars small"><?=tr("Title")?>:</td> 
+	   <td class="bars small"><?=$zen->fhv($jobtitle)?></td>
+	   <td class="bars small"><?=tr("Telephone")?>:</td> 	   
+	   <td class="bars small"><?=$zen->fhv($telephone)?></td>
 	  </tr>
 	  <tr>
-	   <td class="small" width="20%"><?=tr("Department")?>:</td> 
-	   <td class="small" width="30%"><?=$t["department"]?></td>  
-	   <td class="small" width="20%"><?=tr("Mobile no")?>:</td>  
-	   <td class="small" width="30%"><?=stripslashes($mobiel)?></td>
+	   <td class="bars small"><?=tr("Department")?>:</td> 
+	   <td class="bars small"><?=$zen->fhv($t["department"])?></td>  
+	   <td class="bars small"><?=tr("Mobile")?>:</td>  
+	   <td class="bars small" width='30%'><?=$zen->fhv($mobiel)?></td>
 	  </tr>
 	  <tr>
-	   <td class="small" width="20%"><?=tr("E-mail")?>:</td> 
-	   <td class="small" width="30%"><?if(!empty($email)){?><A HREF="mailto:<?=stripslashes($email)?>"><?=stripslashes($email)?></A><? }?></td> 
-	   <td class="small" width="20%"></td> 
-	   <td class="small" width="30%"></td> 
+	   <td class="bars small"><?=tr("E-mail")?>:</td> 
+	   <td class="bars small" width="30%"><?if($email){?>
+      <A HREF="mailto:<?=$zen->ffv($email)?>"><?=$zen->ffv($email)?></A>
+      <? } else { print '&nbsp;'; } ?>
+     </td> 
+	   <td class="bars small" colspan='2'>&nbsp;</td> 
 	  </tr>
 <?
  if(!empty($description)) {
 	 
 ?>	  
 	  <tr>
-	   <td class="smallTitleCell" colspan="4"><?=uptr("Commentary")?></td>  
+	   <td class="headerCell" colspan="4"><?=tr("Notes")?></td>  
 	  </tr>
 	  <tr>
-	   <td class="small" colspan="4"><?= 
-   (get_magic_quotes_runtime())?nl2br(stripslashes($description)):nl2br($description); 
-    ?></td>
+	   <td class="bars small" colspan="4"><?= $zen->ffvText($description) ?></td>
 	  </tr>
 <?
 }
 ?>
-	 </table>
-	 
-	 </td>
-   <td valign="top" width='75'>
+</table>
+
+</td><td align='left' valign='top'>
        
-<table width="120" cellpadding="0" cellspacing="0" border="0">
+<table width="120" cellpadding="0" cellspacing="3" border="0">
 <?
-			//1=show ADD 0=don't show ADD
-      $idi = $person_id ;
-			
-			print "<tr>\n<form name='edit_form' action='$rootUrl/actions/contact_edit.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='EDIT'>\n";
-			print "<input type='hidden' name='pid' value='$idi'>\n";	
-			print "</td>\n</form>\n</tr>\n";
+    //1=show ADD 0=don't show ADD
+    $idi = $person_id ;
+    
+    print "<tr>\n<form name='edit_form' action='$rootUrl/actions/contact_edit.php'>\n";
+    print "<td>\n";
+    renderDivButtonFind("Edit");
+    print "<input type='hidden' name='pid' value='$idi'>\n";	
+    print "</td>\n</form>\n</tr>\n";
 
-  		print "<tr>\n<form name='delete_form' action='$rootUrl/actions/contact_delete.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='DELETE'"; 
-			print " onClick='return confirm(\"Are you sure you want to permanently delete this contact\")'";
-			print ">\n";
-			print "<input type='hidden' name='pid' value='$idi'>\n";		
-			print "</td>\n</form>\n</tr>\n";
-      
-			if(!$company_id) {
-			print "<tr>\n<form name='edit_form' action='$rootUrl/contact.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' $style value='VIEW TICKETS'>\n";
-			print "<input type='hidden' name='pid' value='$idi'>\n";
-			print "<input type='hidden' name='overview' value='tickets'>\n";	
-			print "</td>\n</form>\n</tr>\n";
-		}
+    print "<tr>\n<form name='delete_form' action='$rootUrl/actions/contact_delete.php'>\n";
+    print "<td>\n";
+    renderDivButtonFind("Delete");
+    print "<input type='hidden' name='pid' value='$idi'>\n";		
+    print "</td>\n</form>\n</tr>\n";
+    
+    print "<tr>\n<form name='view_form' action='$rootUrl/contact.php'>\n";
+    print "<td>\n";
+    renderDivButtonFind("View Tickets");
+    print "<input type='hidden' name='pid' value='$idi'>\n";
+    print "<input type='hidden' name='overview' value='tickets'>\n";	
+    print "</td>\n</form>\n</tr>\n";
 ?>
 </table>
-     </td>
-     </tr>
-    </table></td>
-  </tr>
-</table>
+</td></tr></table>
 <br>
 <?
 if($company_id) {
-  $contacts = $zen->get_contact($company_id,"ZENTRACK_COMPANY","company_id");
-  if( is_array($contacts) ) {
-      extract($contacts);
-      $id = $company_id;
-      include("$templateDir/contact_titleBox.php");
-    }
-		
+  print "<table width='620' class='formtable'>";
+  print "<tr><td class='subTitle' colspan='6'>Company</td></tr>";
+  $t = $zen->get_contact($company_id,"ZENTRACK_COMPANY","company_id");
+  if( is_array($t) ) {
+    //extract($contacts);
+    //$id = $company_id;
+    //include("$templateDir/contact_titleBox.php");
+    $cssStyle = 'headerCell';
+    include("$templateDir/listContactsHeading.php");
+    include("$templateDir/listContacts.php");
+  }
+  print "</table><br>";
 }
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/contact_titleBox.php zentrack_2-6-pre1/includes/templates/contact_titleBox.php
--- zentrack_2-5-5-2/includes/templates/contact_titleBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_titleBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,64 +1,63 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table cellpadding="0" cellspacing="0">
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+   $hotkeys->loadSection('contacts_view');
+?>
+<table cellpadding="0" width='600' cellspacing="1">
   <tr>
-   <td class="ticketCell"><table 
-     align="center" width='570'>     
+   <td><table
+     align="center" width='100%'>     
      <tr>
        <td valign="top"><table border="0"
-          width="440" cellpadding="2" cellspacing="1">
+          width='100%' class='formtable' cellpadding="0" cellspacing="1">
           
     <tr>
-	   <td class="titleCell" colspan="3"><p align="center"><? echo strtoupper($title)." "; if(!empty($office)){ echo stripslashes($office);}?> </p></td>  
+	   <td class="subTitle" colspan="3"><p align="center"><? echo $zen->ffv($title)." "; if(!empty($office)){ echo "[".$zen->ffv($office)."]";}?> </p></td>  
 	  </tr>
 	  <tr>
-	   <td class="smallTitleCell" colspan="2" width="50%"><?=uptr("Info")?></td>
-	   <td class="smallTitleCell"  width="50%"><?=uptr("Address")?></td>
+	   <td class="headerCell" colspan="2" width="50%"><?=uptr("Info")?></td>
+	   <td class="headerCell"  width="50%"><?=uptr("Address")?></td>
 	  </tr>
 	  <tr>
-	   <td class="small" colspan="2">
+	   <td class="bars indent boxpad" colspan="2">
 	   <? 
-	   if(!empty($office)){ echo stripslashes($office)."<br>";}
-	   if(!empty($email)){?><A HREF="mailto:<?=stripslashes($email)?>"><?=stripslashes($email)?></A><br><?}
+	   if(!empty($office)){ echo $zen->ffv($office)."<br>";}
+	   if(!empty($email)){?><A HREF="mailto:<?=$zen->ffv($email)?>"><?=$zen->ffv($email)?></A><br><?}
 	   if ($website == "http://" or $website == "") {
 		 echo "<br>";  
 		 } else {
-	   if(!empty($website)){?><A TARGET="_blank" HREF="<?=stripslashes($website)?>"><?=stripslashes($website)?></A><?}}?>
+	   if(!empty($website)){?><A TARGET="_blank" HREF="<?=$zen->ffv($website)?>"><?=$zen->ffv($website)?></A><?}}?>
 	   </td>
-	   <td class="small" rowspan="4">
+	   <td class="bars small" rowspan="4">
 	   <?
-	   if(!empty($address1)){ echo stripslashes($address1)."<br>";}
-	   if(!empty($address2)){ echo stripslashes($address2)."<br>";}
-	   if(!empty($address3)){ echo stripslashes($address3)."<br>";}
-	   if(!empty($postcode)){ echo stripslashes($postcode)."<br>";}
-	   if(!empty($place)){ echo stripslashes($place)."<br>";}
-	   if(!empty($pobox)){ echo stripslashes($pobox)."<br>";}
-	   if(!empty($postcode2)){ echo stripslashes($postcode2)."<br>";}
-	   if(!empty($country)){ echo stripslashes($country);}
+	   if(!empty($address1)){ echo $zen->ffv($address1)."<br>";}
+	   if(!empty($address2)){ echo $zen->ffv($address2)."<br>";}
+	   if(!empty($address3)){ echo $zen->ffv($address3)."<br>";}
+	   if(!empty($postcode)){ echo $zen->ffv($postcode)."<br>";}
+	   if(!empty($place)){ echo $zen->ffv($place)."<br>";}
+	   if(!empty($pobox)){ echo $zen->ffv($pobox)."<br>";}
+	   if(!empty($postcode2)){ echo $zen->ffv($postcode2)."<br>";}
+	   if(!empty($country)){ echo $zen->ffv($country);}
 	   ?>
 	   </td>
 	  </tr>
 	  <tr>
-	   <td class="smallTitleCell" colspan="2"><?=uptr("Numbers")?></td> 
-	   <td class="small"></td>
+	   <td class="headerCell" colspan="2"><?=uptr("Numbers")?></td> 
 	  </tr>
 	  <tr>
-	   <td class="small" width="100"><?=tr("Telephone no")?>:</td>  
-	   <td class="small"><?=stripslashes($telephone)?></td>
-	   <td class="small"></td>
+	   <td class="bars small" width="20%"><?=tr("Telephone no")?>:</td>  
+	   <td class="bars small" width='30%'><?=$telephone? $zen->ffv($telephone) : '&nbsp;'?></td>
 	  </tr>
 	  <tr>
-	   <td class="small"><?=tr("Fax no")?>:</td> 
-	   <td class="small"><?=stripslashes($fax)?></td> 
-	   <td class="small"></td>
+	   <td class="bars small"><?=tr("Fax no")?>:</td> 
+	   <td class="bars small"><?=$fax? $zen->ffv($fax) : '&nbsp;'?></td> 
 	  </tr>
 	  <?
  if(!empty($description)) {
 ?>	  
 	  <tr>
-	   <td class="smallTitleCell" colspan="3"><?=uptr("Comments")?></td>  
+	   <td class="headerCell" colspan="3"><?=uptr("Comments")?></td>  
 	  </tr>
 	  <tr>
-	   <td class="small" colspan="3"><?=(get_magic_quotes_runtime())?nl2br(stripslashes($description)):nl2br($description); ?></td>
+	   <td class="bars small" colspan="3"><?= $zen->ffvText($description) ?></td>
 	  </tr>
 <?
 }
@@ -66,54 +65,40 @@
 	 </table></td>
        <td valign="top" width='75'>
        
-<table width="120" cellpadding="0" cellspacing="0" border="0">
+<table width="120" cellpadding="0" cellspacing="3" border="0">
 <?
 			
 	//1=show ADD 0=don't show ADD
       
-      $actions = array(
-			"edit"  => 0,			
-			"delete"  => 0,		     
+  //button to show open tickets
+  		print "<tr><td>";
+      renderDivButtonFind("View Tickets");
+      print "</td></tr>";
+
+   if ($overview != "agreement") {
+  	  print "<tr><td>";
+      renderDivButtonFind("View Agreements");
+      print "</td></tr>";
+	} else {
+  	  print "<tr><td>";
+      renderDivButtonFind("View Employees");
+      print "</td></tr>";
+	}
+
+  $actions = array(
 			"employee"  => 1,
-			"agreement"    => 1,
+			"agreement" => 1,
+			"edit"      => 0,			
+			"delete"    => 0
 			);	
 	//show the buttons
 	foreach($actions as $a=>$v) {
-		$value = ($v == 1)? uptr("add")." ".uptr(ucfirst($a)) : uptr(ucfirst($a));
-		
-			print "<tr>\n<form name='".$a."_form' action='$rootUrl/actions/contact_$a.php'>\n";
-			print "<td>\n";
-			print "<input type='submit' class='actionButtonContact' value='$value'"; 
-			if ($a=="delete") {print " onClick='return confirm(\"".tr('Are you sure you want to permanently delete this contact')."\")'";}
-			print ">\n";
-			print "<input type='hidden' name='cid' value='$id'>\n";
-			print "</td>\n</form>\n</tr>\n";
+		$value = ($v == 1)? "Add ".ucfirst($a) : ucfirst($a);
+		print "<tr><td>";
+    renderDivButtonFind($value);
+    print "</td></tr>";
   }
-  //button to show open tickets
-  		print "<tr>\n<form name='tickets_form' action='$rootUrl/contact.php'>\n<td>\n";
-			print "<input type='submit' class='actionButtonContact' value='".uptr('view')." ".uptr('Tickets')."'>\n"; 
-			print "<input type='hidden' name='cid' value='$id'>\n";
-			print "<input type='hidden' name='overview' value='tickets'>\n";
-			print "</td>\n</form>\n</tr>\n";
-  
-  //button to show the contacts or agreements
-  if (empty($overview)&&!isset($pid)) $overview = "contact";
   
-  if ($overview=="contact") {
-  	  print "<tr>\n<form name='contact_form' action='$rootUrl/contact.php'>\n<td>\n";
-			print "<input type='submit' class='actionButtonContact' value='".uptr('view')." ".uptr('Agreements')."'>\n"; 
-			print "<input type='hidden' name='cid' value='$id'>\n";
-			print "<input type='hidden' name='overview' value='agreement'>\n";
-			print "</td>\n</form>\n</tr>\n";
-	} else {
-			print "<tr>\n<form name='agreement_form' action='$rootUrl/contact.php'>\n<td>\n";
-			print "<input type='submit' class='actionButtonContact' value='".uptr('view')." ".uptr('Contacts')."'>\n"; 
-			print "<input type='hidden' name='cid' value='$id'>\n";
-			print "<input type='hidden' name='overview' value='contact'>\n";
-			print "</td>\n</form>\n</tr>\n";
-	}
-
-       
 ?>
 </table>
      </td>
@@ -121,4 +106,5 @@
     </table></td>
   </tr>
 </table>
+<br>
 
diff -Naur zentrack_2-5-5-2/includes/templates/contact_tuvBox.php zentrack_2-6-pre1/includes/templates/contact_tuvBox.php
--- zentrack_2-5-5-2/includes/templates/contact_tuvBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_tuvBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -11,14 +11,9 @@
 <?
 //echo $ie;
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "t"),
-								2 => array(1 => $title, 2 => "<", 3 => "u"),
-);
+  $parms = array(array($title, ">", "t"),array($title, "<", "u"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "t"),
-								2 => array(1 => $title, 2 => "<", 3 => "u"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "t"),array($title, "<", "u"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
@@ -52,14 +47,9 @@
      <td valign="top">
 <?
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "u"),
-								2 => array(1 => $title, 2 => "<", 3 => "v"),
-);
+  $parms = array(array($title, ">", "u"),array($title, "<", "v"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "u"),
-								2 => array(1 => $title, 2 => "<", 3 => "v"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "u"),array($title, "<", "v"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
@@ -92,14 +82,9 @@
      <td valign="top">
 <?
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "v"),
-								2 => array(1 => $title, 2 => "<", 3 => "w"),
-);
+  $parms = array(array($title, ">", "v"),array($title, "<", "w"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "v"),
-								2 => array(1 => $title, 2 => "<", 3 => "w"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "v"),array($title, "<", "w"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
diff -Naur zentrack_2-5-5-2/includes/templates/contact_wxyzBox.php zentrack_2-6-pre1/includes/templates/contact_wxyzBox.php
--- zentrack_2-5-5-2/includes/templates/contact_wxyzBox.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/contact_wxyzBox.php	2005-10-20 11:23:44.000000000 -0700
@@ -11,14 +11,9 @@
 <?
 //echo $ie;
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "w"),
-								2 => array(1 => $title, 2 => "<", 3 => "x"),
-);
+  $parms = array(array($title, ">", "w"),array($title, "<", "x"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "w"),
-								2 => array(1 => $title, 2 => "<", 3 => "x"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "w"),array($title, "<", "x"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
@@ -52,14 +47,9 @@
      <td valign="top">
 <?
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "x"),
-								2 => array(1 => $title, 2 => "<", 3 => "y"),
-);
+  $parms = array(array($title, ">", "x"),array($title, "<", "y"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "x"),
-								2 => array(1 => $title, 2 => "<", 3 => "y"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "x"),array($title, "<", "y"),array("inextern", "=", $ie));
 }
 
 $sort = $title." asc";
@@ -92,14 +82,9 @@
      <td valign="top">
 <?
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "y"),
-								2 => array(1 => $title, 2 => "<", 3 => "z"),
-);
+  $parms = array(array($title, ">", "y"),array($title, "<", "z"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "y"),
-								2 => array(1 => $title, 2 => "<", 3 => "z"),
-									3 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "y"),array($title, "<", "z"),array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
@@ -132,12 +117,9 @@
      <td valign="top">
 <?
 if ($overview=="company") {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "z"),
-);
+  $parms = array(array($title, ">", "z"));
 } else {
-$parms = array(1 => array(1 => $title, 2 => ">", 3 => "z"),
-									2 => array(1 => "inextern", 2 => "=", 3 => $ie)
-);	
+  $parms = array(array($title, ">", "z"), array("inextern", "=", $ie));	
 }
 
 $sort = $title." asc";
diff -Naur zentrack_2-5-5-2/includes/templates/editCustomsForm.php zentrack_2-6-pre1/includes/templates/editCustomsForm.php
--- zentrack_2-5-5-2/includes/templates/editCustomsForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/editCustomsForm.php	2005-07-04 13:57:14.000000000 -0700
@@ -62,7 +62,7 @@
        ." value='".$zen->ffv($v['field_label'])."' size='20' maxlength='50'>$te";
 	     print "$t<input type='text' name='newSortOrder[$j]' "
        ." value='".$zen->ffv($v['sort_order'])."' size='5' maxlength='5'>$te";
-	     if( strpos($i, 'menu') > 0 ) {
+	     if( strpos($i, 'menu') > 0 || strpos($i, 'multi') ) {
 	       print "$t<select name='newFieldValue[$j]'>\n";
 	       if( isset($_SESSION['data_groups']) && count($_SESSION['data_groups']) ) {
            print "<option value=''>-none-</option>\n";
diff -Naur zentrack_2-5-5-2/includes/templates/email/create.template zentrack_2-6-pre1/includes/templates/email/create.template
--- zentrack_2-5-5-2/includes/templates/email/create.template	2003-03-13 19:23:06.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/email/create.template	2005-09-09 13:28:23.000000000 -0700
@@ -48,10 +48,10 @@
 @Deadline:
 {*optional: the date can be any standard format, you may also use +1 week, +2 months, etc*}
 
-@Testing Required: [<?=($zen->settings["default_test_checked"]=="on")?"x":" "?>]
+@Testing Required: [<?=$zen->settingOn("default_test_checked")?"x":" "?>]
 {*place an x in the box if testing will be needed before closing*}
 
-@Approval Required: [<?=($zen->settings["default_aprv_checked"]=="on")?"x":" "?>]
+@Approval Required: [<?=$zen->settingOn("default_aprv_checked")?"x":" "?>]
 {*place an x in the box if approval will be required before closing*}
 
 @Details:
diff -Naur zentrack_2-5-5-2/includes/templates/fieldMapForm.php zentrack_2-6-pre1/includes/templates/fieldMapForm.php
--- zentrack_2-5-5-2/includes/templates/fieldMapForm.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/fieldMapForm.php	2005-10-21 03:59:54.000000000 -0700
@@ -1,67 +1,134 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+/**
+  PREREQUISITES:
+    $map - (ZenFieldMap) map object which can be used to retrieve default values
+    $zen - (ZenTrack)
+**/
+ 
+ $loads = ZenFieldMap::getLoadOptions($templateDir);
+ $fields = $map->getFieldMap($view);
+ 
+/**
+ * Generate a pulldown menu containing valid choices for pre/post load options
+ */
+ function renderViewPropField( $view, $vals ) {
+   global $libDir;
+   global $zen;
+   global $loads;
+   global $map;
+   $field = $vals['vm_name'];
+   $val = $map->getViewProp($view, $field);
+   $type = $vals['vm_type'];
+   switch( $type ) {
+     case "load":
+       print "<select name='{$field}[]' multiple size=5>";
+       foreach($loads as $o) {
+         $c = $val && in_array($o,$val)? ' selected' : '';
+         print "<option value='$o'$c>".tr(ucfirst($o))."</option>";
+       }
+       print "</select>";
+       break;       
+     case "access":
+       print "<select name='$field'>";
+       foreach( array('level_view','level_user','level_edit',
+                      'level_edit_varfields','level_test','level_approve',
+                      'level_super','level_contacts') as $l ) {
+         $c = $l == $val? ' selected' : '';
+         print "<option value='$l'$c>$l</option>";
+       }
+       print "</select>";
+       break;
+     case "text":
+       print "<input type='text' name='$field' value='".$zen->ffv($val)."' size='20'>";
+       break;
+     case "label":
+       if( $val == 1 || $val === 0 ) { $val = $val? 'Yes' : 'No'; }
+       print $zen->ffv($val);
+       break;
+     case "checkbox":
+       print "<input type='checkbox' name='$field' value='1'";
+       if( $val ) { print " checked"; }
+       print ">";
+       break;
+     default:
+       print "&nbsp;";
+   }
+ }
 
-  /**
-    PREREQUISITES:
-      $map - (ZenFieldMap) map object which can be used to retrieve default values
-      $fields - (array) values from $map->getFieldMap($view);
-      $zen - (ZenTrack)
-  **/
 ?>
-<br>
-<p class='error'><?
+<form method='post' action='<?=$SCRIPT_NAME?>' name='viewPickForm'>
+<input type='hidden' name='view' value='<?=$zen->ffv($view)?>'>
+<table class='microTable'><tr><td width='150' valign='top'>
+<p class='heading'><?=tr("Edit Field Map")?></p>
+<p class='note'><?
    $str = "<a href='$rootUrl/help/find.php?s=admin&p=fieldmap'>".tr('Documentation')."</a>";
    print tr("Please refer to the ? before using this feature", array($str));
  ?></p>
 
+<div class='bold'>Screen to Edit:</div>
+<select name='view' size=20
+  onchange="window.document.forms['viewPickForm'].submit()">
+<?
+$vp = $map->getViewProps();
+foreach( $vp as $k=>$v ) {
+  $sel = $view == $k? " selected" : "";
+  $l = $map->getViewProp($k,'label')? $k." (".tr($map->getViewProp($k,'label')).")" : $k;
+  print "<option value='$k'$sel>$l</option>\n";
+}
+?>
+</select>
+
+<p class='note'><?=tr("Do not switch views without saving changes!")?></p>
+
+
+</td><td>&nbsp;</td><td valign='top'>
+&nbsp;
+
+</form>
 <form method='post' action='<?=$SCRIPT_NAME?>' name='fieldMapForm'>
 <input type='hidden' name='TODO' value='save'>
 <input type='hidden' name='view' value='<?=$zen->ffv($view)?>'>
 
-<p>
-<nobr>
-<b>Screen to Edit:</b>
-&nbsp;
-<select name='view'>
 <?
-foreach( getFmViewProps() as $k=>$v ) {
-  if( !$v['disabled'] ) {
-    $sel = $view == $k? " selected" : "";
-    print "<option value='$k'$sel>$k</option>\n";
-  }
+if( !$view ) {
+  print "<div class='heading'>Please choose a view to edit</div>";
+}
+else {
+?>
+<table cellpadding='4' cellspacing='1' class='cell' border='0'>
+  <tr toofar="toofar"><td colspan='10' align='center' class='subTitle'><?=tr("Properties for ?", $view)?></td></tr>
+<?
+foreach($map->getViewProps($view) as $v) {
+  if( $v['vm_type'] == 'hidden' ) { continue; }
+  print "<tr class='bars'><td colspan='2'>".$zen->ffv($v['vm_name'])."</td><td colspan='8'>";
+  renderViewPropField($view, $v);
+  print "</td></tr>\n";
 }
 ?>
-</select>
-&nbsp;
-<input type='submit' name='switchview' onclick='return setTodo("switch")' value='GO'>
-</nobr>
-<br><span class='note'><?=tr("Do not switch views without saving changes!")?></span>
-</p>
-
-<table cellpadding="4" cellspacing="1" class='cell' border=0>
 <tr toofar="toofar">
-  <td class='titleCell' align='center' colspan='10'>
-    <b><?=tr("Edit field map for ?", $view)?></b>
+  <td class='subTitle' align='center' colspan='10'>
+    <b><?=tr("Fields for ?", $view)?></b>
   </td>
 </tr>
 <?
 if( !is_array($fields) || !count($fields) || !$map || !$view ){
-  print "<tr><td colspan='10' class='cell'>This view has no properties to configure</td></tr>\n";
+  print "<tr><td colspan='10' class='bars'>".
+     tr("This view has no fields")."</td></tr>\n";
 }
 else {
 ?>
-<tr toofar="toofar">
-  <td class='subTitle' align='center'><b><?=tr("Options")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Name")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Label")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Show")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Required")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Default")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Type")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Columns")?></b></td>
-  <td class='subTitle' align='center'><b><?=tr("Rows")?></b></td>
+<tr toofar="toofar" id="beforeFirstRow">
+  <td class='headerCell' align='center'><b><?=tr("Options")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Name")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Label")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Show")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Required")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Default")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Type")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Columns")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Rows")?></b></td>
 </tr>
-
 <?
 function fmfRow( $text, $class ) {
   print "<td class='$class'>{$text}</td>";
@@ -76,7 +143,6 @@
   return $zen->ffv($field[$key]);
 }
 
-$vprops = getFmViewProps($view);
 $fcount=0;
 $prevSection = false;
 $typeprops = getFmTypeProps();
@@ -107,7 +173,7 @@
     $txt .= " width='16' height='16' alt='Move Down' title='Move Down' border='0'></a>";
     // control sort ordering by tracking what order these hidden fields arrive
     $txt .= "<input type='hidden' name='orderset[$f]' value='$fcount'>";
-  if( $vprops['sections'] ) {
+  if( $map->getViewProp($view, 'sections') ) {
     if( $field['field_type'] == 'section' && $field['field_name'] != 'elapsed' ) {
       // remove sections
       $txt .= "<a href='#' onClick='removeRow(this);return false;'";
@@ -126,8 +192,14 @@
   // the field name (read only)
   fmfRow($field['field_name'],$class);
   // the label (text)
-  fmfRow("<input type='text' ".fmfName($f,'field_label')
-        ."value='".fmfVal($field,'field_label')."' size=15 maxlength=200>",$class);
+  if( $field['field_type'] == 'section' && 
+      ($view == 'ticket_view_top' || preg_match('@^(ticket|project)_tab_@', $view)) ) {
+    fmfRow(fmfVal($field,'field_label'),$class);
+  }
+  else {
+    fmfRow("<input type='text' ".fmfName($f,'field_label')
+          ."value='".fmfVal($field,'field_label')."' size=15 maxlength=200>",$class);
+  }
   // visibility (checkbox)
   $sel = $field['is_visible']? ' checked' : '';
   fmfRow("<input type='checkbox' ".fmfName($f, 'is_visible')
@@ -138,7 +210,7 @@
     print "<td class='altBars $s' colspan='5'>&nbsp;</td>";
   }
   else {
-    if( $vprops['view_only'] ) {
+    if( $map->getViewProp($view,'view_only') ) {
       fmfRow(tr('n/a'),$class);
     }
     else if( $view == 'search_form' ) {
@@ -153,8 +225,15 @@
     }
     // default value (text)
     $txt = "n/a";
-    if( $fprops['default'] && !$vprops['view_only'] ) {
-      if( strpos($f,'custom_menu')===0 ) {
+    if( ($fprops['default']||preg_match('@(project|ticket)_list_filters@',$view)) && !$map->getViewProp($view,'view_only') ) {
+      if( $f == 'status' ) {
+        $choices = array(''             => tr("-any-"),
+                         'OPEN,PENDING' => tr("Open")." ".tr("or")." ".tr("Pending"),
+                         'OPEN'         => tr("Open"),
+                         'PENDING'      => tr("Pending"),
+                         'CLOSED'       => tr("Closed"));
+      }
+      else if( strpos($f,'custom_menu')===0 || strpos($f,'custom_multi')===0 ) {
         // custom menus use the data groups as a selector, not a list of values
         $choices = $zen->getDataGroups();
       }
@@ -163,12 +242,19 @@
       }
       //if( $f == 'custom_menu1' ) { Zen::printArray($choices); }
       if( is_array($choices) && count($choices) ) {
-        $txt = "<select ".fmfName($f,'default_val').">";
-        if( $view != 'search_form' ) {
-          $txt .= "<option value=''>--</option>";
-        }
+        //if( $field['multiple'] ) { 
+        //  $txt = "<select name='{$f}[default_val][]' size='3' multiple>";
+        //}
+        //else {
+          $txt = "<select ".fmfName($f,'default_val')."$m>";
+        //}
         foreach($choices as $k=>$v) {
-          $sel = $field['default_val'] == $k && strlen($field['default_val']) == strlen($k)? " selected" : "";
+          if( is_array($field['default_val']) ) {
+            $sel = in_array($sel, $field['default_val'])&&strlen($sel)? ' selected' : '';
+          }
+          else {
+            $sel = $field['default_val'] == $k && strlen($field['default_val']) == strlen($k)? " selected" : "";
+          }
           $txt .= "<option value='$k'{$sel}>$v</option>";
         }
         $txt .= "</select>";
@@ -182,8 +268,8 @@
 
     // field type, not useful for fields which only have label as type
     // or for sections
-    if( count($fprops['types']) == 1 && $fprops['types'][0] == 'label' ) {
-      fmfRow($field['field_type']=='section'?'&nbsp;':fmfVal($field,'field_type'),$class);
+    if( $map->getViewProp($view,'view_only') || count($fprops['types']) == 1 && $fprops['types'][0] == 'label' ) {
+      fmfRow(fmfVal($field,'field_type'),$class);
     }
     else {
       $txt = "<select style='width:80px;' ".fmfName($f, 'field_type').">";
@@ -220,14 +306,25 @@
 }
 ?>
 <tr id='section0' style="display:none;">
-  <td class='highlight'><input type='hidden' name='orderset[section0]' value='3'><a href='#' onClick='moveRowUp(this.parentNode);return false;' border='0' alt='Move Up' title='Move Up'><img src='/images/icon_arrow_up.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='moveRowDown(this.parentNode);return false;' border='0' alt='Move Down' title='Move Down'><img src='/images/icon_arrow_down.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='removeRow(this);return false;' border='0' alt='Remove Section' title='Remove Section'><img src='/images/icon_trash.gif' width='16' height='16' alt='Remove Section' title='Remove Section' border='0'></a></td>
+  <td class='highlight'><input type='hidden' name='orderset[section0]' value='3'><a href='#' onClick='moveRowUp(this.parentNode);return false;' border='0' alt='Move Up' title='Move Up'><img src='<?=$imageUrl?>/icon_arrow_up.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='moveRowDown(this.parentNode);return false;' border='0' alt='Move Down' title='Move Down'><img src='<?=$imageUrl?>/icon_arrow_down.gif' width='16' height='16' alt='Move Up' title='Move Up' border='0'></a><a href='#' onClick='removeRow(this);return false;' border='0' alt='Remove Section' title='Remove Section'><img src='<?=$imageUrl?>/icon_trash.gif' width='16' height='16' alt='Remove Section' title='Remove Section' border='0'></a></td>
   <td class='highlight' islabel="islabel">section0</td>
   <td class='highlight'><input type='text' name='section0[field_label]' value='' size=15 maxlength=200></td>
   <td class='highlight'><input type='checkbox'  name='section0[is_visible]' value='1' onclick='return checkVisible(this)' checked></td>
   <td class='highlight' colspan='5'>&nbsp;</td>
 </tr>
-<tr id="submitRow" toofar="toofar">
-  <td class='cell' colspan='4'>
+<tr id="afterLastRow" toofar="toofar">
+  <td class='headerCell' align='center'><b><?=tr("Options")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Name")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Label")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Show")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Required")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Default")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Type")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Columns")?></b></td>
+  <td class='headerCell' align='center'><b><?=tr("Rows")?></b></td>
+</tr>
+<tr toofar="toofar">
+  <td class='subTitle' colspan='10'>
     <input type='submit' value='<?=uptr('save')?>' onClick="return setTodo('save');">
     &nbsp;
     <input type='submit' class='submitPlain' value='<?=tr('Reset')?>' onClick="return setTodo('reset');">
@@ -237,8 +334,13 @@
 <? } ?>
 
 </table>
+<? 
+  } //end if( !$view ) { ... } else { ...
+?>
 </form>
 
+</td></tr></table>
+
 <script type='text/javascript'>
 
 function setTodo( txt ) {
@@ -296,14 +398,14 @@
 function moveRowUp( tdCell ) {
   var v1, v2;
   var thisRow = tdCell.parentNode;
-  quickHighlightRow( thisRow, 'subTitle' );
+  quickHighlightRow( thisRow, 'headerCell' );
   var previousRow = thisRow.previousSibling;
   var parentNode = thisRow.parentNode;
   while( previousRow && previousRow.nodeName != "TR" ) {
     previousRow = previousRow.previousSibling;
   }
   if( !previousRow || previousRow.getAttribute("toofar") ) {
-    parentNode.insertBefore(thisRow, document.getElementById("submitRow"));
+    parentNode.insertBefore(thisRow, document.getElementById("afterLastRow"));
     //As this is now the last row, we can get the orderset value of it's new previous row
     previousRow = thisRow.previousSibling;
     while( (previousRow && previousRow.nodeName != "TR") || (previousRow && previousRow.id === "section0") ) {
@@ -343,7 +445,7 @@
 function moveRowDown( tdCell ) {
   var v1, v2;
   var thisRow = tdCell.parentNode;
-  quickHighlightRow( thisRow, 'subTitle' );
+  quickHighlightRow( thisRow, 'headerCell' );
   var nextRow = thisRow.nextSibling;
   var parentNode = thisRow.parentNode;
   //while( nextRow && nextRow.nodeName != "TR" ) {
@@ -352,7 +454,7 @@
   }
   if( !nextRow || nextRow.getAttribute("toofar") ) {
     nextRow = thisRow;
-    thisRow = parentNode.firstChild;
+    thisRow = window.document.getElementById("beforeFirstRow");
     while( thisRow.nodeName != "TR" || thisRow.getAttribute("toofar") ) {
       thisRow = thisRow.nextSibling;
     }
@@ -400,7 +502,6 @@
     var defObj = document.fieldMapForm[defName];
     var reqObj = document.fieldMapForm[reqName];
     toggleRowColor( document.fieldMapForm[namePrefix+"[is_visible]"] );
-    //if( !defObj ) { alert("crap!"); }//debug
     if( defObj && defObj.value == null && reqObj.checked ) {
       alert("You cannot hide a required field unless it has a default value.");
       return false;
@@ -411,4 +512,4 @@
   function getNamePrefix( name ) {
     return name.substr(0, name.indexOf('['))
   }
-</script>
+</script>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/fields/date.template zentrack_2-6-pre1/includes/templates/fields/date.template
--- zentrack_2-5-5-2/includes/templates/fields/date.template	2005-03-11 07:37:39.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/fields/date.template	2005-10-11 04:48:19.000000000 -0700
@@ -1,6 +1,8 @@
 
 <input type="text" name="{field_name}" size="{field_cols}" maxlength="{field_max}" value="{field_value}" 
   hascalendar="{field_name}-calendar_icon" {field_events}>
-  <img name="date_button" src='{rooturl}/images/cal.gif' 
-    onClick="popUpCalendar(this, document.{form_name}['{field_name}'], '{date_format}')"
-    alt="Select a Date" id="{field_name}-calendar_icon">
+  <a href='#' onClick="popUpCalendar(this, window.document.forms['{form_name}'].elements['{field_name}'], '{date_format}');return false"
+    title="Select a Date">
+  <img name="date_button" src='{rooturl}/images/cal.gif' alt="Select a Date"
+    id="{field_name}-calendar_icon" border='0'>
+  </a>
diff -Naur zentrack_2-5-5-2/includes/templates/fields/multihidden.template zentrack_2-6-pre1/includes/templates/fields/multihidden.template
--- zentrack_2-5-5-2/includes/templates/fields/multihidden.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/fields/multihidden.template	2005-08-02 07:12:21.000000000 -0700
@@ -0,0 +1,3 @@
+<select name='{field_name}' size='1' style='visibility: hidden;' {field_multiple} >
+{list:field_choices:"<option value='"+index+"'"+selected+">"+value+"</option>"}
+</select>
diff -Naur zentrack_2-5-5-2/includes/templates/fields/multilabel.template zentrack_2-6-pre1/includes/templates/fields/multilabel.template
--- zentrack_2-5-5-2/includes/templates/fields/multilabel.template	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/fields/multilabel.template	2005-07-19 13:38:25.000000000 -0700
@@ -0,0 +1,3 @@
+<select name='{field_name}' size='1' style='visibility: hidden;' {field_multiple} >
+{list:field_choices:"<option value='"+index+"'"+selected+">"+value+"</option>"}
+</select><div id='{field_name}LabelText'>{field_label}</div>
diff -Naur zentrack_2-5-5-2/includes/templates/fields/searchbox.template zentrack_2-6-pre1/includes/templates/fields/searchbox.template
--- zentrack_2-5-5-2/includes/templates/fields/searchbox.template	2005-01-30 23:10:03.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/fields/searchbox.template	2005-10-20 11:23:44.000000000 -0700
@@ -1,6 +1,6 @@
 
     <input type="text" name="{field_name}" size="{field_cols}" maxlength="{field_max}"
-    value="{field_value}">
+    value="{field_value}" {field_events}>
     &nbsp;<input type='button' class='searchbox' value=' ... ' 
     onClick='popupWindowScrolls("{search_url}","popupHelper",375,500)'>
   {search_text}
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/form_fields.php zentrack_2-6-pre1/includes/templates/form_fields.php
--- zentrack_2-5-5-2/includes/templates/form_fields.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/form_fields.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,71 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   * Process fields which will appear in an editable ticket form.
+   *
+   * REQUIREMENTS:
+   *   $zen - zenTrack
+   *   $map - ZenFieldMap
+   *   $formview - view we are creating (ticket_create, project_edit, ticket_tab_3, etc)
+   *   $form_name - name of the html form
+   *   $ticket - the ticket object containing values
+   *   $td - true if this is an edit form, false if it is a new ticket
+   */
+   
+  // calculate the bins which this user can access
+  $access_level = $map->getViewProp($formview, 'access_level');
+  $userBins = $zen->getUsersBins($login_id, $access_level);
+
+  if( strlen($ticket['deadline']) ) { $ticket['deadline'] = $zen->showDateTime($ticket['deadline']); }
+  if( strlen($ticket['start_date']) ) { $ticket['start_date'] = $zen->showDateTime($ticket['start_date']); }
+  if( strlen($ticket['ctime']) ) { $ticket['ctime'] = $zen->showDateTime($ticket['ctime']); }
+  if( strlen($ticket['otime']) && $td ) { $ticket['otime'] = $zen->showDateTime($ticket['otime']); }
+
+  //$formview = $td? 'ticket_edit' : 'ticket_create';
+  $context_vals = array('view' => $formview, 'form' => $form_name);
+  $fields = $map->listFieldsForView($formview);
+  $hidden_fields = array();
+  $visible_fields = array();
+  $sections = array();
+  foreach($fields as $f) {
+    $field = $map->getFieldFromMap($formview,$f);
+    if( !$field['is_visible'] ) { $hidden_fields[] = $f; }
+    else { 
+      $visible_fields[] = $f;
+      if( $field['field_type'] == 'section' ) { $sections[] = $f; }
+    }
+  }
+  
+  $context = new ZenFieldMapRenderContext($context_vals);
+  foreach($hidden_fields as $f) {
+    $context->set('field', $f);
+    $context->set('value', $ticket[$f]);
+    print $map->renderTicketField($context);
+  }
+  
+  $context = new ZenFieldMapRenderContext($context_vals);
+  $context->set('force_label', $override_as_label);
+  foreach($visible_fields as $f) {
+    $context->set('field', $f);
+    $context->set('value', $ticket[$f]);
+    if( in_array($f, $sections) ) {
+      print "<tr><td colspan='2' class='headerCell indent'>";
+      print $map->renderTicketField($context);
+      print "</td></tr>\n";
+    }
+    else {
+      print "<tr><td class='bars'>";
+      print $map->getLabel($formview, $f);
+      print "</td><td class='bars'>";
+      if( $td && $page_type == 'project' && $f == 'type_id' ) {
+        // do not allow type to be edited for projects
+        print $map->getTextValue($formview, $f, $ticket[$f]);
+      }
+      else {
+        print $map->renderTicketField($context);
+      }
+      print "</td></tr>\n";
+    }
+  }
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/groupAdd.php zentrack_2-6-pre1/includes/templates/groupAdd.php
--- zentrack_2-5-5-2/includes/templates/groupAdd.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/groupAdd.php	2005-09-09 13:28:23.000000000 -0700
@@ -11,7 +11,7 @@
 <form method="post" action="<?=$rootUrl?>/admin/<?=$url?>GroupSubmit.php" name='groupAddForm'>
 <? if( $td ) { print "<input type='hidden' name='group_id' value='".$zen->ffv($group_id)."'>\n"; } ?>
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
   <?=$blurb?>
diff -Naur zentrack_2-5-5-2/includes/templates/homebinForm.php zentrack_2-6-pre1/includes/templates/homebinForm.php
--- zentrack_2-5-5-2/includes/templates/homebinForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/homebinForm.php	2005-07-29 12:13:14.000000000 -0700
@@ -1,8 +1,7 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<form method="post" action="<?=$SCRIPT_NAME?>">
+<form method="post" action="<?=$rootUrl?>/misc/homebin.php">
 
-<blockquote>
 <table width="300" cellpadding="5">
 <tr>
   <td colspan="2" class="titleCell" align="center" height="20">
@@ -37,17 +36,11 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell" colspan="2">
-    <?=tr("Click 'Update' to change your default bin")?>
-  </td>
-</tr>
-<tr>
   <td class="bars" colspan="2">
-    <input type="submit" value="<?=tr("Update")?>" class="submit">
+    <input type="submit" value="<?=tr("Update Bin")?>" class="submit">
   </td>
 </tr>
 </table>
-</blockquote>
 
 <input type="hidden" name="TODO" value="BIN">
 </form>
diff -Naur zentrack_2-5-5-2/includes/templates/languageForm.php zentrack_2-6-pre1/includes/templates/languageForm.php
--- zentrack_2-5-5-2/includes/templates/languageForm.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/languageForm.php	2005-09-09 13:28:23.000000000 -0700
@@ -2,10 +2,9 @@
 
 <form method="post" action="<?=$rootUrl?>/misc/language.php">
 
-<blockquote>
 <table width="300" cellpadding="5">
 <tr>
-  <td colspan="2" class="titleCell" align="center" height="20">
+  <td colspan="2" class="subTitle" align="center" height="20">
     <b><?=tr("Change Your Language")?></b>
   </td>
 </tr>
@@ -27,17 +26,11 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell" colspan="2">
-    <?=tr("Click 'Update' to change your language")?>
-  </td>
-</tr>
-<tr>
   <td class="bars" colspan="2">
-    <input type="submit" value="<?=tr("Update")?>" class="submit">
+    <input type="submit" value="<?=tr("Update Language")?>" class="submit">
   </td>
 </tr>
 </table>
-</blockquote>
 
 <input type="hidden" name="TODO" value="LANG">
 </form>
diff -Naur zentrack_2-5-5-2/includes/templates/listContacts.php zentrack_2-6-pre1/includes/templates/listContacts.php
--- zentrack_2-5-5-2/includes/templates/listContacts.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/listContacts.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,69 +1,24 @@
 <?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-/*
-*Company bar to show some info
-*/
-echo $user_id;
-if( is_array($tickets) ) {
-      ?>
-        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
-      <?
-    //show title bar  
-    if ($setmode=="all"){
-	    ?>
-<td width="32" height="25" valign="middle" title="<?=tr("ID of the contact")?>" class="titleCell" >
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("ID")?></span></b></span></div>
-</td>
-
-<td height="25" valign="middle" title="<?=tr("The title of the contact")?>" class="titleCell">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Title")?></span></b></span></div>
-</td>
-
-<td height="25" valign="middle" title="<?=tr("The email of the contact")?>" class="titleCell">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("E-mail")?></span></b></span></div>
-</td>
-
-<td height="25" valign="middle" title="<?=tr("The telephone of the contact")?>" class="titleCell">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Telephone Nr.")?></span></b></span></div>
-</td>
-
-<td height="25" valign="middle" title="<?=tr("The website of the contact")?>" class="titleCell">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Website")?></span></b></span></div>
-</td>
-	    <?
-    }
-           
-		$link  = "$rootUrl/contact.php";
-   	$td_ttl = "title='".tr("Click here to view the Contact")."'";
-   
-   foreach($tickets as $t) {      
-      ?>
-   <tr  class='bars' onclick='ticketClk("<?=$link?>?cid=<?=$t['company_id']?>")' onMouseOver='mClassX(this, "cell", "hand")' onMouseOut='mClassX(this, "bars")'>
-   <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
-    <?=$t["company_id"]?>
-   </td>
-   <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
-    <?=strtoupper($t["title"])?>&nbsp;<?=strtolower($t["office"])?>
-   </td>
-   <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
-   <?=strtolower($t["email"])?>
-   </td>
-   <td height="25" width="15%" valign="middle" <?=$td_ttl?>>
-   <?=$t["telephone"]?>
-   </td>
-   <td  width="30%" valign="middle" <?=$td_ttl?>>
-   <?=strtolower($t["website"])?>
-   </td>
-   </tr>       
-   <?
-   }      
-     
-   print "</table>\n";
-   
-} else {
-  
-    print "<p>&nbsp;</p><ul><b>".tr('No contacts in this section.').".</b></ul>";
-}
-  
+  ///////////////////////////////////////////
+  // RENDER A COMPANY CONTACT
+  ///////////////////////////////////////////
 ?>
+<tr class='bars' onclick='ticketClk("<?=$link?>?cid=<?=$zen->ffv($t['company_id'])?>")' 
+  onMouseOver='if(window.document.body && mClassX){mClassX(this, "altBars", "hand");}' 
+  onMouseOut='if(window.document.body && mClassX){mClassX(this);}'>
+  <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["company_id"])?>
+  </td>
+  <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["title"])?>&nbsp;<?=$zen->ffv($t["office"])?>
+  </td>
+  <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["email"])?>
+  </td>
+  <td height="25" width="15%" valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["telephone"])?>
+  </td>
+  <td  width="30%" valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["website"])?>
+  </td>
+</tr>       
diff -Naur zentrack_2-5-5-2/includes/templates/listContacts2.php zentrack_2-6-pre1/includes/templates/listContacts2.php
--- zentrack_2-5-5-2/includes/templates/listContacts2.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/listContacts2.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,81 +1,48 @@
 <?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-/*
-*Person bar to show some info
-*/
-
-if( is_array($tickets) ) {
-      ?>
-        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
-      <?   
-    //show title bar  
-    if ($setmode=="all"){
-	    ?>
-		<td width="32" height="25" valign="middle" title="<?=tr("ID of the contact")?>" class="titleCell" >
-		<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("ID")?></span></b></span></div>
-		</td>
-
-		<td height="25" valign="middle" title="<?=tr("The name of the contact")?>" class="titleCell">
-		<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Name")?></span></b></span></div>
-		</td>
-		<?if ($overview=="extern") { ?>
-		<td height="25" valign="middle" title="<?=tr("The company of the contact")?>" class="titleCell">
-		<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Company")?></span></b></span></div>
-		</td>
-		<?}?>
-		<td height="25" valign="middle" title="<?=tr("The e-mail of the contact")?>" class="titleCell">
-		<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("E-mail")?></span></b></span></div>
-		</td>
-
-		<td height="25" valign="middle" title="<?=tr("The telephone of the contact")?>" class="titleCell">
-		<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span><?=tr("Telephone Nr.")?></span></b></span></div>
-		</td>
-	    <?
+///////////////////////////////////////////
+// RENDER A PERSON CONTACT
+///////////////////////////////////////////
+  if( !isset($show_list_options) ) { $show_list_options = false; }
+  $pid = $zen->ffv($t['person_id']);
+?>
+<tr  class='bars' onclick='ticketClk("<?=$link?>?pid=<?=$pid?>",event)' 
+  <?=$row_rollover_eff?>>
+  <td valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["person_id"])?>
+  </td>
+  <td valign="middle" <?=$td_ttl?>>
+    <?=$zen->ffv($t["lname"])?>&nbsp;<?=$zen->ffv($t["fname"])?
+      ",".$zen->ffv($t["fname"]):",".$zen->ffv($t["initials"])?>
+  </td>
+  <?if ($overview=="extern") { ?>
+    <td valign="middle" <?=$td_ttl?>><?
+    if ( isset($t["company_id"])&& $t["company_id"]>"0") {
+      $contact = $zen->get_contact($t["company_id"],"ZENTRACK_COMPANY","company_id");
+      if( is_array($contact) ) {
+        print $zen->ffv($contact['title']);
+        if ($contact['title']){
+          print $zen->ffv($contact['office']);
+        }
+      }	  
     }
-    //show the results             
-		$link  = "$rootUrl/contact.php";
-   	$td_ttl = "title='".tr("Click here to view the Contact")."'";   
-   	
-   foreach($tickets as $t) {    
-
-      ?>
-   <tr  class='priority1' onclick='ticketClk("<?=$link?>?pid=<?=$t["person_id"]?>")' onMouseOver='mClassX(this, "priority1Over", true)' onMouseOut='mClassX(this, "priority1", false)'>
-   <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
-    <?=$t["person_id"]?>
-   </td>
-   <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
-    <?=ucfirst($t["lname"])?>&nbsp;<?=($t["fname"])?",".ucfirst($t["fname"]):",".ucfirst($t["initials"])?>
-   </td>
-   <?if ($overview=="extern") { ?>
-   <td height="25" width="25%" valign="middle" <?=$td_ttl?>><?
-   	 if ( isset($t["company_id"])&& $t["company_id"]>"0") {
-	 $contact = $zen->get_contact($t["company_id"],"ZENTRACK_COMPANY","company_id");
-	  if( is_array($contact) ) {
-      echo strtoupper($contact['title']);
-      if ($contact['title']){
-	      echo " " .strtolower($contact['office']);
-      }
-    }	  
   }
-}
-   ?>
-   </td>
-   <td height="25" width="25%" valign="middle" <?=$td_ttl?>>
-   <?=$t["email"]?>
-   </td>
-   <td width="20%" valign="middle" <?=$td_ttl?>>
-   <?=strtolower($t["telephone"])?>
-   </td>
-   </tr>       
-   <?
-   }      
-   $contact= NULL;  
-   print "</table>\n";
-   
-} else {
-  
-    print "<p>&nbsp;</p><ul><b>".tr('No contacts in this section.').".</b></ul>";
-}
-  
-?>
+  ?>
+  </td>
+  <td valign="middle" <?=$td_ttl?>>
+    <?=$t['email']? $zen->ffv($t["email"]) : '&nbsp;'?>
+  </td>
+  <td width="20%" valign="middle" <?=$td_ttl?>>
+    <?=$t['telephone']? $zen->ffv($t["telephone"]) : '&nbsp;'?>
+  </td>
+  <? if( $show_list_options ) { ?>
+      <td class='bars small' width='50'>
+       <a class='pinIcon' href='<?=$rootUrl?>/actions/contact_edit.php?pid=<?=$pid?>'
+          title='<?=tr("Edit Employee")?>'><img src='<?=$imageUrl?>/16x16/pin_green.png'
+          width='16' height='16' border='0' alt='<?=tr("Edit Employee")?>'></a>
+       <a class='pinIcon' href='<?=$rootUrl?>/actions/contact_delete.php?pid=<?=$pid?>'
+          onclick='return confirm("<?=tr("Delete this contact?")?>")'
+          title='<?=tr("Delete Contact")?>'><img src='<?=$imageUrl?>/16x16/pin_red.png'
+          width='16' height='16' border='0' alt='<?=tr("Delete Contact")?>'></a>
+      </td>    
+  <? } ?>
+</tr>
diff -Naur zentrack_2-5-5-2/includes/templates/listContacts2Heading.php zentrack_2-6-pre1/includes/templates/listContacts2Heading.php
--- zentrack_2-5-5-2/includes/templates/listContacts2Heading.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/listContacts2Heading.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,27 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+  if(!isset($cssStyle) ) { $cssStyle = 'subTitle'; }
+?>
+ <tr>
+		<td valign="middle" title="<?=tr("ID of the contact")?>" class="<?=$cssStyle?>" >
+		  <?=tr("ID")?>
+		</td>
+		<td valign="middle" title="<?=tr("The name of the contact")?>" class="<?=$cssStyle?>">
+		  <?=tr("Name")?>
+		</td>
+		<?if ($overview=="extern") { ?>
+		<td valign="middle" title="<?=tr("The company of the contact")?>" class="<?=$cssStyle?>">
+		  <?=tr("Company")?>
+		</td>
+		<?}?>
+		<td valign="middle" title="<?=tr("The e-mail of the contact")?>" class="<?=$cssStyle?>">
+		  <?=tr("E-mail")?>
+		</td>
+		<td valign="middle" title="<?=tr("The telephone of the contact")?>" class="<?=$cssStyle?>">
+		  <?=tr("Telephone Nr.")?>
+		</td>
+    <? if( isset($show_list_options) && $show_list_options ) { ?>
+		<td valign="middle" class="<?=$cssStyle?>" width='50'>
+		  <?=tr("Options")?>
+		</td>
+    <? } ?>
+ </tr>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/listContactsHeading.php zentrack_2-6-pre1/includes/templates/listContactsHeading.php
--- zentrack_2-5-5-2/includes/templates/listContactsHeading.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/listContactsHeading.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,20 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+  if(!isset($cssStyle) ) { $cssStyle = 'subTitle'; }
+?><tr>
+    <td valign="middle" title="<?=tr("ID of the contact")?>" class="<?=$cssStyle?>" >
+      <?=tr("ID")?>
+    </td>
+    <td valign="middle" title="<?=tr("The title of the contact")?>" class="<?=$cssStyle?>">
+      <?=tr("Title")?>
+    </td>
+    <td valign="middle" title="<?=tr("The email of the contact")?>" class="<?=$cssStyle?>">
+      <?=tr("E-mail")?>
+    </td>
+    <td valign="middle" title="<?=tr("The telephone of the contact")?>" class="<?=$cssStyle?>">
+      <?=tr("Telephone Nr.")?>
+    </td>
+    <td valign="middle" title="<?=tr("The website of the contact")?>" class="<?=$cssStyle?>">
+      <?=tr("Website")?>
+    </td>
+  </tr>
+
diff -Naur zentrack_2-5-5-2/includes/templates/listFiltersForm.php zentrack_2-6-pre1/includes/templates/listFiltersForm.php
--- zentrack_2-5-5-2/includes/templates/listFiltersForm.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/listFiltersForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,63 @@
+<?
+  /**
+   ** APPLY FILTERS TO TICKET LISTS
+   **
+   ** This file is designed to be used with includes/listFilters.php
+   **
+   ** REQUIREMENTS
+   **    $view - the current view name
+   **    $page_type - 'ticket' or 'project'
+   **    $zen - zenTrack object
+   **    $map - ZenFieldMap object
+   **    $filter_params_withnulls - default values for form fields
+   **/
+
+  $filterview = "{$view}_filters";
+  $filtercols = $map->getFieldMap($filterview);
+  if( $filtercols && count($filtercols) > 0 ) {
+    print "<form name='ticketFilterForm' method='post'>";
+    print "<input type='hidden' name='ticketFilterForm' value='1'>";
+    print "<table width='100%'><tr>";
+    $context = new ZenFieldMapRenderContext(
+       array('form' => 'ticketFilterForm', 'view' => $filterview,
+             'events' => "onchange='window.document.ticketFilterForm.submit()'")
+    );
+    foreach($filtercols as $c=>$field) {
+      if( !$field['is_visible'] ) { continue; }
+      $v = array_key_exists($c,$filter_params_withnulls) && 
+            !is_array($filter_params_withnulls[$c])? 
+              $filter_params_withnulls[$c] : null;
+      print "<td class='small'>";
+      print $map->getLabel($filterview, $c);
+      print "&nbsp;";
+      if( $c == 'status' ) {
+        print "<select name='filterForm_status' onchange='window.document.ticketFilterForm.submit()'>";
+        $sel = !array_key_exists($c, $filter_params_withnulls) || !$filter_params_withnulls[$c]?
+          ' selected' : '';
+        print "<option value=''{$sel}>".tr("-any-")."</option>";
+        $sel = array_key_exists($c, $filter_params_withnulls) && $filter_params_withnulls[$c] == 'OPEN,PENDING'?
+          ' selected' : '';
+        print "<option value='OPEN,PENDING'{$sel}>".tr("Open")." ".tr("or")." ".tr("Pending")."</option>";
+        $sel = array_key_exists($c, $filter_params_withnulls) && $filter_params_withnulls[$c] == 'OPEN'?
+          ' selected' : '';
+        print "<option value='OPEN'{$sel}>".tr("Open")."</option>";
+        $sel = array_key_exists($c, $filter_params_withnulls) && $filter_params_withnulls[$c] == 'PENDING'?
+          ' selected' : '';
+        print "<option value='PENDING'{$sel}>".tr("Pending")."</option>";
+        $sel = array_key_exists($c, $filter_params_withnulls) && $filter_params_withnulls[$c] == 'CLOSED'?
+          ' selected' : '';
+        print "<option value='CLOSED'{$sel}>".tr("Closed")."</option>";
+        print "</select>\n";
+      }
+      else {
+        $context->set('field', $c);
+        $context->set('name',  "filterForm_{$c}");
+        $context->set('value', $v);
+        print $map->renderTicketField($context);
+      }
+      print "</td>";
+    }
+    print "</tr></table>\n";
+    print "</form>";
+  }
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/listTickets.php zentrack_2-6-pre1/includes/templates/listTickets.php
--- zentrack_2-5-5-2/includes/templates/listTickets.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/listTickets.php	2005-10-20 11:23:44.000000000 -0700
@@ -5,18 +5,90 @@
    PREREQUISITES:
      (ZenFieldMap)$map - contains properties for fields
      (string)$view - the current view (probably project_list or ticket_list)
-     (array)$fields - [optional]properties for fields to be rendered, obtained from ZenFieldMap::getFieldMap( view )
      (string)$page_type - (optional) either 'ticket' or 'project'
      (array)$tickets - list of tickets to be displayed, as retrieved from zenTrack::get_tickets()
   **/
   
+  $right_aligned = '@^(elapsed|est_hours|wkd_hours|custom_number)@';
+  
+$show_totals = $map->getViewProp($view, 'show_totals');
 if( !$page_type )
   $page_type = "ticket";
-  
-$fields = $map->getFieldMap($view);
+
+if( $view == 'contact_list' ) { $fields = $map->getFieldMap('ticket_list'); }
+else { $fields = $map->getFieldMap($view); }
+$atc = 0;
+
+// creates the $sortby variable describing how columns will be sorted
 include_once("$libDir/sorting.php");
-  
+
+// create ticket list using filters (if applicable)
+if( $view == 'ticket_list' || $view == 'project_list' ) {
+  $sm =& $zen->getSessionManager();
+  // creates the $params array specifying how we will filter tickets
+  include("$libDir/listFilters.php");
+  // retrieves the list of tickets filtered and sorted
+  $tickets = $zen->get_tickets($filter_params,$sortstring);
+  // total records in list
+  $atc = $zen->total_records;
+  // create the form for filtering results
+  include("$templateDir/listFiltersForm.php");
+}
+
+if( $view == 'contact_list' ) { $view = 'ticket_list'; }
+
+if( $ticket && !$atc ) {
+  if( isset($ticket['total_children']) ) {
+    $atc = $ticket['total_children'];
+  }
+}
+
+$locale = localeconv();
+$dec = $locale['decimal_point'];
+$sep = $locale['thousands_sep'];
+$len = $zen->getSetting('worked_hours_decimal');
+$cols = 0;
+$est_col = 0;
+$wkd_col = 0;
+
 if( is_array($tickets) && count($tickets) ) {
+  $c = count($tickets);
+  foreach($fields as $f=>$field) {
+    if ( $field['is_visible'] ) {
+      $cols++;
+      if( $f == 'est_hours' ) { $est_col = $cols; }
+      else if( $f == 'wkd_hours' ) { $wkd_col = $cols; }
+    }
+  }
+  
+  if( $show_totals ) { $cols++; }
+
+  $numtoshow = $zen->getSetting('paging_max_rows');
+  $pageNumber = array_key_exists('pageNumber', $_GET)?
+                $zen->checkNum($_GET['pageNumber']) : 0;
+
+  /***
+  $ata = NULL;
+  if ( strpos($view,"search_list")===0 ) {
+    $ata = $zen->search_tickets($params, "AND", "0", join(',',$orderby), 0) ;
+    if (is_array($ata)) {
+      $atc = count($ata);
+      unset($ata);
+    } else {
+      $atc= 0;
+    }
+  } else {
+    $atc = $zen->count_tickets($params);
+  }
+  ***/
+  if ( $atc > 0 ) {
+    $t_from = $pageNumber*$numtoshow+1;
+    $t_to = $t_from + $c -1;
+  } else {
+    $t_from = 0;
+    $t_to = 0;
+  }
+  
 ?>
 <script type='text/javascript'>
 function resortListPage( sortName ) {
@@ -26,14 +98,33 @@
   document.searchModifyForm.submit();
   return false;
 <? } else { ?>
-  s = window.location.href;
-  s += s.indexOf('?') > 0? '&newsort='+sortName : '?newsort='+sortName;
+  var s = window.location.href;
+  if( s.indexOf('newsort=') > 0 ) {
+    s = s.replace(/newsort=[^&]+/, "newsort="+sortName);
+  }
+  else {
+    s += s.indexOf('?') > 0? '&newsort='+sortName : '?newsort='+sortName;
+  }
   window.location = s;
 <? } ?>
 }
 </script>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
-   <tr bgcolor="<?=$zen->settings["color_title_background"]?>">
+<table width="100%" cellspacing='1' cellpadding='2'>
+<?
+$atc_text = $atc > 1? tr("Tickets ?-? of ?",array($t_from,$t_to,$atc)) : "";  
+if( $view == 'project_tasks' ) {
+  print "<tr><td colspan='$cols' class='subTitle'>".tr("Tasks for this project")
+    .($atc_text? " ($atc_text)":"")."</td></tr>";
+}
+else if ($atc_text) {
+  print "<tr><td class='subTitle' colspan='$cols' align='center'>$atc_text</td></tr>\n";
+}
+else {
+  print "<tr><td class='subTitle' colspan='$cols' align='center'>".tr("Ticket List")
+      .($atc_text? " ($atc_text)":"")."</td></tr>\n";
+}
+?>
+   <tr>
 <?
   // print some table headings
   $custom_field_list = array(); //store these for later
@@ -43,11 +134,11 @@
 
     $tf = tr($map->getLabel($view,$f));
     $sn = in_array($f, $orderby)? "$f DESC" : $f;
-    print "<td width='32' height='25' valign='middle' ";
+    print "<td valign='middle' ";
     if( getFmFieldProps($view, $f) ) {
-      print "onclick='resortListPage(\"$sn\")' $nav_rollover_eff ";
+      print "onclick='resortListPage(\"$sn\")' $heading_rollover ";
     }
-    print " title='".$zen->ffv($tf)."' class='titleCell'><span class='small'>$tf</span></td>\n";
+    print " title='".$zen->ffv($tf)."' class='headerCell'>$tf</td>\n";
     
     // store information about field types
     if( strpos($f, 'custom_') === 0 && $field['is_visible'] ) {
@@ -55,6 +146,14 @@
     }
   }
   
+  if( $show_totals ) {
+    ?>
+      <td width="40" height="25" valign="middle" title="<?=tr("Percent completed")?>" class='headerCell'>
+        <?=tr("%")?>
+      </td>
+    <?    
+  }
+  
   // close the row
   print "</tr>\n";
 
@@ -95,10 +194,29 @@
     }
   }
 
-   $td_ttl = "title='".tr("Click here to view the ?", array($page_type))."'";
+   $td_ttl = "title='".tr("Click here to view the ?", array(tr(ucfirst($page_type))))."'";
+   $ttl_est = 0;
+   $ttl_wkd = 0;
+   $ttl_ext = "";
    foreach($tickets as $t) {
-      $row = $zen->settings["color_background"];
-      
+     $est = null;
+     $wkd = null;
+     $per = "n/a";
+     if( $show_totals ) {
+        // calculate the total hours
+        // and format the ticket's hours
+        list($est,$wkd,$ext) = $zen->getTicketHours($t["id"]);
+        $ttl_est += $est;
+        $ttl_wkd += $wkd;
+        $ttl_ext += $ext;
+        if( !strlen($est) )
+          $est = "n/a";
+        if( $wkd <= 0 ) { $wkd = 0; }
+        if( $est > 0 ) {
+          $per = round($zen->percentWorked($est,$wkd),1).tr("%");
+        }
+     }
+
       // create special url for projects
       if( $zen->inProjectTypeIDs($t["type_id"]) ) {
          $link = $projectUrl;
@@ -110,11 +228,11 @@
       if( $t["status"] == 'CLOSED' ) {
         $classxText = "class='bars' onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' $rollover_greytext";
       }
-      else if( $zen->settings["priority_medium"] ) {
+      else if( $zen->getSetting("priority_medium") ) {
         $classxText = "class='priority{$t['priority']}' "
          ."onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' "
-         ."onMouseOver='mClassX(this, \"priority{$t['priority']}Over\", true)' "
-         ."onMouseOut='mClassX(this, \"priority{$t['priority']}\", false)'";
+         ."onMouseOver='if(window.document.body && mClassX){mClassX(this, \"priority{$t['priority']}Over\", true);}' "
+         ."onMouseOut='if(window.document.body && mClassX){mClassX(this, \"priority{$t['priority']}\", false);}'";
       }
       else {
         $classxText = "class='cell' onclick='ticketClk(\"{$link}?id={$t['id']}\"); return false;' $rollover_text";
@@ -127,7 +245,7 @@
       foreach($fields as $f=>$field) {
         // skip hidden fields
         if( !$field['is_visible'] ) { continue; }
-        $align = $f == 'elapsed'? 'align="right"' : '';
+        $align = preg_match($right_aligned, $f)? 'align="right"' : '';
         print "<td height='25' valign='middle' $align $td_ttl>";
         print "<a class='rowLink' href='$link?id={$t['id']}'>";
         if( $f == 'user_id' || $f == 'creator_id' ) {
@@ -145,14 +263,23 @@
         print "</a></td>\n";
       }
       
+      if( $show_totals ) {
+        print "<td align='right'>$per</td>";
+      }
+      
       // close the row
       print "</tr>";
    }
    
+   if( $show_totals ) {
+     $totals_titlebar_txt = tr('Totals:');
+     include("$templateDir/totalsBar.php");
+   }
+   
    if( strpos($view, 'search')===0 ) {
 ?>
    <tr>
-       <td colspan="<?= 9+$vfcount ?>" class="titleCell">
+       <td colspan="<?= $cols ?>" class="subTitle">
        <nobr>
        <form method="post" action="search.php" name='searchModifyForm' style="display: inline; margin: 0px;">
           <input type="submit" class="smallSubmit" value="<?=tr("Modify Search")?>">
@@ -160,6 +287,7 @@
           <input type='hidden' name='newsort' value=''>
           <input type="hidden" name="search_text" value="<?=$zen->ffv($search_text)?>">
           <?
+          if( is_array($search_params) ) {
            foreach($search_params as $k=>$v) {
              if( is_array($v) ) {
                foreach($v as $val) {
@@ -179,12 +307,14 @@
            if( $or_higher ) {
              print "<input type='hidden' name='or_higher' value='1'>\n";
            }
+          }
            ?>
      </form>
      <form method="post" action="exportSearch.php" style="display: inline; margin: 0px;">
           <input type="submit" class="smallSubmit" value="<?=tr("Export Results")?>">
           <input type="hidden" name="search_text" value="<?=$zen->ffv($search_text)?>">
           <?
+          if( is_array($search_params) ) {
            foreach($search_params as $k=>$v) {
              if( is_array($v) ) {
                foreach($v as $val) {
@@ -195,15 +325,20 @@
                print "<input type='hidden' name='search_params[$k]' value='".$zen->ffv($v)."'>\n";
              }
            }
+         }
+         if( is_array($search_dates) ) { 
            foreach($search_dates as $k=>$v) {
              print "<input type='hidden' name='search_dates[$k]' value='".$zen->ffv($v)."'>\n";
            }
+         }
+         if( is_array($search_fields) ) {
            foreach($search_fields as $k=>$v) {
              print "<input type='hidden' name='search_fields[$k]' value='".$zen->ffv($v)."'>\n";
            }
-           if( $or_higher ) {
-             print "<input type='hidden' name='or_higher' value='1'>\n";
-           }
+         }
+         if( $or_higher ) {
+           print "<input type='hidden' name='or_higher' value='1'>\n";
+         }
          ?>
         </nobr>
        </form>
@@ -212,6 +347,30 @@
 <?
    }
    
+   if( $atc > 0 ) {
+     $hotkeys->loadSection('paging');
+     if( $show_totals ) {
+       $totals_titlebar_txt = tr("Grand Total");
+       list($ttl_est,$ttl_wkd,$ttl_ext) = $zen->getTicketHours($id);
+       include("$templateDir/totalsBar.php");
+     }
+?>
+
+<!--- BEGIN Paging --->
+<tr>
+   <td  align="right" valign='bottom' colspan='<?=$cols?>' class='subTitle'>
+     <?
+       $links = $zen->get_links("all", "off", $atc);
+       for ($y = 0; $y < count($links); $y++) {
+          echo $links[$y] . "&nbsp;&nbsp;";
+       }
+     ?>
+   </td>
+</tr>
+<!--- END Paging --->
+
+<?
+   }
    print "</table>\n";
    
 } else {
diff -Naur zentrack_2-5-5-2/includes/templates/listTickets_workFormat.php zentrack_2-6-pre1/includes/templates/listTickets_workFormat.php
--- zentrack_2-5-5-2/includes/templates/listTickets_workFormat.php	2005-05-01 23:59:37.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/listTickets_workFormat.php	2005-10-20 11:23:44.000000000 -0700
@@ -5,34 +5,34 @@
 if( is_array($tickets) ) {
  
       ?>
-        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
-   <tr bgcolor="<?=$zen->settings["color_title_background"]?>">
+        <table width="100%" class='formtable' cellspacing='1'>
+   <tr bgcolor="<?=$zen->getSetting("color_title_background")?>">
    <td width="32" height="25" valign="middle" title="<?=tr("ID of the ?",array($page_type))?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
    </td>
    <td height="25" valign="middle" title="<?=tr("Name of the ?",array($page_type))?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Title")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Title")?></span></b></span></div>
    </td>
    <td width="32" height="25" valign="middle" title="<?=tr("Importance of the ?",array($page_type))?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Pri")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Pri")?></span></b></span></div>
    </td>
    <td width="32" height="25" valign="middle" title="<?=tr("The type of ticket")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Type")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Type")?></span></b></span></div>
    </td>
    <td width="40" height="25" valign="middle" title="<?=tr("Who the ? belongs to",array($page_type))?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Owner")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Owner")?></span></b></span></div>
    </td>
         <td width="40" height="25" valign="middle" title="<?=tr("Estimated time to complete")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Status")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Status")?></span></b></span></div>
         </td>     
         <td width="40" height="25" valign="middle" title="The estimated time to complete this <?=$page_type?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Est Hrs")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Est Hrs")?></span></b></span></div>
         </td>
         <td width="40" height="25" valign="middle" title="<?=tr("Amount of time worked")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Worked")?></span></b></span></div>     
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Worked")?></span></b></span></div>     
         </td>     
         <td width="40" height="25" valign="middle" title="<?=tr("Percent completed")?>">
-          <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("%")?></span></b></span></div>     
+          <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("%")?></span></b></span></div>     
         </td>
    </tr>
       <?      
@@ -52,11 +52,11 @@
       if( $t["status"] == 'CLOSED' ) {
         $classxText = "class='bars' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_greytext";
       }
-      else if( $zen->settings["priority_medium"] ) {
+      else if( $zen->getSetting("priority_medium") ) {
         $classxText = "class='priority{$t['priority']}' "
          ."onclick='ticketClk(\"{$link}?id={$t['id']}\")' "
-         ."onMouseOver='mClassX(this, \"priority{$t['priority']}Over\", true)' "
-         ."onMouseOut='mClassX(this, \"priority{$t['priority']}\", false)'";
+         ."onMouseOver='if(window.document.body && mClassX){mClassX(this, \"priority{$t['priority']}Over\", true);}' "
+         ."onMouseOut='if(window.document.body && mClassX){mClassX(this, \"priority{$t['priority']}\", false);}'";
       }
       else {
         $classxText = "class='cell' onclick='ticketClk(\"{$link}?id={$t['id']}\")' $rollover_text";
@@ -69,16 +69,16 @@
       $ttl_wkd += ($wkd > $est)? $est : $wkd;
       $ttl_ext += ($wkd > $est)? $wkd - $est : 0;
       if( !strlen($est) )
-   $est = "n/a";
+      $est = "n/a";
       if( $wkd <= 0 )
-   $wkd = 0;
+      $wkd = 0;
       if( $zen->inProjectTypeIDs($t["type_id"]) ) {   
-   $link = $projectUrl;
+        $link = $projectUrl;
       } else {
-   $link = $ticketUrl;
+        $link = $ticketUrl;
       }
       if( $est > 0 )
-   $per = round($zen->percentWorked($est,$wkd),1)."%";
+      $per = round($zen->percentWorked($est,$wkd),1)."%";
    ?>
    <tr <?=$classxText?>>
    <td height="25" valign="middle" <?=$td_ttl?> <?=$txt?>>
@@ -127,13 +127,13 @@
      $p = round($p,1);
      $pp = round($pp,1);
      $ttl_per = round($ttl_per,1);
-     print "<tr style='background:".$zen->settings["color_bars"].";color:".$zen->settings["color_bar_text"].";'>\n";
+     print "<tr style='background:".$zen->getSetting("color_bars").";color:".$zen->getSetting("color_bar_text").";'>\n";
      print "<td colspan='6' align='right'><b>".tr("Actual Hours").":</b>&nbsp;&nbsp;</td>\n";
      print "<td align='right'><b>$ttl_est</b></td>\n";
      print "<td align='right'><b>".($ttl_ext+$ttl_wkd)."</b></td>\n";
      print "<td align='right'><b>$p%</b></td>\n";
      print "</tr>\n";            
-     print "<tr style='background:".$zen->settings["color_bars"].";color:".$zen->settings["color_bar_text"].";'>\n";
+     print "<tr style='background:".$zen->getSetting("color_bars").";color:".$zen->getSetting("color_bar_text").";'>\n";
      print "<td colspan='6' align='right'><b>".tr("Hours over 100%").":</b>&nbsp;&nbsp;</td>\n";
      print "<td align='right'><b>&nbsp;</b></td>\n";
      print "<td align='right'><b>&#150; $ttl_ext</b></td>\n";
@@ -142,7 +142,7 @@
    }
    
    // totals summary
-   print "<tr style='background:".$zen->settings["color_title_background"].";color:".$zen->settings["color_title_text"].";'>\n";
+   print "<tr style='background:".$zen->getSetting("color_title_background").";color:".$zen->getSetting("color_title_text").";'>\n";
    print "<td colspan='6' align='right'><b>".tr("Totals").":</b>&nbsp;&nbsp;</td>\n";
    print "<td align='center'><b>$ttl_est</b></td>\n";
    print "<td align='center'><b>$ttl_wkd</b></td>\n";
diff -Naur zentrack_2-5-5-2/includes/templates/loginForm zentrack_2-6-pre1/includes/templates/loginForm
--- zentrack_2-5-5-2/includes/templates/loginForm	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/loginForm	2005-10-11 04:48:19.000000000 -0700
@@ -1,4 +1,7 @@
-
+<? 
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  $hotkeys->loadSection('login');
+?>
 
 <blockquote><br>
 
@@ -8,37 +11,42 @@
 
   <p><b><i style="color:red"><?tr("Login and passphrase are case sensitive!")?></i></b></p>
 
-  <form method="post" action="<?=$SCRIPT_NAME?><?=($id)? "?id=".$zen->checkNum($id) : ""?>">
+  <form method="post" name="loginForm" action="<?=$SCRIPT_NAME?><?=($id)? "?id=".$zen->checkNum($id) : ""?>">
+  
+  <input type='hidden' name='TODO' value='Log On'>
 
-  <input type=text name=username value='<?=strip_tags($zentrackUsername)?>' width=20 maxlength=20>&nbsp;<?=tr("Login Name")?>
+  <input type=text name=username value='<?=strip_tags($zentrackUsername)?>' width=20 maxlength=20 title="<?=$hotkeys->tt("Login Name")?>">&nbsp;<?=$hotkeys->ll("Login Name")?>
 
   <br>
 
-  <input type="password" name="passphrase" width=20 maxlength=20>&nbsp;<?=tr("Password")?>
+  <input type="password" name="passphrase" width=20 maxlength=20 title="<?=$hotkeys->tt("Password")?>">&nbsp;<?=$hotkeys->ll("Password")?>
 
   <p>
   
   <? if( $zen && $zen->settingOn('allow_pwd_save') ) { ?>
   <p>
-  <input type='checkbox' name='save_my_password' value='1'> <?=tr("In the future, log me in automatically (using a cookie)")?>
+  <input type='checkbox' name='save_my_password' value='1'> <?=$hotkeys->ll("In the future, log me in automatically (using a cookie)")?>
   </p>
   <?  }  ?>
 
-  <input type=hidden name=redirect value='<?=$zen->ffv($redirect)?>'>
-
-  <input type=submit name=TODO value="<?=tr("Log On")?>">
+  <? renderDivButton( $hotkeys->find('Log On'), 'window.document.loginForm.submit()' ); ?>
 
   </form>
 
 </blockquote>
 
-
-
-
-
-
-
-
-
-
-
+<script type='text/javascript'>
+  var f = function() {
+    var f = window.document.loginForm;
+    if( f.username.value == "" ) {
+      f.username.focus();
+    }
+    else if( f.passphrase.value == "" ) {
+      f.passphrase.focus();
+    }
+    else {
+      f.TODO.focus();
+    }  
+  }
+  addToOnload( f );
+</script>
diff -Naur zentrack_2-5-5-2/includes/templates/nav_admin.php zentrack_2-6-pre1/includes/templates/nav_admin.php
--- zentrack_2-5-5-2/includes/templates/nav_admin.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_admin.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,81 @@
+<?
+  if( !ZT_DEFINED ) { die("Illegal Access"); }
+  //shortcut
+  $hk = $hotkeys 
+?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Users")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('New User')?>'>
+    <a href='<?=$rootUrl?>/admin/addUser.php' class='leftNavLink'><?=$hk->ll("New User")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Edit Users')?>'>
+    <a href='<?=$rootUrl?>/admin/listUsers.php' class='leftNavLink'><?=$hk->ll('Edit Users')?></a>
+  </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Tickets")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Edit Tickets')?>'>
+    <a href='<?=$rootUrl?>/admin/editTicket.php' class='leftNavLink'><?=$hk->ll('Edit Tickets')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Edit Field Map')?>'>
+    <a href='<?=$rootUrl?>/admin/fieldMap.php' class='leftNavLink'><?=$hk->ll('Edit Field Map')?></a>
+  </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Data Types")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Bins')?>'>
+    <a href='<?=$rootUrl?>/admin/bins.php' class='leftNavLink'><?=$hk->ll('Bins')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Priorities')?>'>
+    <a href='<?=$rootUrl?>/admin/priorities.php' class='leftNavLink'><?=$hk->ll('Priorities')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Systems')?>'>
+    <a href='<?=$rootUrl?>/admin/systems.php' class='leftNavLink'><?=$hk->ll('Systems')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Tasks')?>'>
+    <a href='<?=$rootUrl?>/admin/tasks.php' class='leftNavLink'><?=$hk->ll('Tasks')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Types')?>'>
+    <a href='<?=$rootUrl?>/admin/types.php' class='leftNavLink'><?=$hk->ll('Types')?></a>
+  </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Settings")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Data Groups')?>'>
+    <a href='<?=$rootUrl?>/admin/groups.php' class='leftNavLink'><?=$hk->ll('Data Groups')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Behaviors')?>'>
+    <a href='<?=$rootUrl?>/admin/behaviors.php' class='leftNavLink'><?=$hk->ll('Behaviors')?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hk->tt('Configuration')?>'>
+    <a href='<?=$rootUrl?>/admin/config.php' class='leftNavLink'><?=$hk->ll('Configuration')?></a>
+  </td>
+</tr>
+<tr><td height='100%'>&nbsp;</td></tr>
diff -Naur zentrack_2-5-5-2/includes/templates/nav_contacts.php zentrack_2-6-pre1/includes/templates/nav_contacts.php
--- zentrack_2-5-5-2/includes/templates/nav_contacts.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_contacts.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,81 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Contacts")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hotkeys->tt("Contacts","Browse")?>'>
+    <a href='<?=$rootUrl?>/contacts.php' class='leftNavLink'><?=$hotkeys->ll("Contacts","Browse")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hotkeys->tt("New Contact")?>'>
+    <a href='<?=$rootUrl?>/newContact.php' class='leftNavLink'><?=$hotkeys->ll("New Contact")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title="<?=$hotkeys->tt('Find')?>">
+    <a href='<?=$rootUrl?>/searchContacts.php' class='leftNavLink'><?=$hotkeys->ll("Find")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='25%' valign='top'>
+    <div class='recentHistory'><?=tr("Recent Companies")?></div>
+    <?
+      $history =& $zen->getHistoryManager();
+      $list = $history->getList('company');
+      if( count($list) ) {
+        foreach($list as $k=>$v) {
+          print "<div><a href='$rootUrl/contact.php?cid=$k'>".$zen->ffv(substr($v,0,15))."</a></div>\n";
+        }
+      }
+      else {
+        print "-none-";
+      }
+    ?>
+    <P>
+    <div class='recentHistory'><?=tr("Recent Employees")?></div>
+    <?
+      $history =& $zen->getHistoryManager();
+      $list = $history->getList('employee');
+      if( count($list) ) {
+        foreach($list as $k=>$v) {
+          print "<div><a href='$rootUrl/contact.php?pid=$k'>".$zen->ffv(substr($v,0,15))."</a></div>\n";
+        }
+      }
+      else {
+        print tr("-none-");
+      }
+    ?>
+  </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Agreements")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title="<?=$hotkeys->tt('Browse')?>">
+    <a href='<?=$rootUrl?>/agreements.php' class='leftNavLink'><?=$hotkeys->ll("Browse")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title="<?=$hotkeys->tt('New Agreement')?>">
+    <a href='<?=$rootUrl?>/newAgreement.php' class='leftNavLink'><?=$hotkeys->ll("New Agreement")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='100%' valign='top'>
+    <div class='recentHistory'><?=tr("Recent Agreements")?></div>
+    <?
+      $history =& $zen->getHistoryManager();
+      $list = $history->getList('agreement');
+      if( count($list) ) {
+        foreach($list as $k=>$v) {
+          print "<br><a href='$rootUrl/contacts.php?pid=$k'>".$zen->ffv(substr($v,0,15))."</a>\n";
+        }
+      }
+      else {
+        print "-none-";
+      }
+    ?>
+  </td>
+</tr>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/nav_help.php zentrack_2-6-pre1/includes/templates/nav_help.php
--- zentrack_2-5-5-2/includes/templates/nav_help.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_help.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,42 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Help")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?>>
+    <a href='<?=$helpUrl?>/tutorial.php' class='leftNavLink'><?=tr("Tutorial")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?>>
+    <a href='<?=$helpUrl?>/users/index.php' class='leftNavLink'><?=tr("User's Guide")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?>>
+    <a href='<?=$helpUrl?>/admin/index.php' class='leftNavLink'><?=tr("Admin Guide")?></a>
+  </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("About Us")?></td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='25%' valign='top'>
+      <a href='<?=$helpUrl?>/about.php'>About <?=$zen->getSetting("system_name")?></a>
+      <br><a href='<?=$helpUrl?>/gpl.php'>License</a>
+      <br><a href='http://www.zentrack.net'>Website</a>
+    </td>
+</tr>
+<tr><td class='note'>&nbsp;</td></tr>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Support")?></td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='100%' valign='top'>
+      <a href='http://www.zentrack.net/modules/support/'>Community</a>
+      <br><a href='http://www.zentrack.net/modules/newbb/'>Forums</a>
+      <br><a href='<?=$helpUrl?>/bugs.php'>Reporting Bugs</a>
+      <br><a href='http://www.zentrack.net/feedback/'>Feedback</a>
+    </td>
+</tr>
diff -Naur zentrack_2-5-5-2/includes/templates/nav_options.php zentrack_2-6-pre1/includes/templates/nav_options.php
--- zentrack_2-5-5-2/includes/templates/nav_options.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_options.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,13 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Options")?></td>
+</tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hotkeys->tt("Log Off")?>'>
+    <a href='<?=$rootUrl?>/index.php?logoff=1' class='leftNavLink'><?=$hotkeys->ll("Log Off")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='100%' valign='top'>
+    You may customize your ZT account using this screen.
+  </td>
+</tr>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/nav_projects.php zentrack_2-6-pre1/includes/templates/nav_projects.php
--- zentrack_2-5-5-2/includes/templates/nav_projects.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_projects.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,31 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Projects")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hotkeys->tt("New Project")?>'>
+    <a href='<?=$rootUrl?>/newProject.php' class='leftNavLink'><?=$hotkeys->ll("New Project")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title="<?=$hotkeys->tt("Advanced Search")?>">
+    <a href='<?=$rootUrl?>/search.php' class='leftNavLink'><?=$hotkeys->ll("Advanced Search", "Search")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='100%' valign='top'>
+    <div class='recentHistory'><?=tr("Recent Projects")?></div>
+    <?
+      $history =& $zen->getHistoryManager();
+      $list = $history->getList('project');
+      if( count($list) ) {
+        foreach($list as $k=>$v) {
+          print "<br><a href='$rootUrl/project.php?id=$k'>$k - ".substr($zen->ffv($v),0,10)."</a>\n";
+        }
+      }
+      else {
+        print "-none-";
+      }
+    ?>
+  </td>
+</tr>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/nav_tickets.php zentrack_2-6-pre1/includes/templates/nav_tickets.php
--- zentrack_2-5-5-2/includes/templates/nav_tickets.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/nav_tickets.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,31 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<tr>
+  <td class='leftNavTitle' height='25' valign='middle'><?=tr("Tickets")?></td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title='<?=$hotkeys->tt("New Ticket")?>'>
+    <a href='<?=$rootUrl?>/newTicket.php' class='leftNavLink'><?=$hotkeys->ll("New Ticket")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavMenu' <?=$lnav_rollover?> title="<?=$hotkeys->tt("Advanced Search")?>">
+    <a href='<?=$rootUrl?>/search.php' class='leftNavLink'><?=$hotkeys->ll("Advanced Search", "Search")?></a>
+  </td>
+</tr>
+<tr>
+  <td class='leftNavCell' height='100%' valign='top'>
+    <div class='recentHistory'><?=tr("Recent Tickets")?></div>
+    <?
+      $history =& $zen->getHistoryManager();
+      $list = $history->getList('ticket');
+      if( count($list) ) {
+        foreach($list as $k=>$v) {
+          print "<br><a href='$rootUrl/ticket.php?id=$k' title='".$zen->ffv($v)."'>$k - ".substr($zen->ffv($v),0,10)."</a>\n";
+        }
+      }
+      else {
+        print "-none-";
+      }
+    ?>
+  </td>
+</tr>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/newAgreementForm.php zentrack_2-6-pre1/includes/templates/newAgreementForm.php
--- zentrack_2-5-5-2/includes/templates/newAgreementForm.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/newAgreementForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,4 +1,6 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+  $hotkeys->loadSection('agreement_form');
+?>
 <script language='javascript' type='text/javascript'>
   function checkMyBox(fieldName, event) {
     if( !event ) { event = window.event; }
@@ -10,7 +12,7 @@
         }
       }
       if( elem.parentNode ) {
-        elem.parentNode.parentNode.oldStyle = elem.checked? 'invalidCell' : 'cell';
+        elem.parentNode.parentNode.oldStyle = elem.checked? 'invalidBars' : 'bars';
       }
     }
   }
@@ -30,26 +32,20 @@
 }
 ?>
 
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>" border="0">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>" border="0">
 <tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
+  <td colspan="2" width="640" class="subTitle" align="center">
      <?=tr("Agreement Information")?>
   </td>
 </tr>
 
 <tr>
-  <td colspan="2" class="subTitle">
-    <?=tr("Global")?>
-  </td>
-</tr>
-
-
-<tr>
   <td class="bars" >
-    <?=tr("Agreement ID")?>:
+    <?=$hotkeys->ll("Agreement ID")?>:
   </td>
   <td class="bars">
-    <input type="text" name="contractnr" size="20" maxlength="25"
+    <input title='<?=$hotkeys->tt("Agreement ID")?>' type="text" 
+      name="contractnr" size="20" maxlength="25"
       value="<?=$zen->ffv($contractnr)?>">
   </td>
 </tr>
@@ -116,32 +112,23 @@
 </tr>
 <tr>
   <td colspan="2" class="bars">
-    <?=tr("Description")?>:
+    <?=$hotkeys->ll("Description")?>:
   </td>
 </tr>
 
 <tr>
   <td colspan="2" class="bars">
-    <textarea cols="60" rows="5" name="description"><?=
+    <textarea cols="60" rows="5" name="description" title="<?=$hotkeys->tt("Description")?>"><?=
 	    $zen->ffv($description)
     ?></textarea>
   </td>
 </tr>
-
-
-
-<tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your agreement")?>.
-  </td>
-</tr>
 <tr>
-  <td colspan="2" class="bars">
-   <input type="submit" value=" <?=($skip)?"Save":"Create"?> " class="submit">
-   <br>
+  <td colspan="2" valign='middle' class="headerCell padded" style='text-align:left'>
+   <? renderDivButtonFind("Create", $skip? "Save":null); ?>
   </td>
 </tr>
-
+<tr><td class='bars' colspan='2'>&nbsp;</td></tr>
 <tr>
   <td colspan="2" class="subTitle">
     <?=tr("Items")?>
@@ -149,14 +136,12 @@
 </tr>
 <tr>
   <td colspan="2" class="bars">
-  <table>
+  <table cellspacing='1' class='formtable'>
   <?
   if (!$id){
-	  $parms = array(1 => array(1 => "agree_id", 2 => "=", 3 => "0")
-		);
+	  $parms = array(array("agree_id", "=", "0"));
   } else {
-	  $parms = array(1 => array(1 => "agree_id", 2 => "=", 3 => $id)
-		);
+	  $parms = array(array("agree_id", "=", $id));
   }
 
 	$sort = "item_id asc";
@@ -167,18 +152,14 @@
 
 	 foreach($contacts as $t) {
       ?>
-   <tr class='cell'
-       onmouseover='mClassX(this, "altCellInv", "hand")'
-       onmouseout='mClassX(this)'
-       onclick='checkMyBox("drops_<?=$t['item_id']?>", event)'>
-   <td height="25" width="20" valign="middle">
-    <?=$t["item_id"]?>
-   </td>
-   <td height="25" width="200" valign="middle">
+   <tr class='bars' <?=$row_rollover_eff?>
+     onclick='checkMyBox("drops_<?=$t['item_id']?>", event)'>
+   <td  width="20"><?=$t["item_id"]?></td>
+   <td width="200">
     <?=$zen->ffv($t["name1"])?>
    </td>
-   <td height="25"  width="400" valign="middle">
-   <pre><?=$zen->ffv($t["description1"])?></pre>
+   <td width="400">
+   <?=$zen->ffv($t["description1"], 200)?>
    </td>
    <td><input id='drops_<?=$t['item_id']?>'
           type='checkbox' name='drops[]'
@@ -187,7 +168,7 @@
    <?
    } ?>
    <tr>
-	<td colspan="2">
+	<td class='headerCell' style='text-align:right' colspan='4'>
          <input type="submit"
 	  value=" <?=tr("Drop Items")?> "
           class="actionButton"
@@ -212,7 +193,7 @@
   </td>
 </tr>
 <tr>
-<td class="bars" colspan="2">
+<td class="bars" colspan="2" valign='top'>
 	<?=tr("Name")?>:
     <input type="text" name="name1" size="30" maxlength="40" value="<?=$zen->ffv($name1)?>">
 
@@ -222,10 +203,8 @@
 	</td>
 </tr>
 <tr>
-<td>
-<input type="submit" value=" <?=tr("Add Item")?> "
-   onClick='return rerouteAgreementForm("addItems")'
-   class="actionButton">
+<td class='subTitle' colspan='2'>
+<? renderDivButtonFind('Add Item'); ?>
 </td>
 </tr>
 </form>
@@ -234,8 +213,8 @@
 
 <script language='javascript'>
   function rerouteAgreementForm( action ) {
-    document.agreementForm.action = '<?=$_SERVER['PHP_SELF'];?>';
-    document.agreementForm.TODO.value = action;
-    return true;
+    window.document.forms['agreementForm'].action = '<?=$zen->ffv($SCRIPT_NAME)?>';
+    window.document.forms['agreementForm'].elements['TODO'].value = action;
+    window.document.forms['agreementForm'].submit();
   }
 </script>
diff -Naur zentrack_2-5-5-2/includes/templates/newContactForm.php zentrack_2-6-pre1/includes/templates/newContactForm.php
--- zentrack_2-5-5-2/includes/templates/newContactForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/newContactForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -13,15 +13,15 @@
 }
 ?>
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
+  <td colspan="2" width="640" class="subTitle" align="center">
      <?=tr("Contact Information")?>
   </td>
 </tr>
   
 <tr>
-  <td colspan="2" class="subTitle">
+  <td colspan="2" class="headerCell">
     <?=tr("Details")?>
   </td>
 </tr>
@@ -181,12 +181,7 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your contact")?>.
-  </td>
-</tr>
-<tr>
-  <td colspan="2" class="bars">
+  <td colspan="2" class="subTitle indent">
    <input type="submit" value=" <?=($skip)?"Save":"Create"?> " class="submit">
   </td>
 </tr>
diff -Naur zentrack_2-5-5-2/includes/templates/newContacteForm.php zentrack_2-6-pre1/includes/templates/newContacteForm.php
--- zentrack_2-5-5-2/includes/templates/newContacteForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/newContacteForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -14,15 +14,15 @@
 
 <input type="hidden" name="id" value="<?=strip_tags($person_id)?>">
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
+  <td colspan="2" width="640" class="subTitle" align="center">
      <?=tr("Contact Information")?>
   </td>
 </tr>
   
 <tr>
-  <td colspan="2" class="subTitle">
+  <td colspan="2" class="headerCell">
     <?=tr("Info")?>
   </td>
 </tr>
@@ -172,7 +172,7 @@
 </tr>   
 
 <tr>
-  <td colspan="2" class="subTitle">
+  <td colspan="2" class="headerCell">
     <?=tr("Notes")?>
   </td>
 </tr>
@@ -185,12 +185,7 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your contact")?>.
-  </td>
-</tr>
-<tr>
-  <td colspan="2" class="bars">
+  <td colspan="2" class="navCell indent" align='right'>
    <input type="submit" value=" <?=($skip)?"Save":"Create"?> " class="submit">
   </td>
 </tr>
diff -Naur zentrack_2-5-5-2/includes/templates/newTicketForm.php zentrack_2-6-pre1/includes/templates/newTicketForm.php
--- zentrack_2-5-5-2/includes/templates/newTicketForm.php	2005-05-08 13:44:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/newTicketForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -6,11 +6,16 @@
      (ZenFieldMap)$map - contains properties for fields
      (string)$view - the current view (probably project_create or ticket_create)
      (string)$page_type - (optional) either 'ticket' or 'project'
+     (array)$ticket - the ticket to be displayed (if any)
   **/
 
 
+  ///////////////////////////////////////////////////
+  // determine which page we are looking at and
+  // validate access priviledges
+  //////////////////////////////////////////////////
   unset($users);
-  $td = ($TODO == 'EDIT');
+  $td = ($TODO == 'EDIT' || $TODO == 'EDIT_CUSTOM');
   
   // determine what type of page we are looking at and create some useful labels
   if( !isset($page_type) ) { 
@@ -19,106 +24,85 @@
   $plural = $page_type == 'project'? 'projects' : 'tickets';
   $ucfirst = ucfirst($page_type);
   
-  // calculate the bins which this user can access
-  if( $td ) {
-    $userBins = $zen->getUsersBins($login_id,"level_edit");  
-  }
-  else {
-    $level = $page_type=='project'? 'level_create_proj' : "level_create";
-    $userBins = $zen->getUsersBins($login_id,$level);
-    $id = 0;
-    $creator_id = $login_id;
-    $status = 'OPEN';
+  if( !$td ) {
+    $ticket = array();
+    $ticket['id'] = 0;
+    $ticket['creator_id'] = $login_id;
+    $ticket['status'] = 'OPEN';
+    if( $project_id ) { $ticket['project_id'] = $zen->checkNum($project_id); }
   }
   
+  $id = $ticket['id'];
+
+  // set the form name and the override as label if appropriate
+  $form_name = "ticketForm";
+  
   // blow up if this user does not have proper access to any bins
+  $userBins = $zen->getUsersBins($login_id, $map->getViewProp($view,'access_level'));
   if( !is_array($userBins) || !count($userBins) ) {
     print "<span class='error'>";
     if( $td ) {
-      print tr("You do not have permission to edit ?.", array($plural));
+      print tr("You do not have permission to edit ? in at least 1 bin.", array($plural));
     }
     else {
-      print tr("You do not have permission to create ?.", array($plural));
+      print tr("You do not have permission to create ? in at least 1 bin.", array($plural));
     }
     print "</span>\n";
     include("$libDir/footer.php");
     exit;
   }
-  if( !$deadline && !$td )
-     $deadline = $zen->getDefaultValue("default_deadline");
-  if( !$start_date && !$td )
-     $start_date = $zen->getDefaultValue("default_start_date");
+  
+  
+  ///////////////////////////////////////////////////
+  // set default values as needed
+  ///////////////////////////////////////////////////
+  
+  // set deadline and start date on create screens
+  if( !$ticket['deadline'] && !$td )
+     $ticket['deadline'] = $zen->getDefaultValue("default_deadline");
+  if( !$ticket['start_date'] && !$td )
+     $ticket['start_date'] = $zen->getDefaultValue("default_start_date");
      
-  if( strlen($deadline) ) { $deadline = $zen->showDateTime($deadline); }
-  if( strlen($start_date) ) { $start_date = $zen->showDateTime($start_date); }
-  if( strlen($ctime) ) { $ctime = $zen->showDateTime($ctime); }
-  if( strlen($otime) && $td ) { $otime = $zen->showDateTime($otime); }
   if( !$td ) { $otime = time(); }
      
-  //$view = $td? 'ticket_edit' : 'ticket_create';
-  $fields = $map->listFieldsForView($view);
-  $hidden_fields = array();
-  $visible_fields = array();
-  $sections = array();
-  foreach($fields as $f) {
-    $field = $map->getFieldFromMap($view,$f);
-    if( !$field['is_visible'] ) { $hidden_fields[] = $f; }
-    else { 
-      $visible_fields[] = $f;
-      if( $field['field_type'] == 'section' ) { $sections[] = $f; }
-    }
-  }
-  
   // calculate the destination of our form results
   if( $td ) {
-    $formDest = $page_type == 'project'? 'editProjectSubmit.php' : 'editTicketSubmit.php';
+    if (strpos($view,"custom")!== false) {
+      $formDest = "actions/editCustomSubmit.php";
+    } else {
+      $formDest = $page_type == 'project'? 'editProjectSubmit.php' : 'editTicketSubmit.php';
+    }
   }
   else {
     $formDest = $page_type == 'project'? 'addProjectSubmit.php' : 'addSubmit.php';
   }
 ?>
-<form method="post" name="ticketForm" action="<?=$formDest?>" onSubmit='return validateTicketForm()'>
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<form method="post" name="<?=$form_name?>" action="<?=$formDest?>" onSubmit='return validateTicketForm(this)'>
+<table width="640" align="left" cellpadding="2" cellspacing="2" class='formTable'>
 <tr>
-  <td colspan="2" width="640" class="titleCell" align="center">
+  <td colspan="2" width="640" class="subTitle" align="center">
      <?=tr("$ucfirst Information")?>
   </td>
 </tr>
 <?
-foreach($hidden_fields as $f) {
-  //$view, $form_name, $field_name, $value = null, $prefix = ''
-  print $map->renderTicketField($view, 'ticketForm', $f, $$f);
-}
-
-foreach($visible_fields as $f) {
-  if( in_array($f, $sections) ) {
-    print "<tr><td colspan='2' class='subTitle'>";
-    print $map->renderTicketField($view, 'ticketForm', $f);
-    print "</td></tr>\n";
-  }
-  else {
-    print "<tr><td class='bars'>";
-    print $map->getLabel($view, $f);
-    print "</td><td class='bars'>";
-    if( $td && $page_type == 'project' && $f == 'type_id' ) {
-      // do not allow type to be edited for projects
-      print $map->getTextValue($view, $f, $$f);
-    }
-    else {
-      print $map->renderTicketField($view, 'ticketForm', $f, $$f);
-    }
-    print "</td></tr>\n";
-  }
-}
-
+  ///////////////////////////////////////
+  // print the ticket fields
+  ///////////////////////////////////////
+  $formview = $view;
+  include("$templateDir/form_fields.php");
+  
+  ////////////////////////////////////////
+  // include the reason required box
+  ////////////////////////////////////////
+  if ($TODO == 'EDIT' && $zen->settingOn('edit_reason_required') && $zen->settingOn('log_edit') ) {
 ?>
 <tr>
-  <td class="titleCell" colspan="2" align="center">
-  <?=tr("Click button to")?> <?=($td)? tr("save your changes"):tr("create your $page_type")?>.
+  <td class="bars">
+    <?=tr("Edit Reason")?><br>
+    <span class='note'>(<?=tr("Required")?>)</note>
   </td>
-</tr>
+  <td class="bars">
 <?
-  if ($td && $zen->settings['edit_reason_required']=='on' && $zen->settings['log_edit']=='on') {
     $er_vals=array('field_cols'   => '60',
                    'field_rows'   => '5',
                    'field_name'   => 'edit_reason',
@@ -126,14 +110,6 @@
                    'field_value'  => '');
     $er_template=new zenTemplate("$templateDir/fields/textarea.template");
     $er_template->values($er_vals);
-?>
-<tr>
-  <td class="bars">
-    <?=tr("Edit Reason")?><br>
-    (<?=tr("Mandatory")?>)
-  </td>
-  <td class="bars">
-<?
     print $er_template->process();
 ?>
   </td>
@@ -142,7 +118,7 @@
   }
 ?>
 <tr>
-  <td colspan="2" class="bars">
+  <td colspan="2" class="subTitle">
    <input type="submit" value=" <?=tr(($td)?"Save":"Create")?> " class="submit">
   </td>
 </tr>
@@ -150,5 +126,6 @@
 </form>
 
 <?
+  $formview = $view;
   include_once("$libDir/templates/validateTicketForm.php");
 ?>
diff -Naur zentrack_2-5-5-2/includes/templates/optionsMenu.php zentrack_2-6-pre1/includes/templates/optionsMenu.php
--- zentrack_2-5-5-2/includes/templates/optionsMenu.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/optionsMenu.php	2005-09-09 13:28:23.000000000 -0700
@@ -1,26 +1,44 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<br>
-<ul>
-  <b><?=tr("Account Options")?></b>
-  <ul>
-    <b><a href="<?=$rootUrl?>/misc/pwc.php"><?=tr("Change Password")?></a></b>
-    <? if( $zen->settings["allow_pwd_save"] == "on" ) {
-         if( $zen->get_prefs($login_id,'autologin') ) {
-           print "<p><b><a href='$rootUrl/misc/autologin.php?setauto=off'>".tr("Disable Auto-Login")."</a></b>";
-         }
-         else {
-           print "<p><b><a href='$rootUrl/misc/autologin.php?setauto=on'>".tr("Enable Auto-Login")."</a></b>";
-         } 
-       }
-     ?>
-    <p><b><a href="<?=$rootUrl?>/misc/homebin.php"><?=tr("Change Default Bin")?></a></b>
-    <p><b><a href="<?=$rootUrl?>/misc/language.php"><?=tr("Change Language")?></a></b>
-  </ul>
-</ul>
+<?
+  include("$templateDir/pwcForm.php");
+  
+  print "<p>";
+  if( $zen->settingOn("allow_pwd_save") ) {
+     if( $zen->get_prefs($login_id,'autologin') ) {
+       $txt = "Disable Auto-Login";
+       $val = "off";
+     }
+     else {
+       $txt = "Enable Auto-Login";
+       $val = "on";
+     } 
 
-<? 
-  if( $page_title == tr("Change Password") ) {
+?>
+<form method="get" action="<?=$rootUrl?>/misc/autologin.php">
+
+<table width="300" cellpadding="5">
+<tr>
+  <td colspan="2" class="subTitle" align="center" height="20">
+    <b><?=tr("Auto Login Setting")?></b>
+  </td>
+</tr>
+<tr>
+  <td class="bars" colspan="2">
+    <input type="submit" value="<?=tr($txt)?>" class="submit">
+  </td>
+</tr>
+</table>
+
+<input type="hidden" name="setauto" value="<?=$val?>">
+</form>
+<?
+  }
+   
+   print "<p>";
+   include("$templateDir/languageForm.php");
+
+   if( $page_title == tr("Change Password") ) {
     $link = "<a href='$helpUrl/tutorial.php'>".tr('Tutorial')."</a>";
     print "<p><span class='error'>";
     print tr("If this is your first time logging in, please read the ?!", array($link));
diff -Naur zentrack_2-5-5-2/includes/templates/projectView.php zentrack_2-6-pre1/includes/templates/projectView.php
--- zentrack_2-5-5-2/includes/templates/projectView.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/projectView.php	2005-09-09 13:28:23.000000000 -0700
@@ -10,17 +10,6 @@
   **  and ticket_box (which is the tabbed section below the buttons)
   */
   
-  // add the "tasks" tab to the bar
-  $tabs = array_merge(array('tasks'=>tr('Tasks')), $tabs);
-
-  $page_type = "project";
-
-?><table width="640" cellspacing="1" cellpadding="2">
-  <tr>
-    <td width="80" valign="top"><? include("$templateDir/ticket_actionBar.php"); ?></td>
-    <td width="560" valign="top"><? include("$templateDir/ticket_titleBox.php"); ?></td>
-  </tr>
-  <tr>
-    <td colspan="2" width="640" valign="top"><? include("$templateDir/ticket_box.php"); ?></td>
-  </tr>
-</table>
+  $page_type = 'project';
+  include("$templateDir/ticketView.php");
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/pwcForm.php zentrack_2-6-pre1/includes/templates/pwcForm.php
--- zentrack_2-5-5-2/includes/templates/pwcForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/pwcForm.php	2005-09-09 13:28:23.000000000 -0700
@@ -8,15 +8,14 @@
 ?>
 
 <form method="post" action="<?=$rootUrl?>/misc/pwc.php">
-<blockquote>
 <table width="300" cellpadding="5">
 <tr>
-  <td colspan="2" class="titleCell" align="center" height="20">
+  <td colspan="2" class="subTitle" align="center" height="20">
     <b><?=tr("Change User Password")?></b>
   </td>
 </tr>
 <?
-  if( $zen->settings["check_pwd_simple"] == "on" ) {
+  if( $zen->settingOn("check_pwd_simple") ) {
 ?>
 <tr>
   <td colspan="2" class="bars">
@@ -43,17 +42,11 @@
   </td>
 </tr>
 <tr>
-  <td class="titleCell" colspan="2">
-    <?=tr("Please keep track of your new passphrase.")?>
-  </td>
-</tr>
-<tr>
   <td class="bars" colspan="2">
     <input type="submit" value="<?=tr("Set Password")?>" class="submit">
   </td>
 </tr>
 </table>
-</blockquote>
 
 <input type="hidden" name="TODO" value="SET">
 </form>
diff -Naur zentrack_2-5-5-2/includes/templates/reportsMenu.php zentrack_2-6-pre1/includes/templates/reportsMenu.php
--- zentrack_2-5-5-2/includes/templates/reportsMenu.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/reportsMenu.php	2005-09-09 13:28:23.000000000 -0700
@@ -1,6 +1,6 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 
 <? 
    include("$templateDir/reportsTypeMenu.php");
diff -Naur zentrack_2-5-5-2/includes/templates/searchContact2List.php zentrack_2-6-pre1/includes/templates/searchContact2List.php
--- zentrack_2-5-5-2/includes/templates/searchContact2List.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchContact2List.php	2005-10-20 11:23:44.000000000 -0700
@@ -3,33 +3,33 @@
 
 if( is_array($tickets) && count($tickets) ) {
  
-   $link = $zen->settings["url_view_ticket"];   
+   $link = $zen->getSetting("url_view_ticket");   
    $c = count($tickets);
    
 ?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
 <tr>
 <td class='titleCell' colspan="9" align='center'><?=($c>1)? tr("? Matches",array($c)) : tr("1 Match");?></td></tr>
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
+<tr bgcolor="<?=$zen->getSetting("color_title_background")?>" >
 
 <td width="32" height="25" valign="middle" title="<?=tr("ID of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The name of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Name")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Name")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The company where the contact works")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Company")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Company")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The E-mail address of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("E-mail")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("E-mail")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The telephone number of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Telephone")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Telephone")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 </tr>
@@ -42,7 +42,9 @@
    foreach($tickets as $t) {    
 
       ?>
-   <tr  class='priority1' onclick='ticketClk("<?=$link?>?pid=<?=$t["person_id"]?>")' onMouseOver='mClassX(this, "priority1Over", true)' onMouseOut='mClassX(this, "priority1", false)'>
+   <tr  class='priority1' onclick='ticketClk("<?=$link?>?pid=<?=$t["person_id"]?>")' 
+      onMouseOver='if(window.document.body && mClassX){mClassX(this, "priority1Over", true);}' 
+      onMouseOut='if(window.document.body && mClassX){mClassX(this, "priority1", false);}'>
    <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
     <?=$t["person_id"]?>
    </td>
diff -Naur zentrack_2-5-5-2/includes/templates/searchContact3List.php zentrack_2-6-pre1/includes/templates/searchContact3List.php
--- zentrack_2-5-5-2/includes/templates/searchContact3List.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchContact3List.php	2005-10-20 11:23:44.000000000 -0700
@@ -3,33 +3,33 @@
 
 if( is_array($tickets) && count($tickets) ) {
  
-   $link = $zen->settings["url_view_ticket"];   
+   $link = $zen->getSetting("url_view_ticket");   
    $c = count($tickets);
    
 ?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
 <tr>
 <td class='titleCell' colspan="9" align='center'><?=($c>1)? tr("? Matches",array($c)) : tr("1 Match");?></td></tr>
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
+<tr bgcolor="<?=$zen->getSetting("color_title_background")?>" >
 
 <td width="32" height="25" valign="middle" title="<?=tr("ID of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The name of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("nr")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("nr")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The company where the agreement runs")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Company")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Company")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("Title of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The Expiration Date")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Expiration Date")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Expiration Date")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 </tr>
@@ -42,7 +42,9 @@
    foreach($tickets as $t) {    
 
       ?>
-   <tr  class='priority1' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' onMouseOver='mClassX(this, "priority1Over", true)' onMouseOut='mClassX(this, "priority1", false)'>
+   <tr  class='priority1' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' 
+     onMouseOver='if(window.document.body && mClassX){mClassX(this, "priority1Over", true);}' 
+     onMouseOut='if(window.document.body && mClassX){mClassX(this, "priority1", false);}'>
    <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
     <?=$t["agree_id"]?>
    </td>
diff -Naur zentrack_2-5-5-2/includes/templates/searchContact4List.php zentrack_2-6-pre1/includes/templates/searchContact4List.php
--- zentrack_2-5-5-2/includes/templates/searchContact4List.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchContact4List.php	2005-10-20 11:23:44.000000000 -0700
@@ -3,25 +3,25 @@
 
 if( is_array($tickets) && count($tickets) ) {
  
-   $link = $zen->settings["url_view_ticket"];   
+   $link = $zen->getSetting("url_view_ticket");   
    $c = count($tickets);
    
 ?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
 <tr>
 <td class='titleCell' colspan="9" align='center'><?=($c>1)? tr("? Matches",array($c)) : tr("1 Match");?></td></tr>
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
+<tr bgcolor="<?=$zen->getSetting("color_title_background")?>" >
 
 <td width="32" height="25" valign="middle" title="<?=tr("ID of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The name of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("name")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("name")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("Title of the agreement")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 
@@ -35,7 +35,9 @@
    foreach($tickets as $t) {    
 
       ?>
-   <tr  class='priority1' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' onMouseOver='mClassX(this, "priority1Over", true)' onMouseOut='mClassX(this, "priority1", false)'>
+   <tr  class='priority1' onclick='ticketClk("<?=$link?>?id=<?=$t["agree_id"]?>")' 
+     onMouseOver='if(window.document.body && mClassX){mClassX(this, "priority1Over", true);}' 
+     onMouseOut='if(window.document.body && mClassX){mClassX(this, "priority1", false);}'>
    <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
     <?=$t["item_id"]?>
    </td>
diff -Naur zentrack_2-5-5-2/includes/templates/searchContactList.php zentrack_2-6-pre1/includes/templates/searchContactList.php
--- zentrack_2-5-5-2/includes/templates/searchContactList.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchContactList.php	2005-10-20 11:23:44.000000000 -0700
@@ -3,33 +3,33 @@
 
 if( is_array($tickets) && count($tickets) ) {
  
-   $link = $zen->settings["url_view_ticket"];   
+   $link = $zen->getSetting("url_view_ticket");   
    $c = count($tickets);
    
 ?>
-<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+<table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
 <tr>
 <td class='titleCell' colspan="9" align='center'><?=($c>1)? tr("? Matches",array($c)) : tr("1 Match");?></td></tr>
-<tr bgcolor="<?=$zen->settings["color_title_background"]?>" >
+<tr bgcolor="<?=$zen->getSetting("color_title_background")?>" >
 
 <td width="32" height="25" valign="middle" title="<?=tr("ID of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The name of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Title")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The E-mail address of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("E-mail")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("E-mail")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The telephone number of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Telephone")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Telephone")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 <td height="25" valign="middle" title="<?=tr("The website of the contact")?>">
-<div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Website")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
+<div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Website")?><?if (!empty($image)) {?>&nbsp;<IMG SRC="<?echo $imageUrl,$image ;?>" border="0"><?}?></span></b></span></div>
 </td>
 
 </tr>
@@ -39,7 +39,9 @@
 
    foreach($tickets as $t) {      
       ?>
-   <tr  class='priority1' onclick='ticketClk("<?=$link?>?cid=<?=$t['company_id']?>")' onMouseOver='mClassX(this, "priority1Over", true)' onMouseOut='mClassX(this, "priority1", false)'>
+   <tr  class='priority1' onclick='ticketClk("<?=$link?>?cid=<?=$t['company_id']?>")' 
+     onMouseOver='if(window.document.body && mClassX){mClassX(this, "priority1Over", true);}' 
+     onMouseOut='if(window.document.body && mClassX){mClassX(this, "priority1", false);}'>
    <td height="25" width="5%" valign="middle" <?=$td_ttl?>>
     <?=$t["company_id"]?>
    </td>
diff -Naur zentrack_2-5-5-2/includes/templates/searchForm.php zentrack_2-6-pre1/includes/templates/searchForm.php
--- zentrack_2-5-5-2/includes/templates/searchForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchForm.php	2005-10-20 11:23:44.000000000 -0700
@@ -8,6 +8,7 @@
   **/  
   
   $view = 'search_form';
+  $hotkeys->loadSection('search_form');
   $fields = $map->getFieldMap($view);
   $text_fields = array();
   $other_fields = array();
@@ -30,17 +31,27 @@
 <form action="<?=$SCRIPT_NAME?>" name="searchForm" method='POST'>
 <input type="hidden" name="TODO" value="SEARCH">
 <?
+$context = new ZenFieldMapRenderContext(
+  array('view' => $view, 'form' => 'searchForm')
+);
 foreach($hidden_fields as $f=>$field) {
-  $map->renderTicketField($view, 'searchForm', $f, $$f);
+  $context->set('field', $f);
+  $context->set('value', $$f);
+  $map->renderTicketField($context);
 }
 ?>
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
      <?=tr("Search For Tickets")?>
   </td>
 </tr>
+<tr>
+  <td class="bars" colspan="2">
+     <input type="submit" class="submit" value="<?=tr("Search")?>">
+  </td>
+</tr>
 
 <?
 if( count($text_fields) ) {
@@ -52,7 +63,7 @@
 </tr>
 <tr>
   <td class="bars">
-     <?=tr("Containing")?>
+     <?=$hotkeys->ll("Containing")?>
   </td>
   <td class="bars">
    <input type="text" name="search_text" 
@@ -73,7 +84,9 @@
       if( $c > 0 && !$switch) { print "<br>"; }
       $switch = false;
       $checked = is_array($search_fields) && array_key_exists($t, $search_fields) && $search_fields["$t"] > 0? " checked" : "";
-      print "<input type='checkbox' name='search_fields[$t]' value='1'$checked>&nbsp;".$map->getLabel($view, $t)."\n";
+      $label = ( $t == 'title' || $t == 'description' )?
+        $hotkeys->ll($t=='title'?'Summary':'Description') : $map->getLabel($view, $t);
+      print "<input type='checkbox' name='search_fields[$t]' value='1'$checked>&nbsp;$label\n";
       if( count($text_fields) > 3 && ++$c == ceil(count($text_fields)/2) ) {
         $switch = true;
         print "</td><td valign='top'>\n";
@@ -94,16 +107,25 @@
   </td>
 </tr>
 <?
+  $context = new ZenFieldMapRenderContext(
+    array('view' => $view, 'form' => 'searchForm')
+  );
   foreach( $date_fields as $f=>$field ) {
       print "<tr><td class='bars'>";
       print $map->getLabel($view, $f);
       print "</td><td class='bars'>";
       print "<span class='note'>between ";
       $name = "{$f}_begin";
-      print $map->renderTicketField($view, 'searchForm', $f, $search_params["$name"], "search_params[$name]");
+      $context->set('field', $f);
+      $context->set('value', $search_parms["$name"]);
+      $context->set('name',  "search_parms[$name]");
+      print $map->renderTicketField($context);
       print " and ";
       $name = "{$f}_end";
-      print $map->renderTicketField($view, 'searchForm', $f, $search_params["$name"], "search_params[$name]");
+      $context->set('field', $f);
+      $context->set('value', $search_parms["$name"]);
+      $context->set('name',  "search_parms[$name]");
+      print $map->renderTicketField($context);
       print "</span>";
       print "</td></tr>\n";
   }
@@ -118,14 +140,25 @@
   </td>
 </tr>
 <?
-  
+  $context = new ZenFieldMapRenderContext(
+    array('view' => $view, 'form' => 'searchForm')
+  );
   foreach( $other_fields as $f=>$field ) {
     print "<tr><td class='bars'>";
     print $map->getLabel($view,$f);
     print "</td><td class='bars'>";
-    print $map->renderTicketField($view, 'searchForm', $f, $search_params["$f"], "search_params[$f]");
+    $context->set('field', $f);
+    $context->set('value', $search_parms["$f"]);
+    $context->set('name',  "search_parms[$f]");
+    print $map->renderTicketField($context);
     if( $f == 'priority' ) {
       print "&nbsp;<input type='checkbox' name='or_higher' checked value='1'> or higher";
+    } else if( strpos($f, "multi")>0 ) {
+      print "&nbsp;<select name='srch_opt[$f]'>";
+      print "<option value='EXACT' selected='selected'>".tr("Exact Match")."</option>";
+      print "<option value='AND'>".tr("Match All")."</option>";
+      print "<option value='OR'>".tr("Match Any")."</option>";
+      print "</selected>";
     }
     print "</td></tr>\n";
   }
diff -Naur zentrack_2-5-5-2/includes/templates/searchLogForm.php zentrack_2-6-pre1/includes/templates/searchLogForm.php
--- zentrack_2-5-5-2/includes/templates/searchLogForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchLogForm.php	2005-09-09 13:28:23.000000000 -0700
@@ -13,7 +13,7 @@
 <form action="<?=$SCRIPT_NAME?>">
 <input type="hidden" name="TODO" value="SEARCH">
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
      <?=tr("Search For Logs")?>
@@ -84,7 +84,7 @@
        <option value="">----</option>
 <?
   $userBins = $zen->getUsersBins($login_id);
-  if( is_array($userBins) && $zen->settings["allow_assign"] == "on" ) {
+  if( is_array($userBins) && $zen->settingOn("allow_assign") ) {
     $users = $zen->get_users($userBins);
     if( is_array($users) ) {
       asort($users);
diff -Naur zentrack_2-5-5-2/includes/templates/searchLogList.php zentrack_2-6-pre1/includes/templates/searchLogList.php
--- zentrack_2-5-5-2/includes/templates/searchLogList.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchLogList.php	2005-09-09 13:28:23.000000000 -0700
@@ -4,41 +4,41 @@
 
 if( is_array($logs) && count($logs) ) {
   
-  $link = $zen->settings["url_view_ticket"];
+  $link = $zen->getSetting("url_view_ticket");
   $c = count($logs);
   $pageNumber = array_key_exists('pageNumber', $_GET)?
   $zen->checkNum($_GET['pageNumber']) : 0;
-  $first = ($zen->settings['paging_max_rows'] * $pageNumber) + 1; //added line
+  $first = ($zen->getSetting('paging_max_rows') * $pageNumber) + 1; //added line
   $last = $c + $ll - 1; //added line
   if( $last > $zen->total_records ) { $last = $zen->total_records; }
   $c = tr("Matches ?-? of ?", array($first,$last,$zen->total_records)); //added line
   ?>
-  <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+  <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
   <tr><td class='titleCell' colspan="8" align='center'><?=$c?></td></tr>
-  <tr bgcolor="<?=$zen->settings["color_title_background"]?>">
+  <tr bgcolor="<?=$zen->getSetting("color_title_background")?>">
   <td width="32" height="25" valign="middle" title="<?=tr("ID of the ticket")?>">
-  <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
+  <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
   </td>
   <td width="32" height="25" valign="middle" title="<?=tr("Date log was created")?>">
-  <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+  <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
   <b><span class="small"><?=tr("Date")?></span></b></span>
   </div>
   </td>
   <? if( !$search_params["action"] || is_array($search_params["action"]) ) { ?>
     <td width="32" height="25" valign="middle" title="<?=tr("Action Taken")?>">
-    <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+    <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
     <b><span class="small"><?=tr("Action")?></span></b></span></div>
     </td>
   <? } ?>
   <? if( !$search_params["user_id"] || is_array($search_params["user_id"]) ) { ?>
     <td width="32" height="25" valign="middle" title="<?=tr("Person ticket is assigned to")?>">
-    <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+    <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
     <b><span class="small"><?=tr("User")?></span></b></span></div>
     </td>
   <? } ?>
   <? if( !$search_params["bin_id"] || is_array($search_params["bin_id"]) ) { ?>
     <td width="32" height="25" valign="middle" title="<?=tr("Bin ticket is located in")?>">
-    <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+    <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
     <b><span class="small"><?=tr("Bin")?></span></b></span></div>
     </td>
   <? } ?>
@@ -50,14 +50,14 @@
     unset($txt);
     unset($est);
     
-    if( $row == $zen->settings["color_background"] ) {
-      $row = $zen->settings["color_bars"];
+    if( $row == $zen->getSetting("color_background") ) {
+      $row = $zen->getSetting("color_bars");
       $txt = $hotrollover_greytext;
-      $text = $zen->settings["color_bar_text"]; 
+      $text = $zen->getSetting("color_bar_text"); 
     } else {
-      $row = $zen->settings["color_background"];
+      $row = $zen->getSetting("color_background");
       $txt = $hotrollover_text;
-      $text = $zen->settings["color_text"];
+      $text = $zen->getSetting("color_text");
     }
     ?>
     <tr style="background:<?=$row?>;color:<?=$text?>" 
diff -Naur zentrack_2-5-5-2/includes/templates/searchResults.php zentrack_2-6-pre1/includes/templates/searchResults.php
--- zentrack_2-5-5-2/includes/templates/searchResults.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/searchResults.php	2005-10-20 11:23:44.000000000 -0700
@@ -1,8 +1,7 @@
 <?{
 if( !ZT_DEFINED ) { die("Illegal Access"); }
 
-  
-  include("$libDir/sorting.php");
+  include_once("$libDir/sorting.php");
   
   function searchResultsMaxPri( $a, $b ) {
     if( $a > $b ) { return $a; }
@@ -111,7 +110,33 @@
             }
             break;  
           default:
-            $params[] = array($k, $op, $v, 1);
+            if ( strpos($k,"custom_multi") === false ) {
+              $params[] = array($k, $op, $v, 1);
+            } else {
+              $qry = "SELECT ticket_id, count(*) FROM $zen->table_varfield_multi "
+                    ."WHERE field_name = '$k' AND field_value IN ('" . implode("','",$v) . "') "
+                    ."GROUP BY ticket_id ";
+              switch ($srch_opt[$k]) {
+                case "EXACT":
+                case "AND":
+                  $qry.="HAVING count(*)=".count($v);
+                  break;
+              }
+              $zen->addDebug("searchResults.php", "Query for multi field: $qry", 3);
+              $vals = $zen->db_queryIndexed($qry);
+              $tids = array('0');
+              for($i=0; $i<count($vals); $i++) {
+                $tids[] = $vals[$i][ticket_id];
+              }
+              if ($srch_opt[$k] == "EXACT") {
+                $qry = "SELECT ticket_id FROM $zen->table_varfield_multi "
+                      ."WHERE field_name = '$k' AND field_value NOT IN ('" . implode("','",$v) . "') ";
+                $zen->addDebug("searchResults.php", "Query for multi field exclusion: $qry", 3);
+                $tids_not = $zen->db_list($qry);
+                $tids = array_diff($tids, $tids_not);
+              }
+              $params[] = array($zen->table_tickets.".id", 'IN', $tids, 1);
+            }
             break;
         }
       }
diff -Naur zentrack_2-5-5-2/includes/templates/ticketView.php zentrack_2-6-pre1/includes/templates/ticketView.php
--- zentrack_2-5-5-2/includes/templates/ticketView.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticketView.php	2005-10-21 03:59:54.000000000 -0700
@@ -1,25 +1,84 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
   /*
   **  TICKET VIEW
   **
-  **  Framework for the ticket viewing screen
-  **  Includes ticket_actionBar (the buttons)
-  **  ticket_titleBox (the important details)
-  **  and ticket_box (which is the tabbed section 
-  **  below the buttons)
+  **  Framework for the ticket view.  Includes the top area, tabs,
+  **  tabs, and actions.
   **
-  **  The ticket object should be retrieved and
-  **  extracted before including this page.
+  **  REQUIREMENTS:
+  **    $view - (String)the current view (ticket_view or project_view)
+  **    $map - (ZenFieldMap)
+  **    $zen - (zenTrack)
+  **    $id - (integer)id of the ticket to view
+  **    $ticket - (array)the ticket properties from get_ticket or get_project
+  **    $page_mode - (string)page to load (ticket_tab_2, close, etc.. validate this!)
   */
+  
+  if( !$page_type ) {
+    preg_match("@^(project|ticket)_view$@", $view);
+    $page_type = $matches[1];
+  }
+  $id = $ticket['id'];
+  $type_id = $ticket['type_id'];
+  $pageUrl = $page_type == 'project'? $projectUrl : $ticketUrl;
+?><table class='barborder' width='100%' cellpadding="0" cellspacing="0">
+<tr>
+  <td class='subTitle padded' valign='bottom'><? //tbar padded indent ridge
+  if( $map->getViewProp('ticket_view_top','move_actions_up') ) {
+  ?><table width='100%' cellpadding='0' cellspacing='0'><tr><td class='tbar' valign='bottom'>
+    <?=$zen->ffv(tr($zen->getTypeName($type_id)))?> #<?=$id?><?
+    if( $map->getViewProp('ticket_view_top','show_summary_inline') ) {
+      print ": ".$zen->ffvText($ticket['title']);
+    }
+  ?></td><td align='right'><?
+    include("$templateDir/ticket_actions.php");
+  ?></td></tr></table><?
+  }
+  else {
+    print $zen->ffv(tr($zen->getTypeName($type_id)))." #$id";
+    if( $map->getViewProp('ticket_view_top','show_summary_inline') ) {
+      print ": ".$zen->ffvText($ticket['title']);
+    }
+  }
+  ?></td>
+</tr>
+<tr>
+  <td class='indent boxpad'><?
+    $boxview = 'ticket_view_top';
+    include("$templateDir/ticket_box.php"); 
+  ?></td>
+</tr>
+<tr>
+  <td class='tbar indent tabpad lip'><? include("$templateDir/ticket_tabs.php") ?></td>
+</tr>
+<tr>
+  <td class='indent boxpad' valign='top' height='225'><?
+    if( isset($action) ) { $action = preg_replace('@[^0-9a-zA-Z_-]@', '', $action); }
+    if( isset($action) && file_exists("$templateDir/actions/$action.php") ) {
+      print "<div class='actionFormBox'>";
+      include("$templateDir/ticket_action.php");
+      print "</div>";
+    }
+    else if( preg_match("/^{$page_type}_tab_[0-9]$/", $page_mode) ) {
+      $tabs = $map->getTabs($page_type, $login_id, $bin_id);
+      if( !array_key_exists($page_mode, $tabs) || !$map->getViewProp($page_mode,'visible') ) {
+        print "<div class='error'>".tr("Invalid page mode requested: ?", $zen->ffv($page_mode))."</div>";
+      }
+      else {
+        $boxview = $page_mode;
+        include("$templateDir/ticket_box.php");
+      }
+    }
+    else {
+      print "<div class='error'>".tr("Invalid page mode requested: ?", $zen->ffv($page_mode))."</div>";
+    }
+  ?></td>
+</tr>
+<?
+ if( !$map->getViewProp('ticket_view_top','move_actions_up') ) {
 ?>
- <table width="640" cellspacing="1" cellpadding="2">
-  <tr>
-    <td width="80" valign="top"><? include("$templateDir/ticket_actionBar.php"); ?></td>
-    <td width="560" valign="top"><? include("$templateDir/ticket_titleBox.php"); ?></td>
-  </tr>
-  <tr>
-    <td colspan="2" width="640" valign="top"><? include("$templateDir/ticket_box.php"); ?></td>
-  </tr>
+<tr>
+  <td class='tbar padded ridge'><? include("$templateDir/ticket_actions.php")?></td>
+</tr>
+ <? } ?>
 </table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_action.php zentrack_2-6-pre1/includes/templates/ticket_action.php
--- zentrack_2-5-5-2/includes/templates/ticket_action.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_action.php	2005-10-11 04:48:19.000000000 -0700
@@ -0,0 +1,12 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+  if( $action && file_exists("$templateDir/actions/$action.php") ) { 
+     // if there is an action, include the appropriate window
+     // so that the user can input the action data and commit
+     include("$templateDir/actions/$action.php");
+     print "<p>&nbsp;</p>\n";
+  }
+  else {
+    print "<p class='error'>".tr("Invalid action declared")." (".$zen->ffv($action).")</p>\n";
+  }
+  
+?>
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_actionBar.php zentrack_2-6-pre1/includes/templates/ticket_actionBar.php
--- zentrack_2-5-5-2/includes/templates/ticket_actionBar.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_actionBar.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,55 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-
-
-<!-- BEGIN ACTION BAR -->
-
-
-<table width="80" cellpadding="0" cellspacing="0">
-<?{
-  // array of action buttons to create
-  // if the value is set to 1, will display
-  // as a greyed out button if not applicable
-  // on the page, otherwise hidden if not applicable
-  
-  if( !is_array($actions) ) 
-  $actions = array(
-  "log"     => 1,
-  "relate"  => 1,
-  "move"    => 1,		     
-  "close"   => 1,
-  "test"    => 1,
-  "approve" => 1
-  );
-  foreach($actions as $a=>$v) {
-    $flag = 1;
-    if( $zen->actionApplicable($ticket, $a, $login_id) ) {
-      $style = "style='color:".$zen->settings["color_highlight"]."'";
-      $button = "submit";
-    } else {
-      if( !$v )
-      $flag = 0;
-      $style = "style='color:".$zen->settings["color_alt_background"]."'";
-      $button = "button";
-    }
-    if( $flag ) {
-      $target = ($a == 'print')?
-      " target='_blank'" : "";
-      print "<tr>\n<form name='$aForm' action='$rootUrl/actions/$a.php'$target>\n";
-      print "<td>\n";
-      
-      // Possible translations: (for the benefit of translation maintenance tools)
-      //  tr("Test"); tr("Approve"); tr("Accept"); tr("Assign"); tr("Print"); tr("Edit");
-      $a_name = ( $page_browser == 'ns' )?
-      uptr(ucfirst($a)) : str_pad( uptr(ucfirst($a)) ,18," ",STR_PAD_RIGHT);
-      print "<input type='$button' class='actionButton' $style value='$a_name'>\n";
-      print "<input type='hidden' name='id' value='$id'>\n";
-      print "<input type='hidden' name='setmode' value='$a'>\n";
-      print "</td>\n</form>\n</tr>\n";
-    }
-  }  
-}?>
-</table>
-
-
-<!-- END ACTION BAR -->
-
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_actions.php zentrack_2-6-pre1/includes/templates/ticket_actions.php
--- zentrack_2-5-5-2/includes/templates/ticket_actions.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_actions.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,44 @@
+<?  if( !ZT_DEFINED ) { die("Illegal Access"); } ?><table><tr><?
+
+$hotkeys->loadSection('actionbar');
+$iconDir = "$imageDir/48x48";
+$actions = $zen->getActions();
+foreach($actions as $k=>$v) {
+  if( !$v['button'] ) { continue; }
+  
+  //actionApplicable( $id, $action, $user_id = '', $noaccess = 0 )
+  $use = $zen->actionApplicable($ticket, $k, $login_id);
+  
+  if( $use ) { 
+    print "<td class='icon' onmouseover='if(window.document.body && mClassX){mClassX(this, \"icon iconDown\", true);}'";
+    print " title=\"".$hotkeys->tt("Action: {$v['label']}")."\"";
+    print " onmouseout='if(window.document.body && mClassX){mClassX(this, \"icon\");}' "
+      ."onclick='if(window.document.body && mClk){mClk(this);return false;}'>";
+    if( $k == 'print' ) {
+      print "<a class='leftNavLink' href='#'";
+      print " onclick='popupWindowScrolls(\"$rootUrl/actions/$k.php?id=$id\",\"printWindow\", 700, 500);return false;'>";
+    }
+    else {
+      print "<a class='leftNavLink' href='$rootUrl/actions/$k.php?id=$id&setmode=".$zen->ffv($page_mode)."'>";
+    }
+    if( $v['img'] ) {
+      print "<img src='$imageUrl/24x24/{$v['img']}' border='0' width='24' height='24'>";
+    }
+    print "<br>".$hotkeys->ll("Action: {$v['label']}", $v['label']);
+    print "</a>";
+    print "</td>";
+  }
+  else {
+    $hotkeys->disableAction( $hotkeys->find("Action: {$v['label']}") );
+    print "<td class='icon iconOff' ";
+    print " title=\"".$hotkeys->tt("Action: {$v['label']}")."\">";    
+    if( $v['img'] ) {
+      print "<img src='$imageUrl/24x24/{$v['img']}' border='0' width='24' height='24'>";
+    }
+    print "<br>".$hotkeys->ll("Action: {$v['label']}", $v['label']);
+    print "</td>";
+  }
+
+}
+
+?></tr></table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_attachmentsBox.php zentrack_2-6-pre1/includes/templates/ticket_attachmentsBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_attachmentsBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_attachmentsBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,78 +0,0 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-   $rollover_text = " onclick=\"mClk(this);\" "
-      ."onmouseout=\"mOut(this,'".$zen->settings["color_background"]."', '');\" "
-      ."onmouseover=\"mOvr(this,'".$zen->settings["color_bars"]."', '');\"";
-   $row = "background:".$zen->settings["color_background"];
-?>
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-  <tr> 
-     <form action="<?=$rootUrl?>/actions/upload.php">
-     <input type="hidden" name="id" value="<?=strip_tags($id)?>">
-     <td align="right">
-       <?
-         if( $zen->actionApplicable($id,"upload",$login_id) ) {
-	    $button = "submit";
-	    $color = $zen->settings["color_highlight"];
-	 } else {
-	    $button = "button";
-	    $color = $zen->settings["color_alt_background"];
-	 }
-       ?>
-       <input type="<?=$button?>" value=" <?=uptr("Add Attachment")?> " class="actionButton" style="width:125;color:<?=$color?>">
-     </td>
-     </form>
-   </tr>  
-   <tr>  
-     <td class="titleCell">
-        <?=tr("Attachments on ? #?",array($page_type,$id))?>
-     </td>
-  </tr>
-   <tr>
-    <td colspan="2">
-<?
-  // get attachments and display a list
-  // of them
-  $attachments = $zen->get_attachments($id);
-  if( is_array($attachments) && count($attachments) > 0) {
-     ?>
-       <table width="100%" cellpadding='2' cellspacing='1' border='0'>
-       <tr>
-         <td class='bars' width='150'><?=tr("Attachment")?></td>
-         <td class='bars' width='50'><?=tr("Log ID")?></td>
-         <td class='bars' width='50'><?=tr("Type")?></td>
-         <td class='bars'><?=tr("Description")?></td>
-       </tr>
-     <?
-     foreach($attachments as $a) {
-	?>
-	  <tr style="<?=$row?>">
-	  <td <?=$rollover_text?>>
-	    <a href='<?=$zen->settings["url_view_attachment"]?>?aid=<?=$a["attachment_id"]?>' 
-	    class='rowLink' target='_blank'><?=$a[name]?></a></td>
-	  <td <?=($a["log_id"])? $rollover_text:"";?>>
-	    <?= ($a["log_id"])?
-	         "<a href='".$zen->settings["url_view_log"]
-                    ."?lid=$a[log_id]' class='rowLink'>$a[log_id]</a>" :
-	         "n/a";
-	    ?>
-	  </td>
-	  <td class='plainCell'>
-	    <?=$a["filetype"]?>
-	  </td>
-	  <td class='plainCell'>
-	    <?=$a["description"]?>
-	  </td>
-	  </tr>
-        <?
-     }    
-     print "</table>\n";
-  } else {
-     print tr("No attachments exist for this ?", array($page_type));
-  }
-?>
-    </td>
-   </tr>
-   </table>
-
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_box.php zentrack_2-6-pre1/includes/templates/ticket_box.php
--- zentrack_2-5-5-2/includes/templates/ticket_box.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_box.php	2005-10-08 00:48:46.000000000 -0700
@@ -1,116 +1,50 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table width="645" cellpadding="0" cellspacing="0" border="0">
-<tr> 
-  <td valign="bottom"><?
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
 
-  /*
-  **  TICKET BOX
-  **
-  **  Includes the correct html to display
-  **  whatever is currently going on with the
-  **  ticket.
-  **
-  **  sets up the tabs at the top as well
-  **  $login_mode is set up in the headerInc.php file
-  **  in accordance with incoming form data and 
-  **  is a session variable
-  */
-
-  /*
-  ** CHECK THE PAGE MODE
+ /**
+  * A tab or block of information in the ticket view
+  *
+  * REQUIREMENTS:
+  *   $map - instance of ZenFieldMap
+  *   $zen - instance of ZenTrack
+  *   $boxview - (string)view to be loaded from field map
+  *   $ticket - values for all columns in the ticket we are viewing
   */
+  
+  $id = $ticket['id'];
+  $varfields = $zen->getVarfieldVals($id);
 
-  if( !$project_mode ) {
-    $project_mode = "tasks";
+  if( !$zen->checkAccess($login_id, $bin_id, $map->getViewProp($boxview,'access_level')) ) {
+    print("Illegal access");
+    exit;
   }
-  if( !$ticket_mode ) {
-    $ticket_mode = "details";
+
+  //////////////////////////////////////////////////
+  // render preload items
+  //////////////////////////////////////////////////
+  $pre = $map->getViewProp($boxview,'preload');
+  if( $pre ) {
+    foreach($pre as $l) { 
+      include("$templateDir/ticket_load_$l.php");
+    }
   }
 
-  // set the page mode, for viewing tickets
-  if( $setmode ) {    
-    if( $page_type == "project" )
-      $project_mode = strtolower($setmode);
-    else
-      $ticket_mode = strtolower($setmode);
+  /////////////////////////////////////////////////
+  // print fields
+  /////////////////////////////////////////////////
+  if( $map->getViewProp($boxview, 'view_only') ) {
+    include("$templateDir/ticket_fields_viewable.php");
   }
-  if( $page_type == "project" ) {
-    $page_mode = $project_mode;
-    $pageUrl = $projectUrl;
-  } else {
-    $page_mode = $ticket_mode;
-    $pageUrl = $ticketUrl;
+  else {
+    include("$templateDir/ticket_fields_editable.php");
   }
-
-  /*
-  ** SHOW THE NAVIGATION TABS
-  */
-
-  // the navigation tabs are set in headerInc.php
   
-  print "<table cellpadding='0' cellspacing='0'><tr>\n";
-  print "<td width='3'><img src='$rootUrl/images/empty.gif' width='3' height='1'></td>\n";
-
-  $i = 1;
-
-  $vx = $zen->getCustomFields(1, $page_type, 'Custom');
-  $counts = $zen->get_ticket_stats($id);
-    
-  foreach( $tabs as $key=>$t ) {
-    if( $key == 'custom' && (!$vx || !count($vx)) ) {
-      // only display the custom tab if there are fields on it
-      continue;
-    }
-    if( $key == 'contacts' && 
-	($zen->settings['allow_contacts'] != 'on' ||
-	 !$zen->checkAccess($login_id, $bin_id, 'level_contacts')) ) {
-      // do not show contacts if this is off
-      continue;
-    }
-    if( $page_mode == $key ) {
-      $class = 'tabOn';
-      $lclass = "tabsOn";
-    } else {
-      $class = 'tabOff';
-      $lclass = 'tabsOff';
-    }
-    
-    // Possible translations: (for the benefit of translation maintenance tools)
-    // tr("Related"); tr("Notify"); tr("Tasks");
-    $txt = (isset($counts[$key]) && $counts[$key])? $t." (".$counts["$key"].")" : $t;
-    $w = ($key == "attachments")? 85 : 60;
-    print "<td class='{$class}' height='{$height_num}' width='{$w}'>";
-    print "<a href='{$pageUrl}?id={$id}&setmode={$key}' class='{$lclass}'>{$txt}</a></td>\n";
-    if( $i < count($tabs) ) {
-      print "<td width='3'><img src='{$rootUrl}/images/empty.gif' width='3' height='1'></td>\n";
-    }
-    $i++;
-  }
-  print "</tr></table>\n";
-
-?></td>
-</tr>
-<tr> 
-  <td class="ticketCell" height="300" valign="top">
-  <br>  
-<?
-
-  /*
-  ** DETERMINE WHICH SCREEN TO SHOW AND SHOW IT
-  */
-  $name = "ticket_".$page_mode."Box.php";
-  $name = ereg_replace("[.]{2}", "", $name);
-
-  // check for valid filename
-  if( !file_exists("$templateDir/$name") ) {
-    if( !file_exists("$templateDir/actions/$page_mode.php") ) {
-      $zen->addDebug("ticket_box","Invalid filename $name declared... redirecting",1);
+  ////////////////////////////////////////////////////
+  // postload items
+  ////////////////////////////////////////////////////
+  $post = $map->getViewProp($boxview,'postload');
+  if( $post ) {
+    foreach($post as $l) {
+      include("$templateDir/ticket_load_$l.php"); 
     }
-    $name = "ticket_systemBox.php";
   }
-  include("$templateDir/$name");
-?>
-   <br>
-  </td>
-</tr>
-</table>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_contactsBox.php zentrack_2-6-pre1/includes/templates/ticket_contactsBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_contactsBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_contactsBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,106 +0,0 @@
-<?
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-
-  // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
-    print "Illegal access.  You do not have permission to access contacts.";
-    exit;
-  }
-
-?>
-<table width="600" align="center" cellpadding="2" cellspacing="2">
-<tr>     
-<td align="right">
-     <form action="<?=$rootUrl?>/actions/addToContacts.php" name='contactForm'>
-     <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
-     <input type="submit"
-         value=" <?=tr("Add Contacts")?> " class="actionButton" 
-         style="width:125;color:#CCFFCC">  
-     </form>
-     </td>
-   </tr>   
-	 <tr>  
-     <td class='titleCell'>
-       <?=tr("Related Contacts", array($page_type))?>    
-     </td>
-   </tr>
-     
-   <tr>
-     <td valign="top">
-     <form action="<?=$rootUrl?>/actions/dropFromContacts.php" method="post">
-     <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
-<?
-  
-   $parms = array(1 => array(1 => "ticket_id", 2 => "=", 3 => $id),);
-   $sort = "ticket_id asc";
-   
-  $tickets = $zen->get_contacts($parms,"ZENTRACK_RELATED_CONTACTS",$sort);
-
-
-if ($tickets){
-?>
-<table width='500' border="0">
-<tr>
-  <td class='subTitle' width='10%' ><?=tr("ID")?></td>	
-  <td class='subTitle' align='center'><?=tr("Name")?></td>
-  <td class='subTitle' align='center'><?=tr("Telephone")?></td>
-  <td class='subTitle' align='center'><?=tr("E-mail")?></td>
-  <td class='subTitle' width='5%' align='center'><?=tr("Delete")?></td>
-</tr>
-<?  
-//print_r($tickets);
-    foreach($tickets as $n) {
-	    
-	   if ($n["type"]=="1"){
-		   $table = "ZENTRACK_COMPANY";
-		   $col = "company_id";
-		   $cpid = $n["cp_id"]; 
-		   $c1 = "cid" ;
-		   $n1 = "title";
-		   $n2 = "office";
-	   } else {
-	   	 $table = "ZENTRACK_EMPLOYEE";
-		 	 $col = "person_id";
-		   $cpid = $n["cp_id"];
-		 	 $c1 = "pid"	;
-		 	 $n1 = "lname";
-		   $n2 = "fname";
-		 }
-		 
-  	$u=$zen->get_contact($n["cp_id"],$table,$col);   
-    $tc = "onclick='ticketClk(\"$rootUrl/contact.php?$c1=$cpid\")'";
-?>	
-      <tr class='bars' onMouseOver='mClassX(this, "cell", "hand")' onMouseOut='mClassX(this)'>
-      <td <?=$tc?>><?=$cpid?></td>
-      <td <?=$tc?>><? echo ucfirst($u[$n1])." "; if(!empty($u[$n2])){ echo stripslashes($u[$n2]);}?></td>
-      <td <?=$tc?>><?=$u["telephone"]?></td>
-      <td <?
-        if( !$u['email'] ) { print $tc; }
-      ?>><A id='link_<?=$cpid?>' HREF="mailto:<?=stripslashes($u['email'])?>"><?=stripslashes($u["email"])?></A></td>
-      <td onClick='checkMyBox("drops_<?=$n['clist_id']?>", event)'><input 
-          id='drops_<?=$n['clist_id']?>' type='checkbox' name='drops[]' 
-          value='<?=$n['clist_id']?>'></td>
-      </tr>
-<?
-    }
-?>
-</table> 
-<table width='600'>
-<tr>
-<td align="right">
-         <input type="<?=$button?>" 
-	  value=" <?=tr("Drop Contacts")?> " 
-	  class="actionButton" style="width:125;color:<?=$color?>"> 
-</td>
-</tr>
-</table>
-</form>
-<?
-  } else {
-	   print "<b>".tr("No related contacts")."</b>";
-  }
-?>     
-  </td>
-</tr>
-</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_customBox.php zentrack_2-6-pre1/includes/templates/ticket_customBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_customBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_customBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,154 +0,0 @@
-<? 
-if( !ZT_DEFINED ) { die("Illegal Access"); }
-
-if( $TODO == 'SAVED' ) {
-  $zen->print_errors($errs); 
-  if( $save_message ) {
-    print "<p class='bold'>".tr($save_message)."</p>";
-  }
-}
-
-  $editMode = $zen->checkAccess($login_id, $bin_id, 'varfield_edit');
-
-  if( $editMode ) {
-
-?><form name="ticket_customForm" action="<?=$rootUrl?>/actions/editCustomSubmit.php" method='POST'><?
-  }
-?>
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-<?
-  $sfd=$zen->getBehaviorDestinationFieldsArray();
-  $cfd=$zen->getCustomFields(0,$page_type,"C");
-  $rc = 0;
-  if( $editMode ) { 
-    foreach($cfd as $f) {
-      $k = $f['field_name'];
-      $l = $f['field_label'];
-      if ( isset($sfd["$l"]) ) {
-        unset($sfd["$l"]);
-      }
-      $v = $varfields["$k"];
-      if( $v == 'NULL' ) { $v = ''; }
-?>
-  <tr>
-    <td class='bars'><?=tr($f['field_label'])?></td>
-    <td class='bars'>
-    <?= genVarfield('ticket_customForm', $f, $v) ?>
-    </td>
-  </tr>
-<?   
-    }
-    foreach($sfd as $k=>$f) {
-      $v = isset($ticket["$f"])? $ticket["$f"] : ( isset($varfields["$f"]) ? $varfields["$f"] : NULL );
-      if( $v == 'NULL' ) { $v = ''; }
-      //If it is a date field it has to be formatted
-      switch ($f) {
-        case "ctime":
-        case "deadline":
-        case "otime":
-        case "start_date":
-          if( $v == 0 ) { $v = ""; }
-          if( strlen($v) && preg_match("/^[0-9]+$/", $v) ) {
-            $v = $zen->showDateTime($v);
-          }
-          break;
-      }
-?>
-         <input type="hidden" name="<?=$f?>" value="<?=strip_tags($v)?>">
-<?
-    }
-  } 
-  else {
-    foreach($cfd as $f) {
-      $k = $f['field_name'];
-      $v = $varfields["$k"];
-      if( $v == 'NULL' || $v == '' ) { $v = 'n/a'; }
-?>
-  <tr>
-     <td class='smallTitleCell'><?=tr($f['field_label'])?></td>
-  </tr>
-  <tr>
-     <td><?=$v?></td>
-  </tr>
-<?
-    }
-  }
-
-  if( $editMode ) {
-?>
-    <tr>
-         <td align="right">
-         <input type="hidden" name="id" value="<?=strip_tags($id)?>">
-   <?
-    $button = "submit";
-    $color = $zen->settings["color_highlight"];
-   ?>
-   <input type="<?=$button?>" value=" <?=uptr("Save")?> " class="actionButton" style="width:125;color:<?=$color?>">
-         </td>
-     </tr>
-<? 
-  } 
-
-  print "</table>\n";
-  if( $editMode ) { 
-?>
- <script language='Javascript' type='text/javascript'>
-
- function validateCustomForm() {
-   var errs = new Array();   
-<?
- if( is_array($cfd) && count($cfd) ) {
-    foreach($cfd as $v) {
-      $k = $v['field_name'];
-      $l = $v['field_label'];
-      if( $v['js_validation'] ) {
-	      print preg_replace('/\{form\}/', 'document.ticket_customForm', $v['js_validation']);
-      }
-      else {
-        $f = "document.ticket_customForm.{$k}";
-        $e = 'errs[ errs.length ]';
-        switch( getVarfieldDataType($k) ) {
-          case "menu":
-            // if the value of the menu selection is '', then
-            // the required status is significant
-            if( $v['is_required'] ) {
-              print "if( {$f}.options[ {$f}.selectedIndex ].value == '' )"
-                . " { {$e} = '{$l} is required'; }\n";
-            }
-          case "boolean":
-            // no validation for checkboxes
-            break;
-          case "number":
-            // make sure it is a valid number
-            print "if( {$f}.value.match( /[^0-9.]/ ) ) { {$e} = '"
-              .tr('? is not a valid number',array(tr($l)))."'; }\n";
-          default:
-            // nothing to do for dates or strings, just
-            // check the required status
-            // numbers fall through to here also
-            if( $v['is_required'] ) {
-              print "if( !{$f}.value ) { {$e} = '"
-                .tr('? is required',array(tr($l)))."'; }\n";
-            }
-        }
-      }
-   }
- }
-?>
-   if( errs.length > 0 ) {
-     var str = "<?=tr("Please correct the following errors:")?>\n----------\n";
-     for( var i=0; i < errs.length; i++ ) {
-       str += errs[i]+"\n";
-     }
-     alert(str);
-     return false;
-   }
-   return true;
- }
-  </script>
-
-  </form>
-<?
-  }
-
-?>
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_detailsBox.php zentrack_2-6-pre1/includes/templates/ticket_detailsBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_detailsBox.php	2005-05-08 13:44:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_detailsBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,174 +0,0 @@
-<? 
-  /**
-   * This displays the details tab within the ticket view.
-   *
-   * Requirements:
-   *   ZenTrack $zen - zenTrack class and utils
-   *   ZenFieldMap $map - an instance of $ZenFieldMap used to obtain list of fields
-   *   String $view - a view as defined in ZenFieldMap.class, used to obtain fields and properties
-   *   int $project_id - [optional] if defined, represents the project this ticket belongs to
-   *   mixed [various] - ticket fields from ZENTRACK_TICKETS are provided to this page as $column_name
-   */
-   
-   if( !ZT_DEFINED ) { die("Illegal Access"); } 
-?>
-
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-   <tr>  
-   <? if( $project_id ) { 
-       $project = $zen->get_ticket($project_id); 
-   ?>
-    <td colspan="3" class='titleCell'><?=uptr("Project")?></td>
-   <? } else { ?>
-    <td colspan="3" rowspan="2"><span class="bigBold"><?=
-    strtoupper($zen->systems["$system_id"]." ".$zen->types["$type_id"]);
-    ?></span></td>
-   <? } ?>
-    <td width="30">&nbsp;</td>
-    <td class="smallTitleCell"><?=uptr("Start Date")?></td>
-  </tr>
-  <tr style='background:<?=$zen->settings["color_background"]?>'>
-   <? if( $project_id ) { ?>  
-    <td colspan='3' <?=$rollover_text?>><a 
-	href='<?=$rootUrl?>/project.php?id=<?=$project_id?>' 
-	class='rowLink'><?=$project_id?> -  
-    	<?=$zen->ffv($project["title"])?></a></td>
-    <? } ?>
-    <td class='altCellInv'>&nbsp;</td>
-    <td class='altCellInv'><?=($start_date)?$zen->showDateTime($start_date):"n/a"?></td>  
-  </tr>
-  <? if( $project_id ) { ?>
-  <tr>
-    <td colspan='5' height='10'>&nbsp;</td>
-  </tr>
-  <? } ?>
-  <tr>
-    <td class="smallTitleCell" width="140" height="<?=$height_num?>"><?=uptr("Bin")?></td>
-    <td class="smallTitleCell" width="140"><?=uptr("Type")?></td>
-    <td class="smallTitleCell" width="140"><?=uptr("System")?></td>
-    <td>&nbsp;</td>
-    <td class="smallTitleCell"><?=uptr("Estimated Hours")?></td>
-  </tr>
-   <tr>
-    <td><?=($bin_id)?$zen->bins["$bin_id"]:tr("n/a")?></td>
-    <td><?=($type_id)?$zen->types["$type_id"]:tr("n/a")?></td>
-    <td><?=($system_id)?$zen->systems["$system_id"]:tr("n/a")?></td>
-    <td>&nbsp;</td>  
-    <?
-    $set = ($page_browser == 'ns')? 
-    "  ".uptr("Set")."  " : str_pad(uptr("Set"),18," ",STR_PAD_RIGHT);
-    if( $type_id == $zen->projectTypeID() ) {
-	    list($est_hours,$wkd_hours) = $zen->getProjectHours($id);
-	    if( $est_hours <= 0 )
-      $est_hours = tr("n/a");
-	    print "<td>$est_hours</td>\n";
-    } else if($est_hours > 0) {
-      print "<td>$est_hours</td>\n";
-    } else if( $user_id == $login_id ) {
-	    echo('
-      <form method="post" action="'.$rootUrl.'/actions/estimate.php">
-		  <input type="hidden" name="id" value="'.$id.'">
-		  <td><input type="submit" class="actionButton" value="'.$set.'"></td>
-      </form>');
-    } else {
-	    echo('
-      <form method="post" action="'.$rootUrl.'/actions/estimate.php">
-		  <input type="hidden" name="id" value="'.$id.'">
-		  <td><input type="button" class="actionButton"
-      style="color:'.$zen->settings["color_alt_background"].'"
-      value="'.$set.'"></td>
-      </form>');
-    }
-    ?>
-  </tr>
-  <tr>
-    <td class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Closed")?></td>
-    <td class="smallTitleCell"><?=uptr("Testing")?></td>
-    <td class="smallTitleCell"><?=uptr("Approval")?></td>
-    <td>&nbsp;</td>    
-    <td class="smallTitleCell"><?=uptr("Hours Worked")?></td>  
-  </tr>
-   <tr>
-    <td><?=($ctime)?$zen->showDateTime($ctime):tr("n/a")?></td>    
-    <td><? 
-      switch($tested){
-        case 1: 
-         print "<b>".tr("required")."</b>";
-         break; 
-        case 2:
-         print tr("completed");
-         break; 
-        default:
-         print tr("n/a");
-      } 
-     ?></td>
-    <td><? 
-      switch($approved){
-        case 1: 
-         print "<b>".tr("required")."</b>";
-         break; 
-        case 2:
-         print tr("completed");
-         break; 
-        default:
-         print tr("n/a");
-      } 
-     ?></td>  
-    <td>&nbsp;</td>    
-    <td><?
-      print ($wkd_hours > 0)? $wkd_hours : "0";
-      if( $est_hours > 0 )
-        print " (".$zen->percentWorked($est_hours,$wkd_hours)."%)";
-      ?></td>
-    <td>&nbsp;</td>    
-  </tr>
-   <tr colspan="5" height="5">
-    <td><img src="<?=$rootUrl?>/images/empty.gif" width="2" height="5"></td>  
-   </tr>
-
-<?
-  $cfd=$zen->getCustomFields(1,$page_type,"D");
-  foreach($cfd as $k => $v) {
-    $varfield_type=ereg_replace("[^a-z_]", "", $k);
-    switch($varfield_type) {
-      case "custom_number":
-        $cfv = strlen($varfields["$k"])? $varfields["$k"] : '&nbsp;';
-        break;
-      case "custom_date":
-        $cfv = $varfields["$k"]? $zen->showDateTime($varfields["$k"]) : "&nbsp;";
-        break;
-      case "custom_text":
-        $cfv = strlen($varfields["$k"])? $zen->ffvText($varfields["$k"]) : "&nbsp;";
-        break;
-      default:
-        $cfv = $varfields["$k"]? $zen->ffv($varfields["$k"]) : '&nbsp;';
-        break;
-    }
-?>
-   <tr>
-    <td colspan="3" class="smallTitleCell" height="<?=$height_num?>"><?=$v?></td>
-    <td colspan='2'>&nbsp;</td>
-   </tr>
-   <tr>
-      <td colspan="3"<?= $varfield_type == 'custom_text'? " class='outlined'" : '' ?>>
-      <?= $cfv ?>
-    </td>
-    <td colspan='2'>&nbsp;</td>
-   </tr>
-<?
-  }
-?>
-
-   <tr colspan="5" height="5">
-    <td><img src="<?=$rootUrl?>/images/empty.gif" width="2" height="5"></td>  
-   </tr>
-   <tr>
-    <td colspan="5" class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Description")?></td>
-   </tr>
-   <tr>
-    <td colspan="5" class="outlined">
-   <?= $zen->ffvText($description) ?>
-    </td>
-   </tr>  
-
-   </table>
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_fields_editable.php zentrack_2-6-pre1/includes/templates/ticket_fields_editable.php
--- zentrack_2-5-5-2/includes/templates/ticket_fields_editable.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_fields_editable.php	2005-10-11 04:48:19.000000000 -0700
@@ -0,0 +1,22 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /*
+  **  FIELDS EDITABLE
+  **
+  **  Renders fields in ticket view window for editing
+  **
+  **  REQUIREMENTS:
+  *   $map - instance of ZenFieldMap
+  *   $zen - instance of ZenTrack
+  *   $boxview - (string)view to be loaded from field map
+  *   $ticket - values for all columns in the ticket we are viewing
+  */
+  
+  $hotkeys->loadSection('ticket_fields_editable');
+  $formview = $boxview;
+  $formName = 'ticketForm';
+  $actionName = $SCRIPT_NAME;
+  $formTitle = '&nbsp;';
+  $submitName = 'Save';
+  include("$templateDir/ticket_tab_form.php");
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_fields_viewable.php zentrack_2-6-pre1/includes/templates/ticket_fields_viewable.php
--- zentrack_2-5-5-2/includes/templates/ticket_fields_viewable.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_fields_viewable.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,90 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /*
+  **  FIELDS VIEW
+  **
+  **  Renders fields in ticket view window.
+  **
+  **  REQUIREMENTS:
+  *   $map - instance of ZenFieldMap
+  *   $zen - instance of ZenTrack
+  *   $boxview - (string)view to be loaded from field map
+  *   $ticket - values for all columns in the ticket we are viewing
+  */
+
+  $columns = $map->getViewProp($boxview,'columns');
+  $width = $map->getViewProp($boxview,'width');
+  $fields = $map->listFieldsForView($boxview);
+  
+  if( !$columns ) { print "No columns specified for view."; $fields = array(); }
+  
+  $i = 0;
+  while( $i < count($fields) ) {
+    // collect items for this row
+    $vals = array();
+    for($j = 0; $j < $columns && $i < count($fields); ) {
+      // collect field info
+      $f = $fields[$i];
+      $field = $map->getFieldFromMap($boxview, $f);
+      
+      // skip hidden fields but don't add a column
+      if( !$field['is_visible'] ) { $i++; continue; }
+      
+      if( $field['field_type'] == 'section' && $f != 'elapsed' ) {
+        // sections become gaps here
+        $label = '';
+        $value = '';
+      }
+      else if( $f == 'elapsed' ) {
+        $label = $map->getLabel($boxview, $f);
+        $value = $zen->showTimeElapsed($otime,$ctime,1,0);
+      }
+      else {
+        $label = $map->getLabel($boxview, $f);
+        $val = array_key_exists($f, $varfields)? $varfields[$f] : $ticket[$f];
+        $value = $map->getTextValue($boxview, $f, $val);
+      }
+      $vals[] = array('label'=>$label, 'value'=>$value);
+
+      // increment values if we make it this far
+      $j++;
+      $i++;
+    }
+    
+    // open row
+    print "<table cellpadding='0' cellspacing='0'>\n";
+    
+    // print headings
+    print "<tr>";
+    foreach($vals as $v) {
+      if( $v['label'] == '' && $v['value'] == '' ) {
+        // this is a gap
+        print "<td rowspan='2' class='propSpace'>&nbsp;</td>\n";
+      }
+      else {
+        $w = $width? "width=$width" : "";
+        print "<td class='propLabel' $w><nobr>".$zen->ffv($v['label'])."</nobr></td>\n";
+        print "<td width='2'><img src='$imageUrl/empty.gif' width='2' height='1'></td>\n";
+      }
+    }
+    print "</tr>";
+    
+    // print cells
+    print "<tr>";
+    foreach($vals as $v) {
+      if( $v['label'] == '' && $v['value'] == '' ) {
+        // this is a gap
+        continue;
+      }
+      else {
+        print "<td class='propContent'>{$v['value']}</td>";
+        print "<td width='2'><img src='$imageUrl/empty.gif' width='2' height='1'></td>\n";
+      }
+    }
+    print "</tr>";
+    
+    // close row
+    print "</table>\n";
+  }
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_attachments.php zentrack_2-6-pre1/includes/templates/ticket_load_attachments.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_attachments.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_attachments.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,91 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+$access = $zen->actionApplicable($id, "upload", $login_id);
+$colspan = $access? 5 : 4;
+if( $access ) {
+  $hotkeys->loadSection('tab_attachments');
+  ?>
+  <form method='post' action='<?=$rootUrl?>/actions/dropAttachments.php' name='deleteAttachmentForm'>
+  <input type="hidden" name="id" value="<?=$id?>">
+  <input type='hidden' name='setmode' value="<?=$zen->ffv($page_mode)?>">
+  <?
+}
+?>
+  <table width="600" class='formtable' cellpadding="2" cellspacing="1">
+   <tr>  
+     <td class="subTitle indent" colspan='<?=$colspan?>'>
+        <?=tr("Attachments")?>
+     </td>
+  </tr>
+<?
+  // get attachments and display a list
+  // of them
+  $attachments = $zen->get_attachments($id);
+  if( is_array($attachments) && count($attachments) > 0) {
+     ?>
+       <tr>
+         <td class='headerCell'><?=tr("Log ID")?></td>
+         <td class='headerCell'><?=tr("Attachment")?></td>
+         <td class='headerCell'><?=tr("Type")?></td>
+         <td class='headerCell'><?=tr("Description")?></td>
+         <? if( $access ) { ?>
+         <td class='headerCell'><?=tr("Delete")?></td>
+         <? } ?>
+       </tr>
+  <?
+     foreach($attachments as $a) {
+       $aid = $a['attachment_id'];
+       $clk = "onclick=\"ticketClk('".$zen->getSetting("url_view_attachment")."?aid=$aid');return false;\"";
+	?>
+	  <tr class='bars' <?=$row_rollover_eff?>>
+	  <td <?=$clk?>>
+	    <?= ($a["log_id"])?
+          $a['log_id']." ".
+	         "<a href='".$zen->getSetting("url_view_log")
+                    ."?lid=".$zen->ffv($a['log_id'])."' class='rowLink'>"
+                    ."<img src='$imageUrl/24x24/magnify.png' width='24' height='24' border='0'>"
+                    ."</a>" :
+	         "n/a";
+	    ?>
+	  </td>
+	  <td <?=$clk?>>
+	    <a href='<?=$zen->getSetting("url_view_attachment")?>?aid=<?=$aid?>' 
+	    class='rowLink' target='_blank'><?=$zen->ffv($a['name'])?></a></td>
+	  <td <?=$clk?>>
+	    <?=$zen->ffv($a["filetype"])?>
+	  </td>
+	  <td <?=$clk?>>
+	    <?=$zen->ffv($a["description"])?>
+	  </td>
+    <? if( $access ) { ?>
+    <td class='bars' onclick='checkMyBox("drops_<?=$aid?>", event)'>
+      <input id='drops_<?=$aid?>' type='checkbox' name='drops[]' value='<?=$aid?>'>
+    </td>
+    <? } ?>
+	  </tr>
+    <?
+     }    
+  } else {
+     print "<tr><td class='bars' colspan='4'>".tr("No attachments exist for this ?", array($page_type))."</td></tr>";
+  }
+?>
+  <? if( $access ) { ?>
+  <tr> 
+     <td class='subTitle' colspan='<?=$colspan?>'>
+     <? if( is_array($attachments) && count($attachments) ) { ?>
+       <div style='float:right'>
+       <? renderDivButtonFind('Delete Attachments', null, null, 150); ?>
+       </div>
+     <? } ?>
+       </form>
+       <div style='float:left'>
+       <form name='addAttachmentForm' action='<?=$rootUrl?>/actions/upload.php'>
+       <input type="hidden" name="id" value="<?=$id?>">
+       <input type='hidden' name='setmode' value="<?=$zen->ffv($page_mode)?>">
+       <? renderDivButtonFind('Add Attachment'); ?>
+       </form>
+       </div>
+     </td>
+   </tr>  
+   <? } ?>
+</table>
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_contacts.php zentrack_2-6-pre1/includes/templates/ticket_load_contacts.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_contacts.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_contacts.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,108 @@
+<?
+if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+$hotkeys->loadSection('tab_contacts');
+
+?>
+<table width="600" cellpadding="0" class='formtable' cellspacing="1">
+	 <tr>  
+     <td colspan='5' class='subTitle indent' width='100%'>
+       <?=tr("Related Contacts", array($page_type))?>    
+     </td>
+   </tr>
+<?
+  
+   $parms = array(array("ticket_id", "=", $id));
+   $sort = "ticket_id asc";
+   
+  $tickets = $zen->get_contacts($parms,"ZENTRACK_RELATED_CONTACTS",$sort);
+
+
+if ($tickets){
+?>
+ <form name='dropContactsForm' action="<?=$rootUrl?>/actions/dropFromContacts.php" method="post">
+ <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+ <input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
+ <tr>
+  <td class='headerCell'><?=tr("ID")?></td>	
+  <td class='headerCell' width='50%'><?=tr("Name")?></td>
+  <td class='headerCell'><?=tr("Telephone")?></td>
+  <td class='headerCell'><?=tr("E-mail")?></td>
+  <td class='headerCell'><?=tr("Delete")?></td>
+ </tr>
+<?  
+//print_r($tickets);
+    foreach($tickets as $n) {
+	    
+	   if ($n["type"]=="1"){
+		   $table = "ZENTRACK_COMPANY";
+		   $col = "company_id";
+		   $cpid = $n["cp_id"]; 
+		   $c1 = "cid" ;
+		   $n1 = "title";
+		   $n2 = "office";
+	   } else {
+	   	 $table = "ZENTRACK_EMPLOYEE";
+		 	 $col = "person_id";
+		   $cpid = $n["cp_id"];
+		 	 $c1 = "pid";
+		 	 $n1 = "lname";
+		   $n2 = "fname";
+		 }
+		 
+  	$u=$zen->get_contact($n["cp_id"],$table,$col);
+    $cpid = $zen->checkNum($cpid);
+    $tc = "onclick='checkMyBox(\"drops_".$zen->ffv($n['clist_id'])."\", event)' ";
+    $img = "<div style='float:right'><a href='#' onclick='ticketClk(\"$rootUrl/contact.php?$c1=$cpid\",this,event);return false;'>";
+    $img .= "<img src='$imageUrl/24x24/magnify.png' border='0' width='24' height='24'></a></div>";
+?>	
+    <tr class='bars' <?=$row_rollover_eff?>>
+    <td <?=$tc?>><?=$zen->ffv($cpid)?></td>
+    <td <?=$tc?>><?= $img." ".$zen->ffv(ucfirst($u[$n1]))." ".$zen->ffv($u[$n2]) ?></td>
+    <td <?=$tc?>><?= $u['telephone']? $zen->ffv($u["telephone"]) : '&nbsp;' ?></td>
+    <td <?=$tc?>><?
+      if( $email ) {
+      ?><A id='link_<?=$cpid?>' HREF="mailto:<?=$zen->ffv($u['email'])?>"><?=$zen->ffv($u["email"])?></A>
+      <? } else { ?>&nbsp;<? } ?></td>
+    <td <?=$tc?>><input 
+        id='drops_<?=$zen->ffv($n['clist_id'])?>' type='checkbox' name='drops[]' 
+        value='<?=$zen->ffv($n['clist_id'])?>'></td>
+    </tr>
+<?
+    }
+?>
+<tr>
+<td class='subTitle' colspan='5'>
+  </div>
+  <div style='float:right'>
+  <? renderDivButton($hotkeys->find('Drop Contacts'), "window.document.forms['dropContactsForm'].submit()"); ?>
+  </div>
+</form>
+  <div style='float:left'>
+  <form action="<?=$rootUrl?>/actions/addToContacts.php" name='ContactsAddForm'>
+  <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+  <? renderDivButton($hotkeys->find('Add Contact'), "window.document.forms['ContactsAddForm'].submit()"); ?>
+  <input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
+  </form>
+</td>
+</tr>
+<? } else { ?>
+<tr><td valign='top' colspan='5' class='bars'>
+<b><?=tr("No contacts found")?></b>
+</td></tr>
+<tr>
+<td colspan='5' class='subTitle'>
+  <form action="<?=$rootUrl?>/actions/addToContacts.php" name='ContactsAddForm'>
+  <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+  <? renderDivButton($hotkeys->find('Add Contact'), "window.document.forms['ContactsAddForm'].submit()"); ?>
+  <input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
+  </form>
+</td>
+</tr>
+<? } ?>     
+</table>
+<p>&nbsp;
+<form action='<?=$rootUrl?>/newContact.php' target="_BLANK" name='newContactForm'>
+  <input type='hidden' name='setmode' value='<?=$zen->ffv($page_mode)?>'>
+  <? renderDivButton($hotkeys->find('Create New Contact'), "window.document.forms['newContactForm'].submit()", 150); ?>
+</form>
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_details.php zentrack_2-6-pre1/includes/templates/ticket_load_details.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_details.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_details.php	2005-09-09 14:19:09.000000000 -0700
@@ -0,0 +1,6 @@
+
+<div class='borderBox'>
+  <div class='borderLabel'><span><?=uptr("Details")?></span></div>
+  <div class='borderContent'><?=$zen->ffvText($ticket['description'])?></div>
+</div>
+<br>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_log.php zentrack_2-6-pre1/includes/templates/ticket_load_log.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_log.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_log.php	2005-10-08 00:48:46.000000000 -0700
@@ -0,0 +1,107 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+
+$hotkeys->loadSection('log');
+$total_hours = 0;
+$logs = $zen->get_logs($id);
+$num_logs=0;
+if( is_array($logs) && count($logs) > 0) {
+  $att = $zen->get_attachments($id,null,1);
+  $sep = ",&nbsp;";
+  $syslogs = array();
+  foreach($logs as $l) {
+    $total_hours += $l['hours'];
+    $num_logs ++;
+
+    $lid = $l["lid"];
+    $style = ($style == 'cell')? 'bars' : 'cell';
+    $thing = " style=''";
+    if( !$l['user_id'] ) {
+      $thing = " style='display:none'";
+      $syslogs[] = $lid;
+    }
+    
+    // the details
+    $log_text .= "<div id='log_{$lid}' class='bars' $thing>";
+    $log_text .= "<b>".$zen->showDateTime($l["created"])." - ".uptr($l["action"])."</b>";
+    $log_text .= "<div class='tiny'>";
+    $log_text .= tr("Bin: ").$zen->getBinName($l["bin_id"]);
+    $log_text .= $sep.tr("User: ").$zen->formatName($l["user_id"],2);
+    $log_text .= (strlen($l["hours"]))? $sep.tr("Hours: ").$l['hours']:"";
+    $log_text .= "</div>";
+    $log_text .= "</div>";
+
+    // the log and attachments
+    if( $l["entry"] ) {
+      $log_text .= "<div id='log_{$lid}_entry' class='cell' $thing>";
+      $l["entry"] = $zen->ffvText($l["entry"]);
+      //$l["entry"] = preg_replace("#\&amp;#", "&", $l["entry"]);
+      //	$l["entry"] = preg_replace("#(https?://[a-zA-Z0-9_/.-]+[a-zA-Z0-9\-_]+\.[a-z]{2,3}(/[a-zA-Z/\._\?=&0-9-]+))#", "<a href='\\1' target='_blank'>\\1</a>", $l["entry"]);
+      $l["entry"] = preg_replace("|(https?://[a-zA-Z0-9_/.-]+(/[a-zA-Z0-9/\.,_\?=&;:#+$!~*%'()-]+[a-zA-Z0-9_=&#+~%-]))|",
+      "<a href='\\1' target='_blank'>\\1</a>", $l["entry"]);
+      $l["entry"] = preg_replace("#([^/])(www\.)([a-zA-Z_/.-]+[a-zA-Z])#", 
+	    "\\1<a href='http://www.\\3' target='_blank'>www.\\3</a>", $l["entry"]);
+      $l["entry"] = preg_replace("#^(www\.)([a-zA-Z_/.-]+[a-zA-Z])#", 
+      "<a href='http://www.\\2' target='_blank'>www.\\2</a>", $l["entry"]);
+      $log_text .= $l["entry"];
+      $log_text .= "</div>\n";
+    }
+    else if( !is_array($att["$id"]["$lid"]) ) {
+      $log_text .= "&nbsp;";
+    }
+    if( is_array($att["$id"]["$lid"]) ) {
+      $log_text .= "<div id='log_{$lid}_att' class='cell' $thing>";
+      $log_text .= "<b>".uptr("Attachments").":</b><br>";
+      foreach( $att["$id"]["$lid"] as $a ) {
+        $log_text .= "<a href='".$zen->getSetting("url_view_attachment")."?aid={$a['attachment_id']}' ";
+        $log_text .= "target='_blank'>{$a['name']}</a>";
+        $log_text .= "<span class='small'>{$a['description']}</span><br>\n";
+      }
+      $log_text .= "</div>\n";
+    }
+  }	    
+} else {
+  $log_text .= "<div>".tr("The log is empty")."</div>\n";
+}
+
+?>
+<div class='borderBox'>
+  <div class='borderLabel'><span><?=uptr("Log History")?></span></div>
+  <form>
+  <input type='checkbox' id='systemLogFilterCheckbox' value='1' onclick='toggleLogs(this.checked);'>
+  <label for="systemLogFilterCheckbox" title="<?=$hotkeys->tt("Show All Logs")?>"><?=$hotkeys->ll("Show All Logs");?></label>
+  <span class='note'>
+  &nbsp;&nbsp;&nbsp;&nbsp;<?=tr("Log Entries: ").$num_logs?>
+  &nbsp;&nbsp;&nbsp;&nbsp;<?=tr("Hours Worked: ").$total_hours?>
+  </span></form>
+  <div id='logSet' class='borderContent'><?=$log_text?></div>
+</div>
+<br>
+<? if( is_array($logs) && count($logs) > 0) { ?>
+<script type='text/javascript'>
+var sysLogIds = [<?
+
+  $sep = '';
+  foreach($syslogs as $s) {
+    print "$sep 'log_$s'";
+    if( !$sep ) { $sep = ','; }
+  }
+
+?>];
+
+function toggleLogs(b) {
+  var s = b? '' : 'none';
+  var n;
+  for(var i=0; i < sysLogIds.length; i++) {
+    n = sysLogIds[i];
+    toggleLogNode( window.document.getElementById(n), s );
+    toggleLogNode( window.document.getElementById(n+'_entry'), s );
+    toggleLogNode( window.document.getElementById(n+'_att'), s);
+  }
+}
+
+function toggleLogNode( node, s ) {
+  if( node ) { node.style.display = s; }  
+}
+
+</script>
+<? } ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_notify.php zentrack_2-6-pre1/includes/templates/ticket_load_notify.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_notify.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_notify.php	2005-10-21 03:59:54.000000000 -0700
@@ -0,0 +1,89 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } 
+
+  $on = $zen->actionApplicable($ticket['id'],'notify',$login_id);
+  $drop = $on && $zen->checkAccess($login_id,$ticket['bin_id'],'notify_drop');
+  $add = $on && $zen->checkAccess($login_id,$ticket["bin_id"],"notify_add");
+  $colspan = $drop? 5 : 4;
+  $hotkeys->loadSection('tab_notify');
+
+?>
+
+  <table width="600" cellpadding="0" cellspacing="1" class='formtable'>
+  <tr>  
+  <td class='subTitle indent' colspan='<?=$colspan?>'>
+  <?=tr("Notify Recipients")?>
+  </td>
+  </tr>  
+  <?
+  $notify_list = $zen->get_notify_list($id);
+  if( is_array($notify_list) ) {
+    ?>
+    <form name='dropNotifyForm' action="<?=$rootUrl?>/actions/dropFromNotify.php" method="post">
+    <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+    <input type="hidden" name="setmode" value="<?=$zen->ffv($page_mode)?>">
+    <tr>
+    <td class='headerCell'><?=tr("Name")?></td>
+    <td class='headerCell'><?=tr("Email")?></td>
+    <? if($drop) {?> <td class='headerCell'><?=tr("Delete")?></td> <? } ?>
+    </tr>
+    <?  
+    foreach($notify_list as $n) {
+      if( $n["user_id"] ) {
+        $u = $zen->get_user($n["user_id"]);
+        $name = $zen->formatName($u);
+        $email = $u["email"];
+      }
+      else {
+        $email = $n["email"];
+        $name = ($n["name"])? $n["name"] : "&nbsp;";
+      }
+      print "<tr class='bars'";
+      print $row_rollover_eff;
+      //print " onmouseover='if(window.document.body && mClassX){mClassX(this, \"altBars\", \"hand\");}' ";
+      //print " onmouseout='if(window.document.body && mClassX){mClassX(this);}'";
+      print " onclick='checkMyBox(\"drops_{$n['notify_id']}\", event)'>\n";
+      print "\t<td>$name</td>\n";
+      print "\t<td>".eLink($email)."</td>\n";
+      if( $drop ) {
+        print "\t<td><input id='drops_{$n['notify_id']}' type='checkbox' "
+        ."name='drops[]' value='{$n['notify_id']}'></td>\n";
+      }
+      print "</tr>\n";
+    }
+    ?>
+    <tr> 
+    <td class='subTitle' colspan='<?=$colspan?>'>
+    <? if( $drop ) { ?>
+    <div style='float:right'>
+    <? renderDivButtonFind('Drop Recipients'); ?>
+    </div>
+    <? } ?>
+    </form>
+    <? if( $add ) { ?>
+      <div style='float:left'>
+      <form name='notifyAddForm' action="<?=$rootUrl?>/actions/addToNotify.php">
+      <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+      <input type="hidden" name="setmode" value="<?=$zen->ffv($page_mode)?>">
+      <? renderDivButtonFind('Add Recipients'); ?>
+      </form>
+      </div>
+    <? } ?>
+    </td>
+    </tr>
+    <?
+  }
+  else {
+    print "<tr><td class='bars bold'>".tr("No recipients on notify list")."</td></tr>";
+    if( $add ) { 
+    ?>
+      <tr><td class='subTitle'>
+      <form name='notifyAddForm' action="<?=$rootUrl?>/actions/addToNotify.php">
+      <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
+      <input type="hidden" name="setmode" value="<?=$zen->ffv($page_mode)?>">
+      <? renderDivButtonFind('Add Recipients'); ?>
+      </form>
+      </td></tr>
+    <? }
+  }
+  ?>
+  </table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_related.php zentrack_2-6-pre1/includes/templates/ticket_load_related.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_related.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_related.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,34 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
+
+  <table width="600" cellpadding="2" cellspacing="2">
+   <tr>  
+     <td class='subTitle'>
+       <?=tr("Related ?",tr($page_type."s"))?>    
+     </td>
+   </tr>  
+   <tr>
+     <td valign="top">
+<?
+  $tickets = false;
+  if( $page_type == "ticket" ) {
+    $view='ticket_list';
+    $ticket = $zen->get_ticket($id);
+  } else {
+    $view='project_list';
+    $ticket = $zen->get_project($id);
+  }
+  if( $ticket["relations"] ) {
+     $tids = explode(",", $ticket["relations"]);
+     $tickets = $zen->get_tickets( array("id"=>$tids) );
+  }
+  $fields=$map->getFieldMap($view);
+  if( is_array($tickets) && count($tickets) ) {
+     include("$templateDir/listTickets.php");
+  } else {
+     print tr("No related ?", tr($page_type."s"));
+  }
+?>
+     </td>
+   </tr>
+   </table>
+
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_summary.php zentrack_2-6-pre1/includes/templates/ticket_load_summary.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_summary.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_summary.php	2005-09-09 14:19:09.000000000 -0700
@@ -0,0 +1,4 @@
+<div class='borderbox'>
+  <div class='borderlabel'><span><?=uptr("Summary")?></span></div>
+  <div class='propContent'><?=$zen->ffv($ticket['title'])?></div>
+</div>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_load_tasks.php zentrack_2-6-pre1/includes/templates/ticket_load_tasks.php
--- zentrack_2-5-5-2/includes/templates/ticket_load_tasks.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_load_tasks.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,37 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+  include_once("$libDir/sorting.php");
+  $tickets = $zen->get_tickets(array('project_id'=>$id),$sortstring);
+  $total_children = $zen->total_records;
+  $hotkeys->loadSection('project_tasks');
+
+  if( is_array($tickets) && count($tickets) > 0) {
+    $master_view = $view;
+    $view = 'project_tasks';
+    include("$templateDir/listTickets.php");
+    $view = $master_view;
+  } else {
+     print tr("No tickets have been added to this Project.");
+  }
+?>
+  <table width="100%" cellpadding="2" cellspacing="2">
+  <tr>
+     <td width='100%'>&nbsp;</td>
+     <td align="right">
+     <form style='display:inline' name='newTicketHotkey' action="<?=$rootUrl?>/newTicket.php">
+     <input type="hidden" name="project_id" value="<?=$zen->checkNum($id)?>">
+     <? renderDivButtonFind('Add Ticket to Project'); ?>
+     </form>
+     </td>
+     <td align='left'>
+     <form style='display:inline' name='newProjectHotkey' action="<?=$rootUrl?>/newProject.php">
+     <input type="hidden" name="project_id" value="<?=$zen->checkNum($id)?>">
+     <? renderDivButtonFind('Create Sub-Project'); ?>
+     </form>
+     </td>
+   </tr>    
+   </table>
+
+
+
+
+
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_logBox.php zentrack_2-6-pre1/includes/templates/ticket_logBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_logBox.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_logBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,64 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-
-<table width="600" align="center" cellpadding="2" cellspacing="2">
-<?
-$logs = $zen->get_logs($id);
-if( is_array($logs) && count($logs) > 0) {
-  print "<tr><td class='titleCell'>".tr("Log Entries");
-  print "</td></tr>\n";
-  $att = $zen->get_attachments($id,null,1);
-  $i = 1;
-  $sep = "\n--";
-  foreach($logs as $l) {
-    if( $i == 20 ) {
-      print $title_row;
-      $i = 1;
-    }
-    $lid = $l["lid"];
-    $style = ($style == 'cell')? 'bars' : 'cell';
-    //
-    // the details
-    print "<tr>\n";
-    print "<td class='$style' style='color:".$zen->settings["color_text"]."'>";
-    print $zen->showDateTime($l["created"]);
-    print $sep.$l["action"];
-    print "<br>".$zen->getBinName($l["bin_id"]);
-    print $sep.$zen->formatName($l["user_id"],2);
-    print (strlen($l["hours"]))? $sep.$l["hours"]." hrs":"";
-    //
-    // the log and attachments
-    if( $l["entry"] ) {
-      print "<br>\n";
-      $l["entry"] = $zen->ffvText($l["entry"]);
-      //$l["entry"] = preg_replace("#\&amp;#", "&", $l["entry"]);
-      //	$l["entry"] = preg_replace("#(https?://[a-zA-Z0-9_/.-]+[a-zA-Z0-9\-_]+\.[a-z]{2,3}(/[a-zA-Z/\._\?=&0-9-]+))#", "<a href='\\1' target='_blank'>\\1</a>", $l["entry"]);
-      $l["entry"] = preg_replace("|(https?://[a-zA-Z0-9_/.-]+(/[a-zA-Z0-9/\.,_\?=&;:#+$!~*%'()-]+[a-zA-Z0-9_=&#+~%-]))|",
-      "<a href='\\1' target='_blank'>\\1</a>", $l["entry"]);
-      $l["entry"] = preg_replace("#([^/])(www\.)([a-zA-Z_/.-]+[a-zA-Z])#", 
-	    "\\1<a href='http://www.\\3' target='_blank'>www.\\3</a>", $l["entry"]);
-      $l["entry"] = preg_replace("#^(www\.)([a-zA-Z_/.-]+[a-zA-Z])#", 
-      "<a href='http://www.\\2' target='_blank'>www.\\2</a>", $l["entry"]);
-      
-      
-      print $l["entry"];
-    }
-    if( is_array($att["$id"]["$lid"]) ) {
-      print "<p><b>".uptr("Attachments").":</b><br>";
-      foreach( $att["$id"]["$lid"] as $a ) {
-        print "<a href='".$zen->settings["url_view_attachment"]
-        ."?aid=$a[attachment_id]' ";
-        print "target='_blank'>$a[name]</a>";
-        print "<span class='small'>($a[description])</span><br>\n";
-      }
-    }
-    print "</td></tr>\n";
-    print "</td>\n";
-    $i++;
-  }	    
-} else {
-  print "<tr><td height='300' valign='top'>"
-  .tr("The log is empty")."</td></tr>\n";
-}
-?>
-</table>
-
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_notifyBox.php zentrack_2-6-pre1/includes/templates/ticket_notifyBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_notifyBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_notifyBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,90 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-  <tr> 
-  <td align="right">
-  <form action="<?=$rootUrl?>/actions/addToNotify.php">
-  <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
-  <?
-  if( $zen->checkAccess($login_id,$ticket["bin_id"],"notify") ) {
-    $button = "submit";
-    $color = $zen->settings["color_highlight"];
-  } else {
-    $button = "button";
-    $color = $zen->settings["color_alt_background"];
-  }
-  ?>
-  <input type="<?=$button?>"
-  value=" <?=tr("Add Recipient")?> " class="actionButton" 
-  style="width:125;color:<?=$color?>">  
-  </form>
-  </td>
-  </tr>
-  <tr>  
-  <td class='titleCell'>
-  <?=tr("Notify List")?>
-  </td>
-  </tr>  
-  <tr>
-  <td valign="top">
-  <form action="<?=$rootUrl?>/actions/dropFromNotify.php" method="post">
-  <input type="hidden" name="id" value="<?=$zen->checkNum($id)?>">
-  <?
-  $notify_list = $zen->get_notify_list($id);
-  if( is_array($notify_list) ) {
-    ?>
-    <table width='500'>
-    <tr>
-    <td class='subTitle' align='center'><?=tr("Name")?></td>
-    <td class='subTitle' align='center'><?=tr("Email")?></td>
-    <td class='subTitle' align='center'><?=tr("Delete")?></td>
-    </tr>
-    <?  
-    foreach($notify_list as $n) {
-      if( $n["user_id"] ) {
-        $u = $zen->get_user($n["user_id"]);
-        $name = $zen->formatName($u);
-        $email = $u["email"];
-      }
-      else {
-        $email = $n["email"];
-        $name = ($n["name"])? $n["name"] : "&nbsp;";
-      }
-      print "<tr class='cell'";
-      print " onmouseover='mClassX(this, \"bars\", \"hand\")' onmouseout='mClassX(this)'";
-      print " onclick='checkMyBox(\"drops_{$n['notify_id']}\", event)'>\n";
-      print "\t<td>$name</td>\n";
-      print "\t<td>$email</td>\n";
-      print "\t<td><input id='drops_{$n['notify_id']}' type='checkbox' "
-      ."name='drops[]' value='{$n['notify_id']}'></td>\n";
-      print "</tr>\n";
-    }
-    ?>
-    </table>
-    </td>
-    </tr>
-    <tr> 
-    <td align="right">
-    <?
-    if( $zen->checkAccess($login_id,$ticket["bin_id"],"notify_set") ) {
-	    $button = "submit";
-	    $color = $zen->settings["color_highlight"];
-    } else {
-	    $button = "button";
-	    $color = $zen->settings["color_alt_background"];
-    }
-    ?>
-    <input type="<?=$button?>" 
-	  value=" <?=tr("Drop Recipients")?> " 
-	  class="actionButton" style="width:125;color:<?=$color?>">  
-    <?
-  }
-  else {
-    print "<b>".tr("No recipients on notify list")."</b>";
-  }
-  ?>
-  </form>
-  </td>
-  </tr>
-  </table>
-  
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_relatedBox.php zentrack_2-6-pre1/includes/templates/ticket_relatedBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_relatedBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_relatedBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,34 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-   <tr>  
-     <td class='titleCell'>
-       <?=tr("Related ?s", array($page_type))?>    
-     </td>
-   </tr>  
-   <tr>
-     <td valign="top">
-<?
-  $tickets = false;
-  if( $page_type == "ticket" ) {
-    $view='ticket_list';
-    $ticket = $zen->get_ticket($id);
-  } else {
-    $view='project_list';
-    $ticket = $zen->get_project($id);
-  }
-  if( $ticket["relations"] ) {
-     $tids = explode(",", $ticket["relations"]);
-     $tickets = $zen->get_tickets( array("id"=>$tids) );
-  }
-  $fields=$map->getFieldMap($view);
-  if( is_array($tickets) && count($tickets) ) {
-     include("$templateDir/listTickets.php");
-  } else {
-     print tr("No tickets have been associated with this ticket.");
-  }
-?>
-     </td>
-   </tr>
-   </table>
-
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_tab_form.php zentrack_2-6-pre1/includes/templates/ticket_tab_form.php
--- zentrack_2-5-5-2/includes/templates/ticket_tab_form.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_tab_form.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,93 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+  /**
+   * TICKET TAB FORM
+   *
+   * Generates a form for editing a given list of fields in a ticket tab
+   *
+   * $formview - (String) the field map view to use for deciding which fields to show
+   * $map - (ZenFieldMap)
+   * $actionName - where to send post data (defaults to $SCRIPT_NAME)
+   * $submitName - name of submit button (defaults to 'Save')
+   * $formTitle - title of the form
+   * $formDesc - descriptive text for this form (optional)
+   * $id - id of the ticket to display
+   */
+  $fields = $map->getFieldMap($formview);
+  if( !isset($actionName) ) { $actionName = $SCRIPT_NAME; }
+  if( !isset($submitName) ) { $submitName = 'Save'; }
+  $hidden_fields = array();
+  $visible_fields = array();
+  foreach($fields as $f=>$field) {
+    if( !$field['is_visible'] ) { $hidden_fields["$f"] = $field; }
+    else {
+      $visible_fields["$f"] = $field;
+    }
+  }
+?>
+
+<form method="post" name="ticketTabForm" action="<?=$actionName?>" onSubmit='return validateTicketForm(this)'>
+<?
+$context = new ZenFieldMapRenderContext(
+  array("view" => $formview, "form" => 'ticketForm')
+);
+foreach($hidden_fields as $f=>$field) {
+  $context->set('field', $f);
+  $context->set('value', $ticket[$f]);
+  print $map->renderTicketField($context);
+}
+?>
+<input type="hidden" name="id" value="<?=$zen->ffv($id)?>">
+<input type="hidden" name="actionComplete" value="1">
+<input type='hidden' name='ticketTabAction' value='1'>
+<input type='hidden' name='currentMode' value='<?=$zen->ffv($page_mode)?>'>
+
+<table class='formtable' cellpadding="4" cellspacing="1" border="0">
+<tr>
+ <td colspan='2' class='subTitle'><?=tr($formTitle)?>
+ <? if( isset($formDesc) ) { print "&nbsp;&nbsp;<span class='note'>".tr($formDesc)."</span>"; } ?>
+ </td>
+</tr>
+<?
+
+foreach($visible_fields as $f=>$field) {
+  $context->set('field', $f);
+  $context->set('value', $ticket[$f]);
+  $context->set('force_label', $f == 'status');
+  if( $field['field_type'] == 'section' ) {
+    print "<tr><td colspan='2' class='subTitle'>";
+    print $map->renderTicketField($context);
+    print "</td></tr>\n";
+  }
+  else {
+    print "<tr><td class='bars' width='150'>";
+    $key = $hotkeys->find("Field: $f");
+    if( $key ) {
+      print $hotkeys->label($key, $map->getLabel($formview,$f));
+    }
+    else {
+      print $map->getLabel($formview,$f);
+    }
+    if( $field['is_required'] ) {
+      print "&nbsp;<span class='error bigBold'>*</span>";
+    }
+    print "</td><td class='bars'>";
+    print $map->renderTicketField($context);
+    print "</td></tr>\n";
+  }
+}
+
+?>
+
+<tr>
+  <td class="subTitle" colspan='2'>
+  <? renderDivButton($hotkeys->find($submitName), "if( validateTicketForm(window.document.forms['ticketTabForm']) ) { window.document.forms['ticketTabForm'].submit(); }"); ?>
+  </td>
+</tr>
+<tr>
+</table>
+<div class='error'><?=tr("Fields marked with ? are required", "<span class='bigBold'>*</span>")?></div>
+</form>			     
+<?
+  include_once("$libDir/templates/validateTicketForm.php");
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_tabs.php zentrack_2-6-pre1/includes/templates/ticket_tabs.php
--- zentrack_2-5-5-2/includes/templates/ticket_tabs.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/ticket_tabs.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,51 @@
+<? if( !ZT_DEFINED ) { die("Illegal Access"); }
+
+ /**
+  * A tab or block of information in the ticket view
+  *
+  * REQUIREMENTS:
+  *   $map - instance of ZenFieldMap
+  *   $zen - instance of ZenTrack
+  *   $hotkeys - instance of ZenHotKeys
+  *   $page_type - 'ticket' or 'project'
+  *   $id - id of the ticket
+  *   $ticket - values of the ticket
+  */
+  function getTabCounts( $id, $loads ) {
+    static $stats;
+    $zen = $GLOBALS['zt_zen'];
+    if( !$loads || !count($loads) ) { return ''; }
+    if( !$stats ) { $stats = $zen->get_ticket_stats($id); }
+    $tf = false;
+    $counts = array();
+    foreach($loads as $l) {
+      if( array_key_exists("$l", $stats) ) {
+        $counts[] = $stats["$l"];
+        if( $stats["$l"] > 0 ) { $tf = true; }
+      }
+    }
+    if( $tf ) { return " (".join(',',$counts).")"; }
+    return '';
+  }
+
+  $tabs = $map->getTabs($page_type, $login_id, $ticket['bin_id']);
+  print "<table cellpadding='0' cellspacing='0'><tr>";
+  $n = 1;
+  foreach($tabs as $k=>$v) {
+    $key = $n++;
+    $viewProps = $map->getViewProps($k);
+    if( !$viewProps['visible']['vm_val'] ) { continue; }
+    $loads = array();
+    if( $v['preload'] ) { $loads = $v['preload']; }
+    if( $v['postload'] ) { $loads = array_merge($loads, $v['postload']); }
+    $class = $page_mode == $k? "class='tab on'" : "class='tab off' $nav_rollover_text";
+    print "<td $class height='20' title='".$hotkeys->tooltip($key)."'>";
+    $class = $page_mode == $k? "tab on" : "tab off";
+    print "<a href='$rootUrl/$page_type.php?id=$id&setmode=$k'>".$hotkeys->label($key,'');
+    print getTabCounts($id,$loads)."</a>";
+    print "</td>";
+    print "<td width='3'><img src='$imageUrl/empty.gif' width='3' height='1'></td>\n";
+  }
+  print "</tr></table>";
+
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_tasksBox.php zentrack_2-6-pre1/includes/templates/ticket_tasksBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_tasksBox.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_tasksBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,60 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-
-  <table width="600" align="center" cellpadding="2" cellspacing="2">
-  <tr> 
-     <td align="right">
-     <form action="<?=$rootUrl?>/newTicket.php">
-     <input type="hidden" name="project_id" value="<?=$zen->checkNum($id)?>">
-       <?
-         if( $zen->checkAccess($login_id,$ticket["bin_id"],"create") ) {
-	    $button = "submit";
-	    $color = $zen->settings["color_highlight"];
-	 } else {
-	    $button = "button";
-	    $color = $zen->settings["color_alt_background"];
-	 }
-       ?>
-       <input type="<?=$button?>" value=" <?=$zen->ttl("Add ticket to project")?> " class="actionButton" style="width:125;color:<?=$color?>">  
-     </form>
-     </td>
-   </tr>  
-  <tr> 
-     <td align="right">
-     <form action="<?=$rootUrl?>/newProject.php">
-     <input type="hidden" name="project_id" value="<?=$zen->checkNum($id)?>">
-       <?
-         if( $zen->checkAccess($login_id,$ticket["bin_id"],"create") ) {
-	    $button = "submit";
-	    $color = $zen->settings["color_highlight"];
-	 } else {
-	    $button = "button";
-	    $color = $zen->settings["color_alt_background"];
-	 }
-       ?>
-       <input type="<?=$button?>" value=" <?=tr("Create Sub-Project")?> " class="actionButton" style="width:125;color:<?=$color?>">  
-     </form>
-     </td>
-   </tr>    
-   <tr>  
-     <td class='titleCell'>
-       <?=tr("Tasks for this project")?>
-     </td>
-   </tr>  
-   <tr>
-     <td valign="top">
-<?
-  if( is_array($children) && count($children) > 0) {
-     $tickets = $children;
-     unset($children);
-     include("$templateDir/listTickets_workFormat.php");
-  } else {
-     print tr("No tickets have been added to this Project.");
-  }
-?>
-     </td>
-   </tr>
-   </table>
-
-
-
-
diff -Naur zentrack_2-5-5-2/includes/templates/ticket_titleBox.php zentrack_2-6-pre1/includes/templates/ticket_titleBox.php
--- zentrack_2-5-5-2/includes/templates/ticket_titleBox.php	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/ticket_titleBox.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,61 +0,0 @@
-<? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
-<table width="560" cellpadding="0" cellspacing="0">
-  <tr>
-   <td class="ticketCell"><table 
-     align="center" width='540'>     
-     <tr>
-       <td valign="top" width="440"><table 
-          width="400" cellpadding="2" cellspacing="1">
-	  <tr>
-	   <td class="smallTitleCell" height="<?=$height_num?>"><?=tr("ID")?></td>
-	   <td class="smallTitleCell" colspan="2"><?=uptr("Title")?></td>
-	  </tr>
-	  <tr>
-	   <td class="small"><?=$id?></td>
-	   <td colspan="2"><?=$zen->ffv($title)?></td>
-	  </tr>
-	  <tr>
-	   <td class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Elapsed")?></td>  
-	   <td class="smallTitleCell"><?=uptr("Opened")?></td>
-	   <td class="smallTitleCell"><?=uptr("Deadline")?></td>
-	  </tr>
-	  <tr>
-	   <td class="small"><?=$zen->showTimeElapsed($otime,$ctime,1,0)?></td>  
-	   <td class="small"><?=$zen->showDateTime($otime)?></td>
-	   <td class="small"><?=($deadline)?$zen->showDateTime($deadline):"n/a"?></td>
-	  </tr>
-	  <tr>
-	   <td rowspan="2"><span class="bigBold"><?=strtoupper($status)?></span></td>
-	   <td class="smallTitleCell" height="<?=$height_num?>"><?=uptr("Priority")?></td> 
-	   <td class="smallTitleCell"><?=uptr("Owner")?></td>
-	  </tr>
-	  <tr>
-            <td class="priority<?=$priority?>"><?=$zen->priorities["$priority"]?></td>
-	   <td class="small"><? 
-	     if($user_id) { 
-	       $user = $zen->get_user($user_id); 
-	       print $user["fname"]." ".$user["lname"];
-	     } else { 
-	       print "-none-"; 
-	     }
-	           ?></td>
-          </tr>	  	  
-	  <tr>
-	 </table></td>
-       <td valign="top" width='100'><?
-       $actions = array(
-          "accept"  => 1,			
-          "assign"  => 0,		     
-          "reject"  => 1,
-          "yank"    => 0,
-          "reopen"  => 0,			
-          "print"   => 1,
-          "email"   => 1,
-          "edit"    => 0
-			);
-       include("$templateDir/ticket_actionBar.php");
-     ?></td>
-     </tr>
-    </table></td>
-  </tr>
-</table>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/totalsBar.php zentrack_2-6-pre1/includes/templates/totalsBar.php
--- zentrack_2-5-5-2/includes/templates/totalsBar.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/templates/totalsBar.php	2005-10-20 11:23:44.000000000 -0700
@@ -0,0 +1,90 @@
+<?
+ /**
+  * GENERATE A TOTALS PRINTOUT
+  *
+  * REQUIREMENTS
+  *    $cols - total number of columns in table
+  *    $est_col - est_hours column (or zero)
+  *    $wkd_col - wkd_hours column (or zero)
+  *    $ttl_est - total of all rows for est_hours
+  *    $ttl_wkd - total of all rows for wkd_hours (up to 100% for each row)
+  *    $ttl_ext - total of all rows for wkd_hours (can be over 100% for each row)
+  *    $totals_titlebar_txt - name of the bar
+  */
+  
+  $ttl_per_txt = "n/a";
+  if( $ttl_est ) {
+    $ttl_per_txt = $zen->percentWorked($ttl_est,$ttl_wkd).tr('%');
+  }
+  $ttl_est_txt = strlen($ttl_est)? number_format($ttl_est, $num, $dec, $sep) : '&nbsp;';
+  $ttl_ext_txt = strlen($ttl_ext)? number_format($ttl_ext, $num, $dec, $sep) : '&nbsp;';
+
+  $from = 1;
+  $to = $cols;
+  if( $est_col && $wkd_col ) {
+    $l = $est_col < $wkd_col? $est_col : $wkd_col;
+    $g = $est_col > $wkd_col? $est_col : $wkd_col;
+    if( $l == 1 ) {
+      if( $g == 2 ) {
+        // if our totals occupy the first two columns, start from
+        // the third
+        $from = 3;
+        $to = $cols;
+      }
+      else {
+        // if one of our totals occupies the first column, start
+        // from the second
+        $from = 2;
+        $to = $g;
+      }
+    }
+    else {
+      $to = $l;
+    }
+  }
+  else if( $est_col || $wkd_col ) {
+    $l = $est_col? $est_col : $wkd_col;
+    if( $l == 1 ) {
+      // if our total occupies the first column, then start from the second
+      $from = 2;
+    }
+    else {
+      $to = $l;
+    }
+  }
+  
+  print "<tr class='headerCell'>\n";
+  for($i=1; $i <= $cols; $i++) {
+    if( $i == $est_col ) {
+      // this is our est total
+      print "<td align='right'>$ttl_est_txt</td>\n";
+      $next = $i+1;
+    }
+    else if( $i == $wkd_col ) {
+      // this is our wkd total
+      print "<td align='right'>$ttl_ext_txt</td>\n";
+      $next = $i+1;
+    }
+    else if( $i == $from ) {
+      // this is our totals label cell
+      $colspan = $to-$from > 1? "colspan='".($to-$from)."'" : '';
+      print "<td $colspan align='right'>{$totals_titlebar_txt}&nbsp;&nbsp;</td>\n";
+      $next = $to;
+    }
+    else if( $i != $cols && $i == $next ) {
+      // this is some random column between our values
+      // see if we should colspan this and make some empty space
+      $n = $cols;
+      if( $est_col > $next && $est_col < $n ) { $n = $est_col; }
+      if( $wkd_col > $next && $wkd_col < $n ) { $n = $wkd_col; }
+      if( $from > $next && $from < $n ) { $n = $from; }
+      $colspan = ($n - $next > 1)? "colspan='".($n-$next)."'" : '';
+      print "<td $colspan>&nbsp;</td>\n";
+    }
+    else if( $i == $cols ) {
+      // this is our totals column
+      print "<td align='right'>$ttl_per_txt</td>\n";         
+    }
+  }
+  print "</tr>\n";
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/templates/tutorial/english/add_attachment.php zentrack_2-6-pre1/includes/templates/tutorial/english/add_attachment.php
--- zentrack_2-5-5-2/includes/templates/tutorial/english/add_attachment.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/tutorial/english/add_attachment.php	2005-09-09 13:28:23.000000000 -0700
@@ -10,7 +10,7 @@
 
 <p>The type of items which can be attached to a ticket are determined by
 your administrator.  Currently, the system is configured to accept the 
-following attachments: <?=$zen->settings['attachment_types_allowed']?>
+following attachments: <?=$zen->getSetting('attachment_types_allowed')?>
 
 <p><b>Viewing Attachments</b></p>
 
diff -Naur zentrack_2-5-5-2/includes/templates/tutorial/english/contacts.php zentrack_2-6-pre1/includes/templates/tutorial/english/contacts.php
--- zentrack_2-5-5-2/includes/templates/tutorial/english/contacts.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/tutorial/english/contacts.php	2005-09-09 13:28:23.000000000 -0700
@@ -11,7 +11,7 @@
 <p>The Contact List is essentially an address book.
 
 <p>Contacts represent companies and employees (both internal and external to your
-organization) which do not have a login account for <?=$zen->settings['system_name']?>.
+organization) which do not have a login account for <?=$zen->getSetting('system_name')?>.
 
 <p>Contacts may be used simply as a record of the responsible parties or people
 associated with a ticket or to add people to the notify lists for tickets.
diff -Naur zentrack_2-5-5-2/includes/templates/userAdd.php zentrack_2-6-pre1/includes/templates/userAdd.php
--- zentrack_2-5-5-2/includes/templates/userAdd.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/userAdd.php	2005-09-09 13:28:23.000000000 -0700
@@ -11,7 +11,7 @@
 <form method="post" action="<?=$rootUrl?>/admin/<?=$url?>UserSubmit.php">
 <? if( $td ) { print "<input type='hidden' name='user_id' value='".strip_tags($user_id)."'>\n"; } ?>
   
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
   <?=$blurb?>
diff -Naur zentrack_2-5-5-2/includes/templates/userSearchForm.php zentrack_2-6-pre1/includes/templates/userSearchForm.php
--- zentrack_2-5-5-2/includes/templates/userSearchForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/userSearchForm.php	2005-09-09 13:28:23.000000000 -0700
@@ -1,6 +1,6 @@
 <? if( !ZT_DEFINED ) { die("Illegal Access"); } ?>
 
-<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->settings["color_background"]?>">
+<table width="640" align="left" cellpadding="2" cellspacing="2" bgcolor="<?=$zen->getSetting("color_background")?>">
 <tr>
   <td colspan="2" width="640" class="titleCell" align="center">
     <?=tr("Search For Users")?>
diff -Naur zentrack_2-5-5-2/includes/templates/userSearchList.php zentrack_2-6-pre1/includes/templates/userSearchList.php
--- zentrack_2-5-5-2/includes/templates/userSearchList.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/userSearchList.php	2005-09-09 13:28:23.000000000 -0700
@@ -6,43 +6,43 @@
  
    $c = count($users);
       ?>
-        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->settings["color_alt_background"]?>'>
+        <table width="100%" cellspacing='1' cellpadding='2' bgcolor='<?=$zen->getSetting("color_alt_background")?>'>
         <tr><td class='titleCell' colspan="8" align='center'><?=($c>1)? "$c ".tr("matches") : "1 ".tr("match");?></td></tr>
-   <tr bgcolor="<?=$zen->settings["color_title_background"]?>">
+   <tr bgcolor="<?=$zen->getSetting("color_title_background")?>">
    <td width="32" height="25" valign="middle" title="<?=tr("Users System ID")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("ID")?></span></b></span></div>
    </td>
    <td height="25" valign="middle" title="<?=tr("The name of the user")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
         <b><span class="small"><?=tr("Name")?></span></b></span></div>
    </td>
    <td height="25" valign="middle" title="<?=tr("Users Initials")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
         <b><span class="small"><?=tr("Initials")?></span></b></span></div>
    </td>
    <td width="32" height="25" valign="middle" title="<?=tr("Default Access Level")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>"><b><span class="small"><?=tr("Access")?></span></b></span></div>
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>"><b><span class="small"><?=tr("Access")?></span></b></span></div>
    </td>
    <td height="25" valign="middle" title="<?=tr("Users email address")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
         <b><span class="small"><?=tr("Email")?></span></b></span></div>
    </td>
      <td width="32" height="25" valign="middle" title="<?=tr("Account is Active")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
              <b><span class="small"><?=tr("Active")?></span></b></span></div>
      </td>
      <td width="32" height="25" valign="middle" title="<?=tr("Users Default Bin")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
              <b><span class="small"><?=tr("Home")?></span></b></span></div>
      </td>
      <td width="32" height="25" valign="middle" title="<?=tr("Administrative Options")?>">
-     <div align="center"><span style="color:<?=$zen->settings["color_title_txt"]?>">
+     <div align="center"><span style="color:<?=$zen->getSetting("color_title_txt")?>">
              <b><span class="small"><?=tr("Options")?></span></b></span></div>
      </td>
    </tr>
       <?      
 
-   $text = $zen->settings["color_bar_text"];
+   $text = $zen->getSetting("color_bar_text");
    $elnk = "$rootUrl/admin/editUser.php";
    $dlnk = "$rootUrl/admin/deleteUser.php";
    $alnk = "$rootUrl/admin/access.php";
@@ -52,8 +52,8 @@
       unset($txt);
       unset($tx);
       unset($est);
-      $row = ($row == $zen->settings["color_bars"])?
-   $zen->settings["color_background"] : $zen->settings["color_bars"];
+      $row = ($row == $zen->getSetting("color_bars"))?
+   $zen->getSetting("color_background") : $zen->getSetting("color_bars");
       $name = $zen->formatName($u,1);
       if( $search_text && ($search_fields["lname"] || $search_fields["fname"] ) ) {
    $name = $zen->highlight($name,$search_text);
diff -Naur zentrack_2-5-5-2/includes/templates/validateTicketForm.php zentrack_2-6-pre1/includes/templates/validateTicketForm.php
--- zentrack_2-5-5-2/includes/templates/validateTicketForm.php	2005-05-01 23:59:38.000000000 -0700
+++ zentrack_2-6-pre1/includes/templates/validateTicketForm.php	2005-10-11 04:48:19.000000000 -0700
@@ -4,11 +4,11 @@
   /**
    PREREQUISITES:
      (ZenFieldMap)$map - contains properties for fields
-     (string)$view - the current view (probably project_create or ticket_create)
+     (string)$formview - the current view (probably project_create or ticket_create)
      (string)$page_type - (optional) either 'ticket' or 'project'
   **/
+  $fields = $map->getFieldMap($formview);
 ?>
-
 <script language='Javascript' type='text/javascript'>
 
  function validateField( obj ) {
@@ -34,24 +34,25 @@
       default:
         return false;
     }
+    return true;
  }
 
- function validateTicketForm() {
+ function validateTicketForm(formObj) {
    var errs = new Array();
 <?
-foreach($fields as $f) {
-  $field = $map->getFieldFromMap($view,$f['field_name']);
+foreach($fields as $f=>$field) {
   // we don't want to validate any hidden fields using javascript, this is
   // a potential problem.
-  if( $field['is_required'] && $field['is_visible'] && $field['field_type'] != 'label' ) {
-    $label = $map->getLabel($view,$f);
+  if( $field['is_required'] && $field['is_visible'] && $field['field_type'] != 'label'
+      && $f != 'status') {
+    $label = $map->getLabel($formview,$f);
     $tr = $zen->fixJSVal(tr("? is required",array(tr($label))));
-    print "\tif( !validateField(document.ticketForm.$f) ) { errs[errs.length] = $tr; }\n";
+    print "\tif( !validateField(formObj.elements['$f']) ) { errs[errs.length] = $tr; }\n";
   }
 }
-if ($td && $zen->settings['edit_reason_required']=='on' && $zen->settings['log_edit']=='on') {
+if ($td && $zen->settingOn('edit_reason_required') && $zen->settingOn('log_edit') ) {
     $tr = $zen->fixJSVal(tr("? is required",array(tr("Edit Reason"))));
-    print "\tif( !validateField(document.ticketForm.edit_reason) ) { errs[errs.length] = $tr; }\n";
+    print "\tif( !validateField(formObj.elements['edit_reason']) ) { errs[errs.length] = $tr; }\n";
 }
 ?>
    if( errs.length > 0 ) {
diff -Naur zentrack_2-5-5-2/includes/translations/english.trans zentrack_2-6-pre1/includes/translations/english.trans
--- zentrack_2-5-5-2/includes/translations/english.trans	2004-02-27 03:37:46.000000000 -0800
+++ zentrack_2-6-pre1/includes/translations/english.trans	2005-09-09 13:28:23.000000000 -0700
@@ -44,7 +44,7 @@
 
 
 #file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "? Settings"
 msgstr ""
 
@@ -140,7 +140,7 @@
 
 
 #file "D:\zentrack\zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "About ?"
 msgstr ""
 
@@ -2709,7 +2709,8 @@
 
 #file "D:\zentrack\zentrack/includes/templates/userAdd.php"
 #args ""
-msgid "This grants the user the specified level of  	access to all bins not otherwise indicated by 'user access'."
+msgid "This grants the user the specified level of 
+ 	access to all bins not otherwise indicated by 'user access'."
 msgstr ""
 
 
@@ -3207,7 +3208,8 @@
 
 #file "D:\zentrack\zentrack/includes/templates/pwcForm.php"
 #args ""
-msgid "Your passphrase must be at least 6 characters long and      contain at least 1 non-letter character."
+msgid "Your passphrase must be at least 6 characters long and 
+     contain at least 1 non-letter character."
 msgstr ""
 
 
diff -Naur zentrack_2-5-5-2/includes/translations/french.trans zentrack_2-6-pre1/includes/translations/french.trans
--- zentrack_2-5-5-2/includes/translations/french.trans	2004-02-27 03:37:46.000000000 -0800
+++ zentrack_2-6-pre1/includes/translations/french.trans	2005-09-09 13:28:23.000000000 -0700
@@ -44,7 +44,7 @@
 
 
 #file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "? Settings"
 msgstr "Rglages (?)"
 
@@ -140,7 +140,7 @@
 
 
 #file "D:\zentrack\zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "About ?"
 msgstr " propos de ?"
 
diff -Naur zentrack_2-5-5-2/includes/translations/german.trans zentrack_2-6-pre1/includes/translations/german.trans
--- zentrack_2-5-5-2/includes/translations/german.trans	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-6-pre1/includes/translations/german.trans	2005-09-09 13:28:23.000000000 -0700
@@ -44,7 +44,7 @@
 
 
 #file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "? Settings"
 msgstr "? Einstellungen"
 
@@ -146,7 +146,7 @@
 
 
 #file "D:\zentrack\zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "About ?"
 msgstr "ber ?"
 
@@ -3435,7 +3435,8 @@
 msgstr "ja"
 
 
-msgid "This grants the user the specified level of  	access to all bins not otherwise indicated by 'user access'."
+msgid "This grants the user the specified level of 
+ 	access to all bins not otherwise indicated by 'user access'."
 msgstr ""
 
 
@@ -3447,7 +3448,8 @@
 msgstr ""
 
 
-msgid "Your passphrase must be at least 6 characters long and      contain at least 1 non-letter character."
+msgid "Your passphrase must be at least 6 characters long and 
+     contain at least 1 non-letter character."
 msgstr ""
 
 
diff -Naur zentrack_2-5-5-2/includes/translations/portuguese.trans zentrack_2-6-pre1/includes/translations/portuguese.trans
--- zentrack_2-5-5-2/includes/translations/portuguese.trans	2003-10-11 09:38:45.000000000 -0700
+++ zentrack_2-6-pre1/includes/translations/portuguese.trans	2005-09-09 13:28:23.000000000 -0700
@@ -1,3616 +1,7232 @@
-# This is the translation template file. It is automatically generated from developers/tr-parser.php
-# If you have any questions on how to create a translation file please direct them to zentrack support
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/assign.php"
-#args "array($r)"
-msgid " ? is required"
-msgstr "?  requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "%"
-msgstr ""
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args "array($file_type)"
-msgid "'?' is not an allowed file extension - See your systems administrator for more information"
-msgstr "'?' no  uma extenso vlida de arquivo - Para mais informaes consulte o Administrador do sistema"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "* = required"
-msgstr "* = requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "1 Match"
-msgstr "1 Ocorrncia"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/close.php"
-#args "array($zen->types[$c['type_id']], $c['id'])"
-msgid "? ? is not completed."
-msgstr "? ? no foi concludo."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args "array($c)"
-msgid "? Matches"
-msgstr "? Ocorrncias"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
-msgid "? Settings"
-msgstr "? Configuraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
-#args "array($j)"
-msgid "? bins were saved to the database. Updates complete"
-msgstr "? repositrios foram salvos no banco de dados. Alteraes concludas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/editSubmit.php"
-#args "array(ucfirst($r))"
-msgid "? is a required field"
-msgstr "?  um campo requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
-#args "array($r)"
-msgid "? is required"
-msgstr "?  requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args "array($k)"
-msgid "? must be set to 'on' or 'off'"
-msgstr "? Deve ser definido como 'Ligado' ou 'Desligado'"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args "array($k)"
-msgid "? must have a value, use zero instead of a blank"
-msgstr "? deve ter um valor, use zero no lugar de branco"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args "array($j, count($newparams))"
-msgid "? of ? settings changed were successfully updated"
-msgstr "? de ? alteraes nas configuraes foram salvas com xito"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args "array($num,count($zen->bins))"
-msgid "? open tickets in ? bins"
-msgstr "? tickets abertos em ? repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
-#args "array($j)"
-msgid "? priorities were saved to the database. Updates complete"
-msgstr "? prioridades salvas no banco de dados. Alteraes concludas"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
-#args "array($j)"
-msgid "? systems were saved to the database. Updates complete"
-msgstr "? sistemas salvos no banco de dados. Alteraes concludas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
-#args "array($j)"
-msgid "? tasks were saved to the database. Updates complete"
-msgstr "? tarefas salvas no banco de dados. Alteraes concludas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
-#args "array($j)"
-msgid "? types were saved to the database. Updates complete"
-msgstr "? tipos salvos no banco de dados. Alteraes concludas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
-#args "array($u)"
-msgid "? was not a valid user id"
-msgstr "? no  uma ID de usrio vlida"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "A large number of elements will appear better in a line chart, bar charts tend to be more pleasing with smaller numbers."
-msgstr "Um nmero grande de elementos  melhor visualizado em um grfico de linhas, grficos de barra so indicados para nmeros menores"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "ATC"
-msgstr "ATC"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
-msgid "About ?"
-msgstr "Sobre ? "
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
-#args ""
-msgid "About"
-msgstr "Sobre"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Accept"
-msgstr "Aceitar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
-#args ""
-msgid "Access Error"
-msgstr "Erro de ccesso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Access"
-msgstr "Acesso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Account Options"
-msgstr "Opes da conta"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Account Settings"
-msgid "Configuraes da conta de usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Account is Active"
-msgstr "Conta ativa"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Action Taken"
-msgstr "Ao tomada"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Action"
-msgstr "Ao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Active"
-msgstr "Ativo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Add Attachment"
-msgstr "Adicionar anexo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add Notify Recipient"
-msgstr "Adicionar destinatrio para notificao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Add Recipient"
-msgstr "Adicionar destinatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Add a total figure"
-msgstr "Adicionar um grfico de totais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Add an average figure"
-msgstr "Adicionar um grfico de mdias"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add recipients to the notify list for this ticket"
-msgstr "Adicionar destinatrios na lista de notificaes para este ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Add ticket to project"
-msgstr "Adicionar ticket ao projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Add"
-msgstr "Adicionar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args ""
-msgid "Admin Section"
-msgstr "Administrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Admin"
-msgstr "Administrador"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/admin_header.php"
-#args ""
-msgid "Administration"
-msgstr "Administrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Administrative Options"
-msgstr "Opes Administrativas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "All bins were removed from access for user ?"
-msgstr "Acessos aos repositrios revogados para o usurio ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "All entries must contain a value."
-msgstr "Todos os campos devem ter valor."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftBins.php"
-#args ""
-msgid "All"
-msgstr "Todos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Amount of time worked"
-msgstr "Tempo Decorrido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Any valid date format"
-msgstr "Qualquer formato vlido de data"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Approval Required"
-msgstr "Requer Aprovao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Approval"
-msgstr "Aprovao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Approve"
-msgstr "Aprovar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Archive Tickets"
-msgstr "Arquivar Tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Are you sure you want to permanently delete this template?"
-msgstr "Tem certeza que deseja apagar permanentemente este Modelo?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Assign Ticket"
-msgstr "Atribuir Ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Assign the ticket to a new user"
-msgstr "Atribuir ticket a um novo usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Assign"
-msgstr "Atribuir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
-#args ""
-msgid "Assigned to"
-msgstr "Atribudo "
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Associate this ticket with others"
-msgstr "Associar este ticket com outros"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Attach"
-msgstr "Anexar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Attachment"
-msgstr "Anexo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
-#args "array($page_type,$id)"
-msgid "Attachments on ? #?"
-msgstr "Anexos em ? #?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "Attachments"
-msgstr "Anexos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Bar Chart"
-msgstr "Grfico de Barras"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Bin Name"
-msgstr "Repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Bin ticket is located in"
-msgstr "Ticket do repositrio encontrado em"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Bin"
-msgstr "Repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Bin(s)"
-msgstr "Repositrio(s)"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid "Bins cannot be destroyed, to maintain data integrity."
-msgstr "Repositrios no podem ser excludos para preservar a integridade dos dados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Date"
-msgstr "Por data"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Parameters"
-msgstr "Por parmetros"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "By Text Match"
-msgstr "Por texto coincidente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "By Text"
-msgstr "Por texto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Default Bin"
-msgstr "Mudar o repositrio padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Language"
-msgstr "Mudar idioma"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Change Password"
-msgstr "Mudar senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Change User Password"
-msgstr "Mudar senha do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "Change Your Default Bin"
-msgstr "Alterar seu repositrio padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "Change Your Language"
-msgstr "Alterar seu idioma"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Change"
-msgstr "Alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid "Changing the Bin Configuration has a large system impact."
-msgstr "A alterao na configurao do repositrio tem um forte impacto no sistema."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Changing these settings can have a severe impact on the system.  Please consider this before making modifications."
-msgstr "A alterao destas opes poder ter um forte impacto no sistema. Considere isto antes de faz-las."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Changing this configuration list has a large system impact."
-msgstr "A alterao destas configuraes tem um grande impacto sobre o sistema."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Chart Options"
-msgstr "Opes de Grfico"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Chart could not be saved."
-msgstr "No foi possvel salvar o grfico."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Choose one of the following options"
-msgstr "Escolha uma das seguintes opes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Click 'Search' to execute the search"
-msgstr "Clique em 'Buscar' para fazer a pesquisa"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "Click 'Update' to change your default bin"
-msgstr "Clique em 'Alterar' para mudar seu repositrio padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "Click 'Update' to change your language"
-msgstr "Clique em 'Alterar' para mudar seu idioma"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args "array($button,$blurb)"
-msgid "Click ? to ?"
-msgstr "Clique em ? para ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
-#args ""
-msgid "Click Here to search for users"
-msgstr "Clique aqui para buscar por usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/translations/french.trans"
-#args ""
-msgid "Click Here"
-msgstr "Clique aqui"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Click button to add recipients"
-msgstr "Clique no boto para adicionar destinatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Click button to assign relations"
-msgstr "Clique no boto para atribuir relaes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Click button to assign"
-msgstr "Clique no boto para atribuir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Click button to close"
-msgstr "Clique no boto para fechar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Click button to create log"
-msgstr "Clique no boto para adicionar log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Click button to move ticket"
-msgstr "Clique no boto para mover o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Click button to open"
-msgstr "Clique no boto para abrir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Click button to reject"
-msgstr "Clique no boto para rejeitar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Click button to send email"
-msgstr "Clique no boto para enviar e-mail"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Click button to set estimated hours to completion"
-msgstr "Clique no boto para definir as horas estimadas para completar o trabalho"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Click button to upload file and attach to ticket"
-msgstr "Clique no boto para enviar o arquivo e anex-lo ao ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Click button to yank ticket"
-msgstr "Clique no boto para desvincular o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Click button to"
-msgstr "Clique no boto para"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Close Ticket"
-msgstr "Fechar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Close"
-msgstr "Fechar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Closed"
-msgstr "Fechado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args "array(strip_tags($report_type))"
-msgid "Combine selected ?s"
-msgstr "Combinar as ?s selecionadas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Comments or Instructions"
-msgstr "Comentrios ou instrues"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Comments"
-msgstr "Comentrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "Commit Edited Ticket"
-msgstr "Salvar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "Commit New Project"
-msgstr "Salvar novo projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
-#args ""
-msgid "Commit New Ticket"
-msgstr "Salvar novo ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "Completed"
-msgstr "Concludo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Configuration Settings"
-msgstr "Opes de Configurao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Containing"
-msgstr "Contendo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "Could not create ticket."
-msgstr "No foi possvel adicionar o ticket."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
-#args ""
-msgid "Create New"
-msgstr "Adicionar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Create Reports"
-msgstr "Adicionar relatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Create Sub-Project"
-msgstr "Adicionar sub-projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/newProject.php"
-#args ""
-msgid "Create a New Project"
-msgstr "Adicionar projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/newTicket.php"
-#args ""
-msgid "Create a New Ticket"
-msgstr "Adicionar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Create a log entry, or log hours worked"
-msgstr "Adicionar uma entrada no log, ou log de horas decorridas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Create a new user account"
-msgstr "Nova conta de usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Create"
-msgstr "Adicionar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftBins.php"
-#args ""
-msgid "Current Bin"
-msgstr "Repositrio atual"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Current status of the ticket"
-msgstr "Estado atual do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "Custom Access priviledges updated for user ?"
-msgstr "Privilgios de acceso personalizados alterados para o usurio ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "DESCRIPTION"
-msgstr "DESCRIO"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Data Options"
-msgstr "Opes de Dados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDataMenu.php"
-#args ""
-msgid "Data Selection"
-msgstr "Seleo de Dados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Date Range"
-msgstr "Faixa de Dados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Date log was created"
-msgstr "Log de datas adicionado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
-#args ""
-msgid "Date"
-msgstr "Data"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Days"
-msgstr "Dias"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Deadline"
-msgstr "Trmino"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Default Access Level"
-msgstr "Nvel de acesso padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Delete Reports"
-msgstr "Excluir relatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "Delete User"
-msgstr "Excluir usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Delete"
-msgstr "Excluir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Description of Attachment"
-msgstr "Descrio do anexo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Description"
-msgstr "Descrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Details"
-msgstr "Detalhes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/headerInc.php"
-#args ""
-msgid "Details"),
-       "Log" => tr("Log"),
-       "Related" => tr("Related"),
-       "Attachments" => tr("Attachments"),
-       "Notify" => tr("Notify"),
-       "System" => tr("System")
-msgstr "Detalhes"),
-       "Log" => tr("Log"),
-       "Related" => tr("Related"),
-       "Attachments" => tr("Attachments"),
-       "Notify" => tr("Notify"),
-       "System" => tr("System")
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Disabled"
-msgstr "Desabilitado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Display Values"
-msgstr "Mostrar Valores"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Drop Recipients"
-msgstr "Excluir destinatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/drop.php"
-#args ""
-msgid "Drop Template"
-msgstr "Excluir modelo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "ETC"
-msgstr "ETC"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Bins"
-msgstr "Alterar repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Priorities"
-msgstr "Alterar prioridades"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Edit Settings"
-msgstr "Alterar configuraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Systems"
-msgstr "Alterar sistemas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Tasks"
-msgstr "Alterar tarefas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/edit.php"
-#args ""
-msgid "Edit Ticket"
-msgstr "Alterar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Edit Tickets"
-msgstr "Alterar tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Types"
-msgstr "Alterar tipos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "Edit User Submit"
-msgstr "Alterar envio do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Edit Users"
-msgstr "Alterar usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit Users/Access"
-msgstr "Alterar usurios/acessos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args "array(ucfirst($type))"
-msgid "Edit the Active ?s"
-msgstr "Alterar ?s ativos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the current bins"
-msgstr "Alterar repositrio atual"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the priorities list"
-msgstr "Alterar lista de prioridades"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the systems list"
-msgstr "Alterar lista de sistemas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the tasks list"
-msgstr "Alterar lista de tarefas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the types list"
-msgstr "Alterar lista de tipos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit the zenTrack settings.  Consult the documentation before using this feature."
-msgstr "Alterar as configuraes do zenTrack. Consulte a documentao antes de utilizar."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Edit ticket information"
-msgstr "Alterar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Edit"
-msgstr "Alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_titleBox.php"
-#args ""
-msgid "Elapsed"
-msgstr "Decorrido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Email Ticket"
-msgstr "Enviar ticket por e-mail"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Email"
-msgstr "E-mail"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Enter Project Information"
-msgstr "Informaes do projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Enter Ticket IDs"
-msgstr "IDs dos tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/nav.php"
-#args ""
-msgid "Enter a ticket ID and press enter"
-msgstr "ID do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Enter any hours worked not previously accounted for"
-msgstr "Horas trabalhadas no computadas anteriormente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Enter hours worked"
-msgstr "Horas trabalhadas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Enter multiple ids, separated by a comma"
-msgstr "IDs, separdos por vrgulas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Enter registered users"
-msgstr "Usurios registrados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Enter the hours worked for this entry"
-msgstr "Horas trabalhadas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Enter the number of hours (can contain up to 2 decimal places)"
-msgstr "Nmero de horas (at 2 decimais)"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Enter ticket ids, separated by commas"
-msgstr "IDs dos tickets, separadas por vrgulas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Equals"
-msgstr "Igual a"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Est Hrs"
-msgstr "Horas est."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Estimate Ticket Hours"
-msgstr "Horas est. ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Estimated Hours to Complete"
-msgstr "Horas est. concluso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Estimated Hours"
-msgstr "Horas estimadas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Estimated time to complete"
-msgstr "Tempo estimado concluso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "First Name"
-msgstr "Nome"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Greater Than"
-msgstr "Maior que"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
-#args ""
-msgid "Help"
-msgstr "Ajuda"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Home Bin"
-msgstr "Repositrio Inicial"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Home"
-msgstr "Incio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Hours Worked"
-msgstr "Horas trabalhadas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
-#args ""
-msgid "Hours must be entered if the activity is 'LABOR'"
-msgstr "A quantidade de horas deve ser informada se a atividade for do tipo 'TRABALHO'"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Hours"
-msgstr "Horas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "ID of the ?"
-msgstr "ID de ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "ID of the ticket"
-msgstr "ID do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "ID"
-msgstr "ID"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Image Type"
-msgstr "Tipo de imagem"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Image"
-msgstr "Imagem"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Importance of the ?"
-msgstr "Importncia de ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Initials"
-msgstr "Iniciais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Items in this list cannot be destroyed, to maintain data integrity."
-msgstr "Para manter a integridade dos dados os elementos da lista no podem ser excludos."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "LOG"
-msgstr "LOG"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Last Name"
-msgstr "Sobrenome"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Less Than"
-msgstr "Menor que"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Less"
-msgstr "Menor"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Level"
-msgstr "Nvel"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
-#args ""
-msgid "License"
-msgstr "Licena"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Line Chart"
-msgstr "Grfico de Linhas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "List All Users"
-msgstr "Listar todos os usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "Log History")
-msgstr "Histrico do Log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "Log ID"
-msgstr "ID do Log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "Log Off"
-msgstr "Desligar Log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "Log On"
-msgstr "Ligar Log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Log"
-msgstr "Log"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Login Name"
-msgstr "Nome de usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
-#args ""
-msgid "Login and passphrase are case sensitive"
-msgstr "Nome de usurio e senha diferenciam maisculas/minsculas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Make Visible To"
-msgstr "Tornar visvel para"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/projectSearchbox.php"
-#args ""
-msgid "Make search of projects that returns comma delimited list"
-msgstr "O resultado da busca de projetos ser uma lista separada por vrgulas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/ticketSearchbox.php"
-#args ""
-msgid "Make ticket search that returns comma delimited list"
-msgstr "O resultado da busca de tickets ser uma lista separada por vrgulas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Manage Reports"
-msgstr "Gerenciar relatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Master Project"
-msgstr "Projeto principal"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Maximum Age"
-msgstr "Idade mxima"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Modify Existing"
-msgstr "Alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/view.php"
-#args ""
-msgid "Modify Report"
-msgstr "Alterar relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Modify Reports"
-msgstr "Alterar relatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Modify Search"
-msgstr "Alterar busca"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "Modify"
-msgstr "Alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Months"
-msgstr "Meses"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "More"
-msgstr "Mais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Most Current"
-msgstr "Mais atual"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Move Ticket"
-msgstr "Mover ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Move"
-msgstr "Mover"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Name of the ?"
-msgstr "Nome de ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Name"
-msgstr "Nome"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
-#args ""
-msgid "New Default Bin"
-msgstr "Repositrio padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
-#args ""
-msgid "New Language"
-msgstr "Idioma"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "New Password"
-msgstr "Senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "New Report"
-msgstr "Adicionar relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
-#args ""
-msgid "New Search"
-msgstr "Nova busca"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "New Template"
-msgstr "Adicionar modelo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "New User"
-msgstr "Adicionar usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "No Log Entries"
-msgstr "No h entradas no log."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "No Related Tickets"
-msgstr "No h tickets relacionados."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "No Tasks Assigned to this Project"
-msgstr "No h tarefas atribudas ao projeto."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
-#args ""
-msgid "No attachments exist for this $page_type"
-msgstr "No h anexos para este $page_type"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
-#args ""
-msgid "No comments were entered."
-msgstr "No h comentrios."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "No file was uploaded."
-msgstr "Nenhum arquivo enviado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "No logs found"
-msgstr "Nenhum log encontrado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/dropFromNotify.php"
-#args ""
-msgid "No recipients were selected to drop"
-msgstr "Nenhum destinatrio selecionado para excluso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args ""
-msgid "No settings were recieved"
-msgstr "Nenhuma configurao alterada"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "No tickets have been added to this Project."
-msgstr "Nenhum ticket adicionado ao projeto."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_relatedBox.php"
-#args ""
-msgid "No tickets have been associated with this ticket."
-msgstr "Nenhum outro ticket associado  este."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "No user id was recieved"
-msgstr "Nenhuma ID de usurio recebida"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogResults.php"
-#args ""
-msgid "No valid fields were provided to conduct a search"
-msgstr "Nenhum campo vlido para realizar a busca"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "Not Required"
-msgstr "Opcional"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Note"
-msgstr "Nota"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Notes"
-msgstr "Nota"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
-#args ""
-msgid "Notify List"
-msgstr "Lista de notificaes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "OR manually enter email addresses, seperated by commas"
-msgstr "ou informe os endereos de e-mail manualmente, separados por vrgula"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Off"
-msgstr "Desligado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "On"
-msgstr "Ligado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Only the root administrator can change the root administrator's passphrase"
-msgstr "A senha do administrador s pode ser modificada pelo administrador"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Open ticket closed in error"
-msgstr "Reabrir ticket fechado com erro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Opened"
-msgstr "Aberto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Optional.  Use control or shift to select multiples"
-msgstr "Opcional. Use as teclas 'control' ou 'shift' para selees mltiplas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Optional. You do not need to select yourself"
-msgstr "Opcional. No  necessrio selecionar a si mesmo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "Options"
-msgstr "Opes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
-#args ""
-msgid "Or add an unregistered user"
-msgstr "ou adicione um usurio no registrado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Order"
-msgstr "Ordem"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Owner"
-msgstr "Proprietrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args "array($user_id)"
-msgid "Password reset to the default [user's last name] for user ?"
-msgstr "A senha do usurio ? foi alterada para o valor padro [sobrenome do usurio]"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Password successfully changed"
-msgstr "Senha alterada com sucesso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Percent completed"
-msgstr "Percentual concludo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args "array($u["user_id"])"
-msgid "Permanently remove user ??"
-msgstr "Excluir usurio ? ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Person ticket is assigned to"
-msgstr "Ticket personalizado atribudo "
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Pick a type"
-msgstr "Selecione um tipo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Pie Chart"
-msgstr "Grfico de Pizza"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Please consider this before making modifications."
-msgstr "Por favor considere isto antes de fazer modificaes."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
-#args ""
-msgid "Please enter a ticket ID"
-msgstr "Informe a ID do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Please fill in both of the fields"
-msgstr "Por favor preencha todos os campos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Please keep track of your new passphrase."
-msgstr "Por favor anote sua nova senha."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "Please log in to view the entire ticket."
-msgstr "Por favor registre-se para visualizar o ticket."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Press 'Reset' to restore the original values."
-msgstr "Clique em 'Padro' para restaurar os valores originais."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Press 'Save' when you are sure that the values are correct."
-msgstr "Clique em 'Salvar' depois que informar todos os valores."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press LESS to remove blank fields"
-msgstr "Clique em 'Menos' para eliminar os campos em branco"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press LESS to remove blank rows"
-msgstr "Clique em 'Menos' para eliminar os linhas em branco"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press MORE to add more custom fields"
-msgstr "Clique em 'Mais' para adicionar campos personalizados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press MORE to create new rows"
-msgstr "Clique em 'Mais' para adicionar novas linhas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press Reset to return to original values"
-msgstr "Clique em 'Padro' para voltar os valores originais."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press Reset to return to users existing values"
-msgstr "Clique em 'Padro' para retornar os valores existentes para os usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Press Save to save changes"
-msgstr "Clique em 'Salvar' para confirmar as alteraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Press Update to save changes"
-msgstr "Clique em 'Alterar' para confirmar as alteraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Pri"
-msgstr "Pri"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Print"
-msgstr "Imprimir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Priority"
-msgstr "Prioridade"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
-#args ""
-msgid "Process completed successfully.  Account not added, because this is a demo site"
-msgstr "Processo concludo. A conta de usuario no foi adicionada por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
-#args ""
-msgid "Process completed successfully.  Bins were not updated since this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Process completed successfully.  No changes were made because this is a demo site"
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args ""
-msgid "Process completed successfully.  No changes were made, because this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
-#args ""
-msgid "Process completed successfully.  Priorities were not updated since this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
-#args ""
-msgid "Process completed successfully.  Systems were not updated since this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
-#args ""
-msgid "Process completed successfully.  Tasks were not updated since this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
-#args ""
-msgid "Process completed successfully.  Types were not updated since this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args ""
-msgid "Process completed successfully. No privileges were changed, because this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "Process successful.  User was not updated, because this is a demo site."
-msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/show.php"
-#args ""
-msgid "Processing Error: Report ID Missing"
-msgstr "Erro de processamento. Reltorio sem ID"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Processing error: tempid not found\n"
-msgstr "Erro de processamento; 'tempid' no encontrada\n"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Processing error: template not found."
-msgstr "Erro de processamento. Modelo no encontrado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Project ID"
-msgstr "ID do projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Project"
-msgstr "Projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
-#args ""
-msgid "Projects"
-msgstr "Projetos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Pull ticket from the current owner"
-msgstr "Desvincular ticket do proprietrio atual"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "RELATED TICKETS"
-msgstr "TICKETS ASSOCIADOS"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Range"
-msgstr "Faixa"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "Really log out of zenTrack?"
-msgstr "Deseja sair do zenTrack?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reason"
-msgstr "Motivo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reject Ticket"
-msgstr "Rejeitar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Reject"
-msgstr "Rejeitar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Relate Ticket"
-msgstr "Associar ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
-#args ""
-msgid "Relate"
-msgstr "Associar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_relatedBox.php"
-#args "array($page_type)"
-msgid "Related ?s"
-msgstr "Associar ?s"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Related Tickets"
-msgstr "Tickets associados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
-#args ""
-msgid "Remember My Password"
-msgstr "Lembrar senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Reopen Ticket"
-msgstr "Reabir ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
-#args ""
-msgid "Reopen"
-msgstr "Reabrir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/drop.php"
-#args ""
-msgid "Report Deleted"
-msgstr "Relatrio excludo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/custom.php"
-#args ""
-msgid "Report ID not found"
-msgstr "ID do relatrio no encontrada"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Report Name is required"
-msgstr "Nome do relatrio  requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "Report Type"
-msgstr "Tipo de Relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftReports.php"
-#args ""
-msgid "Reports"
-msgstr "Relatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
-#args ""
-msgid "Required field missing:"
-msgstr "Campo requerido no encontrado:"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "Required"
-msgstr "requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Requirements"
-msgstr "Requerimentos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "Reset Password"
-msgstr "Senha Padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args "array($u["user_id"])"
-msgid "Reset the password for user ??"
-msgstr "Voltar senha do usurio ? para o padro?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Reset"
-msgstr "Padro"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
-#args ""
-msgid "Return ticket to sender"
-msgstr "Devolver ticket ao remetente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Retype New Password"
-msgstr "Repita a nova Senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Role"
-msgstr "Perfil"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Save Report"
-msgstr "Salvar relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Save Submit"
-msgstr "Salvar envio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Save Template"
-msgstr "Salvar Modelo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "Save"
-msgstr "Salvar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Scatter Chart"
-msgstr "Grfico de Disperso"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "Search For Logs"
-msgstr "Buscar por logs"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Search For Users"
-msgstr "Buscar por usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
-#args ""
-msgid "Search Logs"
-msgstr "Busca de logs"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Search Projects"
-msgstr "Busca de projetos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Search Tickets"
-msgstr "Busca de tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/userSearchbox.php"
-#args ""
-msgid "Search Users"
-msgstr "Busca de usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/listUsers.php"
-#args ""
-msgid "Search for Users"
-msgstr "Busca por usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
-#args ""
-msgid "Search"
-msgstr "Buscar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDataMenu.php"
-#args "array($zen->ffv($report_type))"
-msgid "Select ?s"
-msgstr "?s selecionados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select Projects"
-msgstr "Projetos selecionados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/ticketSearchbox.php"
-#args ""
-msgid "Select Tickets"
-msgstr "Tickets selecionados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
-#args ""
-msgid "Select a Recipient"
-msgstr "Selecione um destinatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Select a User"
-msgstr "Selecione um usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Select a file to upload"
-msgstr "Selecione um arquivo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "Select an activity"
-msgstr "Selecione uma atividade"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select more than one by using control or shift"
-msgstr "Use as teclas 'Control' ou 'Shift' para selees mltiplas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "Select"
-msgstr "Selecionar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a link to this ticket only"
-msgstr "Enviar um link somente para este ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a summary of the ticket"
-msgstr "Enviar um resumo deste ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send a summary, and the ticket's log"
-msgstr "Enviar um resumo e o log do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
-#args ""
-msgid "Send ticket to another bin"
-msgstr "Mover o ticket para outro repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "Send ticket to specified recipients"
-msgstr "Enviar o ticket para os destinatrios especificados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args "array($zen->formatName($user_id))"
-msgid "Set Access for ?"
-msgstr "Nvel de Acesso para ?"
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Set Password"
-msgstr "Senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "Set status to closed/pending"
-msgstr "Estado fechado/pendente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Set testing to completed on ticket"
-msgstr "Finalizar teste sobre o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
-#args ""
-msgid "Set the expected hours this ticket will take to complete"
-msgstr "Nmero de horas estimado para concluir o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Set"
-msgstr "Configurar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Settings Administration"
-msgstr "Adminstrao de Configuraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
-#args ""
-msgid "Settings"
-msgstr "Configuraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "Show All Users"
-msgstr "Exibir todos usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Both"
-msgstr "Exibir ambos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Graph"
-msgstr "Exibir grfico"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/show.php"
-#args ""
-msgid "Show Report"
-msgstr "Exibir relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Show Tables"
-msgstr "Exibir tabelas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Stack Chart"
-msgstr "Grfico de blocos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Start Date"
-msgstr "Data de incio"
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Start From Date"
-msgstr "Iniciar a partir de"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Status"
-msgstr "Estado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsSubmit.php"
-#args ""
-msgid "Submit Results"
-msgstr "Enviar resultados"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Subtitle"
-msgstr "Subttulo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
-#args ""
-msgid "Support"
-msgstr "Suporte"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "System Error"
-msgstr "Erro de sistema"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
-#args "array($lname, $fname)"
-msgid "System Error: Could not add ?, ? to the system"
-msgstr "Erro de sistema: No foi possvel adicionar ?, ? para o sistema"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args "array($lname, $fname)"
-msgid "System Error: Could not update ?, ?"
-msgstr "Erro de sistema: No foi possvel alterar ?, ?"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "System Error: Unable to change user passphrase."
-msgstr "Erro de sistema: No foi possvel alterar a senha do usurio."
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
-#args ""
-msgid "System Error: Unable to update bin."
-msgstr "Eror de sistema: No foi possvel alterar o repositrio"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args ""
-msgid "System Error: could not update access &#151; this is most likely because no bins were set, and no bins previously existed (i.e. nothing happened)"
-msgstr "Erro de sistema: No foi possvel atualizar &#151; possivelmente no h um repositrio definido, ou repositrio no criado (nada foi alterado)"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args "array($user_id)"
-msgid "System Error: could not update access for user ?"
-msgstr "Erro de sistema: No foi possivel alterar o nvel de acesso para o usurio ?"
-
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_systemBox.php"
-#args ""
-msgid "System History"
-msgstr "Histrico do sistema"
-
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
-#args ""
-msgid "System error: Activity could not be logged."
-msgstr "Erro de sistema: No foi possvel gerar log da atividade."
-
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args "array($userfile_name, $id)"
-msgid "System error: Attachment ? could not be uploaded for ticket ?. "
-msgstr "Erro de sistema: No foi possvel anexar arquivo ? ao ticket."
-
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
-#args ""
-msgid "System error: Notify list could not be updated "
-msgstr "Error de sistema: No foi possvel alterar a lista de notificaes."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/accept.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be accepted"
-msgstr "Erro de sistema: o ticket ? no pde ser aceito."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/approve.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be approved"
-msgstr "Erro de sistema: o Ticket ? no pde ser aprovado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/assign.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be assigned"
-msgstr "Erro de sistema: o ticket ? no pde ser atribudo."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/close.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be closed"
-msgstr "Erro de sistema: o ticket ? no pde ser fechado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be emailed. "
-msgstr "Erro de sistema: o ticket ? no pde ser enviado por e-mail."
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/move.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be moved. "
-msgstr "Erro de sistema: o ticket ? no pde ser movido."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/reject.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be rejected"
-msgstr "Erro de sistema: o ticket ? no pde ser rejeitado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/relate.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be related, or the entries were the same."
-msgstr "Erro de sistema: o ticket ? no pde ser associado, ou as entradas so as mesmas."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/reopen.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be reopened."
-msgstr "Erro de sistema: o ticket ? no pde ser reaberto."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/test.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be tested"
-msgstr "Erro de sistema: o ticket ? no pde ser testado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/yank.php"
-#args "array($id)"
-msgid "System error: Ticket ? could not be yanked."
-msgstr "Erro de sistema: o ticket ? no pde ser desvinculado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/estimate.php"
-#args "array($id)"
-msgid "System error: Ticket ? hours could not be set"
-msgstr "Erro de sistema: o ticket ? no pde ter as horas definidas."
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "System involved in ticket"
-msgstr "Sistema relacionado com o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "System"
-msgstr "Sistema"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "TASKS FOR COMPLETION"
-msgstr "TAREFAS  CONCLUIR"
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
-#args ""
-msgid "Tasks for this project"
-msgstr "Tarefas para o projeto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Test Ticket"
-msgstr "Testar Ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid "Test"
-msgstr "Teste"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
-#args ""
-msgid "Tested"
-msgstr "Testado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "Testing Required"
-msgstr "Teste requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "Testing"
-msgstr "Testando"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Text"
-msgstr "Texto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
-#args ""
-msgid "That bin doesn't exist"
-msgstr "Repostitrio inexistente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "That is not a recognized file type, by your browsers determinations"
-msgstr "Seu navegador no reconhece este tipo de arquivo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
-#args ""
-msgid "That login name already exists.  Please choose another."
-msgstr "Nome de usurio j cadastrado. Por favor escolha outro."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "That login name is in use by another account"
-msgstr "Nome de usurio j em uso por outra conta"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/custom.php"
-#args ""
-msgid "That temporary report doesn't exist"
-msgstr "Relatrio temporrio no existe"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
-#args ""
-msgid "That ticket doesn't exist"
-msgstr "Ticket inexistente"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
-#args ""
-msgid "That user could not be found"
-msgstr "Usurio no encontrado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "The Guest Password cannot be changed!"
-msgstr "Senha de usurio convidado (guest) no pode ser modificada!"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
-#args ""
-msgid "The Root Admin Account can only be modified by the Root Administrator"
-msgstr "A conta do Administrador s pode ser modificada por ele mesmo"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
-#args "array($user_id)"
-msgid "The account (?) could not be found/deleted successfully"
-msgstr "A conta do usurio (?) no foi encontrada/excluda corretamente"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
-#args "array($user_id)"
-msgid "The account(?) was successfully removed"
-msgstr "Conta do usurio (?) excluda com sucesso"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "The action completed successfully.  The account was not actually deleted, because this is a demo site"
-msgstr "Ao concluda com sucesso. A conta de usurio no foi excluda por estarmos no modo de Demonstrao"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "The file could not be uploaded "
-msgstr "O arquivo no pde ser enviado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args "array(number_format($userfile_size), number_format($max_size))"
-msgid "The file size (?) exceeded the maximum allowed (?)"
-msgstr "O tamanho do arquivo (?) excede o mximo permitido (?)"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args "array(substr($max_size,0,strlen($max_size)-3))"
-msgid "The file was not recieved. Check to insure it's size does not exceed ?KB"
-msgstr "Arquivo no recebido. Verifique que seu tamanho no excede ? kb"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "The importance of the ticket"
-msgstr "Importncia do ticket"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
-#args ""
-msgid "The language could not be changed to ?", $newlang
-msgstr "No foi possvel alterar o idioma para $newlang"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
-#args ""
-msgid "The language file chosen was not valid"
-msgstr "Arquivo de idioma escolhido invlido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "The name of the ticket"
-msgstr "Nome do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "The name of the user"
-msgstr "Nome do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin access cannot be less than the level_settings parameter"
-msgstr "O Nvel de acesso do Administrador no pode ser menor que o parmetro 'level_settings'"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin account cannot be deactivated"
-msgstr "No  possvel desativar a conta do administrador"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args ""
-msgid "The root admin account must have access of 5 or greater"
-msgstr "O Nvel de acesso para a conta de administrador deve ser 5 ou maior"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
-#args ""
-msgid "The root administrator account cannot be deleted"
-msgstr "A conta de administrador no pode ser excluda"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "The type of ticket"
-msgstr "Tipo do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the html form."
-msgstr "O tamanho do arquivo enviado  maior que o especificado na diretiva 'MAX_FILE_SIZE' no formulrio HTML."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file exceeds the upload_max_filesize directive in php.ini."
-msgstr "O tamanho do arquivo enviado  maior que o especificado na diretiva 'MAX_FILE_SIZE' no arquivo 'php.ini'."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "The uploaded file was only partially uploaded."
-msgstr "O arquivo enviado foi recebido parcialmente."
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
-#args ""
-msgid "The user passphrase could not be found/edited"
-msgstr "A Senha do usurio no pde ser encontrada/alterada"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "There are more log entries."
-msgstr "No existem mais entradas no log."
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args ""
-msgid "There is already an entry with that value."
-msgstr "J existe uma entrada com este valor."
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
-#args ""
-msgid "There was nothing provided to update"
-msgstr "No havia nada para alterar"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
-#args ""
-msgid "There were no changes made to the settings.  Procedure skipped."
-msgstr "No foram feitas alteraes nas configuraes. Procedimento ignorado."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/searchLogs.php"
-#args ""
-msgid "There were no logs matching your search."
-msgstr "No existem arquivos de log para a busca solicitada."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
-#args ""
-msgid "There were no recipients"
-msgstr "No h destinatrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/listUsers.php"
-#args ""
-msgid "There were no results for your search"
-msgstr "No foram encontrados resultados para a busca."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/search.php"
-#args ""
-msgid "There were no results for your search."
-msgstr "No foram encontrados resultados para a busca."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "These options aren't useful when only graphing one element."
-msgstr "Estas opes no so teis para grficos de um nico elemento"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "This could be a long list! Proceed anyways?"
-msgstr "A lista pode ser longa! Continuar?
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "This grants the user the specified level of access to all bins not otherwise indicated by 'user access'."
-msgstr "Isto garantir ao usurio o nvel de acesso especificado  todos os repositrios no somente aos indicados pelo 'acesso personalizado' pelo usurio."
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
-#args "array($id)"
-msgid "Ticket #? cannot be edited in its current status"
-msgstr "Ticket #? no pode ser alterado devido ao seu estado atual"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
-#args "array($id)"
-msgid "Ticket #? could not be found"
-msgstr "Ticket #? no encontrado"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/action_header.php"
-#args "array($id)"
-msgid "Ticket #?"
-msgstr "Ticket #?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id,$this->formatName($user_id,2))"
-msgid "Ticket #?: Log added by ?"
-msgstr "Ticket #?: Log adicionado por ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "Ticket #?: assigned to ?"
-msgstr "Ticket #?: atribudo  ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: closed"
-msgstr "Ticket #?: fechado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: created"
-msgstr "Ticket #?: adicionado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id,$this->getBinName($newBin))"
-msgid "Ticket #?: moved to ?"
-msgstr "Ticket #?: movido para ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: rejected"
-msgstr "Ticket #?: rejeitado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket #?: reopened"
-msgstr "Ticket #?: reaberto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "Ticket #?: yanked by ?"
-msgstr "Ticket #?: desvinculado por ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/editSubmit.php"
-#args "array($id)"
-msgid "Ticket ? could not edit ticket. "
-msgstr "Ticket ? no pde alterar o ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id)"
-msgid "Ticket ? has been reopened."
-msgstr "Ticket ? foi reaberto"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "Ticket Administration"
-msgstr "Administrao de tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/nav.php"
-#args ""
-msgid "Ticket ID"
-msgstr "ID do ticket"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "Ticket Information"
-msgstr "Informaes do ticket"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args ""
-msgid "Ticket Summary")
-msgstr "Resumo do ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
-#args ""
-msgid "Ticket"
-msgstr "Ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/assignedTickets.php"
-#args ""
-msgid "Tickets assigned"
-msgstr "Tickets atribudos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
-#args ""
-msgid "Tickets"
-msgstr "Tickets"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
-#args ""
-msgid "Time"
-msgstr "Tempo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Title"
-msgstr "Ttulo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
-#args "array($type)"
-msgid "To remove a ? from use, uncheck the 'active' box."
-msgstr "Para remover um ? do uso, desmarque a caixa 'ativo'"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid "To remove a bin from use, uncheck the 'active' box."
-msgstr "Para excluir um repositrio, desmarque a caixa 'ativo'"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
-#args ""
-msgid "Totals"
-msgstr "Totais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "Tracker"
-msgstr "Rastreador"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "Try using Combine Selected with a very large number of elements, if you intend to view a graphical image."
-msgstr "Quando o nmero de elementos  muito elevado, combine as selees se quiser ver em um grfico."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
-#args ""
-msgid "Two or more bins were submitted with the same name"
-msgstr "Dois ou mais repositrios enviados com o mesmo nome"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "Type ids separated by commas, or click on the button."
-msgstr "Informe as IDs separadas por vrgulas, ou clique no boto"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
-#args ""
-msgid "Type of ticket"
-msgstr "Tipo do Ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Type"
-msgstr "Tipo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Uncheck to disable this account."
-msgstr "Desmarque para desativar esta conta"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
-#args ""
-msgid "Update Bins"
-msgstr "Alterar repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
-#args ""
-msgid "Update Priorities"
-msgstr "Alterar prioridades"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
-#args ""
-msgid "Update Systems"
-msgstr "Alterar sistemas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
-#args ""
-msgid "Update Tasks"
-msgstr "Alterar tarefas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
-#args ""
-msgid "Update Types"
-msgstr "Alterar tipos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "Update"
-msgstr "Alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "Upload Attachment"
-msgstr "Enviar anexo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
-#args ""
-msgid "Uploaded file size 0 bytes"
-msgstr "O arquivo enviado contm 0 bytes"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/index.php"
-#args ""
-msgid "Usage Reports"
-msgstr "Relatrios de Uso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "Use zero if unsure."
-msgstr "Informe zero se no tiver certeza"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
-#args "array($user_id, "--link--" . tr("Click Here") . "</a>", $user_id)"
-msgid "User ? was added successfully. The password is the last name of the user. ? to customize user ?'s access permissions."
-msgstr "Usurio ? adicionado com sucesso. A senha  o sobrenome do usurio. ? para alterar as permisses de acesso do usurio ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
-#args "array($user_id,
- 			"--link--",
- 			$user_id)"
-msgid "User ? was updated successfully. ? to customize user ?'s access permissions."
-msgstr "Usurio ? alterado com sucesso. ? para alterar as permisses de acesso do usurio ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "User Administration"
-msgstr "Adminstrao de usurios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
-#args ""
-msgid "User ID"
-msgstr "ID do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
-#args ""
-msgid "User Information"
-msgstr "Informaes do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/options.php"
-#args ""
-msgid "User Options"
-msgstr "Opces do usurio"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
-#args ""
-msgid "User"
-msgstr "Usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
-#args ""
-msgid "User(s)"
-msgstr "Usurio(s)"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users Default Bin"
-msgstr "Repositrio padro do usurio"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users Initials"
-msgstr "Iniciais do usurio"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users System ID"
-msgstr "IDs dos usurios do sistema"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "Users email address"
-msgstr "E-mail dos usurios"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
-#args ""
-msgid "Value"
-msgstr "Valor"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsSubmit.php"
-#args ""
-msgid "View Chart"
-msgstr "Ver Grfico"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
-#args ""
-msgid "View Reports"
-msgstr "Ver Relatrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
-#args ""
-msgid "Visit the zenTrack development site"
-msgstr "Visite o site do desenvolvedor zenTrack"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Weeks"
-msgstr "Semanas"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/index.php"
-#args ""
-msgid "Welcome to zenTrack"
-msgstr "Bem-vindo ao zenTrack"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
-#args ""
-msgid "Welcome"
-msgstr "Bem-vindo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
-#args ""
-msgid "What to Graph"
-msgstr "Informao  mostrar no grfico"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args "array($page_type)"
-msgid "Who the ? belongs to"
-msgstr "Proprietrio do ?"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "Worked"
-msgstr "Trabalhado"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Yank Ticket"
-msgstr "Desvincular Ticket"
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
-#args ""
-msgid "Yank"
-msgstr "Desvincular"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "Years"
-msgstr "Anos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
-#args ""
-msgid "You are not allowed to view the following in this bin"
-msgstr "Acesso negado  este repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
-#args ""
-msgid "You cannot edit a ticket in this bin "
-msgstr "Voc no pode alterar um ticket neste repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
-#args ""
-msgid "You cannot edit a ticket in this bin"
-msgstr "Voc no pode alterar um ticket neste repositrio"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/admin_header.php"
-#args ""
-msgid "You do not have access to administrate zenTrack."
-msgstr "Voc no possui permisso para adminstrar o zenTrack."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchResults.php"
-#args ""
-msgid "You do not have access to any bins."
-msgstr "Voc no possui acesso aos repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/index.php"
-#args ""
-msgid "You do not have access to any existing bins"
-msgstr "Voc no tem acesso a nenhum dos repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "You do not have permission to create projects."
-msgstr "Voc no tem permisso para adicionar projetos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "You do not have permission to create tickets in this bin."
-msgstr "Voc no tem permisso para adicionar tickets neste repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/reports_header.php"
-#args ""
-msgid "You do not have permission to view the reports."
-msgstr "Voc no tem permisso para ver os relatrios."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/userSearchbox.php"
-#args ""
-msgid "You may use * for a wildcard in any field but the id.. i.e. J* would match anything starting with J"
-msgstr "Utilize * como coringa em qualquer campo, por exemplo, J* selecionar qualquer elemento que comee por J"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "You may use * for a wildcard in the title or description.. i.e. J* would match anything starting with J"
-msgstr "Utilize * como coringa no ttulo ou a descrio, por exemplo, J* selecionar qualquer elemento que comee por J"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
-#args ""
-msgid "You must provide at least one registered user, or a valid name and email address"
-msgstr "Voc deve informar pelo menos um usurio registrado, ou um nome e e-mail vlidos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
-#args ""
-msgid "Your bin has been changed to"
-msgstr "Seu repositrio foi mudado para"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
-#args ""
-msgid "Your chart has been saved successfully saved with title: $report_name"
-msgstr "Seu grfico foi salvo com o ttulo: $report_name"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
-#args ""
-msgid "Your language has been changed to ?", $newlang
-msgstr "Seu idioma foi modificado para $newlang"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your new passphrase must contain at least 1 non-letter character"
-msgstr "Sua nova senha deve conter pelo menos 1 caractere no-alfabtico"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
-#args ""
-msgid "Your passphrase must be at least 6 characters long and contain at least 1 non-letter character."
-msgstr "Sua nova senha deve ter no mnimo 6 caracteres e conter ter pelo menos 1 caracter no-alfabtico"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your passphrase must be at least 6 digits long"
-msgstr "Sua nova senha deve conter no mnimo 6 caracteres"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your passwords did not match"
-msgstr "Suas senhas no conferem"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
-#args ""
-msgid "Your request was successful, but this is a demo site, so the passphrase was not altered"
-msgstr "Sua requisio foi correta, mas no modo de Demonstrao sua senha no ser modificada"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
-#args ""
-msgid "accepts up to 2 decimal places"
-msgstr "at 2 decimais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "access"
-msgstr "acesso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
-#args ""
-msgid "completed"
-msgstr "concludo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
-#args ""
-msgid "create an attachment for this ticket"
-msgstr "adicionar um anexo neste ticket"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "delete"
-msgstr "excluir"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "edit"
-msgstr "alterar"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
-#args ""
-msgid "edit,delete,change access"
-msgstr "alterar, excluir, modificar acesso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "enter a number"
-msgstr "ente um nmero"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
-#args ""
-msgid "hold control or shift to select multiple users"
-msgstr "pressione as teclas 'Control' ou 'Shift' para selecionar vrios usurios"
-
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
-#args ""
-msgid "less"
-msgstr "menos"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
-#args ""
-msgid "n/a"
-msgstr "n/d"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no bins"
-msgstr "Nenhum repositrio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no priorities"
-msgstr "Nenhuma prioridade"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
-#args ""
-msgid "no systems"
-msgstr "Nenhum sistema"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/ticketSearchbox.php"
-#args ""
-msgid "no types"
-msgstr "Nenhum tipo"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "no"
-msgstr "No"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "none"
-msgstr "Nenhum"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "optional"
-msgstr "opcional"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "password"
-msgstr "senha"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
-#args ""
-msgid "required field missing:"
-msgstr "campo requerido faltando:"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
-#args ""
-msgid "required"
-msgstr "requerido"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/view.php"
-#args ""
-msgid "required... processing error"
-msgstr "requerido... erro de processamento"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
-#args ""
-msgid "save your changes"
-msgstr "salvar suas alteraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
-#args "array($id,$name)"
-msgid "ticket #?: accepted by ?"
-msgstr "ticket #?: aceito por"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid "up to two decimal places, optional"
-msgstr "at 2 decimais, opcional"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
-#args ""
-msgid "use 4 digit year, time is optional"
-msgstr "indicar o ano com 4 dgitos, o tempo  opcional"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
-#args ""
-msgid "user ID"
-msgstr "ID do usurio"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
-#args ""
-msgid "version"
-msgstr "verso"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
-#args ""
-msgid "yes"
-msgstr "sim"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Notes are special tickets which do not require any actions.'
-msgstr "Notas so tickets especiais que no requerem nenhuma ao."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
-#args ""
-msgid 'Please Log On.'
-msgstr "Por favor registre-se"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Press LESS to remove blank rows'
-msgstr "Pressione 'Menos' para remover as linhas em branco"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Press MORE to create new bins'
-msgstr "Pressione 'Mais' para adicionar novos repositrios"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Press Reset to return to original values'
-msgstr "Pressione 'Padro' para voltar aos valores originais"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Press Save to save changes'
-msgstr "Pressione 'Salvar' para confirmar as alteraes"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Projects act as containers, which can hold multiple tickets as "tasks" which are part of the projects completion requirements.'
-msgstr "Projetos funcionam como depsitos, que podem conter vrios tickets, como 'Tarefas' que so parte dos requisitos de concluso dos projetos."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'There are two special bin types, which can be set manually in the includes/configVars.php file (poor method), or set here (preferred	method) by naming a bin with either the word "project" or "note" in	the bin name.'
-msgstr "H dois tipos especiais de reposit'rorios, aquele que pode ser definido manualmente no arquivo 'includes/configVars.php'. ou definidos aqui (recomendvel), dando um nome ao repositrio como 'projeto' ou 'nota'"
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'They start their life closed, and do not need to be completed.'
-msgstr "Ele j inicia fechado, e no precisa ser concludo."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
-#args ""
-msgid 'Use them only for tracking and documentation.'
-msgstr "Use-os apenas para ratreamento e documentao."
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
-#args ""
-msgid ($td
-msgstr ""
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid ucfirst($a)
-msgstr ""
-
-
-#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
-#args ""
-msgid ucfirst($a)) ,18," ",STR_PAD_RIGHT
-msgstr ""
-
-
+# This is the translation template file. It is automatically generated from developers/tr-parser.php
+
+# If you have any questions on how to create a translation file please direct them to zentrack support
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/assign.php"
+
+#args "array($r)"
+
+msgid " ? is required"
+
+msgstr "?  requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "%"
+
+msgstr ""
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args "array($file_type)"
+
+msgid "'?' is not an allowed file extension - See your systems administrator for more information"
+
+msgstr "'?' no  uma extenso vlida de arquivo - Para mais informaes consulte o Administrador do sistema"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "* = required"
+
+msgstr "* = requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "1 Match"
+
+msgstr "1 Ocorrncia"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/close.php"
+
+#args "array($zen->types[$c['type_id']], $c['id'])"
+
+msgid "? ? is not completed."
+
+msgstr "? ? no foi concludo."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args "array($c)"
+
+msgid "? Matches"
+
+msgstr "? Ocorrncias"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args "array($zen->getSetting("system_name"))"
+
+msgid "? Settings"
+
+msgstr "? Configuraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
+
+#args "array($j)"
+
+msgid "? bins were saved to the database. Updates complete"
+
+msgstr "? repositrios foram salvos no banco de dados. Alteraes concludas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/editSubmit.php"
+
+#args "array(ucfirst($r))"
+
+msgid "? is a required field"
+
+msgstr "?  um campo requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
+
+#args "array($r)"
+
+msgid "? is required"
+
+msgstr "?  requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args "array($k)"
+
+msgid "? must be set to 'on' or 'off'"
+
+msgstr "? Deve ser definido como 'Ligado' ou 'Desligado'"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args "array($k)"
+
+msgid "? must have a value, use zero instead of a blank"
+
+msgstr "? deve ter um valor, use zero no lugar de branco"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args "array($j, count($newparams))"
+
+msgid "? of ? settings changed were successfully updated"
+
+msgstr "? de ? alteraes nas configuraes foram salvas com xito"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args "array($num,count($zen->bins))"
+
+msgid "? open tickets in ? bins"
+
+msgstr "? tickets abertos em ? repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
+
+#args "array($j)"
+
+msgid "? priorities were saved to the database. Updates complete"
+
+msgstr "? prioridades salvas no banco de dados. Alteraes concludas"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
+
+#args "array($j)"
+
+msgid "? systems were saved to the database. Updates complete"
+
+msgstr "? sistemas salvos no banco de dados. Alteraes concludas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
+
+#args "array($j)"
+
+msgid "? tasks were saved to the database. Updates complete"
+
+msgstr "? tarefas salvas no banco de dados. Alteraes concludas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
+
+#args "array($j)"
+
+msgid "? types were saved to the database. Updates complete"
+
+msgstr "? tipos salvos no banco de dados. Alteraes concludas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
+
+#args "array($u)"
+
+msgid "? was not a valid user id"
+
+msgstr "? no  uma ID de usrio vlida"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "A large number of elements will appear better in a line chart, bar charts tend to be more pleasing with smaller numbers."
+
+msgstr "Um nmero grande de elementos  melhor visualizado em um grfico de linhas, grficos de barra so indicados para nmeros menores"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "ATC"
+
+msgstr "ATC"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/help/install.php"
+
+#args "array($zen->getSetting("system_name"))"
+
+msgid "About ?"
+
+msgstr "Sobre ? "
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
+
+#args ""
+
+msgid "About"
+
+msgstr "Sobre"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Accept"
+
+msgstr "Aceitar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
+
+#args ""
+
+msgid "Access Error"
+
+msgstr "Erro de ccesso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Access"
+
+msgstr "Acesso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
+
+#args ""
+
+msgid "Account Options"
+
+msgstr "Opes da conta"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Account Settings"
+
+msgid "Configuraes da conta de usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Account is Active"
+
+msgstr "Conta ativa"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
+
+#args ""
+
+msgid "Action Taken"
+
+msgstr "Ao tomada"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "Action"
+
+msgstr "Ao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Active"
+
+msgstr "Ativo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
+
+#args ""
+
+msgid "Add Attachment"
+
+msgstr "Adicionar anexo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Add Notify Recipient"
+
+msgstr "Adicionar destinatrio para notificao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
+
+#args ""
+
+msgid "Add Recipient"
+
+msgstr "Adicionar destinatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Add a total figure"
+
+msgstr "Adicionar um grfico de totais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Add an average figure"
+
+msgstr "Adicionar um grfico de mdias"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Add recipients to the notify list for this ticket"
+
+msgstr "Adicionar destinatrios na lista de notificaes para este ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
+
+#args ""
+
+msgid "Add ticket to project"
+
+msgstr "Adicionar ticket ao projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Add"
+
+msgstr "Adicionar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args ""
+
+msgid "Admin Section"
+
+msgstr "Administrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "Admin"
+
+msgstr "Administrador"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/admin_header.php"
+
+#args ""
+
+msgid "Administration"
+
+msgstr "Administrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Administrative Options"
+
+msgstr "Opes Administrativas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args "array($user_id)"
+
+msgid "All bins were removed from access for user ?"
+
+msgstr "Acessos aos repositrios revogados para o usurio ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "All entries must contain a value."
+
+msgstr "Todos os campos devem ter valor."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftBins.php"
+
+#args ""
+
+msgid "All"
+
+msgstr "Todos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Amount of time worked"
+
+msgstr "Tempo Decorrido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Any valid date format"
+
+msgstr "Qualquer formato vlido de data"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Approval Required"
+
+msgstr "Requer Aprovao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "Approval"
+
+msgstr "Aprovao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Approve"
+
+msgstr "Aprovar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "Archive Tickets"
+
+msgstr "Arquivar Tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Are you sure you want to permanently delete this template?"
+
+msgstr "Tem certeza que deseja apagar permanentemente este Modelo?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Assign Ticket"
+
+msgstr "Atribuir Ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Assign the ticket to a new user"
+
+msgstr "Atribuir ticket a um novo usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Assign"
+
+msgstr "Atribuir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
+
+#args ""
+
+msgid "Assigned to"
+
+msgstr "Atribudo "
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Associate this ticket with others"
+
+msgstr "Associar este ticket com outros"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "Attach"
+
+msgstr "Anexar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
+
+#args ""
+
+msgid "Attachment"
+
+msgstr "Anexo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
+
+#args "array($page_type,$id)"
+
+msgid "Attachments on ? #?"
+
+msgstr "Anexos em ? #?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "Attachments"
+
+msgstr "Anexos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Bar Chart"
+
+msgstr "Grfico de Barras"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Bin Name"
+
+msgstr "Repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "Bin ticket is located in"
+
+msgstr "Ticket do repositrio encontrado em"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
+
+#args ""
+
+msgid "Bin"
+
+msgstr "Repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Bin(s)"
+
+msgstr "Repositrio(s)"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid "Bins cannot be destroyed, to maintain data integrity."
+
+msgstr "Repositrios no podem ser excludos para preservar a integridade dos dados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "By Date"
+
+msgstr "Por data"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "By Parameters"
+
+msgstr "Por parmetros"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "By Text Match"
+
+msgstr "Por texto coincidente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "By Text"
+
+msgstr "Por texto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
+
+#args ""
+
+msgid "Change Default Bin"
+
+msgstr "Mudar o repositrio padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
+
+#args ""
+
+msgid "Change Language"
+
+msgstr "Mudar idioma"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
+
+#args ""
+
+msgid "Change Password"
+
+msgstr "Mudar senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "Change User Password"
+
+msgstr "Mudar senha do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
+
+#args ""
+
+msgid "Change Your Default Bin"
+
+msgstr "Alterar seu repositrio padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
+
+#args ""
+
+msgid "Change Your Language"
+
+msgstr "Alterar seu idioma"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Change"
+
+msgstr "Alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid "Changing the Bin Configuration has a large system impact."
+
+msgstr "A alterao na configurao do repositrio tem um forte impacto no sistema."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Changing these settings can have a severe impact on the system.  Please consider this before making modifications."
+
+msgstr "A alterao destas opes poder ter um forte impacto no sistema. Considere isto antes de faz-las."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Changing this configuration list has a large system impact."
+
+msgstr "A alterao destas configuraes tem um grande impacto sobre o sistema."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Chart Options"
+
+msgstr "Opes de Grfico"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
+
+#args ""
+
+msgid "Chart could not be saved."
+
+msgstr "No foi possvel salvar o grfico."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Choose one of the following options"
+
+msgstr "Escolha uma das seguintes opes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "Click 'Search' to execute the search"
+
+msgstr "Clique em 'Buscar' para fazer a pesquisa"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
+
+#args ""
+
+msgid "Click 'Update' to change your default bin"
+
+msgstr "Clique em 'Alterar' para mudar seu repositrio padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
+
+#args ""
+
+msgid "Click 'Update' to change your language"
+
+msgstr "Clique em 'Alterar' para mudar seu idioma"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args "array($button,$blurb)"
+
+msgid "Click ? to ?"
+
+msgstr "Clique em ? para ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
+
+#args ""
+
+msgid "Click Here to search for users"
+
+msgstr "Clique aqui para buscar por usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/translations/french.trans"
+
+#args ""
+
+msgid "Click Here"
+
+msgstr "Clique aqui"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Click button to add recipients"
+
+msgstr "Clique no boto para adicionar destinatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Click button to assign relations"
+
+msgstr "Clique no boto para atribuir relaes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Click button to assign"
+
+msgstr "Clique no boto para atribuir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "Click button to close"
+
+msgstr "Clique no boto para fechar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "Click button to create log"
+
+msgstr "Clique no boto para adicionar log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
+
+#args ""
+
+msgid "Click button to move ticket"
+
+msgstr "Clique no boto para mover o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
+
+#args ""
+
+msgid "Click button to open"
+
+msgstr "Clique no boto para abrir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
+
+#args ""
+
+msgid "Click button to reject"
+
+msgstr "Clique no boto para rejeitar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Click button to send email"
+
+msgstr "Clique no boto para enviar e-mail"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
+
+#args ""
+
+msgid "Click button to set estimated hours to completion"
+
+msgstr "Clique no boto para definir as horas estimadas para completar o trabalho"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "Click button to upload file and attach to ticket"
+
+msgstr "Clique no boto para enviar o arquivo e anex-lo ao ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
+
+#args ""
+
+msgid "Click button to yank ticket"
+
+msgstr "Clique no boto para desvincular o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Click button to"
+
+msgstr "Clique no boto para"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "Close Ticket"
+
+msgstr "Fechar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "Close"
+
+msgstr "Fechar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "Closed"
+
+msgstr "Fechado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args "array(strip_tags($report_type))"
+
+msgid "Combine selected ?s"
+
+msgstr "Combinar as ?s selecionadas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Comments or Instructions"
+
+msgstr "Comentrios ou instrues"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
+
+#args ""
+
+msgid "Comments"
+
+msgstr "Comentrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
+
+#args ""
+
+msgid "Commit Edited Ticket"
+
+msgstr "Salvar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
+
+#args ""
+
+msgid "Commit New Project"
+
+msgstr "Salvar novo projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
+
+#args ""
+
+msgid "Commit New Ticket"
+
+msgstr "Salvar novo ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "Completed"
+
+msgstr "Concludo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Configuration Settings"
+
+msgstr "Opes de Configurao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "Containing"
+
+msgstr "Contendo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
+
+#args ""
+
+msgid "Could not create ticket."
+
+msgstr "No foi possvel adicionar o ticket."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
+
+#args ""
+
+msgid "Create New"
+
+msgstr "Adicionar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Create Reports"
+
+msgstr "Adicionar relatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
+
+#args ""
+
+msgid "Create Sub-Project"
+
+msgstr "Adicionar sub-projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/newProject.php"
+
+#args ""
+
+msgid "Create a New Project"
+
+msgstr "Adicionar projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/newTicket.php"
+
+#args ""
+
+msgid "Create a New Ticket"
+
+msgstr "Adicionar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "Create a log entry, or log hours worked"
+
+msgstr "Adicionar uma entrada no log, ou log de horas decorridas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Create a new user account"
+
+msgstr "Nova conta de usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Create"
+
+msgstr "Adicionar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftBins.php"
+
+#args ""
+
+msgid "Current Bin"
+
+msgstr "Repositrio atual"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "Current status of the ticket"
+
+msgstr "Estado atual do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args "array($user_id)"
+
+msgid "Custom Access priviledges updated for user ?"
+
+msgstr "Privilgios de acceso personalizados alterados para o usurio ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "DESCRIPTION"
+
+msgstr "DESCRIO"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Data Options"
+
+msgstr "Opes de Dados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDataMenu.php"
+
+#args ""
+
+msgid "Data Selection"
+
+msgstr "Seleo de Dados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Date Range"
+
+msgstr "Faixa de Dados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
+
+#args ""
+
+msgid "Date log was created"
+
+msgstr "Log de datas adicionado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogList.php"
+
+#args ""
+
+msgid "Date"
+
+msgstr "Data"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Days"
+
+msgstr "Dias"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Deadline"
+
+msgstr "Trmino"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Default Access Level"
+
+msgstr "Nvel de acesso padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Delete Reports"
+
+msgstr "Excluir relatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
+
+#args ""
+
+msgid "Delete User"
+
+msgstr "Excluir usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Delete"
+
+msgstr "Excluir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "Description of Attachment"
+
+msgstr "Descrio do anexo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Description"
+
+msgstr "Descrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Details"
+
+msgstr "Detalhes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/headerInc.php"
+
+#args ""
+
+msgid "Details"),
+
+       "Log" => tr("Log"),
+
+       "Related" => tr("Related"),
+
+       "Attachments" => tr("Attachments"),
+
+       "Notify" => tr("Notify"),
+
+       "System" => tr("System")
+
+msgstr "Detalhes"),
+
+       "Log" => tr("Log"),
+
+       "Related" => tr("Related"),
+
+       "Attachments" => tr("Attachments"),
+
+       "Notify" => tr("Notify"),
+
+       "System" => tr("System")
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Disabled"
+
+msgstr "Desabilitado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Display Values"
+
+msgstr "Mostrar Valores"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
+
+#args ""
+
+msgid "Drop Recipients"
+
+msgstr "Excluir destinatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/drop.php"
+
+#args ""
+
+msgid "Drop Template"
+
+msgstr "Excluir modelo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "ETC"
+
+msgstr "ETC"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Bins"
+
+msgstr "Alterar repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Priorities"
+
+msgstr "Alterar prioridades"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Edit Settings"
+
+msgstr "Alterar configuraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Systems"
+
+msgstr "Alterar sistemas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Tasks"
+
+msgstr "Alterar tarefas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/edit.php"
+
+#args ""
+
+msgid "Edit Ticket"
+
+msgstr "Alterar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "Edit Tickets"
+
+msgstr "Alterar tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Types"
+
+msgstr "Alterar tipos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "Edit User Submit"
+
+msgstr "Alterar envio do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "Edit Users"
+
+msgstr "Alterar usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit Users/Access"
+
+msgstr "Alterar usurios/acessos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args "array(ucfirst($type))"
+
+msgid "Edit the Active ?s"
+
+msgstr "Alterar ?s ativos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the current bins"
+
+msgstr "Alterar repositrio atual"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the priorities list"
+
+msgstr "Alterar lista de prioridades"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the systems list"
+
+msgstr "Alterar lista de sistemas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the tasks list"
+
+msgstr "Alterar lista de tarefas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the types list"
+
+msgstr "Alterar lista de tipos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit the zenTrack settings.  Consult the documentation before using this feature."
+
+msgstr "Alterar as configuraes do zenTrack. Consulte a documentao antes de utilizar."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Edit ticket information"
+
+msgstr "Alterar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Edit"
+
+msgstr "Alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_titleBox.php"
+
+#args ""
+
+msgid "Elapsed"
+
+msgstr "Decorrido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Email Ticket"
+
+msgstr "Enviar ticket por e-mail"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Email"
+
+msgstr "E-mail"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Enter Project Information"
+
+msgstr "Informaes do projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Enter Ticket IDs"
+
+msgstr "IDs dos tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/nav.php"
+
+#args ""
+
+msgid "Enter a ticket ID and press enter"
+
+msgstr "ID do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "Enter any hours worked not previously accounted for"
+
+msgstr "Horas trabalhadas no computadas anteriormente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
+
+#args ""
+
+msgid "Enter hours worked"
+
+msgstr "Horas trabalhadas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "Enter multiple ids, separated by a comma"
+
+msgstr "IDs, separdos por vrgulas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Enter registered users"
+
+msgstr "Usurios registrados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "Enter the hours worked for this entry"
+
+msgstr "Horas trabalhadas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
+
+#args ""
+
+msgid "Enter the number of hours (can contain up to 2 decimal places)"
+
+msgstr "Nmero de horas (at 2 decimais)"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Enter ticket ids, separated by commas"
+
+msgstr "IDs dos tickets, separadas por vrgulas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Equals"
+
+msgstr "Igual a"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Est Hrs"
+
+msgstr "Horas est."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
+
+#args ""
+
+msgid "Estimate Ticket Hours"
+
+msgstr "Horas est. ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "Estimated Hours to Complete"
+
+msgstr "Horas est. concluso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "Estimated Hours"
+
+msgstr "Horas estimadas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Estimated time to complete"
+
+msgstr "Tempo estimado concluso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "First Name"
+
+msgstr "Nome"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Greater Than"
+
+msgstr "Maior que"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
+
+#args ""
+
+msgid "Help"
+
+msgstr "Ajuda"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Home Bin"
+
+msgstr "Repositrio Inicial"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Home"
+
+msgstr "Incio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "Hours Worked"
+
+msgstr "Horas trabalhadas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
+
+#args ""
+
+msgid "Hours must be entered if the activity is 'LABOR'"
+
+msgstr "A quantidade de horas deve ser informada se a atividade for do tipo 'TRABALHO'"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Hours"
+
+msgstr "Horas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args "array($page_type)"
+
+msgid "ID of the ?"
+
+msgstr "ID de ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "ID of the ticket"
+
+msgstr "ID do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "ID"
+
+msgstr "ID"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Image Type"
+
+msgstr "Tipo de imagem"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Image"
+
+msgstr "Imagem"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args "array($page_type)"
+
+msgid "Importance of the ?"
+
+msgstr "Importncia de ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Initials"
+
+msgstr "Iniciais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Items in this list cannot be destroyed, to maintain data integrity."
+
+msgstr "Para manter a integridade dos dados os elementos da lista no podem ser excludos."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "LOG"
+
+msgstr "LOG"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Last Name"
+
+msgstr "Sobrenome"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Less Than"
+
+msgstr "Menor que"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Less"
+
+msgstr "Menor"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Level"
+
+msgstr "Nvel"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
+
+#args ""
+
+msgid "License"
+
+msgstr "Licena"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Line Chart"
+
+msgstr "Grfico de Linhas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "List All Users"
+
+msgstr "Listar todos os usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "Log History")
+
+msgstr "Histrico do Log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
+
+#args ""
+
+msgid "Log ID"
+
+msgstr "ID do Log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "Log Off"
+
+msgstr "Desligar Log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "Log On"
+
+msgstr "Ligar Log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "Log"
+
+msgstr "Log"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Login Name"
+
+msgstr "Nome de usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
+
+#args ""
+
+msgid "Login and passphrase are case sensitive"
+
+msgstr "Nome de usurio e senha diferenciam maisculas/minsculas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Make Visible To"
+
+msgstr "Tornar visvel para"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/projectSearchbox.php"
+
+#args ""
+
+msgid "Make search of projects that returns comma delimited list"
+
+msgstr "O resultado da busca de projetos ser uma lista separada por vrgulas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/ticketSearchbox.php"
+
+#args ""
+
+msgid "Make ticket search that returns comma delimited list"
+
+msgstr "O resultado da busca de tickets ser uma lista separada por vrgulas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Manage Reports"
+
+msgstr "Gerenciar relatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Master Project"
+
+msgstr "Projeto principal"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "Maximum Age"
+
+msgstr "Idade mxima"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Modify Existing"
+
+msgstr "Alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/view.php"
+
+#args ""
+
+msgid "Modify Report"
+
+msgstr "Alterar relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Modify Reports"
+
+msgstr "Alterar relatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "Modify Search"
+
+msgstr "Alterar busca"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "Modify"
+
+msgstr "Alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Months"
+
+msgstr "Meses"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "More"
+
+msgstr "Mais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Most Current"
+
+msgstr "Mais atual"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
+
+#args ""
+
+msgid "Move Ticket"
+
+msgstr "Mover ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
+
+#args ""
+
+msgid "Move"
+
+msgstr "Mover"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args "array($page_type)"
+
+msgid "Name of the ?"
+
+msgstr "Nome de ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Name"
+
+msgstr "Nome"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/homebinForm.php"
+
+#args ""
+
+msgid "New Default Bin"
+
+msgstr "Repositrio padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/languageForm.php"
+
+#args ""
+
+msgid "New Language"
+
+msgstr "Idioma"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "New Password"
+
+msgstr "Senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "New Report"
+
+msgstr "Adicionar relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
+
+#args ""
+
+msgid "New Search"
+
+msgstr "Nova busca"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "New Template"
+
+msgstr "Adicionar modelo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "New User"
+
+msgstr "Adicionar usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "No Log Entries"
+
+msgstr "No h entradas no log."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "No Related Tickets"
+
+msgstr "No h tickets relacionados."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "No Tasks Assigned to this Project"
+
+msgstr "No h tarefas atribudas ao projeto."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_attachmentsBox.php"
+
+#args ""
+
+msgid "No attachments exist for this $page_type"
+
+msgstr "No h anexos para este $page_type"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
+
+#args ""
+
+msgid "No comments were entered."
+
+msgstr "No h comentrios."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "No file was uploaded."
+
+msgstr "Nenhum arquivo enviado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "No logs found"
+
+msgstr "Nenhum log encontrado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/dropFromNotify.php"
+
+#args ""
+
+msgid "No recipients were selected to drop"
+
+msgstr "Nenhum destinatrio selecionado para excluso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args ""
+
+msgid "No settings were recieved"
+
+msgstr "Nenhuma configurao alterada"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
+
+#args ""
+
+msgid "No tickets have been added to this Project."
+
+msgstr "Nenhum ticket adicionado ao projeto."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_relatedBox.php"
+
+#args ""
+
+msgid "No tickets have been associated with this ticket."
+
+msgstr "Nenhum outro ticket associado  este."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args ""
+
+msgid "No user id was recieved"
+
+msgstr "Nenhuma ID de usurio recebida"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogResults.php"
+
+#args ""
+
+msgid "No valid fields were provided to conduct a search"
+
+msgstr "Nenhum campo vlido para realizar a busca"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "Not Required"
+
+msgstr "Opcional"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Note"
+
+msgstr "Nota"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Notes"
+
+msgstr "Nota"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_notifyBox.php"
+
+#args ""
+
+msgid "Notify List"
+
+msgstr "Lista de notificaes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "OR manually enter email addresses, seperated by commas"
+
+msgstr "ou informe os endereos de e-mail manualmente, separados por vrgula"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Off"
+
+msgstr "Desligado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "On"
+
+msgstr "Ligado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args ""
+
+msgid "Only the root administrator can change the root administrator's passphrase"
+
+msgstr "A senha do administrador s pode ser modificada pelo administrador"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
+
+#args ""
+
+msgid "Open ticket closed in error"
+
+msgstr "Reabrir ticket fechado com erro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
+
+#args ""
+
+msgid "Opened"
+
+msgstr "Aberto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Optional.  Use control or shift to select multiples"
+
+msgstr "Opcional. Use as teclas 'control' ou 'shift' para selees mltiplas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Optional. You do not need to select yourself"
+
+msgstr "Opcional. No  necessrio selecionar a si mesmo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "Options"
+
+msgstr "Opes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/notify.php"
+
+#args ""
+
+msgid "Or add an unregistered user"
+
+msgstr "ou adicione um usurio no registrado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Order"
+
+msgstr "Ordem"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Owner"
+
+msgstr "Proprietrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args "array($user_id)"
+
+msgid "Password reset to the default [user's last name] for user ?"
+
+msgstr "A senha do usurio ? foi alterada para o valor padro [sobrenome do usurio]"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Password successfully changed"
+
+msgstr "Senha alterada com sucesso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Percent completed"
+
+msgstr "Percentual concludo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args "array($u["user_id"])"
+
+msgid "Permanently remove user ??"
+
+msgstr "Excluir usurio ? ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "Person ticket is assigned to"
+
+msgstr "Ticket personalizado atribudo "
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
+
+#args ""
+
+msgid "Pick a type"
+
+msgstr "Selecione um tipo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Pie Chart"
+
+msgstr "Grfico de Pizza"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Please consider this before making modifications."
+
+msgstr "Por favor considere isto antes de fazer modificaes."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
+
+#args ""
+
+msgid "Please enter a ticket ID"
+
+msgstr "Informe a ID do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Please fill in both of the fields"
+
+msgstr "Por favor preencha todos os campos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "Please keep track of your new passphrase."
+
+msgstr "Por favor anote sua nova senha."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "Please log in to view the entire ticket."
+
+msgstr "Por favor registre-se para visualizar o ticket."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Press 'Reset' to restore the original values."
+
+msgstr "Clique em 'Padro' para restaurar os valores originais."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Press 'Save' when you are sure that the values are correct."
+
+msgstr "Clique em 'Salvar' depois que informar todos os valores."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Press LESS to remove blank fields"
+
+msgstr "Clique em 'Menos' para eliminar os campos em branco"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Press LESS to remove blank rows"
+
+msgstr "Clique em 'Menos' para eliminar os linhas em branco"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Press MORE to add more custom fields"
+
+msgstr "Clique em 'Mais' para adicionar campos personalizados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Press MORE to create new rows"
+
+msgstr "Clique em 'Mais' para adicionar novas linhas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Press Reset to return to original values"
+
+msgstr "Clique em 'Padro' para voltar os valores originais."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Press Reset to return to users existing values"
+
+msgstr "Clique em 'Padro' para retornar os valores existentes para os usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Press Save to save changes"
+
+msgstr "Clique em 'Salvar' para confirmar as alteraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Press Update to save changes"
+
+msgstr "Clique em 'Alterar' para confirmar as alteraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Pri"
+
+msgstr "Pri"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Print"
+
+msgstr "Imprimir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Priority"
+
+msgstr "Prioridade"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
+
+#args ""
+
+msgid "Process completed successfully.  Account not added, because this is a demo site"
+
+msgstr "Processo concludo. A conta de usuario no foi adicionada por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
+
+#args ""
+
+msgid "Process completed successfully.  Bins were not updated since this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args ""
+
+msgid "Process completed successfully.  No changes were made because this is a demo site"
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args ""
+
+msgid "Process completed successfully.  No changes were made, because this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
+
+#args ""
+
+msgid "Process completed successfully.  Priorities were not updated since this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
+
+#args ""
+
+msgid "Process completed successfully.  Systems were not updated since this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
+
+#args ""
+
+msgid "Process completed successfully.  Tasks were not updated since this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
+
+#args ""
+
+msgid "Process completed successfully.  Types were not updated since this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args ""
+
+msgid "Process completed successfully. No privileges were changed, because this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "Process successful.  User was not updated, because this is a demo site."
+
+msgstr "Processo concludo. As alteraes no foram efetuadas por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/show.php"
+
+#args ""
+
+msgid "Processing Error: Report ID Missing"
+
+msgstr "Erro de processamento. Reltorio sem ID"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
+
+#args ""
+
+msgid "Processing error: tempid not found\n"
+
+msgstr "Erro de processamento; 'tempid' no encontrada\n"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Processing error: template not found."
+
+msgstr "Erro de processamento. Modelo no encontrado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
+
+#args ""
+
+msgid "Project ID"
+
+msgstr "ID do projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "Project"
+
+msgstr "Projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
+
+#args ""
+
+msgid "Projects"
+
+msgstr "Projetos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
+
+#args ""
+
+msgid "Pull ticket from the current owner"
+
+msgstr "Desvincular ticket do proprietrio atual"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "RELATED TICKETS"
+
+msgstr "TICKETS ASSOCIADOS"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Range"
+
+msgstr "Faixa"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "Really log out of zenTrack?"
+
+msgstr "Deseja sair do zenTrack?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
+
+#args ""
+
+msgid "Reason"
+
+msgstr "Motivo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
+
+#args ""
+
+msgid "Reject Ticket"
+
+msgstr "Rejeitar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
+
+#args ""
+
+msgid "Reject"
+
+msgstr "Rejeitar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Relate Ticket"
+
+msgstr "Associar ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/relate.php"
+
+#args ""
+
+msgid "Relate"
+
+msgstr "Associar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_relatedBox.php"
+
+#args "array($page_type)"
+
+msgid "Related ?s"
+
+msgstr "Associar ?s"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "Related Tickets"
+
+msgstr "Tickets associados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/optionsMenu.php"
+
+#args ""
+
+msgid "Remember My Password"
+
+msgstr "Lembrar senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
+
+#args ""
+
+msgid "Reopen Ticket"
+
+msgstr "Reabir ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reopen.php"
+
+#args ""
+
+msgid "Reopen"
+
+msgstr "Reabrir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/drop.php"
+
+#args ""
+
+msgid "Report Deleted"
+
+msgstr "Relatrio excludo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/custom.php"
+
+#args ""
+
+msgid "Report ID not found"
+
+msgstr "ID do relatrio no encontrada"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
+
+#args ""
+
+msgid "Report Name is required"
+
+msgstr "Nome do relatrio  requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
+
+#args ""
+
+msgid "Report Type"
+
+msgstr "Tipo de Relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftReports.php"
+
+#args ""
+
+msgid "Reports"
+
+msgstr "Relatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addSubmit.php"
+
+#args ""
+
+msgid "Required field missing:"
+
+msgstr "Campo requerido no encontrado:"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "Required"
+
+msgstr "requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Requirements"
+
+msgstr "Requerimentos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args ""
+
+msgid "Reset Password"
+
+msgstr "Senha Padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args "array($u["user_id"])"
+
+msgid "Reset the password for user ??"
+
+msgstr "Voltar senha do usurio ? para o padro?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Reset"
+
+msgstr "Padro"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/reject.php"
+
+#args ""
+
+msgid "Return ticket to sender"
+
+msgstr "Devolver ticket ao remetente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "Retype New Password"
+
+msgstr "Repita a nova Senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Role"
+
+msgstr "Perfil"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Save Report"
+
+msgstr "Salvar relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
+
+#args ""
+
+msgid "Save Submit"
+
+msgstr "Salvar envio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Save Template"
+
+msgstr "Salvar Modelo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "Save"
+
+msgstr "Salvar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Scatter Chart"
+
+msgstr "Grfico de Disperso"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "Search For Logs"
+
+msgstr "Buscar por logs"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Search For Users"
+
+msgstr "Buscar por usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
+
+#args ""
+
+msgid "Search Logs"
+
+msgstr "Busca de logs"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "Search Projects"
+
+msgstr "Busca de projetos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "Search Tickets"
+
+msgstr "Busca de tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/userSearchbox.php"
+
+#args ""
+
+msgid "Search Users"
+
+msgstr "Busca de usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/listUsers.php"
+
+#args ""
+
+msgid "Search for Users"
+
+msgstr "Busca por usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftSearch.php"
+
+#args ""
+
+msgid "Search"
+
+msgstr "Buscar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDataMenu.php"
+
+#args "array($zen->ffv($report_type))"
+
+msgid "Select ?s"
+
+msgstr "?s selecionados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "Select Projects"
+
+msgstr "Projetos selecionados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/ticketSearchbox.php"
+
+#args ""
+
+msgid "Select Tickets"
+
+msgstr "Tickets selecionados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/assign.php"
+
+#args ""
+
+msgid "Select a Recipient"
+
+msgstr "Selecione um destinatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Select a User"
+
+msgstr "Selecione um usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "Select a file to upload"
+
+msgstr "Selecione um arquivo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "Select an activity"
+
+msgstr "Selecione uma atividade"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "Select more than one by using control or shift"
+
+msgstr "Use as teclas 'Control' ou 'Shift' para selees mltiplas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "Select"
+
+msgstr "Selecionar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Send a link to this ticket only"
+
+msgstr "Enviar um link somente para este ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Send a summary of the ticket"
+
+msgstr "Enviar um resumo deste ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Send a summary, and the ticket's log"
+
+msgstr "Enviar um resumo e o log do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/move.php"
+
+#args ""
+
+msgid "Send ticket to another bin"
+
+msgstr "Mover o ticket para outro repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "Send ticket to specified recipients"
+
+msgstr "Enviar o ticket para os destinatrios especificados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args "array($zen->formatName($user_id))"
+
+msgid "Set Access for ?"
+
+msgstr "Nvel de Acesso para ?"
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "Set Password"
+
+msgstr "Senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "Set status to closed/pending"
+
+msgstr "Estado fechado/pendente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
+
+#args ""
+
+msgid "Set testing to completed on ticket"
+
+msgstr "Finalizar teste sobre o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/estimate.php"
+
+#args ""
+
+msgid "Set the expected hours this ticket will take to complete"
+
+msgstr "Nmero de horas estimado para concluir o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Set"
+
+msgstr "Configurar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Settings Administration"
+
+msgstr "Adminstrao de Configuraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftAdmin.php"
+
+#args ""
+
+msgid "Settings"
+
+msgstr "Configuraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "Show All Users"
+
+msgstr "Exibir todos usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Show Both"
+
+msgstr "Exibir ambos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Show Graph"
+
+msgstr "Exibir grfico"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/show.php"
+
+#args ""
+
+msgid "Show Report"
+
+msgstr "Exibir relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Show Tables"
+
+msgstr "Exibir tabelas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Stack Chart"
+
+msgstr "Grfico de blocos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Start Date"
+
+msgstr "Data de incio"
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Start From Date"
+
+msgstr "Iniciar a partir de"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Status"
+
+msgstr "Estado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsSubmit.php"
+
+#args ""
+
+msgid "Submit Results"
+
+msgstr "Enviar resultados"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Subtitle"
+
+msgstr "Subttulo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftHelp.php"
+
+#args ""
+
+msgid "Support"
+
+msgstr "Suporte"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
+
+#args ""
+
+msgid "System Error"
+
+msgstr "Erro de sistema"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
+
+#args "array($lname, $fname)"
+
+msgid "System Error: Could not add ?, ? to the system"
+
+msgstr "Erro de sistema: No foi possvel adicionar ?, ? para o sistema"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args "array($lname, $fname)"
+
+msgid "System Error: Could not update ?, ?"
+
+msgstr "Erro de sistema: No foi possvel alterar ?, ?"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "System Error: Unable to change user passphrase."
+
+msgstr "Erro de sistema: No foi possvel alterar a senha do usurio."
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
+
+#args ""
+
+msgid "System Error: Unable to update bin."
+
+msgstr "Eror de sistema: No foi possvel alterar o repositrio"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args ""
+
+msgid "System Error: could not update access &#151; this is most likely because no bins were set, and no bins previously existed (i.e. nothing happened)"
+
+msgstr "Erro de sistema: No foi possvel atualizar &#151; possivelmente no h um repositrio definido, ou repositrio no criado (nada foi alterado)"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args "array($user_id)"
+
+msgid "System Error: could not update access for user ?"
+
+msgstr "Erro de sistema: No foi possivel alterar o nvel de acesso para o usurio ?"
+
+
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_systemBox.php"
+
+#args ""
+
+msgid "System History"
+
+msgstr "Histrico do sistema"
+
+
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/log.php"
+
+#args ""
+
+msgid "System error: Activity could not be logged."
+
+msgstr "Erro de sistema: No foi possvel gerar log da atividade."
+
+
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args "array($userfile_name, $id)"
+
+msgid "System error: Attachment ? could not be uploaded for ticket ?. "
+
+msgstr "Erro de sistema: No foi possvel anexar arquivo ? ao ticket."
+
+
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
+
+#args ""
+
+msgid "System error: Notify list could not be updated "
+
+msgstr "Error de sistema: No foi possvel alterar a lista de notificaes."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/accept.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be accepted"
+
+msgstr "Erro de sistema: o ticket ? no pde ser aceito."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/approve.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be approved"
+
+msgstr "Erro de sistema: o Ticket ? no pde ser aprovado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/assign.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be assigned"
+
+msgstr "Erro de sistema: o ticket ? no pde ser atribudo."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/close.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be closed"
+
+msgstr "Erro de sistema: o ticket ? no pde ser fechado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be emailed. "
+
+msgstr "Erro de sistema: o ticket ? no pde ser enviado por e-mail."
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/move.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be moved. "
+
+msgstr "Erro de sistema: o ticket ? no pde ser movido."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/reject.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be rejected"
+
+msgstr "Erro de sistema: o ticket ? no pde ser rejeitado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/relate.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be related, or the entries were the same."
+
+msgstr "Erro de sistema: o ticket ? no pde ser associado, ou as entradas so as mesmas."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/reopen.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be reopened."
+
+msgstr "Erro de sistema: o ticket ? no pde ser reaberto."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/test.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be tested"
+
+msgstr "Erro de sistema: o ticket ? no pde ser testado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/yank.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? could not be yanked."
+
+msgstr "Erro de sistema: o ticket ? no pde ser desvinculado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/estimate.php"
+
+#args "array($id)"
+
+msgid "System error: Ticket ? hours could not be set"
+
+msgstr "Erro de sistema: o ticket ? no pde ter as horas definidas."
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "System involved in ticket"
+
+msgstr "Sistema relacionado com o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "System"
+
+msgstr "Sistema"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "TASKS FOR COMPLETION"
+
+msgstr "TAREFAS  CONCLUIR"
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_tasksBox.php"
+
+#args ""
+
+msgid "Tasks for this project"
+
+msgstr "Tarefas para o projeto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
+
+#args ""
+
+msgid "Test Ticket"
+
+msgstr "Testar Ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid "Test"
+
+msgstr "Teste"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/test.php"
+
+#args ""
+
+msgid "Tested"
+
+msgstr "Testado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "Testing Required"
+
+msgstr "Teste requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "Testing"
+
+msgstr "Testando"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Text"
+
+msgstr "Texto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
+
+#args ""
+
+msgid "That bin doesn't exist"
+
+msgstr "Repostitrio inexistente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "That is not a recognized file type, by your browsers determinations"
+
+msgstr "Seu navegador no reconhece este tipo de arquivo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
+
+#args ""
+
+msgid "That login name already exists.  Please choose another."
+
+msgstr "Nome de usurio j cadastrado. Por favor escolha outro."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "That login name is in use by another account"
+
+msgstr "Nome de usurio j em uso por outra conta"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/custom.php"
+
+#args ""
+
+msgid "That temporary report doesn't exist"
+
+msgstr "Relatrio temporrio no existe"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
+
+#args ""
+
+msgid "That ticket doesn't exist"
+
+msgstr "Ticket inexistente"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
+
+#args ""
+
+msgid "That user could not be found"
+
+msgstr "Usurio no encontrado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "The Guest Password cannot be changed!"
+
+msgstr "Senha de usurio convidado (guest) no pode ser modificada!"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUser.php"
+
+#args ""
+
+msgid "The Root Admin Account can only be modified by the Root Administrator"
+
+msgstr "A conta do Administrador s pode ser modificada por ele mesmo"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
+
+#args "array($user_id)"
+
+msgid "The account (?) could not be found/deleted successfully"
+
+msgstr "A conta do usurio (?) no foi encontrada/excluda corretamente"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
+
+#args "array($user_id)"
+
+msgid "The account(?) was successfully removed"
+
+msgstr "Conta do usurio (?) excluda com sucesso"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
+
+#args ""
+
+msgid "The action completed successfully.  The account was not actually deleted, because this is a demo site"
+
+msgstr "Ao concluda com sucesso. A conta de usurio no foi excluda por estarmos no modo de Demonstrao"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "The file could not be uploaded "
+
+msgstr "O arquivo no pde ser enviado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args "array(number_format($userfile_size), number_format($max_size))"
+
+msgid "The file size (?) exceeded the maximum allowed (?)"
+
+msgstr "O tamanho do arquivo (?) excede o mximo permitido (?)"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args "array(substr($max_size,0,strlen($max_size)-3))"
+
+msgid "The file was not recieved. Check to insure it's size does not exceed ?KB"
+
+msgstr "Arquivo no recebido. Verifique que seu tamanho no excede ? kb"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "The importance of the ticket"
+
+msgstr "Importncia do ticket"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
+
+#args ""
+
+msgid "The language could not be changed to ?", $newlang
+
+msgstr "No foi possvel alterar o idioma para $newlang"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
+
+#args ""
+
+msgid "The language file chosen was not valid"
+
+msgstr "Arquivo de idioma escolhido invlido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "The name of the ticket"
+
+msgstr "Nome do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "The name of the user"
+
+msgstr "Nome do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "The root admin access cannot be less than the level_settings parameter"
+
+msgstr "O Nvel de acesso do Administrador no pode ser menor que o parmetro 'level_settings'"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "The root admin account cannot be deactivated"
+
+msgstr "No  possvel desativar a conta do administrador"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args ""
+
+msgid "The root admin account must have access of 5 or greater"
+
+msgstr "O Nvel de acesso para a conta de administrador deve ser 5 ou maior"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/deleteUser.php"
+
+#args ""
+
+msgid "The root administrator account cannot be deleted"
+
+msgstr "A conta de administrador no pode ser excluda"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "The type of ticket"
+
+msgstr "Tipo do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the html form."
+
+msgstr "O tamanho do arquivo enviado  maior que o especificado na diretiva 'MAX_FILE_SIZE' no formulrio HTML."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "The uploaded file exceeds the upload_max_filesize directive in php.ini."
+
+msgstr "O tamanho do arquivo enviado  maior que o especificado na diretiva 'MAX_FILE_SIZE' no arquivo 'php.ini'."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "The uploaded file was only partially uploaded."
+
+msgstr "O arquivo enviado foi recebido parcialmente."
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/resetPassword.php"
+
+#args ""
+
+msgid "The user passphrase could not be found/edited"
+
+msgstr "A Senha do usurio no pde ser encontrada/alterada"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "There are more log entries."
+
+msgstr "No existem mais entradas no log."
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args ""
+
+msgid "There is already an entry with that value."
+
+msgstr "J existe uma entrada com este valor."
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
+
+#args ""
+
+msgid "There was nothing provided to update"
+
+msgstr "No havia nada para alterar"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/config.php"
+
+#args ""
+
+msgid "There were no changes made to the settings.  Procedure skipped."
+
+msgstr "No foram feitas alteraes nas configuraes. Procedimento ignorado."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/searchLogs.php"
+
+#args ""
+
+msgid "There were no logs matching your search."
+
+msgstr "No existem arquivos de log para a busca solicitada."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/email.php"
+
+#args ""
+
+msgid "There were no recipients"
+
+msgstr "No h destinatrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/listUsers.php"
+
+#args ""
+
+msgid "There were no results for your search"
+
+msgstr "No foram encontrados resultados para a busca."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/search.php"
+
+#args ""
+
+msgid "There were no results for your search."
+
+msgstr "No foram encontrados resultados para a busca."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "These options aren't useful when only graphing one element."
+
+msgstr "Estas opes no so teis para grficos de um nico elemento"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "This could be a long list! Proceed anyways?"
+
+msgstr "A lista pode ser longa! Continuar?
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "This grants the user the specified level of access to all bins not otherwise indicated by 'user access'."
+
+msgstr "Isto garantir ao usurio o nvel de acesso especificado  todos os repositrios no somente aos indicados pelo 'acesso personalizado' pelo usurio."
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
+
+#args "array($id)"
+
+msgid "Ticket #? cannot be edited in its current status"
+
+msgstr "Ticket #? no pode ser alterado devido ao seu estado atual"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
+
+#args "array($id)"
+
+msgid "Ticket #? could not be found"
+
+msgstr "Ticket #? no encontrado"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/action_header.php"
+
+#args "array($id)"
+
+msgid "Ticket #?"
+
+msgstr "Ticket #?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id,$this->formatName($user_id,2))"
+
+msgid "Ticket #?: Log added by ?"
+
+msgstr "Ticket #?: Log adicionado por ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id,$name)"
+
+msgid "Ticket #?: assigned to ?"
+
+msgstr "Ticket #?: atribudo  ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id)"
+
+msgid "Ticket #?: closed"
+
+msgstr "Ticket #?: fechado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id)"
+
+msgid "Ticket #?: created"
+
+msgstr "Ticket #?: adicionado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id,$this->getBinName($newBin))"
+
+msgid "Ticket #?: moved to ?"
+
+msgstr "Ticket #?: movido para ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id)"
+
+msgid "Ticket #?: rejected"
+
+msgstr "Ticket #?: rejeitado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id)"
+
+msgid "Ticket #?: reopened"
+
+msgstr "Ticket #?: reaberto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id,$name)"
+
+msgid "Ticket #?: yanked by ?"
+
+msgstr "Ticket #?: desvinculado por ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/editSubmit.php"
+
+#args "array($id)"
+
+msgid "Ticket ? could not edit ticket. "
+
+msgstr "Ticket ? no pde alterar o ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id)"
+
+msgid "Ticket ? has been reopened."
+
+msgstr "Ticket ? foi reaberto"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "Ticket Administration"
+
+msgstr "Administrao de tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/nav.php"
+
+#args ""
+
+msgid "Ticket ID"
+
+msgstr "ID do ticket"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "Ticket Information"
+
+msgstr "Informaes do ticket"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args ""
+
+msgid "Ticket Summary")
+
+msgstr "Resumo do ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
+
+#args ""
+
+msgid "Ticket"
+
+msgstr "Ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/assignedTickets.php"
+
+#args ""
+
+msgid "Tickets assigned"
+
+msgstr "Tickets atribudos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftTickets.php"
+
+#args ""
+
+msgid "Tickets"
+
+msgstr "Tickets"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets.php"
+
+#args ""
+
+msgid "Time"
+
+msgstr "Tempo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Title"
+
+msgstr "Ttulo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configForm.php"
+
+#args "array($type)"
+
+msgid "To remove a ? from use, uncheck the 'active' box."
+
+msgstr "Para remover um ? do uso, desmarque a caixa 'ativo'"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid "To remove a bin from use, uncheck the 'active' box."
+
+msgstr "Para excluir um repositrio, desmarque a caixa 'ativo'"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/print.php"
+
+#args ""
+
+msgid "Totals"
+
+msgstr "Totais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "Tracker"
+
+msgstr "Rastreador"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "Try using Combine Selected with a very large number of elements, if you intend to view a graphical image."
+
+msgstr "Quando o nmero de elementos  muito elevado, combine as selees se quiser ver em um grfico."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/access.php"
+
+#args ""
+
+msgid "Two or more bins were submitted with the same name"
+
+msgstr "Dois ou mais repositrios enviados com o mesmo nome"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "Type ids separated by commas, or click on the button."
+
+msgstr "Informe as IDs separadas por vrgulas, ou clique no boto"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchList.php"
+
+#args ""
+
+msgid "Type of ticket"
+
+msgstr "Tipo do Ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Type"
+
+msgstr "Tipo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Uncheck to disable this account."
+
+msgstr "Desmarque para desativar esta conta"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/bins.php"
+
+#args ""
+
+msgid "Update Bins"
+
+msgstr "Alterar repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/priorities.php"
+
+#args ""
+
+msgid "Update Priorities"
+
+msgstr "Alterar prioridades"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/systems.php"
+
+#args ""
+
+msgid "Update Systems"
+
+msgstr "Alterar sistemas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/tasks.php"
+
+#args ""
+
+msgid "Update Tasks"
+
+msgstr "Alterar tarefas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/types.php"
+
+#args ""
+
+msgid "Update Types"
+
+msgstr "Alterar tipos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "Update"
+
+msgstr "Alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "Upload Attachment"
+
+msgstr "Enviar anexo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/upload.php"
+
+#args ""
+
+msgid "Uploaded file size 0 bytes"
+
+msgstr "O arquivo enviado contm 0 bytes"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/index.php"
+
+#args ""
+
+msgid "Usage Reports"
+
+msgstr "Relatrios de Uso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "Use zero if unsure."
+
+msgstr "Informe zero se no tiver certeza"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/addUserSubmit.php"
+
+#args "array($user_id, "--link--" . tr("Click Here") . "</a>", $user_id)"
+
+msgid "User ? was added successfully. The password is the last name of the user. ? to customize user ?'s access permissions."
+
+msgstr "Usurio ? adicionado com sucesso. A senha  o sobrenome do usurio. ? para alterar as permisses de acesso do usurio ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/editUserSubmit.php"
+
+#args "array($user_id,
+
+ 			"--link--",
+
+ 			$user_id)"
+
+msgid "User ? was updated successfully. ? to customize user ?'s access permissions."
+
+msgstr "Usurio ? alterado com sucesso. ? para alterar as permisses de acesso do usurio ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "User Administration"
+
+msgstr "Adminstrao de usurios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsTypeMenu.php"
+
+#args ""
+
+msgid "User ID"
+
+msgstr "ID do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userAdd.php"
+
+#args ""
+
+msgid "User Information"
+
+msgstr "Informaes do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/options.php"
+
+#args ""
+
+msgid "User Options"
+
+msgstr "Opces do usurio"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchLogForm.php"
+
+#args ""
+
+msgid "User"
+
+msgstr "Usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/save.php"
+
+#args ""
+
+msgid "User(s)"
+
+msgstr "Usurio(s)"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Users Default Bin"
+
+msgstr "Repositrio padro do usurio"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Users Initials"
+
+msgstr "Iniciais do usurio"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Users System ID"
+
+msgstr "IDs dos usurios do sistema"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "Users email address"
+
+msgstr "E-mail dos usurios"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/configSettingsForm.php"
+
+#args ""
+
+msgid "Value"
+
+msgstr "Valor"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsSubmit.php"
+
+#args ""
+
+msgid "View Chart"
+
+msgstr "Ver Grfico"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportMenu.php"
+
+#args ""
+
+msgid "View Reports"
+
+msgstr "Ver Relatrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
+
+#args ""
+
+msgid "Visit the zenTrack development site"
+
+msgstr "Visite o site do desenvolvedor zenTrack"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Weeks"
+
+msgstr "Semanas"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/index.php"
+
+#args ""
+
+msgid "Welcome to zenTrack"
+
+msgstr "Bem-vindo ao zenTrack"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
+
+#args ""
+
+msgid "Welcome"
+
+msgstr "Bem-vindo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsOptionsMenu.php"
+
+#args ""
+
+msgid "What to Graph"
+
+msgstr "Informao  mostrar no grfico"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args "array($page_type)"
+
+msgid "Who the ? belongs to"
+
+msgstr "Proprietrio do ?"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "Worked"
+
+msgstr "Trabalhado"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
+
+#args ""
+
+msgid "Yank Ticket"
+
+msgstr "Desvincular Ticket"
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/yank.php"
+
+#args ""
+
+msgid "Yank"
+
+msgstr "Desvincular"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "Years"
+
+msgstr "Anos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/ticket.php"
+
+#args ""
+
+msgid "You are not allowed to view the following in this bin"
+
+msgstr "Acesso negado  este repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/editTicketSubmit.php"
+
+#args ""
+
+msgid "You cannot edit a ticket in this bin "
+
+msgstr "Voc no pode alterar um ticket neste repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/editTicketForm.php"
+
+#args ""
+
+msgid "You cannot edit a ticket in this bin"
+
+msgstr "Voc no pode alterar um ticket neste repositrio"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/admin/admin_header.php"
+
+#args ""
+
+msgid "You do not have access to administrate zenTrack."
+
+msgstr "Voc no possui permisso para adminstrar o zenTrack."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/searchResults.php"
+
+#args ""
+
+msgid "You do not have access to any bins."
+
+msgstr "Voc no possui acesso aos repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/index.php"
+
+#args ""
+
+msgid "You do not have access to any existing bins"
+
+msgstr "Voc no tem acesso a nenhum dos repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "You do not have permission to create projects."
+
+msgstr "Voc no tem permisso para adicionar projetos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
+
+#args ""
+
+msgid "You do not have permission to create tickets in this bin."
+
+msgstr "Voc no tem permisso para adicionar tickets neste repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/reports_header.php"
+
+#args ""
+
+msgid "You do not have permission to view the reports."
+
+msgstr "Voc no tem permisso para ver os relatrios."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/userSearchbox.php"
+
+#args ""
+
+msgid "You may use * for a wildcard in any field but the id.. i.e. J* would match anything starting with J"
+
+msgstr "Utilize * como coringa em qualquer campo, por exemplo, J* selecionar qualquer elemento que comee por J"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "You may use * for a wildcard in the title or description.. i.e. J* would match anything starting with J"
+
+msgstr "Utilize * como coringa no ttulo ou a descrio, por exemplo, J* selecionar qualquer elemento que comee por J"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/actions/addToNotify.php"
+
+#args ""
+
+msgid "You must provide at least one registered user, or a valid name and email address"
+
+msgstr "Voc deve informar pelo menos um usurio registrado, ou um nome e e-mail vlidos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/homebin.php"
+
+#args ""
+
+msgid "Your bin has been changed to"
+
+msgstr "Seu repositrio foi mudado para"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/saveSubmit.php"
+
+#args ""
+
+msgid "Your chart has been saved successfully saved with title: $report_name"
+
+msgstr "Seu grfico foi salvo com o ttulo: $report_name"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/language.php"
+
+#args ""
+
+msgid "Your language has been changed to ?", $newlang
+
+msgstr "Seu idioma foi modificado para $newlang"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Your new passphrase must contain at least 1 non-letter character"
+
+msgstr "Sua nova senha deve conter pelo menos 1 caractere no-alfabtico"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/pwcForm.php"
+
+#args ""
+
+msgid "Your passphrase must be at least 6 characters long and contain at least 1 non-letter character."
+
+msgstr "Sua nova senha deve ter no mnimo 6 caracteres e conter ter pelo menos 1 caracter no-alfabtico"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Your passphrase must be at least 6 digits long"
+
+msgstr "Sua nova senha deve conter no mnimo 6 caracteres"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Your passwords did not match"
+
+msgstr "Suas senhas no conferem"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/misc/pwc.php"
+
+#args ""
+
+msgid "Your request was successful, but this is a demo site, so the passphrase was not altered"
+
+msgstr "Sua requisio foi correta, mas no modo de Demonstrao sua senha no ser modificada"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/log.php"
+
+#args ""
+
+msgid "accepts up to 2 decimal places"
+
+msgstr "at 2 decimais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "access"
+
+msgstr "acesso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_detailsBox.php"
+
+#args ""
+
+msgid "completed"
+
+msgstr "concludo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/upload.php"
+
+#args ""
+
+msgid "create an attachment for this ticket"
+
+msgstr "adicionar um anexo neste ticket"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "delete"
+
+msgstr "excluir"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "edit"
+
+msgstr "alterar"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/adminMenu.php"
+
+#args ""
+
+msgid "edit,delete,change access"
+
+msgstr "alterar, excluir, modificar acesso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "enter a number"
+
+msgstr "ente um nmero"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/email.php"
+
+#args ""
+
+msgid "hold control or shift to select multiple users"
+
+msgstr "pressione as teclas 'Control' ou 'Shift' para selecionar vrios usurios"
+
+
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/accessForm.php"
+
+#args ""
+
+msgid "less"
+
+msgstr "menos"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/listTickets_workFormat.php"
+
+#args ""
+
+msgid "n/a"
+
+msgstr "n/d"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "no bins"
+
+msgstr "Nenhum repositrio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "no priorities"
+
+msgstr "Nenhuma prioridade"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/projectSearchbox.php"
+
+#args ""
+
+msgid "no systems"
+
+msgstr "Nenhum sistema"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/helpers/ticketSearchbox.php"
+
+#args ""
+
+msgid "no types"
+
+msgstr "Nenhum tipo"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "no"
+
+msgstr "No"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "none"
+
+msgstr "Nenhum"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "optional"
+
+msgstr "opcional"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "password"
+
+msgstr "senha"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/addProjectSubmit.php"
+
+#args ""
+
+msgid "required field missing:"
+
+msgstr "campo requerido faltando:"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/actions/close.php"
+
+#args ""
+
+msgid "required"
+
+msgstr "requerido"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/www/reports/view.php"
+
+#args ""
+
+msgid "required... processing error"
+
+msgstr "requerido... erro de processamento"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newProjectForm.php"
+
+#args ""
+
+msgid "save your changes"
+
+msgstr "salvar suas alteraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/zenTrack.class"
+
+#args "array($id,$name)"
+
+msgid "ticket #?: accepted by ?"
+
+msgstr "ticket #?: aceito por"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid "up to two decimal places, optional"
+
+msgstr "at 2 decimais, opcional"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/reportsDateMenu.php"
+
+#args ""
+
+msgid "use 4 digit year, time is optional"
+
+msgstr "indicar o ano com 4 dgitos, o tempo  opcional"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchForm.php"
+
+#args ""
+
+msgid "user ID"
+
+msgstr "ID do usurio"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/leftMain.php"
+
+#args ""
+
+msgid "version"
+
+msgstr "verso"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/userSearchList.php"
+
+#args ""
+
+msgid "yes"
+
+msgstr "sim"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Notes are special tickets which do not require any actions.'
+
+msgstr "Notas so tickets especiais que no requerem nenhuma ao."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/loginForm"
+
+#args ""
+
+msgid 'Please Log On.'
+
+msgstr "Por favor registre-se"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Press LESS to remove blank rows'
+
+msgstr "Pressione 'Menos' para remover as linhas em branco"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Press MORE to create new bins'
+
+msgstr "Pressione 'Mais' para adicionar novos repositrios"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Press Reset to return to original values'
+
+msgstr "Pressione 'Padro' para voltar aos valores originais"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Press Save to save changes'
+
+msgstr "Pressione 'Salvar' para confirmar as alteraes"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Projects act as containers, which can hold multiple tickets as "tasks" which are part of the projects completion requirements.'
+
+msgstr "Projetos funcionam como depsitos, que podem conter vrios tickets, como 'Tarefas' que so parte dos requisitos de concluso dos projetos."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'There are two special bin types, which can be set manually in the includes/configVars.php file (poor method), or set here (preferred	method) by naming a bin with either the word "project" or "note" in	the bin name.'
+
+msgstr "H dois tipos especiais de reposit'rorios, aquele que pode ser definido manualmente no arquivo 'includes/configVars.php'. ou definidos aqui (recomendvel), dando um nome ao repositrio como 'projeto' ou 'nota'"
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'They start their life closed, and do not need to be completed.'
+
+msgstr "Ele j inicia fechado, e no precisa ser concludo."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/binForm.php"
+
+#args ""
+
+msgid 'Use them only for tracking and documentation.'
+
+msgstr "Use-os apenas para ratreamento e documentao."
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/newTicketForm.php"
+
+#args ""
+
+msgid ($td
+
+msgstr ""
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid ucfirst($a)
+
+msgstr ""
+
+
+
+
+
+#file "/home/e-smith/files/ibays/zt/files/zentrack/includes/templates/ticket_actionBar.php"
+
+#args ""
+
+msgid ucfirst($a)) ,18," ",STR_PAD_RIGHT
+
+msgstr ""
+
+
+
+
+
diff -Naur zentrack_2-5-5-2/includes/translations/spanish.trans zentrack_2-6-pre1/includes/translations/spanish.trans
--- zentrack_2-5-5-2/includes/translations/spanish.trans	2005-03-22 08:31:41.000000000 -0800
+++ zentrack_2-6-pre1/includes/translations/spanish.trans	2005-10-18 08:27:49.000000000 -0700
@@ -1,6 +1,42 @@
 # This is the translation template file. It is automatically generated from developers/tr-parser.php
 # If you have any questions on how to create a translation file please direct them to zentrack support
 
+#file "/home/ired/zentrack_2/includes/templates/ticket_logBox.php"
+#args ""
+msgid "EDIT"
+msgstr "EDITADO"
+
+msgid "CREATED"
+msgstr "CREADO"
+
+msgid "PENDING"
+msgstr "PENDIENTE"
+
+msgid "TESTED"
+msgstr "TESTEADO"
+
+msgid "APPROVED"
+msgstr "APROBADO"
+
+msgid "CLOSED"
+msgstr "CERRADO"
+
+msgid "OPEN"
+msgstr "ABIERTO"
+
+msgid "MOVED"
+msgstr "MOVIDO"
+
+msgid "ACCEPTED"
+msgstr "ACEPTADO"
+
+msgid "ASSIGNED"
+msgstr "ASIGNADO"
+
+msgid "YANKED"
+msgstr "CAPTURADO"
+
+
 #file "/home/ired/zentrack_2/www/actions/assign.php"
 #args "array($r)"
 msgid " ? is required"
@@ -50,7 +86,7 @@
 
 
 #file "/home/ired/zentrack_2/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "? Settings"
 msgstr "Configuraciones de ?"
 
@@ -1540,7 +1576,7 @@
 #file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
 #args ""
 msgid "Edit Types"
-msgstr "Editar Tipos de Problema"
+msgstr "Editar Tipos"
 
 
 #file "/home/ired/zentrack_2/www/admin/editUserSubmit.php"
@@ -2332,7 +2368,7 @@
 #file "/home/ired/zentrack_2/includes/templates/languageForm.php"
 #args ""
 msgid "New Language"
-msgstr "Nuevo Usuario"
+msgstr "Nuevo Idioma"
 
 
 #file "/home/ired/zentrack_2/includes/templates/pwcForm.php"
@@ -2866,7 +2902,7 @@
 #file "/home/ired/zentrack_2/www/admin/types.php"
 #args ""
 msgid "Process completed successfully.  Types were not updated since this is a demo site."
-msgstr "Proceso finalizado satisfactoriamente. Los Tipos de Problema no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
+msgstr "Proceso finalizado satisfactoriamente. Los Tipos no fueron actualizados porque &eacute;ste es un sitio de demostraci&oacute;n"
 
 
 #file "/home/ired/zentrack_2/www/admin/editBehaviorDetails.php"
@@ -4054,7 +4090,7 @@
 #file "/home/ired/zentrack_2/includes/templates/listTickets_workFormat.php"
 #args ""
 msgid "The type of ticket"
-msgstr "El tipo de problema en el ticket"
+msgstr "El tipo de ticket"
 
 
 #file "/home/ired/zentrack_2/www/actions/upload.php"
@@ -4384,7 +4420,7 @@
 #file "/home/ired/zentrack_2/includes/zenTrack.class"
 #args ""
 msgid "Type"
-msgtr "Tipo de Problema"
+msgtr "Tipo"
  
      
 #file "/home/ired/zentrack_2/includes/zenTrack.class"
@@ -4480,13 +4516,13 @@
 #file "/home/ired/zentrack_2/includes/templates/groupForm.php"
 #args ""
 msgid "Type"
-msgstr "Tipo de Problema"
+msgstr "Tipo"
 
 
 #file "/home/ired/zentrack_2/includes/templates/adminMenu.php"
 #args ""
 msgid "Types represent the type of ticket activity."
-msgstr "Los Tipos de Problema representan por qu&eacute; se gener&oacute; el ticket."
+msgstr "Los Tipos representan por qu&eacute; se gener&oacute; el ticket."
 
 
 #file "/home/ired/zentrack_2/includes/templates/userAdd.php"
@@ -5008,7 +5044,7 @@
 #file "/home/ired/zentrack_2/www/helpers/ticketSearchbox.php"
 #args ""
 msgid "no types"
-msgstr "ning&uacute;n tipo de problema"
+msgstr "ning&uacute;n tipo"
 
 
 #file "/home/ired/zentrack_2/includes/templates/userSearchList.php"
@@ -5457,25 +5493,30 @@
 
 #file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
 #args ""
-msgid 'Match All'
-msgstr "Coincidir todos (ALL)"
+msgid "Exact Match"
+msgstr "Coincidencia exacta"
+
+#file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
+#args ""
+msgid "Match All"
+msgstr "Coincidir todos (AND)"
 
 
 #file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
 #args ""
-msgid 'Match Any'
+msgid "Match Any"
 msgstr "Coincidir al menos uno (OR)"
 
 
 #file "/home/ired/zentrack_2/www/help/english/admin/behaviors.php"
 #args ""
-msgid 'Match Type'
+msgid "Match Type"
 msgstr "Tipo de Coincidencia"
 
 
 #file "/home/ired/zentrack_2/www/help/english/admin/data_groups.php"
 #args ""
-msgid 'Matches'
+msgid "Matches"
 msgstr "Coincidencias"
 
 
@@ -5824,7 +5865,7 @@
 #file "/home/ired/zentrack_2/includes/templates/tutorial/english/create_ticket.php"
 #args ""
 msgid 'Type'
-msgstr "Tipo de Problema"
+msgstr "Tipo"
 
 
 #file "/home/ired/zentrack_2/includes/templates/configForm.php"
diff -Naur zentrack_2-5-5-2/includes/translations/swedish.trans zentrack_2-6-pre1/includes/translations/swedish.trans
--- zentrack_2-5-5-2/includes/translations/swedish.trans	2004-02-27 03:37:47.000000000 -0800
+++ zentrack_2-6-pre1/includes/translations/swedish.trans	2005-09-09 13:28:23.000000000 -0700
@@ -44,7 +44,7 @@
 
 
 #file "D:\zentrack\zentrack/www/admin/config.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "? Settings"
 msgstr "? Instllningar"
 
@@ -140,7 +140,7 @@
 
 
 #file "D:\zentrack\zentrack/www/help/install.php"
-#args "array($zen->settings["system_name"])"
+#args "array($zen->getSetting("system_name"))"
 msgid "About ?"
 msgstr "Angnde"
 
diff -Naur zentrack_2-5-5-2/includes/translator.class zentrack_2-6-pre1/includes/translator.class
--- zentrack_2-5-5-2/includes/translator.class	2005-05-01 23:59:35.000000000 -0700
+++ zentrack_2-6-pre1/includes/translator.class	2005-09-09 13:28:23.000000000 -0700
@@ -164,7 +164,7 @@
       if (!array_key_exists($translationFile, $this->_translationCache)) {
          //check for file
          if (!is_file($translationFile)) {
-            $this->_zenObj->addDebug("Translator->trans", "Translation File Does Not Exist: '$translationFile'\n", 2);
+            $this->_zenObj->addDebug("Translator->trans", "Translation File Does Not Exist: '$translationFile'\n", 1);
             $error = true;
          }
          else {
diff -Naur zentrack_2-5-5-2/includes/validateFields.php zentrack_2-6-pre1/includes/validateFields.php
--- zentrack_2-5-5-2/includes/validateFields.php	2005-05-08 14:14:53.000000000 -0700
+++ zentrack_2-6-pre1/includes/validateFields.php	2005-10-11 04:48:19.000000000 -0700
@@ -37,6 +37,12 @@
 
   $zen->cleanInput($fields);
   
+  // insure that the user/bin combination provided is allowed
+  if( $user_id && !$zen->checkAccess($user_id, $bin_id, 'level_user') ) {
+    $errs[] = tr('The user assigned to this ticket does not have '.
+                 'level_user priviledges for the selected bin (?)', $zen->getBinName($bin_id));
+  }
+  
   // check for required fields
   foreach($required as $r) {
     if( !strlen($$r) ) {
@@ -52,4 +58,4 @@
     include("$libDir/parseVarfields.php");
   }
   
-}?>
\ No newline at end of file
+}?>
diff -Naur zentrack_2-5-5-2/includes/zen.class zentrack_2-6-pre1/includes/zen.class
--- zentrack_2-5-5-2/includes/zen.class	2005-05-15 16:44:30.000000000 -0700
+++ zentrack_2-6-pre1/includes/zen.class	2005-10-20 11:23:44.000000000 -0700
@@ -155,12 +155,28 @@
      }
      return $val;
    }
+   
+   function fhv( $val = '', $strlen = 0 ) {
+     $val = Zen::ffv($val,$strlen);
+     return strlen($val)? $val : '&nbsp;';
+   }
+   
+   function fixJsHtml( $val, $char = '"' ) {
+     $val = str_replace($char, ($char == '"'? '&quot;' : '&#39;'), $val);
+     $val = str_replace('<', '&lt;', $val);
+     $val = str_replace('>', '&gt;', $val);
+     return $char.$val.$char;
+   }
 
-   function fixJsVal( $val ) {
+   function fixJsVal( $val, $char = '"' ) {
      // escape any js sensitive characters for use in strings
      if( is_null($val) ) { return "null"; }
-     if( strlen($val) == 0 ) { return "''"; }
-     return "'".str_replace("'", "\\'", str_replace("\\", "\\\\", $val))."'";
+     if( preg_match('@^[0-9]+$@', $val) ) {
+       return $val;
+     }
+     if( strlen($val) == 0 ) { return "$char$char"; }
+     $val = str_replace($char, "\\$char", str_replace("\\", "\\\\", $val));
+     return $char.$val.$char;
    }
    
    function checkAlpha( $val = '', $special = '_' ) {
@@ -576,12 +592,10 @@
       // prints an array of errors
       // in red, as a formatted list
       if( is_array($errs) ) {
-    print "<span class='error'><b>Errors Detected</b>";
-    print "<br>If problems persist, contact your "
-      ."<a href='{$this->settings['admin_email']}'>Administrator</a>\n<ul>\n";
-    foreach($errs as $e)
-      print "<li class='error'>$e</li>\n";
-    print "</ul></span>";
+        print "<span class='error'><b>Errors Detected</b><ul>\n";
+        foreach($errs as $e)
+        print "<li class='error'>".$this->ffv($e)."</li>\n";
+        print "</ul></span>";
       }
    }
    
@@ -782,6 +796,97 @@
     function cleanPath( $path ) {
       return str_replace('\\', '/', realpath($path) );
     }
+    
+   /**
+    * Adds a variable to a url appropriately
+    *
+    * @static
+    */
+   function addToUrl( $url, $key, $val ) {
+     $key = urlencode($key);
+     $val = urlencode($val);
+     $tf = strpos($url, '?') > 0;
+     return $url . ($tf? "&$key=$val" : "?$key=$val");
+   }
+   
+   /**
+    * Return a value for use in debugging.  This will handle arrays, objects,
+    * numbers, and strings intelligently, printing out a representative
+    * value for them.
+    *
+    * @static
+    * @param mixed $val the value to print
+    * @param boolean $dump_contents if true, dumps all values of arrays or objects
+    * @param boolean $format include line breaks
+    * @return string
+    */
+   function dval( $val, $format = true, $dump_contents = true ) {
+     $indent = func_num_args() > 3? func_get_arg(3) : 0;
+     $char = "   ";
+     $tabs = $indent? str_repeat($char,$indent) : "";
+     if( is_object($val) ) {
+       $txt = "Object(".get_class($val).")";
+       if( $dump_contents ) {
+         $txt .= $format? " {\n" : " {";
+         $i=0;
+         foreach( get_object_vars($val) as $k=>$v ) {
+           if( $format ) { $txt .= $tabs.$char; }
+           $txt .= $k."=>".Zen::dval($v,$dump_contents,$format,$indent+1)
+              .($i++ < count($val)-1? ', ' : '');
+           if( $format ) { $txt .= "\n"; }
+         }
+         $txt .= $format? "$tabs}\n" : "}";
+       }
+       return $txt;
+     }
+     else if( is_array($val) ) {
+       $txt = "Array";
+       if( $dump_contents ) {
+         $txt .= $format? " [\n" : " [";
+         foreach($val as $k=>$v) {
+           if( $format ) { $txt .= $tabs.$char; }
+           $txt .= "{$k}=>";
+           $txt .= Zen::dval($v,$dump_contents,$format,$indent+1);
+           $txt .= $i++ < count($val)-1? ($format? ",\n" : ",") : ($format? "\n":'');
+         }
+         $txt .= $format? "$tabs]\n" : "]";
+       }
+       return $txt;
+     }
+     else if( is_bool($val) ) {
+       $txt = $val? 'true' : 'false';
+     }
+     else if( is_null($val) ) {
+       return 'null';
+     }
+     else if( preg_match('/[^0-9]/', $val) ) {
+       return "'".Zen::ffv($val)."'";
+     }
+     else {
+       return $val;
+     }
+   }
+   
+   /**
+    * Print a value for use in debugging.  This will handle arrays, objects,
+    * numbers, and strings intelligently, printing out a representative
+    * value for them.
+    *
+    * @static
+    * @param mixed $val the value to print
+    * @param boolean $format include line breaks
+    * @param boolean $dump_contents if true, dumps all values of arrays or objects
+    */
+   function dprint( $val, $format = true, $dump_contents = true ) {
+     print Zen::dval( $val, $dump_contents );
+   }
+   
+   /**
+    * Print a value as in Zen::dprint(), but set it up to display in html
+    */
+   function dprintf( $val, $dump_contents = true ) {
+     print "<pre>".Zen::dval($val, $dump_contents, true)."</pre>";
+   }
    
    /*
    **  SYSTEM METHODS
@@ -806,4 +911,4 @@
    
 } 
   
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/includes/zenDate.class zentrack_2-6-pre1/includes/zenDate.class
--- zentrack_2-5-5-2/includes/zenDate.class	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/zenDate.class	2005-08-02 08:58:50.000000000 -0700
@@ -298,6 +298,12 @@
      // and returns the unix timestamp for
      // that date
      $ctime = trim($ctime);
+
+     //Prevent parsing an already parsed date:
+     if (strval(intval($ctime))==$ctime) {
+       return $ctime;
+     }
+
      if( !$ctime )
        $ctime = $this->currTime;
      // separator to parse euro date
@@ -309,7 +315,7 @@
        // break up date
        list($day, $month, $year) = split($sep, $date);
        // break up time
-       list($hours, $mins, $seconds) = explode('[.,:-]', $time);
+       list($hours, $mins, $seconds) = split('[.,:-]', $time);
        // create a unix timestamp and return
        return mktime($hours, $mins, $seconds, $month, $day, $year);
      }
diff -Naur zentrack_2-5-5-2/includes/zenGraph.class zentrack_2-6-pre1/includes/zenGraph.class
--- zentrack_2-5-5-2/includes/zenGraph.class	2005-05-01 23:59:36.000000000 -0700
+++ zentrack_2-6-pre1/includes/zenGraph.class	2005-10-04 14:13:20.000000000 -0700
@@ -27,13 +27,18 @@
     // When finished inputting the layers
     // and system settings, call this function
     // to produce a graphical image
+    
+    if( $this->debug > 0 ) {
+      error_reporting(E_ALL ^ E_NOTICE);
+      ini_set("display_errors", false);
+    }
 
     // initialize the image
     if( $this->trueColorEnabled ) {
-      $this->img = @ImageCreateTrueColor( $this->imageWidth, $this->imageHeight );
+      $this->img = ImageCreateTrueColor( $this->imageWidth, $this->imageHeight );
       ImageAlphaBlending( $this->img, TRUE );
     } else {
-      $this->img = @imageCreate( $this->imageWidth, $this->imageHeight );
+      $this->img = imageCreate( $this->imageWidth, $this->imageHeight );
     }
     if( !$this->img ) {
       $this->addDebug("zenGraph", "imageCreate() failed", 1, TRUE);
@@ -3282,8 +3287,7 @@
     // this function is called automatically through printString
     // if ttf is installed, then print a text
     // box using the installed font
-    // $angle is a degree angle from 3 o'clock position  
-
+    // $angle is a degree angle from 3 o'clock position
     if( !$font )
       $font = $this->ttfDefault;
     $fontfile = $this->libDir."/fonts/$font";
@@ -3292,6 +3296,7 @@
       $this->textStart($x,$y,$text,$size,$angle,$font,$adjust_x, $adjust_y);
       $this->addDebug("ttfPrintString(".$this->img
 		      .",$size,$angle,$x,$y,$color,$fontfile,$text)",$text,3);
+      if( !$color ) { $color = $this->colorForeground; }
       imageTtfText( $this->img, $size, $angle, $x, $y, $color, $fontfile, $text );
     } else {
       $this->addDebug("ttfPrintString","fontfile: $fontfile not found, text skipped!",1);
diff -Naur zentrack_2-5-5-2/includes/zenNotifier.php zentrack_2-6-pre1/includes/zenNotifier.php
--- zentrack_2-5-5-2/includes/zenNotifier.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/includes/zenNotifier.php	2005-09-09 13:28:23.000000000 -0700
@@ -0,0 +1,229 @@
+<?
+//For these settings use 1 (yes) or 0 (no)
+  $mailOwner=1;
+  $mailManager=1;
+  $mailTester=1;
+  $mailNotifylist=1;
+  $includeProjects=0;
+  $includePending=0;
+
+//Fill these with the text you want to use in tha notification emails
+  $mailSubject="Overdued tickets";
+  $mailHeader="This is an automatic message from zenTrack";
+
+//Here you can include a list of users who should never receive notification emails (use full lowercase)
+  $ignoreMailsTo=array("dontsend@mails.to.me",
+                       "neither@for.me");
+
+//The following lines should be copied from your header.php file
+  $libDir = "/home/zen/zentrack_2/includes";
+  $rootUrl = "http://your.root.url";
+  $Db_Type      = "mysql";      //sql type
+  $Db_Instance  = "mybase";       //db name
+  $Db_Login     = "myuser";   //username
+  $Db_Pass      = "mypass";   //password
+  $Db_Host      = "localhost";  //host of database
+  $page_prefix = "zenTrack | ";
+  $page_title = "Welcome to zenTrack";
+  $configFile = "$libDir/configVars.php";
+  $system_message_limit = 20;
+  setlocale(LC_TIME, "es_AR.iso88591");
+//You shouldn't touch anything after here
+//==============================================================
+  include_once("$libDir/translator.class");
+  include_once("$libDir/zenTrack.class");
+  include_once("$libDir/zenTemplate.class");
+  $zen = new zenTrack( $configFile );
+  $managers=array();
+  $testers=array();
+
+  /**
+   * Translator Object Initialization (mlively)
+   */
+  // set language to default if unspecified
+  if( !$login_language ) {
+    $login_language = $zen->getSetting("language_default");
+  }
+
+  //Create the initialization array for the translator object
+  //this data set also appears in the egate_utils.php script
+  $translator_init = array(
+     'domain' => 'translator',
+     'path' => "$libDir/translations",
+     'locale' => $login_language
+  );
+  $translator_init['zen'] =& $zen;
+  tr($translator_init);
+  //save a bit on memory
+  unset($translator_init);
+
+  $mainQuery= "SELECT user_id, email, lname, fname FROM ".$zen->table_users;
+  $vars = $zen->db_queryIndexed($mainQuery);
+  if (is_array($vars) && count($vars)) {
+    $users=array();
+    foreach($vars as $v) {
+      $i=$v["user_id"];
+      unset($v["user_id"]);
+      $users[$i]=$v;
+    }
+  }
+  $mainQuery= "SELECT bid FROM ".$zen->table_bins." WHERE active=1";
+  $vars = $zen->db_queryIndexed($mainQuery);
+  if (is_array($vars) && count($vars)) {
+    if ($mailManager) {
+      foreach($vars as $v) {
+        $list=$zen->fetch_bin_roles( $v["bid"], 'manager' );
+        if (is_array($list) && count($list)) {
+          $managers[$v["bid"]]=array();
+          foreach($list as $u) {
+            $em=$users[intval($u["user_id"])]["email"];
+            if(!is_null($em)) {
+              $managers[$v["bid"]][]=$em;
+            }
+          }
+        }
+      }
+    }
+    if ($mailTester) {
+      foreach($vars as $v) {
+        $list=$zen->fetch_bin_roles( $v["bid"], 'tester' );
+        if (is_array($list) && count($list)) {
+          $testers[$v["bid"]]=array();
+          foreach($list as $u) {
+            $em=$users[intval($u["user_id"])]["email"];
+            if(!is_null($em)) {
+              $testers[$v["bid"]][]=$em;
+            }
+          }
+        }
+      }
+    }
+  }
+
+  $mainQuery="SELECT id, title, otime, status, bin_id, deadline, bin_id, ZB.name BIN_NAME, ZY.name TYPE_NAME, "
+            ."       ZT.user_id, ZT.priority PID, email, ZP.name PRIORITY_NAME "
+            ."FROM ".$zen->table_tickets." ZT, ".$zen->table_types." ZY, ".$zen->table_bins." ZB, ".$zen->table_priorities." ZP "
+            ."     LEFT JOIN ".$zen->table_users." ZU ON ZT.user_id=ZU.user_id "
+            ."WHERE ZT.bin_id=ZB.bid AND ZT.type_id=ZY.type_id AND ZB.active=1 AND ZT.priority=ZP.pid"
+            ."     AND deadline<".$zen->currTime." AND deadline>0 AND (ctime IS NULL OR ctime=0) ";
+  if ($includeProjects==0) {
+    $mainQuery.="     AND ZY.name NOT LIKE '%project%' ";
+  }
+  if ($includePending==1) {
+    $mainQuery.="     AND status<>'CLOSED' ";
+  } else {
+    $mainQuery.="     AND status='OPEN' ";
+  }
+  $mainQuery.="ORDER BY PID, status, id";
+  $tickets = $zen->db_queryIndexed($mainQuery);
+  if( is_array($tickets) && count($tickets) ) {
+    $ticketsByID=array();
+    foreach($tickets as $t) {
+      $ticketsByID[$t["id"]]=$t;
+      if($mailOwner==1 && isset($t["email"])) {
+        $notification[$t["email"]][$t["BIN_NAME"]][intval($t["id"])]=1;
+      }
+      if(isset($managers[intval($t["bin_id"])])) {
+        foreach ($managers[intval($t["bin_id"])] as $email) {
+          $notification[$email][$t["BIN_NAME"]][intval($t["id"])]=1;
+        }
+      }
+      if(isset($testers[intval($t["bin_id"])])) {
+        foreach ($testers[intval($t["bin_id"])] as $email) {
+          $notification[$email][$t["BIN_NAME"]][intval($t["id"])]=1;
+        }
+      }
+    }
+  }
+  $headers = "Subject: $mailSubject \n"
+            ."Content-Type: text/html; charset=\"iso-8859-1\"\n";
+  foreach ($notification as $mailTo => $v)
+  {
+    if( !in_array(strtolower($mailTo), $ignoreMailsTo) )  {
+
+      $message = "
+<html>
+  <head>
+    <title>Overdue Notification</title>
+  </head>
+  <body><b>".$mailHeader."</b><br><br>";
+      foreach($v as $bin => $ids) {
+        $message.="<br><b>$bin</b><br>
+    <table width='100%' cellspacing='1' cellpadding='2' bgcolor='".$zen->getSetting("color_alt_background")."'>
+      <tr bgcolor='".$zen->getSetting("color_title_background")."'>
+        <td height='25' valign='middle' width='32'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("ID")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Title")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='32'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Pri")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='32'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Status")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='32'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Type")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='60'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Open Time")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='60'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Deadline")."</span></b></span></div>
+        </td>
+        <td height='25' valign='middle' width='40'>
+          <div align='center'><span style='color: rgb(255, 255, 255);'><b><span class='small'>".tr("Owner")."</span></b></span></div>
+        </td>
+      </tr>";
+
+        foreach($ids as $id => $one) {  
+          $link=$rootUrl."/ticket.php?id=".$id;
+          if ( isset($users[$ticketsByID[$id]["user_id"]]["email"]) && strlen($users[$ticketsByID[$id]["user_id"]]["email"]) ) {
+            $userinfo="<a href='mailto:".$users[$ticketsByID[$id]["user_id"]]["email"]
+                     ."'>".$users[$ticketsByID[$id]["user_id"]]["lname"].", "
+                     .$users[$ticketsByID[$id]["user_id"]]["fname"]."</a>";
+          } else {
+            $userinfo=$users[$ticketsByID[$id]["user_id"]]["lname"].", ".$users[$ticketsByID[$id]["user_id"]]["fname"];
+          }
+          $message.="
+      <tr>
+        <td height='25' valign='middle'>
+          <a href='$link'>$id</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".substr($ticketsByID[$id]["title"],0,40)."</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".$ticketsByID[$id]["PRIORITY_NAME"]."</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".$ticketsByID[$id]["status"]."</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".$ticketsByID[$id]["TYPE_NAME"]."</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".$zen->showDateTime($ticketsByID[$id]["otime"])."</a>
+        </td>
+        <td height='25' valign='middle'>
+          <a href='$link'>".$zen->showDateTime($ticketsByID[$id]["deadline"])."</a>
+        </td>
+        <td height='25' valign='middle'>
+          $userinfo
+        </td>
+      </tr>";
+        }
+        $message.="
+    </table>";
+      }
+
+
+
+      $message.="
+  </body>
+</html>";
+      mail($mailTo, $mailSubject, $message, $headers);
+    }
+  }
+?>
diff -Naur zentrack_2-5-5-2/includes/zenTemplate.class zentrack_2-6-pre1/includes/zenTemplate.class
--- zentrack_2-5-5-2/includes/zenTemplate.class	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/zenTemplate.class	2005-09-09 13:28:23.000000000 -0700
@@ -25,7 +25,7 @@
    **
    ** <ul> 
    **  <li>{varname} - inserts value of varname
-   **  <li>{zen:varname} - inserts value of $zen->settings["varname"]
+   **  <li>{zen:varname} - inserts value of $zen->getSetting("varname")
    **  <li>{list:varname:"text"+index+"more text"+value} - loops through indexed array and prints name/value
    **  <li>{list:varname:"text"+index+"more text"+selected+"other text"+value} - loops through indexed array and print
    **                                                                            name/value (and " selected" when appropriate)
@@ -129,7 +129,7 @@
 	  // {zen:varname}
 	  $zen = &$this->_getZenObject();
 	  $n = trim($parts[1]);
-	  return isset($zen->settings["$n"])? $zen->settings["$n"] : "";
+	  return $zen->getSetting("$n")? $zen->getSetting("$n") : "";
 	}
 	break;
       case "list":
@@ -142,10 +142,12 @@
 	    $str = $this->_parseString($parts[2]);
 	    // loop the list and make output text
 	    foreach($vars as $k=>$v) {
-        $fv = $this->_getVar("field_value");
+              $fv = $this->_getVar("field_value");
+              $fl = $this->_getVar("field_label");
 	      $tmp=$str;
 	      if($fv==$k && strlen($fv) == strlen($k) || is_array($fv) && in_array($k, $fv) || 
-            (!is_array($fv) && !strlen($k) && !strlen($fv))) {
+                                           ( is_array($fl) && in_array($k, $fl) ) ||
+                                           (!is_array($fv) && !strlen($k) && !strlen($fv))) {
 	        $tmp = str_replace("{selected}", " selected", $tmp);
 	        $tmp = str_replace("{checked}", " checked", $tmp);
 	      } else {
diff -Naur zentrack_2-5-5-2/includes/zenTrack.class zentrack_2-6-pre1/includes/zenTrack.class
--- zentrack_2-5-5-2/includes/zenTrack.class	2005-05-15 16:44:31.000000000 -0700
+++ zentrack_2-6-pre1/includes/zenTrack.class	2005-10-21 03:59:54.000000000 -0700
@@ -1,7 +1,6 @@
 <? /* -*- Mode: C; c-basic-indent: 3; indent-tabs-mode: nil -*- ex: set tabstop=3 expandtab: */ 
 if( !ZT_DEFINED ) { die("Illegal Access"); }
 
-
 /* 
 **  zenTrack Class
 **
@@ -20,10 +19,10 @@
 
 include_once("$libDir/zen.class");
 include_once("$libDir/ZenSessionManager.class");
+include_once("$libDir/ZenHistoryManager.class");
 
 class zenTrack extends zen {
 
-
   /*
   **  RETRIEVAL 
   */
@@ -127,7 +126,7 @@
     return( $this->db_queryIndexed($query) );
   }  
 
-  function get_project( $pid, $archive_flag = 0 ) {
+  function get_project( $pid, $reload = false ) {
     // retrieves all properties from database for given
     // project.  Also returns the following:
     //    children -  an array of tickets that belong to this project 
@@ -137,29 +136,27 @@
     //    percent_hours - is the percentage completion based on est_ and wkd_
     // if $archive_flag = 1, then will look in archived tickets instead of 
     // active tickets table
-
+    
     // check the cached data
-    $t = $this->_session->getDataCache('tickets',$id);
+    $t = $reload? false : $this->_session->getDataCache('tickets',$pid);
     if( $t ) { return $t; }
 
-    $table = ($archive_flag)? 
-      $this->table_tickets_archived : $this->table_tickets;
+    $table = $this->table_tickets;
     $pid = $this->checkNum($pid);
     $query = "SELECT * FROM $table WHERE id = $pid";
     $vars = $this->db_quickIndexed($query);
     if( is_array($vars) && count($vars) ) {
-      list($vars["est_hours"], $vars["wkd_hours"]) = 
-        $this->getProjectHours($pid, $archive_flag);
-        $vars["children"] = $this->getProjectChildren($pid, NULL, $archive_flag);
+      $vars["children"] = $this->getProjectChildren($pid);
+      $vars['total_children'] = count($vars['children']);
     }
     
     // store in data cache
-    $this->_session->storeDataCache('tickets',$id,$vars);
+    $this->_session->storeDataCache('tickets',$pid,$vars);
     
     return($vars);
   }
 
-  function get_projects( $params, $sort = 'priority, otime desc', $archive_flag =0 ) {
+  function get_projects( $params, $sort = 'priority, otime desc' ) {
     // retrieves a list of projects
     // see get_tickets() for a list of valid params
     // (with the exception of 'type_id' which is set to
@@ -170,10 +167,10 @@
     // if $archive_flag = 1, then retrieves from archive table
 
     $params["type_id"] = $this->projectTypeID();
-    return( $this->get_tickets($params, $sort, NULL, $archive_flag) );
+    return( $this->get_tickets($params, $sort) );
   }
 
-  function get_ticket( $id, $archive_flag = 0 ) {
+  function get_ticket( $id, $reload = 0 ) {
     // retrieves the properties for a 
     // specific ticket by id
     // use get_project() instead for projects
@@ -181,9 +178,9 @@
     // to a project and all it's children
     // $archive_flag retrieves tickets from archive db instead
     // of the ticket db
-
+    
     // check the cached data
-    $t = $this->_session->getDataCache('tickets',$id);
+    $t = $reload? false : $this->_session->getDataCache('tickets',$id);
     if( $t ) { return $t; }
     
     // load from database
@@ -197,7 +194,7 @@
                     
     // add to the cache
     $this->_session->storeDataCache('tickets',$id,$vals);
-                    
+    
     return( $vals );
   }
   
@@ -205,7 +202,7 @@
      // checks settings for priority styles and return the
      // appropriate cell style
      
-     if (!$this->settings["color_priority_low"]) {
+     if (!$this->getSetting("color_priority_low")) {
         return ("cell");
      } else {
         return ("priority$priority");
@@ -273,12 +270,39 @@
    * @param string $columns [optional] comma separated list of columns to select 
    */
   function get_tickets( $params = '', $sort = 'priority desc, otime desc', 
-                        $columns = '', $archive_flag = 0 ) {
+                        $columns = '', $pageNumber = null ) {
+    // sorting by priority is a special case... we don't want to sort
+    // by the priority_id, we want the sort order, so we will include
+    // the priority table and alter the processing slightly to get the
+    // desired effect
     $tf_pri = preg_match("/priority/", $sort);
 
+    // parse fields and deal with special values such as custom fields, which
+    // mean that we need to include the custom table
+    foreach($params as $k=>$v) {
+      if( strpos($k, 'custom_') === 0 ) {
+        // if we have custom fields in the search criteria, we must include the table
+        $tf_vf = true;
+        break;
+      }
+    }
+    
+    // if we are using the priority table and the priority appears in the where
+    // clause, then the priority fields are ambiguous, so we will deal with
+    // this case by providing a special name for the priority field.
+    if( $tf_pri && array_key_exists('priority', $params) ) {
+      $params['t.priority'] = $params['priority'];
+      unset($params['priority']);
+    }
+    
+    // if we have custom fields in the sort criteria, we must include the table
+    if( !$tf_vf ) { $tf_vf = strpos($sort, 'custom_') === 0; }
+
     //added for paging feature
-    $pageNumber = array_key_exists('pageNumber', $_GET)? 
-                $this->checkNum($_GET['pageNumber']) : 0;
+    if( !strlen($pageNumber) ) {
+      $pageNumber = array_key_exists('pageNumber', $_GET)? 
+                  $this->checkNum($_GET['pageNumber']) : 0;
+    }
     
     $tables = $this->table_tickets." t";
     if( $tf_pri ) {
@@ -286,6 +310,10 @@
       $tables .= ", $tblpri p";
       $sort = str_replace("priority", "ppri", $sort);
     }
+    
+    if( $tf_vf ) {
+      $tables .= ", ".$this->table_varfield." vf";
+    }
 
     if( !is_array($columns) ) {
       $columns = $tf_pri? 
@@ -310,6 +338,9 @@
     else {
       $where = $where? "WHERE $where" : '';
     }
+    if( $tf_vf ) {
+      $where .= $where? " AND t.id = vf.ticket_id " : " WHERE t.id = fv.ticket_id ";
+    }
       
     $query = "SELECT ".join(",",$columns)." FROM $tables $where";
 
@@ -317,7 +348,7 @@
       $query .= " ORDER BY $sort ";
     $w = preg_replace('/^ *WHERE/', '', $where);
     $this->total_records = $this->db_getrowcount($tables, $w);
-    $numtoshow = $this->settings['paging_max_rows'];
+    $numtoshow = $this->getSetting('paging_max_rows');
     $start = $pageNumber * $numtoshow;
     if( $start + $numtoshow > $this->total_records ) {
       $numtoshow = $this->total_records - $start; 
@@ -326,7 +357,32 @@
     $this->addDebug("get_tickets","count(vals)=".count($vals).",numtoshow=".$numtoshow.",start=".$start.",total_records=".$this->total_records.",query=".$query,3);    
     return $vals;
     //return( $this->db_queryIndexed($query) );
-  }      
+  }
+
+  /**
+   * retrieves the count of tickets
+   *
+   * $params can contain:
+   *     bins  - string/array of bins to retrieve for
+   *     users - string/array of users to retrieve for
+   *     id    - an array of specific ticket ids to retrieve
+   * the default columns returned can be overriden by using $columns to
+   * specify what should be returned from this function.  Note that the
+   * sort must correspond to the $columns values for SQL compatibility
+   * @param array $params see description
+   */
+  function count_tickets( $params = '',
+                          $archive_flag = 0 ) {
+    $tables = $this->table_tickets." t";
+
+    if( is_array($params) ) {
+      $where = $this->simpleWhere($params);
+    }
+
+    $v = $this->db_getrowcount($tables, $where);
+    $this->addDebug("count_tickets","records = ".$v." where = ".$query,3);
+    return $v;
+  }
 
   function get_user( $user_id ) {
     // returns a specific user
@@ -343,6 +399,22 @@
       ." WHERE login = ".$this->checkSlashes($login);
     return( $this->db_quickIndexed($query) );
   }
+  
+  function listTitles($table, $ids) {
+    $selectFields = $this->getDataTypeFields( $table );
+    $idField = $this->getTableId($table);
+    $query = "SELECT $selectFields FROM $table WHERE $idField IN($ids)";
+    $vals = $this->db_queryIndexed($query);
+    $titles = array();
+    if( $vals ) {
+      foreach($vals as $v) {
+        $id = $v[ $idField ];
+        $label = $zen->getDataTypeLabel($table, $vals);
+        $titles["$id"] = $label;
+      }
+    }
+    return $titles;
+  }
 
   /**
    * returns a list of users matching the given name
@@ -382,54 +454,88 @@
   /**
    * grabs all users matching the priviledges given for the bins designated
    *
-   * @param array $bins the bin ids to match
-   * @param string $level the access level to match to each bin
+   * @param array $bins only return users with access to the bins listed
+   * @param string $level only return users with at least $level access
    * @param integer $active 1-active members, 0-active and inactive members
    * @return array indexed, containing all fields from each row matched
    */
   function get_users( $bins = '', $level = 'level_view', $active = 1 ) {
     // get our level
-    $lvl = ($level)? $this->settings["$level"] : 0;
+    $lvl = $level? $this->getSetting($level) : 0;
+    
+    $binlist = '';
+    for($i=0; $i<count($bins); $i++) {
+      if( $i > 0 ) { $query .= ","; }
+      $binlist .= $this->checkNum($bins[$i]);
+    }
+    
 
-    // get a list from the access table
+    // get a list from the access table of invalid bins
+    // and map them to user_ids
     $outs = array();  //ones to skip
     $ins  = array();   //ones to keep
-    if( $bins ) {      
-      $query = "SELECT user_id,bin_id,lvl FROM ".$this->table_access;      
-      $query .= " WHERE bin_id IN(";
-      for($i=0; $i<count($bins); $i++) {
-        if( $i > 0 ) { $query .= ","; }
-        $query .= $this->checkNum($bins[$i]);
+    $outlist = '';
+    $query  = "SELECT user_id,bin_id FROM ".$this->table_access;
+    $query .= " WHERE lvl IS NOT NULL AND lvl < $lvl";
+    if( $active ) { $query .= " AND active = 1"; }
+    $vals = $this->db_query($query);
+    for($i=0; $i<count($vals); $i++) {
+      list($k,$v) = $vals[$i];
+      if( array_key_exists($k, $outs) ) {
+        $outs[$k][] = $v;
       }
-      $query .= ")";
-      $query .= " AND lvl IS NOT NULL";
-      $vals = $this->db_query($query);
-      for($i=0; $i<count($vals); $i++) {
-        $v = $vals[$i];
-        if( $v[2] < $lvl )
-          $outs[] = $v[0];
-        else
-          $ins[] = $v[0];
+      else {
+        $outs[$k] = array($v);
       }
     }
 
-    // set the query for users
-    $query = "SELECT * FROM ".$this->table_users;
-    $query .= " WHERE (access_level >= $lvl";
-    // add the users with bin specific access
-    $query .= count($ins)? " OR user_id IN(".join(',',$ins)."))" : ")";    
-    // remove the users with bin specific overrides
-    if( count($outs) ) {
-      $query .= " AND user_id NOT IN(".join(",",$outs).")";
+    // select all users who appear to have some sort of access to one of the bins
+    $query  = "SELECT u.*, bin_id as bins ";
+    $query .= " FROM {$this->table_users} u LEFT JOIN {$this->table_access} a";
+    $query .= " ON (u.user_id = a.user_id)";
+    $query .= " WHERE access_level >= $lvl";
+    if( $binlist ) {
+      $query .= " OR (a.bin_id IN($binlist) AND a.lvl >= $lvl)";
+    }
+    else {
+      $query .= " OR (a.bin_id IS NOT NULL AND a.lvl >= $lvl)";
     }
-    // set the ordering
+    if( $active ) { $query .= " AND active = 1"; }
     $query .= " ORDER BY lname,fname";
-    // query
     $vals = $this->db_queryIndexed($query);
+    
+    // create the users array, filter out items from our outs list
+    $users = array();
+    $usermap = array();
+    $count = 0;
+    for($i=0; $i<count($vals); $i++) {
+      $user = $vals[$i];
+      $id = $user['user_id'];
+      $bin = $user['bins'];
+      if( $bin && array_key_exists($id, $outs) && in_array($bin, $outs[$id]) ) {
+        // skip invalid entries
+        continue;
+      }
+      if( array_key_exists($id, $usermap) ) {
+        // add our bin to the list of bins for this user
+        $index = $usermap[$id];
+        if( array_key_exists($index, $users) && !in_array($bin, $users[$index]['bins']) ) {
+          $users[$index]['bins'][] = $bin;
+        }
+      }
+      else {
+        // create the user, store the location of the user in our temp map
+        // create the special bins array to store valid bins
+        $user['bins'] = array($user['bins']);
+        $users[$count++] = $user;
+        $usermap[$id] = $count;
+      }
+    }
+    
     // debug
     $this->addDebug("get_users","results: ".count($vals)."/$query",3);
     // return
-    return $vals;
+    return $users;  
   }
 
   /*
@@ -635,26 +741,23 @@
   function update_notify_list($old, $new) {
     $id = $old["id"];
     if( strlen($new["user_id"]) && $new["user_id"] != 'NULL' 
-    && $this->settings["default_notify_owner"] == "on" ) {
-      // modify the owner notification
-      if( $this->settings["default_notify_owner"] == "on" ) {
-        // see if they changed
-        if( $old["user_id"] != $new["user_id"] ) {
-          // drop the old user
-          if( $old["user_id"] ) {
-            $this->drop_notify_by_user($old["user_id"],$id);
-          }
-          // add the new user
-          if( $new["user_id"] ) {
-            $p = array("user_id"=>$new["user_id"]);
-            $this->add_to_notify_list($id,$p);
-          }
+    && $this->settingOn("default_notify_owner") ) {
+      // see if they changed
+      if( $old["user_id"] != $new["user_id"] ) {
+        // drop the old user
+        if( $old["user_id"] ) {
+          $this->drop_notify_by_user($old["user_id"],$id);
+        }
+        // add the new user
+        if( $new["user_id"] ) {
+          $p = array("user_id"=>$new["user_id"]);
+          $this->add_to_notify_list($id,$p);
         }
       }
     }
     // shorten up some settings for brevity
-    $dnm = ($this->settings["default_notify_manager"] == "on");
-    $dnt = ($this->settings["default_notify_tester"] == "on");
+    $dnm = $this->settingOn("default_notify_manager");
+    $dnt = $this->settingOn("default_notify_tester");
     if( isset($new["bin_id"]) && ($dnm || $dnt) ) {
       // check if bin has changed
       if( $old["bin_id"] != $new["bin_id"] ) {
@@ -965,7 +1068,16 @@
   function getVarfieldVals( $ticket_id ) { 
     $ticket_id = $this->checkNum($ticket_id);
     $query = "SELECT * FROM ".$this->table_varfield." WHERE ticket_id = $ticket_id";
-    return $this->db_quickIndexed($query);
+//    return $this->db_quickIndexed($query);
+    $res =  $this->db_quickIndexed($query);
+    $fm =& new ZenFieldMap($this);
+    $multi_fields = $fm->listMultiFields();
+    foreach ($multi_fields as $v) {
+      $query = "SELECT field_value FROM ".$this->table_varfield_multi." WHERE ticket_id = $ticket_id AND field_name='".$v."'"
+              ." ORDER BY multi_id";
+      $res[$v] = $this->db_list($query);
+    }
+    return ($res);
   }
   
   /**
@@ -980,9 +1092,18 @@
      $skip_id = $columns && !in_array('ticket_id',$columns);
      if( $columns ) {
        $cols = !$skip_id? '' : 'ticket_id';
+       $mcols = array();
+       $fm =& new ZenFieldMap($this);
+       $multi_fields = $fm->listMultiFields();
        foreach($columns as $c) {
-         if( $cols ) { $cols .= ','; }
-         $cols .= $c;
+         if ( strpos($c,'custom_multi')===false ) {
+           if( $cols ) { $cols .= ','; }
+           $cols .= $c;
+         } else {
+           if ( in_array($c,$multi_fields) ) {
+             $mcols[]=$c;
+           }
+         }
        }
      }
      else { $cols = "*"; }
@@ -991,6 +1112,10 @@
      $vars = array();
      for($i=0; $i < count($vals); $i++) {
        $k = $vals[$i]['ticket_id'];
+       foreach ($mcols as $mc) {
+         $query = "SELECT field_value FROM ".$this->table_varfield_multi." WHERE ticket_id = $k AND field_name='".$mc."'";
+         $vals[$i][$mc] = $this->db_list($query);
+       }
        if( $skip_id ) { unset($vals[$i]['ticket_id']); }
        $vars["$k"] = $vals[$i];
      }
@@ -1009,9 +1134,11 @@
   function updateVarfieldVals( $ticket_id, $field_values, $user_id = null, $bin_id = null ) { 
     $ticket_id = $this->checkNum($ticket_id);
     $user_id = $this->checkNum($user_id);
-    $a = $this->settings['varfield_tab_name'];
-    $log_entry = $a? "Updated ".ucfirst(strtolower($a))." fields\n" : "Updated Custom Fields";
+    $a = $this->getSetting('varfield_tab_name');
+    $log_entry = $a? "Updated ".ucfirst(strtolower($a))." fields" : "Updated Custom Fields";
     $oldVals = $this->getVarfieldVals($ticket_id);
+    $field_values_std = array();
+    $field_values_multi = array();
     foreach($field_values as $key=>$val) {
       $v1=$oldVals["$key"];
       $v2=$val;
@@ -1040,12 +1167,42 @@
         } else {
           $v2 = $val;
         }
+      } else if ( strpos($key, 'custom_multi') !== false ) {
+        if ( count($oldVals[$key])==0 ) {
+          $v1 = 'NULL';
+        } else {
+          $v1 = implode('; ', $oldVals[$key]);
+        }
+        if ( count($val)==0 ) {
+          $v2 = 'NULL';
+        } else {
+          $v2 = implode('; ', $val);
+        }
       }
       // find out if value was updated, check strlen so that 0 != '', and so forth
-      if( $v1 != $v2 ) { $log_entry .= "{$label} changed from [$v1] to [$v2]\n"; }
+      if( $v1 != $v2 ) { $log_entry .= "\n - {$label} changed from [$v1] to [$v2]"; }
+      //split the multi fields appart so that we can call the db_update function for all the other fields:
+      if ( strpos($key, 'custom_multi') === false ) {
+        $field_values_std[$key] = $val;
+      } else {
+        $field_values_multi[$key] = $val;
+      }
+    }
+    $res = $this->db_update( $this->table_varfield, "ticket_id", $ticket_id, $field_values_std );
+    if ($res && count($field_values_multi) ) {
+      foreach($field_values_multi as $key=>$val) {
+        $query = "DELETE FROM ".$this->table_varfield_multi." WHERE ticket_id = ".$ticket_id." AND field_name = '".$key."'";
+        $res_del = $this->db_result($query);
+        $this->addDebug("updateVarfieldVals - db_result", "[$res_del]".$query, 3);
+        foreach ($val as $element) {
+          $multi_entry = array('ticket_id' => $ticket_id,
+                               'field_name' => $key,
+                               'field_value' => $element);
+          $res_ins = $this->db_insert($this->table_varfield_multi,$multi_entry);
+        }
+      }
     }
-    $res = $this->db_update( $this->table_varfield, "ticket_id", $ticket_id, $field_values );
-    if( $res && $this->settings['log_edit'] == 'on' ) {
+    if( $res && $this->settingOn('log_edit') ) {
       // add a log entry
       $this->add_log( $ticket_id, array('user_id'   => $user_id,
                                         'bin_id'    => $bin_id,
@@ -1661,7 +1818,7 @@
     $this->addDebug("search_logsQuery",$query,2);
 
     //paging feature
-    $numtoshow = $this->settings['paging_max_rows'];
+    $numtoshow = $this->getSetting('paging_max_rows');
     $start = $pageNumber * $numtoshow;
     $this->total_records = $this->db_getrowcount($tables, $where);
     return($this->db_getlimitedIndex($query,$numtoshow,$start));
@@ -1722,7 +1879,7 @@
     $this->addDebug("search_ticketsQuery:",$query,3);
     // return(  $this->db_queryIndexed($query) );      
     //paging feature
-    $numtoshow = $limit? $limit : $this->settings['paging_max_rows'];
+    $numtoshow = $limit? $limit : $this->getSetting('paging_max_rows');
     $start = $pageNumber * $numtoshow;
     $this->total_records = $this->db_getrowcount($tables, $where);
     if( $limit === 0 ) {
@@ -1845,7 +2002,7 @@
 
     $params = array( "user_id" => $user_id );
     $res = $this->update_ticket($id,$params);
-    if( $res && $this->settings["log_accept"] == "on" ) {
+    if( $res && $this->settingOn("log_accept") ) {
       $logParams = array(
                          "action"   =>  'ACCEPTED',
                          "user_id"   =>  $user_id,
@@ -1862,7 +2019,7 @@
         $logParams["entry"] = $this->ffv($comments);   
       $res = $this->add_log($id, $logParams);
     }
-    if( $res && $this->settings["email_accept"] == "on" ) {
+    if( $res && $this->settingOn("email_accept") ) {
       $recipients = $this->get_notify_recipients($id);
       if( is_array($recipients) && count($recipients) ) {
         $subject = $this->ptrans("ticket #?: accepted by ?",array($id,$this->formatName($user_id)));
@@ -1894,7 +2051,7 @@
     }
     $params = array("approved"=>2);
     $res = $this->update_ticket($id,$params);
-    if( $res && $this->settings["log_approve"] ) {
+    if( $res && $this->settingOn("log_approve") ) {
       $logParams = array(
                          "action"   =>  'APPROVED',
                          "user_id"   =>  $user_id,
@@ -1908,7 +2065,7 @@
     if( $t["tested"] != 1 ) {
       $res = $this->close_ticket($id);
     }
-    else if( $this->settings["email_pending"] == "on" ) {
+    else if( $this->settingOn("email_pending") ) {
       $recipients = $this->get_notify_recipients($id);
       // make sure testers get notification      
       $vals = $this->fetch_bin_role_emails($t['bin_id'], $this->getRoleId("tester"));
@@ -1928,7 +2085,7 @@
     return( $res );
   }
 
-  function assign_ticket( $id, $recipient, $user_id = '', $comments = '' ) {
+  function assign_ticket( $id, $recipient, $user_id = 0, $comments = '' ) {
     // set the user_id for the ticket to another person
     // the recipient recieves the ticket, the user_id is for the 
     // sender
@@ -1960,7 +2117,7 @@
       }
     }
     $name = $this->formatName($recipient,1);
-    if( $res && $this->settings["log_assign"] == 'on' ) {
+    if( $res && $this->settingOn("log_assign") ) {
       $logParams = array(
                          "action"   =>  'ASSIGNED',
                          "user_id"   =>  $user_id
@@ -1971,7 +2128,7 @@
         $logParams["entry"] .= "\n\n".$comments;
       $this->add_log($id, $logParams);                
     }
-    if( $res && $this->settings["email_assign"] == "on" ) {
+    if( $res && $this->settingOn("email_assign") ) {
       $user = $this->get_user($recipient);
       $recipients = $this->get_notify_recipients($id);
       // make sure the assignee gets a notification
@@ -2006,7 +2163,7 @@
     $user_id = $this->checkNum($user_id);
     $res = $this->add_attachment($name, $filename, $filetype, $id, 
                                  $log_id, $description);
-    if( $res && $this->settings["log_attachment"] == 'on' ) {
+    if( $res && $this->settingOn("log_attachment") ) {
       $logParams = array(
                          "user_id"   => $user_id,
                          "action"   => "ATTACHMENT"
@@ -2051,7 +2208,7 @@
 	     $params["user_id"] = $user_id;
       }
       $res = $this->update_ticket($id, $params);
-      if( $this->settings["log_close"] == "on" ) {
+      if( $this->settingOn("log_close") ) {
 	// create a log entry
 	$logParams = array(
 			   "action"   =>  'CLOSED',
@@ -2069,7 +2226,7 @@
 	// send the log
 	$this->add_log($id, $logParams);    
       }
-      if( $this->settings["email_closed"] == "on" ) {
+      if( $this->settingOn("email_closed") ) {
 	     // send email
 	     $recipients = $this->get_notify_recipients($id);
         // make sure the manager gets a notification
@@ -2095,7 +2252,7 @@
 		      "user_id"  =>  'NULL'
 		      );
       $res = $this->update_ticket($id, $params);
-      if( $this->settings["log_pending"] == "on" ) {
+      if( $this->settingOn("log_pending") ) {
 	     // make a log entry
 	     $logParams = array(
 			   "action"   =>  'PENDING',
@@ -2112,7 +2269,7 @@
 	       $logParams["entry"] = $comments;
 	     $this->add_log($id, $logParams);    
       }  
-      if( $this->settings["email_pending"] == "on" ) {
+      if( $this->settingOn("email_pending") ) {
   	     // send an email
 	     $recipients = $this->get_notify_recipients($id);
         // make sure the testers/managers gets a notification
@@ -2153,7 +2310,7 @@
      * @param float $hours Amount of time to be added to the ticket's worked hours
      * @param string $comments Comments to add in the tickets log.
      **/
-  function close_ticket( $id, $user_id = '', $hours = '', $comments = '' ) {
+  function close_ticket( $id, $user_id = 0, $hours = '', $comments = '' ) {
     $id = $this->checkNum($id);
     if( $user_id ) { $user_id = $this->checkNum($user_id); }
 
@@ -2173,11 +2330,11 @@
       if( ! $t["ctime"] ) {
         $params["ctime"]=$this->currTime;
       }
-      if( $this->settings["retain_owner_closed"] != "on") {
+      if( !$this->settingOn("retain_owner_closed") ) {
         $params["user_id"] = NULL;
       }
       $res = $this->update_ticket($id, $params);
-      if( $this->settings["log_close"] == "on" ) {
+      if( $this->settingOn("log_close") ) {
         // create a log entry
         $logParams = array(
             "action"   =>  'CLOSED',
@@ -2195,7 +2352,7 @@
         // send the log
         $this->add_log($id, $logParams);
       }
-      if( $this->settings["email_closed"] == "on" ) {
+      if( $this->settingOn("email_closed") ) {
         // send email
         $recipients = $this->get_notify_recipients($id);
         // make sure the manager gets a notification
@@ -2217,14 +2374,14 @@
               && $t["status"] == "OPEN" ) {
       // update status to pending
       $params["status"]='PENDING';
-      if( $this->settings["retain_owner_pending"] != "on") {
+      if( !$this->settingOn("retain_owner_pending") ) {
         $params["user_id"] = NULL;
       }
-      if( ! $t["ctime"]  && $this->settings["ctime_on_pending"] == "on" ) {
+      if( !$t["ctime"]  && $this->settingOn("ctime_on_pending") ) {
         $params["ctime"]=$this->currTime;
       }
       $res = $this->update_ticket($id, $params);
-      if( $this->settings["log_pending"] == "on" ) {
+      if( $this->settingOn("log_pending") ) {
         // make a log entry
         $logParams = array(
              "action"   =>  'PENDING',
@@ -2241,7 +2398,7 @@
           $logParams["entry"] = $comments;
         $this->add_log($id, $logParams);
       }
-      if( $this->settings["email_pending"] == "on" ) {
+      if( $this->settingOn("email_pending") ) {
         // send an email
         $recipients = $this->get_notify_recipients($id);
         // make sure the testers/managers gets a notification
@@ -2285,7 +2442,7 @@
     if( $comments )
       $logParams["entry"] = $comments;
     $res = $this->add_log($id, $logParams);
-    if( $res && $this->settings["email_log"] == "on" ) {
+    if( $res && $this->settingOn("email_log") ) {
       $recipients = $this->get_notify_recipients($id);
       if( is_array($recipients) && count($recipients) ) {
         $eParams = array(
@@ -2305,7 +2462,7 @@
     return $res;
   }
 
-  function move_ticket( $id, $newBin, $user_id = '', $comments = '' ) {
+  function move_ticket( $id, $newBin, $user_id = 0, $comments = '' ) {
     // moves the ticket to a new bin location
     // if comments field is set to 'skip_log' then
     // no log will be generated (assumed to have 
@@ -2316,21 +2473,16 @@
 
     $t = $this->get_ticket($id);      
     $params["bin_id"] = $newBin;
-    if ($this->settings["retain_owner_move"] != "on") {
+    if( !$this->settingOn("retain_owner_move") ) {
       $params["user_id"] = NULL;
     } else {
       $currentOwner=$this->checkNum($t['user_id']);
-      $ownerAccess = $this->get_access($currentOwner,0);
-      if( ! (strlen($ownerAccess["$newBin"]) > 0) ) {
+      if ( ! $this->checkAccess($currentOwner,$newBin,'level_user') ) {
         $params["user_id"] = NULL;
-      } else {
-        if( $ownerAccess["$newBin"] < $this->settings["level_user"] ) {
-          $params["user_id"] = NULL;
-        }
       }
     }
     $res = $this->update_ticket($id, $params);
-    if( $res && $this->settings["log_move"] == "on" ) {
+    if( $res && $this->settingOn("log_move") ) {
       $logParams["action"] = "MOVED";
       $logParams["bin_id"] = $t["bin_id"];
       $logParams["entry"] = "MOVED TO ".$this->bins["$newBin"];
@@ -2341,7 +2493,7 @@
         $logParams["entry"] .= "\n\n".$comments;
       $this->add_log($id,$logParams);
     }
-    if( $res && $this->settings["email_arrival"] == "on" ) {
+    if( $res && $this->settingOn("email_arrival") ) {
       $recipients = $this->get_notify_recipients($id);
       // make sure the manager gets a notification
       $vals = $this->fetch_bin_role_emails($t['bin_id'], $this->getRoleId('manager'));
@@ -2368,21 +2520,32 @@
     $id = $this->checkNum($id);
     $user_id = $this->checkNum($user_id);
     $sender = $this->getTicketSender($id);
-    if( $sender["bin_id"] )
-      $res = $this->move_ticket( $id, $sender["bin_id"], $user_id );
-    if( $sender["user_id"] )
-      $res = $this->assign_ticket($id,$sender["user_id"],$user_id);
+    $sender_id = ($sender && array_key_exists('user_id',$sender))? $sender['user_id'] : false;
     $t = $this->get_ticket($id);
-    if( $res && $this->settings["log_reject"] == "on" ) {
+    if( $sender && array_key_exists('bin_id',$sender) ) {
+      $res = $this->move_ticket( $id, $sender["bin_id"] );
+    }
+    if( $sender_id ) {
+      $res = $this->assign_ticket($id, $sender_id);
+    }
+    if( $res && $this->settingOn("log_reject") ) {
       $logParams["action"] = "REJECTED";
       $logParams["bin_id"] = $t["bin_id"];
       $logParams["user_id"] = $user_id;
       $logParams["ticket_id"] = $t["id"];
-      if( $comments )
-      $logParams["entry"] = $comments;
+      if( $comments || $sender_id ) {
+        $logParams['entry'] = '';
+        if( $sender_id ) {
+          $logParams['entry'] .= tr("Returned to ?", array($this->formatName($sender_id)));
+          if( $comments ) { $logParams['entry'] .= "\n"; }
+        }
+        if( $comments ) {
+          $logParams["entry"] .= $comments;
+        }
+      }
       $this->add_log($id,$logParams);
     }
-    if( $res && $this->settings["email_reject"] == "on" ) {
+    if( $res && $this->settingOn("email_reject") ) {
       $recipients = $this->get_notify_recipients($id);
       // make sure the sender gets an email
       if( is_array($sender) && isset($sender["user_id"]) ) {
@@ -2421,7 +2584,7 @@
     return($res);
   }
 
-  function relate_ticket( $id, $relations, $user_id = '', $comments = '' ) {
+  function relate_ticket( $id, $relations, $user_id = 0, $comments = '' ) {
     // takes either a comma delimited string
     // or an array of ticket ids
     // checks to insure they exist before performing
@@ -2461,7 +2624,7 @@
       // 
     }
 
-    if( $res && $this->settings["log_relate"] == "on" && $user_id ) {
+    if( $res && $this->settingOn("log_relate") && $user_id ) {
       $logParams["action"] = "RELATED";
       $logParams["bin_id"] = $t["bin_id"];
       $logParams["user_id"] = $user_id;
@@ -2474,7 +2637,7 @@
     return( $res );
   }
 
-  function reopen_ticket( $id, $user_id = 'NULL', $comments = '' ) {
+  function reopen_ticket( $id, $user_id = 0, $comments = '' ) {
     // opens a ticket that has been closed
     // this can be used to reopen tickets
     // closed in error, or to make modifications
@@ -2504,8 +2667,8 @@
         $logParams["entry"] .= "\n\n".$comments;
       $this->add_log($id,$logParams);
     }
-    if( $res && ($this->settings["email_created"] == "on" 
-                 || $this->settings["email_arrival"] == "on")  ) {
+    if( $res && ($this->settingOn("email_created") 
+                 || $this->settingOn("email_arrival") )  ) {
       $recipients = $this->get_notify_recipients($id);
       if( $t['user_id'] ) {
 	$user = $this->get_user($t["user_id"]);
@@ -2539,7 +2702,7 @@
 
     $t = $this->get_ticket($id);
     $res = $this->update_ticket($id, array("tested"=>2));
-    if( $res && $this->settings["log_test"] ) {
+    if( $res && $this->settingOn("log_test") ) {
       $logParams["action"] = "TESTED";
       $logParams["bin_id"] = $t["bin_id"];
       $logParams["user_id"] = $user_id;
@@ -2554,7 +2717,7 @@
       // approved       
       $this->close_ticket($id);
     }         
-    else if( $this->settings["email_pending"] == "on" ) {
+    else if( $this->settingOn("email_pending") ) {
       $bin = $t["bin_id"];
       $recipients = $this->get_notify_recipients($id);
       // make sure the testers/managers gets a notification
@@ -2584,7 +2747,7 @@
     $t = $this->get_ticket($id);
     $bin_id = $t["bin_id"];
     if( is_array($t) ) {
-      if( $this->settings["log_yank"] == "on" ) {
+      if( $this->settingOn("log_yank") ) {
         $lParams = array(
                          "action"   =>   "YANKED",
                          "user_id"   =>   $user_id,
@@ -2594,7 +2757,7 @@
           $lParams["entry"] = $comments;
         $this->add_log($id,$lParams);
       }
-      if( $this->settings["email_assign"] == "on" ) {
+      if( $this->settingOn("email_assign") ) {
         $recipients = $this->get_notify_recipients($id);
 	if( $t["user_id"] ) {
 	  $user = $this->get_user($t["user_id"]);
@@ -2615,7 +2778,7 @@
       if( $t["status"] == 'CLOSED' ) {
         $tested = ($t["tested"] == 2)? 1:0;
         $approved = ($t["approved"] == 2)? 1:0;
-        $this->reopen_ticket($id, $user_id, $tested, $approved, $comments);
+        $this->reopen_ticket($id, 0, $tested, $approved, $comments);
       }
       $this->assign_ticket($id,$user_id);
       return( 1 );
@@ -2648,7 +2811,7 @@
       $notify_list = array();
 
       // the bin owners
-      if( $this->settings["default_notify_owner"] == "on" ) {
+      if( $this->settingOn("default_notify_owner") ) {
         $vars = $this->fetch_bin_roles($params["bin_id"],"manager");
         if( is_array($vars) && count($vars) ) {
           foreach($vars as $v) {
@@ -2658,7 +2821,7 @@
       }
 
       // the bin testers
-      if( $this->settings["default_notify_tester"] == "on" ) {
+      if( $this->settingOn("default_notify_tester") ) {
         $vars = $this->fetch_bin_roles($params["bin_id"],"tester");
         if( is_array($vars) && count($vars) ) {
           foreach($vars as $v) {
@@ -2667,42 +2830,45 @@
         }
       }
       // the ticket creator
-      if( $this->settings["default_notify_creator"] == "on" ) {
+      if( $this->settingOn("default_notify_creator") ) {
         $notify_list[]["user_id"] = $params["creator_id"];
       }
       // the ticket owner
-      if( $this->settings["default_notify_owner"] == "on"
-          && $params["user_id"] ) {
+      if( $this->settingOn("default_notify_owner") && $params["user_id"] ) {
         $notify_list[]["user_id"] = $params["user_id"];   
       }
       // create the list
       $this->set_notify_list($id,$notify_list);
 
       // create a log entry
-      $log_entry=$params["user_id"]?tr("Assigned to [?-?]",array($params["user_id"],$this->formatName($params["user_id"])))
-                                   :tr("Unassigned");
       $lParams = array(
                        "action"   =>   "CREATED",
                        "user_id"   =>   $params["creator_id"],
-                       "bin_id"    =>   $params["bin_id"],
-                       "entry"     =>   $log_entry
+                       "bin_id"    =>   $params["bin_id"]
                        );
-      if( $log_notes ) {
-        $lParams["entry"] = $log_notes;
+      if( $log_notes || $params['user_id'] ) {
+        $lParams['entry'] = '';
+        if( $params['user_id'] ) {
+          $lParams['entry'] = tr("Assigned to [?-?]",array($params["user_id"],$this->formatName($params["user_id"])));
+          if( $log_notes ) { $lParams['entry'] .= "\n"; }
+        }
+        if( $log_notes ) {
+          $lParams["entry"] .= $log_notes;
+        }
       }
       $this->add_log($id,$lParams);
 
-      if( $this->settings["email_created"] == "on" ) {
+      if( $this->settingOn("email_created") ) {
         // send email
         $bin = $t["bin_id"];
         // set the recipient list
         $recipients = $this->get_notify_recipients($id);
-	if( $params["user_id"] ) {
-	  $user = $this->get_user($params["user_id"]);	
-	  if( $user["email"] ) {
-	    $this->checkIncludedRecipients($recipients,$params['user_id']);
-	  }
-	}
+        if( $params["user_id"] ) {
+          $user = $this->get_user($params["user_id"]);	
+          if( $user["email"] ) {
+            $this->checkIncludedRecipients($recipients,$params['user_id']);
+          }
+        }
         if( is_array($recipients) && count($recipients) ) {
           $recipient = array_unique($recipients);
           $subject = $this->ptrans("Ticket #?: created",array($id));
@@ -2759,6 +2925,7 @@
       $t = $this->get_ticket($id);
     }
     $id = $this->checkNum($id);
+    $this->_session->clearDataCache('tickets',$id);
     foreach($params as $k=>$v) {
       if( !strlen($v) ) {
         switch($k) {
@@ -2787,7 +2954,7 @@
     $this->addDebug("update_ticket",$query,3);
     $this->_session->clearDataCache('tickets',$id);
     return $this->db_result($query);
-  }      
+  }
 
   function edit_ticket( $id, $user_id, $params, $reason="" ) {
     if( is_array($id) ) {
@@ -2800,11 +2967,11 @@
     }
     $id = $this->checkNum($id);
     $res = $this->update_ticket($id, $params);
-    if( $res && $this->settings['log_edit'] == 'on' ) {
+    if( $res && $this->settingOn('log_edit') ) {
       $log_entry = "Ticket edited:\n\n";
       foreach($params as $key=>$val) {
         // check each field to see if it was updated
-        if( $t["$key"] && $t["$key"] != $val ) {
+        if( $t["$key"] != $val ) {
           $v1 = strlen($t["$key"]) > 50? substr($t["$key"], 0, 50)."..." : $t["$key"];
           $v2 = strlen($val) > 50? substr($val, 0, 50)."..." : $val;
           switch ("$key") {
@@ -2837,11 +3004,11 @@
                                }
                                break;
           }
-          if (strlen($d1)>0) $d1="-".$d1;
-          if (strlen($d2)>0) $d2="-".$d2;
+          if (strlen($d1)>0) $d1=": ".$d1;
+          if (strlen($d2)>0) $d2=": ".$d2;
           $fm =& new ZenFieldMap($this);
           $label = $fm->getLabel("ticket_edit",$key);
-          $log_entry .= "{$label} changed from [$v1$d1] to [$v2$d2]\n";
+          $log_entry .= " - {$label} changed from [$v1$d1] to [$v2$d2]\n";
         }
       }
       if(strlen($reason)) {
@@ -2880,7 +3047,7 @@
     if( !$params["action"] )
       $params["action"] = "LOG";
     if( !$params["user_id"] )
-      $params["user_id"] = 0;//$this->settings["bot_name"];
+      $params["user_id"] = 0;//$this->getSetting("bot_name");
     if( !$params["bin_id"] ) {
       $ticket = $this->get_ticket($id);
       $params["bin_id"] = $ticket["bin_id"];
@@ -2962,18 +3129,28 @@
   function delete_attachment( $access_id ) { 
     // deletes attachments by attachment_id
     // can be an array
-
-    $access_id = $this->checkNum($access_id);
+    $c = 0;
     if( !is_array($access_id) )
       $access_id = array($access_id);
+    $ids = array();
     for( $i=0; $i<count($access_id); $i++ ) {
-      $att = $this->get_attachment($access_id[$i]);
-      $file = $this->attachmentDir."/$att[name]";
-      unlink($file);   
+      $aid = $this->checkNum($access_id[$i]);
+      $att = $this->get_attachment($aid);
+      if( !$att || !count($att) ) {
+        $this->addDebug('delete_attachment', "Attachment not found: "+$access_id);
+        continue;
+      }
+      $ids[] = $aid;
+      $file = $this->libDir."/attachments/{$att['filename']}";
+      unlink($file);
+      $c++;
+    }
+    if( count($ids) ) {
+      $query = "DELETE FROM ".$this->table_attachments
+        ." WHERE attachment_id IN(".join(",",$ids).")";
+      if( $this->db_result($query) ) { return $c; }
     }
-    $query = "DELETE FROM ".$this->table_attachments
-      ." WHERE attachment_id IN(".join(",",$id).")";
-    return( $this->db_result($query) );
+    return false;
   }
 
   function delete_all_attachments( $ids ) {
@@ -2982,6 +3159,7 @@
 
     if( !is_array($ids) )
       $ids = array($ids);
+    $access_id = array();
     foreach($ids as $id) {
       $id = $this->checkNum($id);
       $att = $this->get_attachments($id, $flag);
@@ -3206,17 +3384,29 @@
    * @param string $value the value to be inserted, null or "" should work fine
    */
   function update_pref( $user_id, $pref, $value ) {
-    $this->delete_prefs($user_id,$prefname);
-    $this->_session->clearDataType('prefs');
+    $old_value = $this->get_prefs($user_id, $pref);
+    if( "$old_value" == "$value" ) {
+      $this->addDebug('update_pref', "Value has not changed for '$pref', not updated", 2);
+    }
+    
+    // delete old pref
+    $user_id = $this->checkNum($user_id);
+    $pref = $this->checkAlphaNum($pref, '_ -');
+    $query = "DELETE FROM ".$this->table_preferences." WHERE user_id = $user_id "
+      ." AND prefname = '$pref'";
+    $res = $this->db_result($query);
+    
+    // add new pref
     $vals = array(
-      'user_id'  => $this->checkNum($user_id),
-      'prefname' => $this->checkAlphaNum($pref, '_ -'),
+      'user_id'  => $user_id,
+      'prefname' => $pref,
       'prefval'  => $value
     );
     list($cols,$vals) = $this->makeInsertVals($vals);
     $query = "INSERT INTO ".$this->table_preferences
       ." ($cols) VALUES($vals)";
     $res = $this->db_result($query);
+    $this->_session->clearDataType('prefs');
     $this->addDebug('update_pref', "[$res]".$query, 3);
     return $res;
   }
@@ -3299,6 +3489,7 @@
   function add_setting( $params ) {
     // add a new setting into the db
     $this->_session->clearDataType('settings');
+    $this->_settings = false;
     return( $this->db_insert($this->table_settings, $params) );
   }
 
@@ -3357,6 +3548,7 @@
     $query = "UPDATE ".$this->table_settings." SET $set WHERE setting_id = $setting_id";
     $this->addDebug("update_setting()Query",$query,2);
     $this->_session->clearDataType('settings');
+    $this->_settings = false;
     return( $this->db_result($query) );
   }
 
@@ -3630,7 +3822,7 @@
         // include the body of the message
         $message .= "\n\n$v\n\n";
       } else if( $k == 'link' ) {
-        $message .= $this->settings["url_view_ticket"]."?id=$v";       
+        $message .= $this->getSetting("url_view_ticket")."?id=$v";       
       } else if( $k == 'tid' ) {
         // print a summary of the ticket
         $message .= "\n\n--- ".strtoupper($this->trans("Ticket Summary"))." ---\n\n";
@@ -3646,8 +3838,8 @@
             $ticket = $this->get_ticket($v);
           }
         }
-        $ticket['varfields'] = $this->getVarfieldVals($id);
-        $url = $this->settings["url_view_ticket"]."?id=$v";
+        $ticket['varfields'] = $this->getVarfieldVals($v);
+        $url = $this->getSetting("url_view_ticket")."?id=$v";
         $n = $ticket["bin_id"];
         $u = $ticket["user_id"];
         $s = $ticket["system_id"];
@@ -3683,8 +3875,8 @@
         $message .= $msg->process();
       } else if( $k == "log" ) {
         // print the log for the ticket
-        if( $this->settings["email_max_logs"] )
-          $lim = $this->settings["email_max_logs"];
+        if( $this->getSetting("email_max_logs") )
+          $lim = $this->getSetting("email_max_logs");
         $logs = $this->get_logs($v, 'created DESC', $lim);
         $message .= "\n\n";
         if( is_array($logs) ) {
@@ -3731,7 +3923,7 @@
             $message .= "\n".$this->trans("There are more log entries.")
               .$this->trans("Please log in to view the entire ticket.")."\n";
             if( !$params["tid"] && !$params["link"] ) {
-              $message .= $this->settings["url_view_ticket"]."?id=$v";
+              $message .= $this->getSetting("url_view_ticket")."?id=$v";
             }
           }
         } else {
@@ -3766,7 +3958,7 @@
     }
     
     // add the obligatory email stuff
-    $subject = "[".$this->settings["bot_name"]."] ".$subject;
+    $subject = "[".$this->getSetting("bot_name")."] ".$subject;
     
     // figure out who sent it
     $message = (get_magic_quotes_gpc())? stripslashes($message) : $message;
@@ -3774,7 +3966,7 @@
                             array("#&lt;#", "#&gt;#", "#&quot;#", "#&amp;#"),
                             array("<",">",'"',"&"), $message);
     if( !$sender ) {
-      $sender_address = $this->settings["admin_email"];
+      $sender_address = $this->getSetting("admin_email");
     } else {
       if( eregi("^[0-9]+$", $sender) ) {
         $s = $this->get_user($sender);
@@ -3822,7 +4014,7 @@
         $headers .= "cc: $cc_address\n";
       }
       
-      if( $this->settings["email_interface_enabled"] == "on" ) {
+      if( $this->settingOn("email_interface_enabled") ) {
         // set reply address to egate user        
         $s = $egate_user;
         if( !is_array($s) ) {
@@ -3978,6 +4170,11 @@
     // name of this row: i.e. for users, last_name, first_name
     // and for bins, the name field
     switch( strtoupper($table) ) {
+    case "ZENTRACK_TICKETS":
+    case "TICKETS":
+    case "ZENTRACK_COMPANY":
+    case "COMPANY":
+      return $vals['title'];
     case "ZENTRACK_BINS":
     case "BINS":
     case "ZENTRACK_PRIORITIES":
@@ -3989,6 +4186,8 @@
     case "ZENTRACK_TYPES":
     case "TYPES":
       return $vals['name'];
+    case "ZENTRACK_EMPLOYEE":
+    case "EMPLOYEE":
     case "ZENTRACK_USERS":
     case "USERS":
       return $this->formatName($vals);
@@ -4049,7 +4248,7 @@
         return 'person_id';
       case 'GROUP':
         return 'group_id';
-      case 'LOGS';
+      case 'LOGS':
         return 'lid';
       case 'NOTIFY_LIST':
         return 'notify_id';
@@ -4114,6 +4313,7 @@
           $vals["{$u['user_id']}"] = $this->formatName($u,1);
         }
         break;
+      case "ticket_id":
       case "id":
         if( !$validBins ) { return null; }
         $tickets = $this->get_tickets(
@@ -4126,14 +4326,18 @@
         break;
       case "project_id":
         $tickets = $this->get_tickets(
-          array('type_id'=>$this->projectTypeIds(),'bin_id'=>$bins)
+          array('type_id'=>$this->projectTypeIds(),'bin_id'=>$validBins)
         );
+        for($i=0; $i<count($tickets); $i++) {
+          $t = $tickets[$i];
+          $vals["{$t['id']}"] = $t['title'];
+        }
         break;
       default:
         return null;
     }
     $this->addDebug('getValsForTicketField()', "dataTypeId=$dataTypeId, $mode=$mode, "
-      .count($bins)." bins, ".count($vals)." results",3);
+      .count($validBins)." bins, ".count($vals)." results",3);
     return $vals;
   }
 
@@ -4203,7 +4407,16 @@
     $userBins = $this->_session->getDataType('userbins');
     if( !isset($userBins) ) { $userBins = array(); }
     if( !isset($userBins["U$user_id"]) ) { $userBins["U$user_id"] = array(); }
-    if( isset($userBins["U$user_id"]["L$level"]) ) { return $userBins["U$user_id"]["L$level"]; }
+    if( isset($userBins["U$user_id"]["L$level"]) ) { 
+      $vars = $userBins["U{$user_id}"]["L$level"];
+      if( $this->debug > 2 ) {
+        // don't waste resources if it is not going to be printed
+        $adp = (is_array($vars))? 
+          join(",",$vars) : "-none-";
+          $this->addDebug("getUsersBins", $this->formatName($user_id)." loaded from session: ".$adp,3);
+      }
+      return $vars;
+    }
     
     // insure that our session cache doesn't become excessive
     if( count($userBins) > 5 ) {
@@ -4218,11 +4431,11 @@
       foreach($this->getBins() as $k=>$v) {
         if( $k ) {
           if( strlen($access["$k"]) ) {
-            if( $access["$k"] >= $this->settings["$level"] ) {
+            if( $access["$k"] >= $this->getSetting("$level") ) {
               $vars[] = $k;
             }
           } else {
-            if( $user["access_level"] >= $this->settings["$level"] ) {
+            if( $user["access_level"] >= $this->getSetting("$level") ) {
               $vars[] = $k;
             }
           }
@@ -4235,9 +4448,12 @@
     $this->_session->storeDataType('userbins', $userBins);
 
     // debug and return results
-    $adp = (is_array($vars))? 
-      join(",",$vars) : "-none-";
-    $this->addDebug("getUsersBins", "user bins loaded from database: ".$adp,3);
+    if( $this->debug > 2 ) {
+      // don't waste resources if it is not going to be printed
+      $adp = (is_array($vars))? 
+        join(",",$vars) : "-none-";
+        $this->addDebug("getUsersBins", $this->formatName($user_id)." loaded from database: ".$adp,3);
+    }
     return $vars;
   }
   
@@ -4246,7 +4462,7 @@
     // they have special priviledges
     $user_id = $this->checkNum($user_id);
     $ticket_id = $this->checkNum($ticket_id);
-    if( !$this->settings["allow_cview"] )
+    if( !$this->settingOn("allow_cview") )
       return false;
     $ticket = $this->get_ticket($ticket_id);
     return( $user_id == $ticket["creator_id"] );
@@ -4268,8 +4484,8 @@
     }
     else {
       // return the default level
-      $level = (preg_match("@^level_@", $action) && $this->settings["$action"])? 
-        $this->settings["$action"] : $this->settings["level_view"];
+      $level = (preg_match("@^level_@", $action) && $this->getSetting("$action") )? 
+        $this->getSetting("$action") : $this->getSetting("level_view");
     }
     // find out what access our user has
     $access = $this->getAccess($user_id);
@@ -4318,7 +4534,7 @@
     // this should check the enabled field
     // for the action instead
     $n = "allow_$action";
-    if( $this->settings["$n"] && $this->settings["$n"] != "on" ) {
+    if( $this->hasSetting("$n") && !$this->settingOn("$n") ) {
       $this->addDebug('actionApplicable', "Setting '$n' is off: disqualified",3);
       return false;
     }
@@ -4389,9 +4605,9 @@
       if( $ticket["user_id"] != $user_id ) {
         if( !$c["override"] 
             || ( strlen($access["$bin_id"]) 
-                 && $access["$bin_id"] < $this->settings["level_super"] )
+                 && $access["$bin_id"] < $this->getSetting("level_super") )
             || ( !strlen($access["$bin_id"]) 
-                 && $user["access_level"] < $this->settings["level_super"])
+                 && $user["access_level"] < $this->getSetting("level_super") )
                  ) {
           $this->addDebug('actionApplicable', "[{$action}]must be owner or meet override", 3);                   
           return false;
@@ -4470,13 +4686,29 @@
     // this array is sorted by key
     if( !$this->actions ) {
       $actions = array();
+      $actions['contacts'] = array(
+                                 "owner"    => 0, 
+                                 "access"   => 0, 
+                                 "status"   => null,
+                                 "override" => 0,
+                                 "egate"    => 0,
+                                 "img"      => null,
+                                 "label"    => null,
+                                 "button"   => null,
+                                 "key"      => null,
+                                 "level"    => $this->getSetting("level_view")
+                                 );                                  
       $actions["accept"] = array( 
                                  "owner"    => 3, 
                                  "access"   => 1, 
                                  "status"   => array('OPEN'),
                                  "override" => 0,
                                  "egate"    => 1,
-                                 "level"    => $this->settings["level_accept"]
+                                 "img"      => 'arrow_green_down.png',
+                                 "label"    => tr('Accept'),
+                                 "button"   => 1,
+                                 "key"      => 'A',
+                                 "level"    => $this->getSetting("level_accept")
                                  );
       $actions["approve"] = array( 
                                   "owner"    => 0, 
@@ -4484,7 +4716,11 @@
                                   "status"   => array('PENDING'),
                                   "override" => 0,
                                   "egate"    => 1,
-                                  "level"    => $this->settings["level_approve"]
+                                  "img"      => 'flag_green.png',
+                                  "label"    => tr('Approve'),
+                                  "button"   => 1,
+                                  "key"      => 'V',
+                                  "level"    => $this->getSetting("level_approve")
                                   );
       $actions["assign"] = array(
                                  "owner"    => 5,
@@ -4492,7 +4728,11 @@
                                  "status"   => array('OPEN'),
                                  "override" => 0,
                                  "egate"    => 1,
-                                 "level"    => $this->settings["level_assign"]
+                                 "img"      => 'two_people.png',
+                                 "label"    => tr('Assign'),
+                                 "button"   => 1,
+                                 "key"      => 'S',
+                                 "level"    => $this->getSetting("level_assign")
                                  );
       $actions["close"] = array(
                                 "owner"    => 1,
@@ -4500,7 +4740,11 @@
                                 "status"   => array('OPEN'),
                                 "override" => 1,
                                 "egate"    => 1,
-                                "level"    => $this->settings["level_user"]
+                                "img"      => 'box_gold.png',
+                                "label"    => tr('Close'),
+                                "button"   => 1,
+                                "key"      => 'C',
+                                "level"    => $this->getSetting("level_user")
                                 );
       $actions["create"] = array(
                                  "owner"    => 0,
@@ -4508,15 +4752,35 @@
                                  "status"   => null,
                                  "override" => 0,
                                  "egate"    => 1,
-                                 "level"    => $this->settings["level_create"]
+                                 "img"      => "",
+                                 "label"    => tr('Create'),
+                                 "button"   => 0,
+                                 "key"      => null,
+                                 "level"    => $this->getSetting("level_create")
                                  );
+      $actions["delete"] = array(
+                               "owner"    => 0,
+                               "access"   => 1,
+                               "status"   => null,
+                               "override" => 0,
+                               "egate"    => 0,
+                               "img"      => "trash.png",
+                               "label"    => tr("Delete"),
+                               "button"   => 0,
+                               "key"      => null,
+                               "level"    => $this->getSetting('level_settings')
+                               );
       $actions["edit"] = array(
                                "owner"    => 0,
                                "access"   => 1,
                                "status"   => array('OPEN','PENDING'),
                                "override" => 0,
                                "egate"    => 0,
-                               "level"    => $this->settings["level_edit"]
+                               "img"      => "pin_blue.png",
+                               "label"    => tr('Edit'),
+                               "button"   => 1,
+                               "key"      => 'D',
+                               "level"    => $this->getSetting("level_edit")
                                );
       $actions["email"] = array(
                                 "owner"    => 0,
@@ -4524,7 +4788,11 @@
                                 "status"   => null,
                                 "override" => 0,
                                 "egate"    => 1,
-                                "level"    => $this->settings["level_view"]
+                                "img"      => "mail.png",
+                                "label"    => tr('Email'),
+                                "button"   => 1,
+                                "key"      => 'E',
+                                "level"    => $this->getSetting("level_view")
                                 );
       $actions["estimate"] = array(
                                    "owner"    => 1,
@@ -4532,7 +4800,11 @@
                                    "status"   => array('OPEN'),
                                    "override" => 1,
                                    "egate"    => 1,
-                                   "level"    => $this->settings["level_user"]
+                                   "img"      => "clock.png",
+                                   "label"    => tr('Estimate'),
+                                   "button"   => 0,
+                                   "key"      => null,
+                                   "level"    => $this->getSetting("level_user")
                                    );
       $actions["log"] = array(
                               "owner"    => 0,
@@ -4540,7 +4812,11 @@
                               "status"   => array('OPEN','PENDING'),
                               "override" => 1,
                               "egate"    => 1,
-                              "level"    => $this->settings["level_user"]
+                              "img"      => "book_blue.png",
+                              "label"    => tr('Log'),
+                              "button"   => 1,
+                              "key"      => 'L',
+                              "level"    => $this->getSetting("level_user")
                               );
       $actions["move"] = array(
                                "owner"    => 1,
@@ -4548,7 +4824,11 @@
                                "status"   => array('OPEN','PENDING'),
                                "override" => 1,
                                "egate"    => 1,
-                               "level"    => $this->settings["level_move"]
+                               "img"      => "arrow_blue_right.png",
+                               "label"    => tr('Move'),
+                               "button"   => 1,
+                               "key"      => 'M',
+                               "level"    => $this->getSetting("level_move")
                                );
       // add an entry to notify list
       // used exclusively by egate system
@@ -4559,7 +4839,11 @@
                                      "status"   => array('OPEN','PENDING'),
                                      "override" => 0,
                                      "egate"    => 1,
-                                     "level"    => $this->settings["level_view"]
+                                     "img"      => "",
+                                     "label"    => tr('Add to Notify'),
+                                     "button"   => 0,
+                                     "key"      => null,
+                                     "level"    => $this->getSetting("level_view")
                                      );
       // drop an entry from the notify list
       // used exclusively by the egate system
@@ -4570,7 +4854,11 @@
                                       "status"   => array('OPEN','PENDING'),
                                       "override" => 0,
                                       "egate"    => 1,
-                                      "level"    => $this->settings["level_view"]
+                                      "img"      => "",
+                                      "label"    => tr('Drop From Notify'),
+                                      "button"   => 0,
+                                      "key"      => null,
+                                      "level"    => $this->getSetting("level_view")
                                       );
       // used to modify the list of recipients in
       // ticket's notify list
@@ -4580,7 +4868,11 @@
                                  "status"   => array('OPEN','PENDING'),
                                  "override" => 1,
                                  "egate"    => 0,
-                                 "level"    => $this->settings["level_user"]
+                                 "img"      => "",
+                                 "label"    => tr('Notify List'),
+                                 "button"   => 0,
+                                 "key"      => null,
+                                 "level"    => $this->getSetting("level_user")
                                  );
       $actions["print"] = array(
                                 "owner"    => 0,
@@ -4588,15 +4880,35 @@
                                 "status"   => null,
                                 "override" => 0,
                                 "egate"    => 0,
-                                "level"    => $this->settings["level_view"]
+                                "img"      => "printer.png",
+                                "label"    => tr('Print'),
+                                "button"   => 1,
+                                "key"      => 'P',
+                                "level"    => $this->getSetting("level_view")
                                 );
+      $actions["yank"] = array(
+                               "owner"    => 4,
+                               "access"   => 1,
+                               "status"   => null,
+                               "override" => 0,
+                               "egate"    => 0,
+                               "img"      => "arrow_blue_up.png",
+                               "label"    => tr('Pull'),
+                               "button"   => 1,
+                               "key"      => 'U',
+                               "level"    => $this->getSetting("level_yank")
+                               );
       $actions["reject"] = array(
                                  "owner"    => 1,
                                  "access"   => 1,
                                  "status"   => array('OPEN','PENDING'),
                                  "override" => 0,
                                  "egate"    => 1,
-                                 "level"    => $this->settings["level_user"]
+                                 "img"      => "flag_red.png",
+                                 "label"    => tr('Reject'),
+                                 "button"   => 1,
+                                 "key"      => 'R',
+                                 "level"    => $this->getSetting("level_user")
                                  );
       $actions["relate"] = array(
                                  "owner"    => 0,
@@ -4604,7 +4916,11 @@
                                  "status"   => null,
                                  "override" => 0,
                                  "egate"    => 0,
-                                 "level"    => $this->settings["level_user"]
+                                 "img"      => "tree.png",
+                                 "label"    => tr('Relate'),
+                                 "button"   => 1,
+                                 "key"      => 'X',
+                                 "level"    => $this->getSetting("level_user")
                                  );
       $actions["reopen"] = array(
                                  "owner"    => 0,
@@ -4612,7 +4928,11 @@
                                  "status"   => array('PENDING','CLOSED'),
                                  "override" => 0,
                                  "egate"    => 0,
-                                 "level"    => $this->settings["level_user"]
+                                 "img"      => "arrow_blue_left.png",
+                                 "label"    => tr('Reopen'),
+                                 "button"   => 1,
+                                 "key"      => 'O',
+                                 "level"    => $this->getSetting("level_user")
                                  );
       $actions["test"] = array(
                                "owner"    => 0,
@@ -4620,7 +4940,11 @@
                                "status"   => array('PENDING'),
                                "override" => 1,
                                "egate"    => 1,
-                               "level"    => $this->settings["level_test"]
+                               "img"      => "flag_blue.png",
+                               "label"    => tr('Test'),
+                               "button"   => 1,
+                               "key"      => 'T',
+                               "level"    => $this->getSetting("level_test")
                                );
       $actions["upload"] = array(
                                  "owner"    => 1,
@@ -4628,7 +4952,11 @@
                                  "status"   => null,
                                  "override" => 1,
                                  "egate"    => 0,
-                                 "level"    => $this->settings["level_user"]
+                                 "img"      => "arrow_blue_up.png",
+                                 "label"    => tr('Upload'),
+                                 "button"   => 0,
+                                 "key"      => '',
+                                 "level"    => $this->getSetting("level_user")
                                  );
       $actions["view"] = array(
                                "owner"    => 0,
@@ -4636,7 +4964,11 @@
                                "status"   => null,
                                "override" => 0,
                                "egate"    => 1,
-                               "level"    => $this->settings["level_view"]
+                               "img"      => "magnify.png",
+                               "label"    => tr('View'),
+                               "button"   => 0,
+                               "key"      => '',
+                               "level"    => $this->getSetting("level_view")
                                );
       $actions["varfield_edit"] = array(
                                         "owner"    => 1,
@@ -4644,16 +4976,12 @@
                                         "status"   => array('OPEN','PENDING'),
                                         "override" => 1,
                                         "egate"    => 0,
-                                        "level"    => $this->settings["level_edit_varfields"]
+                                        "img"      => "pn_blue.png",
+                                        "label"    => tr('Edit'),
+                                        "button"   => 0,
+                                        "key"      => '',
+                                        "level"    => $this->getSetting("level_edit_varfields")
                                         );
-      $actions["yank"] = array(
-                               "owner"    => 4,
-                               "access"   => 1,
-                               "status"   => null,
-                               "override" => 0,
-                               "egate"    => 0,
-                               "level"    => $this->settings["level_yank"]
-                               );
       $this->actions = $actions;
     }
     return $this->actions;
@@ -4809,7 +5137,7 @@
   }
   
   /**
-   * returns whether a zen->settings["field"] is an On/Off type
+   * returns whether a zen->getSetting("field") is an On/Off type
    *
    * the main reason for this method is that we will be updating
    * the structure of the settings before long to become more rigid.
@@ -4818,7 +5146,8 @@
    * @return boolen yes or no
    */
   function isOnOffSetting( $field ) {
-    return ($this->settings["$field"] == "on" || $this->settings["$field"] == "off");
+    $v = $this->getSetting($field);
+    return ($v == "on" || $v == "off");
   }
 
   /**
@@ -4843,16 +5172,15 @@
   function getDefaultValue( $field ) {
     if( $this->isDateFormatSetting($field) ) {
       // make a date
-      $val = ($this->settings[$field])?
-        strtotime($this->settings["$field"]) : "";
+      $val = $this->getSetting($field)?
+        strtotime($this->getSetting($field)) : "";
     }
     else if( $this->isOnOffSetting($field) ) {
       // tell whether its checked
-      $val = ($this->settings["$field"] == "on")?
-        " checked " : "";
+      $val = $this->settingOn($field)? " checked " : "";
     } else {
       // there isn't one, so return the actual value
-      $val = $this->settings["$field"];
+      $val = $this->getSetting($field);
     }
     return $val;
   }
@@ -5011,9 +5339,9 @@
     // prints out status with proper <span>
     // tags to highlight critical status items
 
-    if( $priority <= $this->settings["level_hot"] ) {
+    if( $priority <= $this->getSetting("level_hot") ) {
       $pri = "hot";
-    } else if( $priority <= $this->settings["level_highlight"] ) {
+    } else if( $priority <= $this->getSetting("level_highlight") ) {
       $pri = "highlight";
     } else {
       $pri = "";
@@ -5021,6 +5349,23 @@
     return $pri;
   }
   
+  /**
+   * Returns the value of a configuration setting
+   *
+   * @param string key the name of the setting to return
+   * @param string value could be null
+   */
+  function getSetting( $key ) {
+    $settings = $this->getSettings();
+    if( is_array($settings) && array_key_exists("$key", $settings) ) {
+      return $settings["$key"];
+    }
+    else {
+      $this->addDebug('getSetting', "Setting not found for ".$key, 2);
+      return null;
+    }
+  }
+  
   function getSettings($flag = 0) {
     // pulls the variables from the settings table
     // into an indexed array.
@@ -5030,8 +5375,12 @@
     
     // attempt to retrieve from the session if possible
     if( !$flag ) {
+      if( $this->_settings ) { return $this->_settings; }
       $settings = $this->_session->getDataType('settings');
-      if( $settings ) { return $settings; }
+      if( $settings ) { 
+        $this->_settings = $settings;
+        return $settings;
+      }
     }
     
     // load from the database
@@ -5063,21 +5412,28 @@
     
     // store vals in session
     if( !$flag ) {
-      $this->_session->storeDataType('settings',$vals);      
+      $vals["font_size_small"] = $vals["font_size"] - 2;
+      $vals["font_size_large"] = $vals["font_size"] + 4;
+      $vals["color_title_txt"] = $vals["color_title_text"];
+      $this->_session->storeDataType('settings',$vals);
+      $this->_settings = $vals;
     }
-    
     return($vals);
   }
   
   function settingOn( $setting_name ) {
-    return array_key_exists($setting_name, $this->settings) && $this->settings["$setting_name"] == "on";
+    return $this->getSetting($setting_name) == "on";
+  }
+  
+  function hasSetting( $setting_name ) {
+    return strlen($this->getSetting($setting_name));
   }
 
   function getTypeName($id) {
     // retrieves the name of the type
     // with the given id
     $types = $this->getTypes();
-    return( (isset($types["$id"]))? $types["$id"] : "" );
+    return( array_key_exists("$id", $types)? $types["$id"] : "" );
   }
 
   function getTypes($flag = 0, $active = 1) {
@@ -5102,7 +5458,6 @@
       
       // store in session
       $this->_session->storeDataType('types',$vals);
-      
       return($vals);
     } else {
       $where = ($active)? " WHERE active = $active" : "";
@@ -5111,7 +5466,7 @@
     }
   }
 
-  function getProjectChildren( $pid, $columns = '', $archive_flag = 0 ) {
+  function getProjectChildren( $pid, $columns = '', $archive_flag = 0, $sort = "status desc, t.priority desc, otime desc" ) {
     // returns array of tickets for the project by its pid ($pid)
     // this is seperated from the get_tickets() for abstraction
     // (i.e. future expansion compatability)
@@ -5120,8 +5475,11 @@
 
     $pid = $this->checkNum($pid);
     $params = array("project_id"=>$pid);
-    $sort = "status desc, priority desc, otime desc";
-    $vars = $this->get_tickets($params, $sort, $columns, $archive_flag);
+    $page = 0;
+    $vars = $this->get_tickets($params, $sort, $columns,$page++);
+    while( count($vars) < $this->total_records ) {
+      $vars = array_merge($vars,$this->get_tickets($params,$sort,$columns,$page++));
+    }
     return( $vars );
   }
 
@@ -5133,21 +5491,25 @@
     $id = $this->checkNum($id);
     $ticket = $this->get_ticket($id);
     $est_hours = $ticket["est_hours"];
-    $wkd_hours = $ticket["wkd_hours"];
+    $ext_hours = $ticket['wkd_hours'];
+    $wkd_hours = $ext_hours>$est_hours? $est_hours : $ext_hours;
 
     // get the children for this project
-    $columns = array("id","est_hours","wkd_hours","type_id");
-    $children = $this->getProjectChildren($id,$columns,$archive_flag);
-    if( is_array($children) ) {
-      for( $i=0; $i<count($children); $i++ ) {
-        list($e,$w) = $this->getTicketHours($children[$i]["id"]);
-        $est_hours += $e;
-        $wkd_hours += $w;
+    if( $this->inProjectTypeIDs($ticket['type_id']) ) {
+      $columns = array("id","est_hours","wkd_hours","type_id");
+      $children = $this->getProjectChildren($id,$columns,$archive_flag);
+      if( is_array($children) ) {
+        for( $i=0; $i<count($children); $i++ ) {
+          list($e,$w,$x) = $this->getTicketHours($children[$i]["id"]);
+          $est_hours += $e;
+          $wkd_hours += $w;
+          $ext_hours += $x;
+        }
       }
     }
     $this->addDebug("getTicketHours","Retrieving hours for $id, with ".count($children)
-                    ." children: $est_hours, $wkd_hours",3);
-    return( array($est_hours,$wkd_hours) );   
+                    ." children: $est_hours, $wkd_hours, $ext_hours",3);
+    return( array($est_hours,$wkd_hours,$ext_hours) );   
   }
 
   function getProjectHours( $pid, $archive_flag = 0 ) {
@@ -5219,6 +5581,15 @@
   }
 
   function inProjectTypeIDs($type_id) {
+    if( is_array($type_id) ) {
+      // handle arrays by checking each value seperately
+      foreach($type_id as $t) {
+        if( !$this->inProjectTypeIDs($t) ) {
+          return false;
+        }
+      }
+      return true;
+    }
     // determines whether the id provided
     // is a valid project id
     // and returns true or false
@@ -5265,30 +5636,27 @@
     $this->bins        = $this->getBins();
     $this->systems     = $this->getSystems();
     //$this->strings     = $this->getStrings($this->language);
-    $this->settings    = $this->getSettings();
-    $this->settings["font_size_small"] = $this->settings["font_size"] - 2;
-    $this->settings["font_size_large"] = $this->settings["font_size"] + 4;
-    // this is a quick hack to fix an oops
-    // should eventually go through code and fix this
-    $this->settings["color_title_txt"] = $this->settings["color_title_text"];
+    $this->getSettings();
+    $this->_settings = false;
+
     $this->types       = $this->getTypes();
     $this->priorities  = $this->getPriorities();
     $this->tasks       = $this->getTasks();
     $this->custom_fields = $this->getCustomFields(1);
 
     // set the date formatting
-    $this->date_fmt_long  = $this->settings["date_fmt_long"];
-    $this->date_fmt_short = $this->settings["date_fmt_short"];
-    $this->time_fmt       = $this->settings["date_fmt_time"];
-    $this->elapsed_unit   = $this->settings["time_elapsed_unit"];
+    $this->date_fmt_long  = $this->getSetting("date_fmt_long");
+    $this->date_fmt_short = $this->getSetting("date_fmt_short");
+    $this->time_fmt       = $this->getSetting("date_fmt_time");
+    $this->elapsed_unit   = $this->getSetting("time_elapsed_unit");
     $this->date_and_time  = $this->date_fmt_short." ".$this->time_fmt;
-    $this->euroEnabled    = ($this->settings['use_euro_date'] == "on");
+    $this->euroEnabled    = $this->settingOn("use_euro_date");
 
     // set language params
-    $this->language       = ($language)? $language : $this->settings["language_default"];
+    $this->language       = ($language)? $language : $this->getSetting("language_default");
 
     // cache length
-    $this->cache_time = $this->settings["sql_cache_time"];
+    $this->cache_time = $this->getSetting("sql_cache_time");
 
   }
 
@@ -5662,8 +6030,9 @@
   function get_contact($id,$t,$c) {
     //get a single contact
     $query = "SELECT * FROM $t WHERE $c = $id";
-    $this->addDebug("get_contact",$query,3);
-    return( $this->db_quickIndexed($query) );
+    $vals = $this->db_quickIndexed($query);
+  $this->addDebug("get_contact","[".count($vals)."]".$query,3);
+    return( $vals );
   }
   
   function update_contact( $id, $params,$table,$c ) {
@@ -5682,24 +6051,25 @@
     return( $this->db_result($query) );
   }
   
-  function get_contacts( $params,$tabel ,$sort, $columns = '') {
+  function get_contacts( $params,$tabel ,$sort = '', $columns = '') {
     //get contacts
     $columns =  array("*");
     
-    if(count($params)&&!empty($params)){
+    if(is_array($params) && count($params)){
       foreach($params as $a) {
         if(!isset($where)) {
-          $where = "WHERE lower(".$a[1].")".$a[2]."'".$a[3]."'";  
+          $where = "WHERE lower(".$a[0].")".$a[1].$this->checkSlashes($a[2]);
         } else {
-          $where.= " AND lower(".$a[1].")".$a[2]."'".$a[3]."'";    
+          $where.= " AND lower(".$a[0].")".$a[1].$this->checkSlashes($a[2]);
         }  
       }
     }
     $query = "SELECT ".join(",",$columns)." FROM $tabel $where";
     if( $sort )
       $query .= " ORDER BY $sort";
-    $this->addDebug("get_contacts",$query,3);
-    return( $this->db_queryIndexed($query) );
+    $vals = $this->db_queryIndexed($query);
+    $this->addDebug("get_contacts","[".count($vals)."]".$query,3);
+    return( $vals );
   }
   
   
@@ -5767,22 +6137,24 @@
   // $show_blank parameter (default to "off") :
   //  . "off" - don't show the "Next" or "Previous" when it is not needed
   //  . "on"  - show the "Next" or "Previous" strings as plain text when it is not needed
-  function get_links($option = "all", $show_blank = "off") {
-
-     $numtoshow = $this->settings['paging_max_rows'];
+  function get_links($option = "all", $show_blank = "off", $total_rows = null) {
+     $hk = $GLOBALS['zt_hotkeys'];
+     $numtoshow = $this->getSetting("paging_max_rows");
      list($extra_vars, $file) = $this->build_geturl();
      $pageNumber = array_key_exists('pageNumber', $_GET)? 
                  $this->checkNum($_GET['pageNumber']) : 0;
-     $activePages = 10;
-     $number_of_pages = ceil($this->total_records/ $numtoshow);
-     $subscript = 0;
-     $backnos = intval($activePages/2);
-     $prev = tr('Prev');
-     $next = tr('Next');
      
      $array = array();
-     if( $this->total_records == 0 ) { return $array; }
+     if( !$total_rows && !$this->total_records ) { return $array; }
+     else if( !$total_rows ) { $total_rows = $this->total_records; }
        
+     $activePages = 10;
+     $number_of_pages = ceil($total_rows/ $numtoshow);
+     $subscript = 0;
+     $backnos = intval($activePages/2);
+     $prev = $hk->ll('Prev');
+     $next = $hk->ll('Next');
+
      if( $number_of_pages > $activePages ) {
        // we have more pages than we will display at once
        if( $pageNumber - $backnos > 0 ) {
@@ -5809,29 +6181,44 @@
      $this->addDebug('get_links', "Current: ".$current,3);
      $this->addDebug('get_links', "Row: ".$pageNumber,3);
      if( $number_of_pages == 1 ) { return array(); }
-     if ((($option == "all") || ($option == "sides")) ) {
-       if ($pageNumber != 0)
-         $array[] = '<A HREF="' . $file . '?pageNumber=' . ($pageNumber - 1) . $extra_vars . '">'.$prev.'</A>';
-       elseif (($pageNumber == 0) && ($show_blank == "on"))
+     if ( ($option == "all") || ($option == "sides") ) {
+       if($pageNumber != 0) {
+         $array[] = '<A title="'.$hk->tt('Prev').'" id="pagingPrevLink" HREF="' . $file 
+          . '?pageNumber=' . ($pageNumber - 1) . $extra_vars . '">'.$prev.'</A>';
+       }
+       elseif ($pageNumber == 0 && $show_blank == "on") {
          $array[] = $prev;
+       }
      }
      for ($current ; $current < $maxrow; $current++) {
-       if (($option == "all") || ($option == "pages")) {
-         if ($pageNumber == $current)
+       if ($option == "all" || $option == "pages") {
+         if($pageNumber == $current) {
            $array[] = ($current > 0 ? ($current + 1) : 1);
-         else
+         }
+         else {
            $array[] = '<A HREF="' . $file . '?pageNumber=' . $current . $extra_vars . '">' . ($current + 1) . '</A>';
+         }
        }
      }
-     if ((($option == "all") || ($option == "sides")) && ($pageNumber != ($maxrow - 1))) {
-       $array[] = '<A HREF="' . $file . '?pageNumber=' . ($pageNumber + 1) . $extra_vars . '">' . $next . '</A>';
+     if ( ($option == "all" || $option == "sides") && $pageNumber != ($maxrow - 1) ) {
+       $array[] = '<A title="'.$hk->tt('Next').'" id="pagingNextLink" HREF="' . $file . '?pageNumber=' . ($pageNumber + 1) . $extra_vars . '">' . $next . '</A>';
      }
-     else if ((($option == "all") || ($option == "sides")) && ($pageNumber == $maxrow-1) && $show_blank == 'on') {
+     else if (($option == "all" || $option == "sides") && $pageNumber == $maxrow-1 && $show_blank == 'on') {
        $array[] = $next;
      }
      return $array;
   }
   
+  /**
+   * Retrieves the history of recently viewed items
+   * @return ZenHistory
+   */
+  function &getHistoryManager() {
+    if( !$this->_history ) {
+      $this->_history = new ZenHistoryManager($this);
+    }
+    return $this->_history;
+  }
   
   /** 
    * Returns an instance of the session manager
@@ -5854,7 +6241,7 @@
   var $date_format_short;
 
   // settings vars
-  var $settings;
+  var $_settings;
 
   var $bins;
   var $priorities;
@@ -5876,7 +6263,7 @@
   var $table_attachments;
   var $actions;
   var $table_bins;
-  var $table_feild_map;
+  var $table_field_map;
   var $table_logs;   
   var $table_logs_archived;
   var $table_preferences;
@@ -5931,6 +6318,9 @@
   
   // manages session and globals cache data, instance of ZenSessionManager
   var $_session;
+  
+  // manages history of viewed items
+  var $_history;
 }
 
 ?>
diff -Naur zentrack_2-5-5-2/www/actions/accept.php zentrack_2-6-pre1/www/actions/accept.php
--- zentrack_2-5-5-2/www/actions/accept.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/accept.php	2005-10-11 04:48:19.000000000 -0700
@@ -13,23 +13,17 @@
 
    $res = $zen->accept_ticket($id, $login_id);
    if( $res ) {
-      add_system_messages(tr("Ticket ? was accepted by ?", array($id, $login_name)));
-      $setmode = "details";
-      include("../ticket.php");
-      exit;	   
-      //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
+      $msg = tr("Ticket ? was accepted by ?", array($id,$login_name));
    } else {
       $errs[] = tr("System error: Ticket ? could not be accepted", array($id)).$zen->db_error;
    }
-   if( $errs )
-     add_system_messages( $errs, 'Error' );     
+  $setmode = null;
+  $action = null;
    
    include("$libDir/nav.php");
-
+   $zen->printErrors($errs);
    $ticket = $zen->get_ticket($id);
-   extract($ticket);
-   unset($action);
-   if( strtolower($zen->types["$type_id"]) == "project" ) {
+   if( $zen->inProjectTypeIDs($type_id) ) {
       include("$templateDir/projectView.php");
    } else {
       include("$templateDir/ticketView.php");     
diff -Naur zentrack_2-5-5-2/www/actions/action_header.php zentrack_2-6-pre1/www/actions/action_header.php
--- zentrack_2-5-5-2/www/actions/action_header.php	2005-05-15 16:45:02.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/action_header.php	2005-10-21 03:59:54.000000000 -0700
@@ -20,7 +20,7 @@
   $id = ereg_replace("[^0-9]", "", $id);
   if( !$id ) {
     $zen->addDebug("action_header","No ticket id, redirecting",1);
-    include("../index.php");
+    include("$rootWWW/index.php");
     exit;
   }
   
@@ -34,8 +34,10 @@
 	    array("id,title,status,est_hours,wkd_hours"));
     list($ticket["est_hours"],$ticket["wkd_hours"]) = $zen->getProjectHours($id);
     $page_type = "project";
+    $view = 'project_view';
   }  else {
     $page_type = "ticket";
+    $view = 'ticket_view';
   }
   
   // use the filename to 
@@ -44,39 +46,45 @@
   if( in_array($basename,array_keys($zen->getActions())) ) {
     $action = $basename;
   }
-  else if( $basename == 'editcustomsubmit' ) {
-    $action = 'varfield_edit';
-  }
+  //else if( $basename == 'editcustomsubmit' ) {
+  //  $action = 'varfield_edit';
+  //}
   else if( $basename == "editticketsubmit" || $basename == "editsubmit" ) {
     $action = "edit";
   }
   else if( $basename == "addtonotify" || $basename == "dropfromnotify" ) {
     $action = "notify";
-  } 
+  }
+  else if( $basename == 'addtocontacts' || $basename == 'dropfromcontacts' ) {
+    $action = 'contacts';
+  }
+  else if( $basename == 'dropattachments' ) {
+    $action = 'upload';
+  }
   else if( !$action ) {
     $action = "view";
   }
   
-  $setmode = "system";
-
   // find out if this is the ticket's creator (special conditions apply)
   $tf_creator = (($action=="view"||$action == "print"||$action == "email")
-	&&$zen->settings["allow_cview"]=="on"
+	&&$zen->settingOn("allow_cview")
 	&&$zen->checkCreator($login_id,$tid));
 
 
   // find out if user can do this action, if not, redirect them
   if( !$zen->actionApplicable( $id, $action, $login_id ) && !$tf_creator ) {
-    $setmode = "details";
-    $zen->addDebug("action_header.php","Action was not applicable, redirecting",1);
-    include("../ticket.php");
+    $zen->addDebug("action_header.php","Action ($action) was not applicable, redirecting",1);
+    $action = '';
+    $ticketTabAction = false;
+    include("$rootWWW/ticket.php");
     exit;
   }
 
   // set up page paremeters
   $page_title = $page_type == "project"? tr("Project #?", array($id)) : tr("Ticket #?", array($id));
   $page_section = "Ticket #$id";
-  if( $page_type == 'project' ) { $expand_projects = 1; }
-  else { $expand_tickets = 1; }
+  $page_mode = $setmode? $setmode : $action;
+  $hotkeys->loadSection($view);
+  $hotkeys->loadSection("action_$action");
 
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/addToContacts.php zentrack_2-6-pre1/www/actions/addToContacts.php
--- zentrack_2-5-5-2/www/actions/addToContacts.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/addToContacts.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,30 +7,42 @@
    **  to a ticket's notify list
    */
   
-  $action = "contacts";  
-  include_once("../header.php");
+  $action = "contacts";
+  include_once("action_header.php");
   
     // check to insure that this user has access
   // and this ticket allows the requested action
   // to be completed
   $ticket = $zen->get_ticket($id);
   $tid = $ticket["type_id"];
+  $type_id = $tid;
   if( in_array($tid,$zen->projectTypeIDs()) ) {
     $ticket["children"] = $zen->getProjectChildren($id, 
 	    array("id,title,status,est_hours,wkd_hours"));
     list($ticket["est_hours"],$ticket["wkd_hours"]) = $zen->getProjectHours($id);
     $page_type = "project";
+    $view = 'project_view';
   }  else {
     $page_type = "ticket";
+    $view = 'ticket_view';
   }
-  $page_mode = "system";
-
   
   $page_title = tr("Ticket #?", array($id));
   $page_section = "Ticket #$id";
-  $expand_tickets = 1;
   
   if( $actionComplete == 1 ) {
+    // check user acces
+    if( !$zen->checkAccess($login_id,$ticket['bin_id'],$map->getViewProp($setmode,'access_level')) ) {
+      $errs[] = tr("You cannot access this area");
+    }
+    
+    // check to make sure the contacts appear on the tab
+    $p1 = $map->getViewProp($setmode,'preload');
+    $p2 = $map->getViewProp($setmode,'postload');
+    if( (!$p1 || !in_array('contacts',$p1)) && (!$p2 || !in_array('contacts',$p2)) ) {
+      $errs[] = tr("You cannot access this area");
+    }
+    
     $priority = 1;
     // clean input vars
     $cp_id = null;
@@ -40,48 +52,55 @@
       $errs[] = tr("You must select a Company or Person.");
     }
     
+    $dups = false;
+    $parms = array(array("ticket_id", "=", $id));
+    $currentContacts = $zen->get_contacts($parms,"ZENTRACK_RELATED_CONTACTS");
+    if( $currentContacts ) {
+      foreach($currentContacts as $c) {
+        if( !$person_id && $c['type'] == 1 && $company_id && $c['cp_id'] == $company_id ) { 
+          $msg[] = tr("Company already in contact list");
+          $dups = true;
+          break;
+        }
+        else if( $person_id && $c['type'] != 1 && $c['cp_id'] == $person_id ) { 
+          $msg[] = tr("Employee already exists in contact list");
+          $dups = true;
+          break;
+        }
+      }
+    }
+    
     if($company_id) {
-    $cp_id = $company_id;
-	  $type = "1";  
+      $cp_id = $company_id;
+      $type = "1";  
 	  }
 	  
 	  if($person_id) {
-    $cp_id = $person_id;
-	  $type = "2";  
+      $cp_id = $person_id;
+      $type = "2";  
 	  }
 
-    if( !$errs ) {
-      
-      $params = array("type"   => $type,
-          "cp_id"  => $cp_id,
-          "ticket_id" => $id);
-          
+    if( !$errs && !$dups ) {
+      $params = array("type" => $type, "cp_id"  => $cp_id, "ticket_id" => $id);
       $res = $zen->add_contact( $params,"ZENTRACK_RELATED_CONTACTS");
-
+      if( $res ) {
+        $msg[] = tr("Contact added successfully");
+        $action = '';
+      }
+      else {
+        $errs[] = tr("Unable to add contact due to system error");
+      }
     }
   }
 
-      if( !empty($res)) {
-  				add_system_messages(tr("? contact added to #?.", array($i, $id)));
-  				$setmode = "contacts";
-				}
-    if( $errs ){
-      add_system_messages( $errs, 'Error' );     
-  }
   
   include("$libDir/nav.php");
-  
-  $page_mode="system";
-  $setmode = 'system';
-  
-  extract($ticket);
+  $zen->printErrors($errs);
   if( strtolower($zen->types["$type_id"]) == "project" ) {
-	  
     include("$templateDir/projectView.php");
   } else {
     include("$templateDir/ticketView.php");     
   }
-  
   include("$libDir/footer.php");
 
 }?>
diff -Naur zentrack_2-5-5-2/www/actions/addToNotify.php zentrack_2-6-pre1/www/actions/addToNotify.php
--- zentrack_2-5-5-2/www/actions/addToNotify.php	2004-11-16 06:03:02.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/addToNotify.php	2005-10-20 11:23:48.000000000 -0700
@@ -54,8 +54,7 @@
               $i++;
             }
             else if( $res && $res == "duplicate" ) {
-              add_system_messages(tr("user_id ? already on notify "
-              ."list for #?", array($u, $ticket_id)));        
+              $msg[] = tr("User ? already on notify list", $u);        
             }
           }
         }
@@ -70,16 +69,32 @@
           $i++;
         }
         else if( $res && $res == "duplicate" ) {
-          add_system_messages(tr("email ? already on notify "
-          ."list for #?", array($unreg_email, $ticket_id)));        
+          $msg[] = tr("Email ? already on notify list", $unreg_email);        
         }
       }
       if(strlen($company_id) || strlen($person_id)) {
         
-        $params = array('ticket_id'   =>   $ticket_id,
-                        'priority'    =>   $priority);
-        
-        if( !$errs ) {
+        $dups = false;
+        $parms = array(array("ticket_id", "=", $id));
+        $currentContacts = $zen->get_contacts($parms,"ZENTRACK_RELATED_CONTACTS");
+        if( $currentContacts ) {
+          foreach($currentContacts as $c) {
+            if( !$person_id && $c['type'] == 1 && $company_id && $c['cp_id'] == $company_id ) { 
+              $msg[] = tr("Company already in contact list");
+              $dups = true;
+              break;
+            }
+            else if( $person_id && $c['type'] != 1 && $c['cp_id'] == $person_id ) { 
+              $msg[] = tr("Employee already exists in contact list");
+              $dups = true;
+              break;
+            }
+          }
+        }
+    
+        if( !$errs && !$dups ) {
+          $params = array('ticket_id'   =>   $ticket_id,
+                          'priority'    =>   $priority);
           if($company_id) {
             $data = $zen->get_contact($company_id,'ZENTRACK_COMPANY','company_id');
             $params['name'] = $data['title']." ".$data['office'];
@@ -105,17 +120,26 @@
       
       
       if( $i > 0 ) {
-        add_system_messages(tr("? entries added to #? notification.", array($i, $ticket_id)));
-        $setmode = "notify";
-      } else {
-        $errs[] = tr("System error: Notify list could not be updated ").$zen->db_error;
+        $msg[] = tr("? recipients added", $i);
+        $action = '';
+        $page_mode = $setmode;
       }
     }
-    if( $errs ) { add_system_messages( $errs, 'Error' ); }     
   }
   
   include("$libDir/nav.php");
-  
-  include("$rootWWW/ticket.php");
+  $zen->printErrors($errs);  
+  if( $actionComplete == 1 && $page_type == "project" ) {
+    $ticket = $zen->get_project($id);
+  }
+  else if( $actionComplete ) {
+    $ticket = $zen->get_ticket($id);
+  }
+  if( $page_type == "project" ) {
+    include("$templateDir/projectView.php");
+  } else {
+    include("$templateDir/ticketView.php");     
+  }
+  include("$libDir/footer.php");
 
 }?>
diff -Naur zentrack_2-5-5-2/www/actions/agreement_archive.php zentrack_2-6-pre1/www/actions/agreement_archive.php
--- zentrack_2-5-5-2/www/actions/agreement_archive.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/agreement_archive.php	2005-10-20 11:23:48.000000000 -0700
@@ -1,32 +1,25 @@
 <?
 
   $id = NULL;
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Agreements");
   $page_section = "Agreements";
   $expand_agreement = 1;
   
-  
-  include("$libDir/nav.php");
-
-
 	if(isset($id)){	
-
-      $params["status"] = $active;
-     
-      $res = $zen->update_contact($id,$params,"ZENTRACK_AGREEMENT","agree_id");
-     
-      if( !$res ) {
-   			$errs[] = tr("System Error").": ".tr("Agreement could not be archived.")." ".$zen->db_error;
-     	} else {
-      	print "archived agreement ".$id."<br>\n" ;   
-    	}
-    
+    $params["status"] = $active;
+    $res = $zen->update_contact($id,$params,"ZENTRACK_AGREEMENT","agree_id");
+    if( !$res ) {
+      $errs[] = tr("System Error").": ".tr("Agreement could not be archived.")." ".$zen->db_error;
+    } else {
+      $msg = "Archived agreement #$id";
+    }
 	} else {
-			print "No agreement selected";
+	  $errs[] = "No agreement selected";
 	}
 	
+  include("$libDir/nav.php");
+  $zen->printErrors($errs);
   include("$templateDir/agreementView.php");
-
   include("$libDir/footer.php");
 ?>
diff -Naur zentrack_2-5-5-2/www/actions/agreement_delete.php zentrack_2-6-pre1/www/actions/agreement_delete.php
--- zentrack_2-5-5-2/www/actions/agreement_delete.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/agreement_delete.php	2005-07-29 12:13:15.000000000 -0700
@@ -3,7 +3,7 @@
   **  Action: delete contact
   */
   $id = NULL;
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Agreements");
   $page_section = "Agreements";
   $expand_agreement = 1;
diff -Naur zentrack_2-5-5-2/www/actions/agreement_edit.php zentrack_2-6-pre1/www/actions/agreement_edit.php
--- zentrack_2-5-5-2/www/actions/agreement_edit.php	2005-05-15 16:45:03.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/agreement_edit.php	2005-07-29 12:13:15.000000000 -0700
@@ -2,7 +2,7 @@
   /*
   **  Action: edit agreement
   */
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Agreement #?", array($id));
   $expand_agreement = 1;
 
diff -Naur zentrack_2-5-5-2/www/actions/approve.php zentrack_2-6-pre1/www/actions/approve.php
--- zentrack_2-5-5-2/www/actions/approve.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/approve.php	2005-10-11 04:48:19.000000000 -0700
@@ -11,36 +11,33 @@
   include("action_header.php");
   
   $input = array(
-		 "id"       => "int",
-		 "comments" => "html"
-		 );
+  "id"       => "int",
+  "comments" => "html"
+  );
   $zen->cleanInput($input);
   
-   if( !$errs ) {
-     $res = $zen->approve_ticket($id, $login_id, $comments);
-     if( $res ) {
-       add_system_messages("Ticket $id was approved");
-       $setmode = "details";
-       include("../ticket.php");
-       exit;       
-       //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
-     } else {
-       $errs[] = tr("System error: Ticket ? could not be approved", array($id)).$zen->db_error;
-     }
-   }
-   if( $errs )
-     add_system_messages( $errs, 'Error' );     
-   
-   include("$libDir/nav.php");
-   
-   unset($action);
-   extract($ticket);
-   if( strtolower($zen->types["$type_id"]) == "project" ) {
-     include("$templateDir/projectView.php");
-   } else {
-     include("$templateDir/ticketView.php");     
-   }
-   
-   include("$libDir/footer.php");
-
+  if( !$errs ) {
+    $res = $zen->approve_ticket($id, $login_id, $comments);
+    if( $res ) {
+      $msg = "Ticket was approved and closed";
+      $setmode = null;
+      $action = null;
+      include("../ticket.php");
+      exit;       
+    } else {
+      $errs[] = tr("System error: Ticket ? could not be approved", array($id)).$zen->db_error;
+    }
+  }
+  
+  include("$libDir/nav.php");
+  $zen->printErrors($errs);
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
+    include("$templateDir/projectView.php");
+  } else {
+    include("$templateDir/ticketView.php");     
+  }
+  
+  include("$libDir/footer.php");
+  
 }?>
diff -Naur zentrack_2-5-5-2/www/actions/assign.php zentrack_2-6-pre1/www/actions/assign.php
--- zentrack_2-5-5-2/www/actions/assign.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/assign.php	2005-10-11 04:48:19.000000000 -0700
@@ -12,44 +12,40 @@
   
   if( $actionComplete == 1 ) {
     $input = array(
-		   "id"       => "int",
-		   "user_id"   => "int",
-		   "comments" => "html"
-		   );
+    "id"       => "int",
+    "user_id"   => "int",
+    "comments" => "html"
+    );
     $zen->cleanInput($input);
     $required = array("user_id","id");
     foreach($required as $r) {
       if( !$$r ) {
-	$errs[] = tr(" ? is required", array($r));
+        $errs[] = tr(" ? is required", array($r));
       }
     }
     
     if( !$errs ) {
       $res = $zen->assign_ticket($id, $user_id, $login_id, $comments);
       if( $res ) {
-	add_system_messages("Ticket $id assigned to ".$zen->formatName($user_id));
-	$setmode = "details";
-	include("../ticket.php");
-	exit;
-	//header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
+        $msg = tr("Ticket was assigned to ?",$zen->formatName($user_id));
+        $setmode = "";
+        $action = "";
+        include("../ticket.php");
+        exit;
       } else {
-	$errs[] = tr("System error: Ticket ? could not be assigned", array($id)).$zen->db_error;
+        $errs[] = tr("System error: Ticket could not be assigned").$zen->db_error;
       }
     }
-    if( $errs ) {
-      add_system_messages( $errs, 'Error' );
-    }
   }
-
+  
   include("$libDir/nav.php");
+  $zen->printErrors($errs);
   
-  if( $actionComplete == 1 )
-    $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIds($ticket['type_id']) ) {
     include("$templateDir/projectView.php");
   } else {
-    include("$templateDir/ticketView.php");     
+    include("$templateDir/ticketView.php");
   }
   
   include("$libDir/footer.php");
diff -Naur zentrack_2-5-5-2/www/actions/close.php zentrack_2-6-pre1/www/actions/close.php
--- zentrack_2-5-5-2/www/actions/close.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/close.php	2005-10-20 11:23:48.000000000 -0700
@@ -30,7 +30,7 @@
         if( is_array($children) ) {
           foreach($children as $c) {
             if( $c["status"] != "CLOSED" ) {
-              $errs[] = tr("? ? is not completed.", array($zen->types[$c['type_id']], $c['id']));
+              $errs[] = tr("? ? must be closed before this project may close", array($zen->getTypeName($c['type_id']), $c['id']));
             }
           }
         }
@@ -50,26 +50,25 @@
         // update the variable field entries for this ticket
         $res = $zen->updateVarfieldVals($id, $varfield_params);
         if( !$res ) {
-          add_system_mesages(tr("? ? closed, but variable fields could not be saved", array(tr('Ticket'),$id)));
+          $msg = tr("? ? closed, but variable fields could not be saved", array(tr('Ticket'),$id));
         } else {
-          add_system_messages(tr("Ticket ? has been closed", array($id)));
+          $msg = tr("Ticket ? has been closed", array($id));
         }
       }
-      $setmode="details";
-    }
-    if( $errs ) {
-      add_system_messages( $errs, 'Error' );
+      $setmode = null;
+      $action = null;
+      $ticketTabAction = false;
+      include("$rootWWW/ticket.php");
+      exit;
     }
   }
 
+  $onLoad[] = "behavior_js.php?formset=ticketTabForm";
   include("$libDir/nav.php");
-
+  $zen->printErrors($errs);
   $ticket = $zen->get_ticket($id);
-  $varfields = $zen->getVarfieldVals($id);
-  extract($varfields);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
-     include("$templateDir/projectView.php");
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
+    include("$templateDir/projectView.php");
   } else {
     include("$templateDir/ticketView.php");     
   }
diff -Naur zentrack_2-5-5-2/www/actions/contact_agreement.php zentrack_2-6-pre1/www/actions/contact_agreement.php
--- zentrack_2-5-5-2/www/actions/contact_agreement.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/contact_agreement.php	2005-07-29 12:13:15.000000000 -0700
@@ -2,7 +2,7 @@
   /*
   **  Action: edit ticket
   */
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $expand_agreement = 1;
   
   
diff -Naur zentrack_2-5-5-2/www/actions/contact_delete.php zentrack_2-6-pre1/www/actions/contact_delete.php
--- zentrack_2-5-5-2/www/actions/contact_delete.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/contact_delete.php	2005-10-20 11:23:48.000000000 -0700
@@ -3,14 +3,10 @@
   **  Action: delete contact
   */
   $id = NULL;
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Contacts");
   $page_section = "Contacts";
-  $expand_contacts = 1;
   
-  
-  include("$libDir/nav.php");
-
   if( isset($cid)) {
 			$table = "ZENTRACK_COMPANY";
 			$col = "company_id";	
@@ -24,16 +20,18 @@
 
 	if(isset($id)){	
       $res = $zen->delete_contact($id,$table,$col);
-      print $res? "Deleted contact ".$id."<br>\n" : "Delete contact failed<br>\n"; 
+      if( $res ) { $msg = tr("Deleted contact #?",$id); }
+      else { $errs[] = "Delete contact failed due to system error"; } 
 	} else {
 			print "No contact selected";
 	}
-	
-$tabel = "ZENTRACK_COMPANY";
-$title = "title";
-$overview = "company";
 
+  $tabel = "ZENTRACK_COMPANY";
+  $title = "title";
+  $overview = "company";
+  
+  include("$libDir/nav.php");
+  $zen->printErrors($errs);	
   include("$templateDir/contactView.php");
-
   include("$libDir/footer.php");
 ?>
diff -Naur zentrack_2-5-5-2/www/actions/contact_edit.php zentrack_2-6-pre1/www/actions/contact_edit.php
--- zentrack_2-5-5-2/www/actions/contact_edit.php	2004-11-23 10:34:15.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/contact_edit.php	2005-07-29 12:13:15.000000000 -0700
@@ -2,7 +2,7 @@
   /*
   **  Action: edit ticket
   */
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Contact #?", array($id));
   $expand_contact = 1;
   
diff -Naur zentrack_2-5-5-2/www/actions/contact_employee.php zentrack_2-6-pre1/www/actions/contact_employee.php
--- zentrack_2-5-5-2/www/actions/contact_employee.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/contact_employee.php	2005-07-29 12:13:15.000000000 -0700
@@ -1,8 +1,8 @@
 <?
   /*
-  **  Action: edit ticket
+  **  Action: add an employee to a contact
   */
-  include_once("../header.php");
+  include_once("../contact_header.php");
   $page_title = tr("Contact #?", $id);
   $expand_contact = 1;
   
diff -Naur zentrack_2-5-5-2/www/actions/dropAttachments.php zentrack_2-6-pre1/www/actions/dropAttachments.php
--- zentrack_2-5-5-2/www/actions/dropAttachments.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/dropAttachments.php	2005-10-20 11:23:48.000000000 -0700
@@ -0,0 +1,46 @@
+<?{
+  
+  /*
+  **  DELETE ATTACHMENTS
+  */
+  
+  $action = "upload";  
+  include("action_header.php");
+  
+  if( !$drops ) {
+    $msg[] = tr("No attachments were selected to delete");
+  }
+  else {
+    $possibles = array();
+    $vals = $zen->get_attachments($id);
+    if( $vals ) {
+      foreach($vals as $v) {
+        $possibles["{$v['attachment_id']}"] = $v;
+      }
+    }
+    $do = array();
+    foreach($drops as $d) {
+      if( !$possibles["$d"] ) {
+        $errs[] = tr("Attachment ? does not belong to this ticket", $d);
+      }
+      else {
+        $do[] = $zen->checkNum($d);
+      }
+    }
+    if( count($do) ) {
+      $c = $zen->delete_attachment($drops);
+      $msg[] = tr("? attachments deleted", $c);
+    }
+  }
+  
+  include("$libDir/nav.php");
+  $action = '';
+  $zen->printErrors($errs);  
+  if( $page_type == "project" ) {
+    include("$templateDir/projectView.php");
+  } else {
+    include("$templateDir/ticketView.php");     
+  }
+  include("$libDir/footer.php");
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/dropFromContacts.php zentrack_2-6-pre1/www/actions/dropFromContacts.php
--- zentrack_2-5-5-2/www/actions/dropFromContacts.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/dropFromContacts.php	2005-10-20 11:23:48.000000000 -0700
@@ -3,7 +3,7 @@
 
   // get action properties
   $action = "contacts";  
-  include("../header.php");
+  include("action_header.php");
   
   // check to insure that this user has access
   // and this ticket allows the requested action
@@ -18,12 +18,11 @@
   }  else {
     $page_type = "ticket";
   }
-  $page_mode = "system";
+  $page_mode = $setmode;
 
   
   $page_title = tr("Ticket #?", array($id));
   $page_section = "Ticket #$id";
-  $expand_tickets = 1;
   
   if( is_array($drops) ) {
     // drop items in list
@@ -32,28 +31,34 @@
       // clean up numbers just in case
       $n = $zen->checkNum($drops[$i]);
       if( strlen($n) ) {
-	// do the drop
-	$res = $zen->delete_contact( $n,"ZENTRACK_RELATED_CONTACTS","clist_id");
-	// calculate the number of results
-	if( $res ) {
-	  $num += 1;
-	}
+        // do the drop
+        $res = $zen->delete_contact( $n,"ZENTRACK_RELATED_CONTACTS","clist_id");
+        // calculate the number of results
+        if( $res ) {
+          $num++;
+        }
+        else {
+          $errs[] = tr("Contact #? could not be removed",$n);
+        }
       }
     }
-    add_system_messages(tr("? are dropped from the contact list", array($num)),"Bold");
-    $setmode = "contacts";
+    if( !$errs ) { 
+      $action = ''; 
+      $msg = $num > 1?
+        tr("? contacts were removed", array($num)) :
+        tr("One contact was removed");
+    }
   }
   else {
     // create an error message
-    $msg = tr("No contacts were selected to drop");
-    add_system_messages( $msg, 'Error' );
+    $errs[] = tr("No contacts were selected to drop");
+    $action = '';
   }
 
   
   // display the results
   include("$libDir/nav.php");
-  unset($action);
-  extract($ticket);
+  $zen->printErrors($errs);
   if( $zen->inProjectTypeIDs($type_id) ) {
     include("$templateDir/projectView.php");
   } else {
diff -Naur zentrack_2-5-5-2/www/actions/dropFromNotify.php zentrack_2-6-pre1/www/actions/dropFromNotify.php
--- zentrack_2-5-5-2/www/actions/dropFromNotify.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/dropFromNotify.php	2005-10-20 11:23:48.000000000 -0700
@@ -1,11 +1,11 @@
 <?{
-
+  
   /**
-   **  ADD ENTRIES TO NOTIFY LIST
-   **  
-   **  Checks for duplicates and adds users/email addresses
-   **  to a ticket's notify list
-   */
+  **  ADD ENTRIES TO NOTIFY LIST
+  **  
+  **  Checks for duplicates and adds users/email addresses
+  **  to a ticket's notify list
+  */
   
   // get action properties
   $action = "notify";  
@@ -18,33 +18,32 @@
       // clean up numbers just in case
       $n = $zen->checkNum($drops[$i]);
       if( strlen($n) ) {
-	// do the drop
-	$res = $zen->delete_from_notify_list($n);
-	// calculate the number of results
-	if( $res ) {
-	  $num += 1;
-	}
+        // do the drop
+        $res = $zen->delete_from_notify_list($n);
+        // calculate the number of results
+        if( $res ) {
+          $num += 1;
+        }
       }
     }
-    add_system_messages(tr("? recipients dropped from the notify list", array($num)),"Bold");
-    $setmode = "notify";
+    $msg = tr("? recipients dropped from the notify list", $num);
+    $action = '';
   }
   else {
     // create an error message
     $msg = tr("No recipients were selected to drop");
-    add_system_messages( $msg, 'Error' );
+    $action = '';
   }
-
+  
   
   // display the results
   include("$libDir/nav.php");
-  unset($action);
-  extract($ticket);
+  $zen->printErrors($errs);
   if( $zen->inProjectTypeIDs($type_id) ) {
     include("$templateDir/projectView.php");
   } else {
     include("$templateDir/ticketView.php");     
   }  
   include("$libDir/footer.php");    
-
-}?>
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/editAgreementSubmit.php zentrack_2-6-pre1/www/actions/editAgreementSubmit.php
--- zentrack_2-5-5-2/www/actions/editAgreementSubmit.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/editAgreementSubmit.php	2005-07-29 12:13:15.000000000 -0700
@@ -1,5 +1,5 @@
 <?
-  include_once("../header.php");
+  include_once("../contact_header.php");
   
   include("$libDir/editAgreementSubmit.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/editContactSubmit.php zentrack_2-6-pre1/www/actions/editContactSubmit.php
--- zentrack_2-5-5-2/www/actions/editContactSubmit.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/editContactSubmit.php	2005-07-29 12:13:15.000000000 -0700
@@ -1,5 +1,5 @@
 <?
-  include_once("../header.php");
+  include_once("../contact_header.php");
   
   include("$libDir/editContactSubmit.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/editContacteSubmit.php zentrack_2-6-pre1/www/actions/editContacteSubmit.php
--- zentrack_2-5-5-2/www/actions/editContacteSubmit.php	2004-09-02 09:41:08.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/editContacteSubmit.php	2005-07-29 12:13:15.000000000 -0700
@@ -1,5 +1,5 @@
 <?
-  include_once("../header.php");
+  include_once("../contact_header.php");
   
   include("$libDir/editContacteSubmit.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/editCustomSubmit.php zentrack_2-6-pre1/www/actions/editCustomSubmit.php
--- zentrack_2-5-5-2/www/actions/editCustomSubmit.php	2004-08-09 01:10:05.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/editCustomSubmit.php	2005-07-12 06:17:45.000000000 -0700
@@ -1,6 +1,7 @@
 <?
   include("action_header.php");
 
+
   if( !$zen->checkAccess($login_id, $bin_id, 'varfield_edit') ) {
     $errs[] = tr("You cannot edit a ticket's custom fields in this bin");
   }
diff -Naur zentrack_2-5-5-2/www/actions/editSubmit.php zentrack_2-6-pre1/www/actions/editSubmit.php
--- zentrack_2-5-5-2/www/actions/editSubmit.php	2005-02-28 12:02:32.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/editSubmit.php	1969-12-31 16:00:00.000000000 -0800
@@ -1,93 +0,0 @@
-<?
-  /*
-  **  EDIT TICKET (edit submit)
-  **  
-  **  Commit changes to database
-  **
-  */
-  
-  include("action_header.php");
-
-  $page_title = tr("Commit Edited Ticket");
-  $expand_tickets = 1;
-
-  // initiate default values
-  $otime = time();  // set time ticket opened
-  if( $deadline ) {
-     $deadline = $zen->dateParse($deadline);
-  }
-  if( $start_date ) {
-     $start_date = $zen->dateParse($start_date);
-  }
-
-  $fields = array(
-		  "title"       => "text",
-		  "priority"    => "int",
-		  "description" => "html",
-		  "otime"       => "int",
-		  "bin_id"       => "int",
-		  "type_id"      => "int",
-		  "user_id"      => "int",
-		  "system_id"    => "int",
-		  "tested"      => "int",
-		  "approved"    => "int",
-		  "relations"   => "text",
-		  "project_id"   => "int",
-		  "est_hours"   => "num",
-		  "deadline"    => "int",
-		  "start_date"  => "int"
-		  );
-      
-  $fields = $map->getFieldMap('ticket_edit');
-  $required = array();
-  foreach($fields as $f=>$field) {
-    if( $field['is_required'] ) {
-      $required[] = $f;
-    }
-  }
-
- // $required = array(
-		   // "title",
-		   // "priority",
-		   // "description",
-		   // "bin_id",
-		   // "type_id",
-		   // "system_id"
-		   // );
-  $zen->cleanInput($fields);
-  // check for required fields
-  foreach($required as $r) {
-     if( !strlen($$r) ) {
-       $errs[] = tr("? is a required field", array(ucfirst($r)));
-     }
-  }
-  if( !$errs ) {
-     // create an array of existing fields
-     foreach(array_keys($fields) as $f) {
-	if( strlen($$f) ) {
-	   $params["$f"] = $$f;
-	}
-     }
-     // update the ticket info
-     $res = $zen->edit_ticket($id,$login_id,$params);
-     // check for errors
-     if( !$res ) {
-	$errs[] = tr("Ticket ? could not edit ticket. ",array($id)).$zen->db_error;
-     }
-  }
-
-  if( !$errs ) {
-     add_system_messages(tr("Edited ticket ?.", array($id)));
-     $setmode = "details";
-     include("../ticket.php");
-     exit;
-     //header("Location:$rootUrl/ticket.php?id=$id&setmode=Details");
-  } else {
-     add_system_messages($errs);
-     include("$libDir/nav.php");
-     $zen->print_errors($errs);
-     $view = "ticket_edit";
-     include("$templateDir/newTicketForm.php");
-     include("$libDir/footer.php");
-  }
-?>
diff -Naur zentrack_2-5-5-2/www/actions/email.php zentrack_2-6-pre1/www/actions/email.php
--- zentrack_2-5-5-2/www/actions/email.php	2005-03-21 09:55:55.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/email.php	2005-10-11 04:48:19.000000000 -0700
@@ -44,7 +44,7 @@
        $recipients = explode(",", $custom_email_addresses);
      }  
      
-     $subject = "[{$zen->settings['system_name']}] ".$zen->getTypeName($ticket["type_id"])." $id";
+     $subject = "[".$zen->getSetting('system_name')."] ".$zen->getTypeName($ticket["type_id"])." $id";
      unset($params);
      if( $comments )
      $params["message"] = $comments;
@@ -62,7 +62,7 @@
      if( !$errs ) {
        $err = $zen->sendEmail($recipients, $subject, $message, $login_id);
        if( !$err ) {
-         if( $zen->settings["log_email"] == 'on' ) {
+         if( $zen->settingOn("log_email") ) {
            $name = $zen->formatName($user,1);
            $logParams = array(
              "action"   =>  'EMAIL',
@@ -75,9 +75,10 @@
            foreach ($recipients as $v) {
              if ($zen->checkNum($v) >0) {
                $user_info=$zen->get_user($v);
-               $v1="[".$v." - ".$user_info["email"]."]";
+               $v1= $zen->formatName($user_info);
+               $v1 .= "(".($user_info['email']? $user_info['email'] : '-no email-').")";
              } else {
-               $v1=$v;
+               $v1 = $v;
              }
              $entry .= $v1 . ", ";
            }
@@ -88,8 +89,9 @@
            $zen->add_log($id, $logParams);
            $zen->addDebug("www/actions/email.php", "Ticket emailed by $login_id", 3);
          }
-         add_system_messages(tr("Ticket ? emailed to selected recipients", array($id)));
-         $setmode = "system";
+         $msg = tr("Ticket ? emailed to selected recipients", array($id));
+         $setmode = "";
+         $action = "";
          include("$rootWWW/ticket.php");
          exit;
          //header("Location:$rootUrl/ticket.php?id=$id&setmode=system");
@@ -99,13 +101,11 @@
          $errs[] = tr("Ticket ? not mailed: ?", array($id, tr($err)));
        }
      }
-     if( $errs )
-     add_system_messages( $errs, 'Error' );
    }
    
    include("$libDir/nav.php");
+   $zen->printErrors($errs);
    
-   extract($ticket);
    if( strtolower($zen->types["$type_id"]) == "project" ) {
      include("$templateDir/projectView.php");
    } else {
diff -Naur zentrack_2-5-5-2/www/actions/empty.gif zentrack_2-6-pre1/www/actions/empty.gif
--- zentrack_2-5-5-2/www/actions/empty.gif	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/empty.gif	2005-10-08 00:48:46.000000000 -0700
@@ -0,0 +1 @@
+GIF89a       333ffffff3333ff333  f         33ff3 3 f3f33 ff f3ff3 f 3 3f f 3 fff33f333 ff    3f  33f f f3f3f f 3f f33 f3 f33 ff3f333ff33 3  f       33ff 3 33f3f 3f f3ff f3 f3 3 ff 3 f3ff3f3 33 ff   3f  33 ff 3ff 3f f3 f3f 3f 33f 3ff33f33ff33  3  f      33ff3 3 f3f33 ff f3f3 ff 3 3f f 3 ff3f3f33 3f f   3f  33 ff 3fff 3 f3 f3f 3f 33f 3                                                                                                                        !   ,        , ;
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/log.php zentrack_2-6-pre1/www/actions/log.php
--- zentrack_2-5-5-2/www/actions/log.php	2005-05-15 16:45:03.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/log.php	2005-10-20 11:23:48.000000000 -0700
@@ -35,34 +35,36 @@
     if( !$errs ) {
       $res = $zen->log_ticket($id, $login_id, $log_action, $hours, $comments);
       if( $res ) {
-        add_system_messages(tr("Activity has been logged."));
-        $setmode = "log";
-        include("../ticket.php");
-        exit;
-        //header("Location:$rootUrl/ticket.php?id=$id&setmode=log");
+        $msg = tr("Log entry has been added");
       } else {
         $errs[] = tr("System error: Activity could not be logged.").$zen->db_error;
       }
     }
-    if( $errs )
-    add_system_messages( $errs, 'Error' );     
+
+    if( !$errs ) { 
+      $action = null;
+      $tabs = $map->getTabs($page_type, $login_id, $ticket['bin_id']);
+      foreach($tabs as $k=>$v) {
+        if( $v['preload'] && in_array('log',$v['preload']) ) {
+          $setmode = $k;
+          break;
+        }
+        else if( $v['postload'] && in_array('log',$v['postload']) ) {
+          $setmode = $k;
+          break;
+        }
+      }
+    }
   }
-  
+
   include("$libDir/nav.php");
-  
-  if( $actionComplete == 1 && $page_type == "project" ) {
-    $ticket = $zen->get_project($id);
-  }
-  else if( $actionComplete ) {
-    $ticket = $zen->get_ticket($id);
-  }
-  extract($ticket);
+  $zen->printErrors($errs);  
+  $page_mode = $setmode;
   if( $page_type == "project" ) {
     include("$templateDir/projectView.php");
   } else {
     include("$templateDir/ticketView.php");     
   }
-  
   include("$libDir/footer.php");
   
 }?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/move.php zentrack_2-6-pre1/www/actions/move.php
--- zentrack_2-5-5-2/www/actions/move.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/move.php	2005-10-11 04:48:19.000000000 -0700
@@ -12,41 +12,39 @@
   if( $actionComplete == 1 ) {
     $user_id = $login_id;
     $input = array(
-		   "id"       => "int",
-		   "newBin"   => "int",
-		   "user_id"   => "int",
-		   "comments" => "html"
-		   );
+    "id"       => "int",
+    "newBin"   => "int",
+    "user_id"   => "int",
+    "comments" => "html"
+    );
     $zen->cleanInput($input);
     $required = array("id","newBin","user_id");
     foreach($required as $r) {
       if( !$$r ) {
-	$errs[] = tr(" ? is required", array($r));
+        $errs[] = tr(" ? is required", array($r));
       }
     }
     
     if( !$errs ) {
       $res = $zen->move_ticket($id, $newBin, $login_id, $comments);
       if( $res ) {
-	add_system_messages(tr("Ticket ? moved to the ? bin", array($id, $zen->bins["$newBin"])));
-	$setmode = "details";
-	include("../ticket.php");
-	exit;
-	//header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
+        $msg = tr("Ticket ? moved to the ? bin", array($id, $zen->bins["$newBin"]));
+        $setmode = "";
+        $action = '';
+        include("$rootWWW/ticket.php");
+        exit;
+        //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
       } else {
-	$errs[] = tr("System error: Ticket ? could not be moved. ", array($id)).$zen->db_error;
+        $errs[] = tr("System error: Ticket ? could not be moved. ", array($id)).$zen->db_error;
       }
     }
-    if( $errs )
-      add_system_messages( $errs, 'Error' );
   }
 
   include("$libDir/nav.php");
+  $zen->printErrors($errs);
 
-  if( $actionComplete == 1 ) 
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
+  // the ticket is retrieved in action_header, don't do that here
+  if( $page_type == "project" ) {
     include("$templateDir/projectView.php");
   } else {
     include("$templateDir/ticketView.php");     
diff -Naur zentrack_2-5-5-2/www/actions/print.php zentrack_2-6-pre1/www/actions/print.php
--- zentrack_2-5-5-2/www/actions/print.php	2004-11-01 11:19:22.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/print.php	2005-10-20 11:23:48.000000000 -0700
@@ -9,7 +9,7 @@
 
   $tid = $ticket["type_id"];
   $user_id = $ticket["user_id"];
-  $title = ($zen->types["$tid"] == "Project")? strtoupper($zen->settings["system_name"]). " PROJECT REPORT" : strtoupper($zen->settings["system_name"])." ".strtoupper($zen->types["$tid"]). " REPORT";
+  $title = ($zen->types["$tid"] == "Project")? strtoupper($zen->getSetting("system_name")). " PROJECT REPORT" : strtoupper($zen->getSetting("system_name"))." ".strtoupper($zen->types["$tid"]). " REPORT";
   $ticketroj = ($zen->types["$tid"] == "Project")? 1 : '';
   if( $ticket["project_id"] ) {
      $parent = $zen->get_ticket($ticket["project_id"] );
diff -Naur zentrack_2-5-5-2/www/actions/reject.php zentrack_2-6-pre1/www/actions/reject.php
--- zentrack_2-5-5-2/www/actions/reject.php	2004-10-11 16:35:29.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/reject.php	2005-10-11 04:48:19.000000000 -0700
@@ -26,25 +26,27 @@
     if( !$errs ) {
       $res = $zen->reject_ticket($id, $login_id, $comments);
       if( $res ) {
-        add_system_messages(tr("Ticket ? was rejected.", array($id)));
-        $setmode = "details";
+        $ticket = $zen->get_ticket($id);
+        $to = $ticket['user_id']? $zen->formatName($ticket['user_id']) : '';
+        if( $ticket['bin_id'] ) {
+          $to = $ticket['user_id']? $to . '(' . $zen->getBinName($ticket['bin_id']) . ')' :
+             $zen->getBinName($ticket['bin_id']);
+        }
+        $msg = tr("Ticket was rejected to ?", array($to));
+        $setmode = null;
+        $action = null;
         include("../ticket.php");
         exit;
-        //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
       } else {
         $errs[] = tr("System error: Ticket ? could not be rejected", array($id)).$zen->db_error;
       }
     }
-    if( $errs )
-    add_system_messages( $errs, 'Error' );     
   }
 
   include("$libDir/nav.php");
-
-  if( $actionComplete == 1 )
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
+  $zen->printErrors($errs);
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
      include("$templateDir/projectView.php");
   } else {
      include("$templateDir/ticketView.php");     
diff -Naur zentrack_2-5-5-2/www/actions/relate.php zentrack_2-6-pre1/www/actions/relate.php
--- zentrack_2-5-5-2/www/actions/relate.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/relate.php	2005-10-20 11:23:48.000000000 -0700
@@ -1,63 +1,57 @@
 <?{
-   
+  
   /*
   **  RELATE TICKET
   **  
   **  create associations between this ticket and others
   **
   */
-
+  
   $action = "relate";  
   include("action_header.php");
-
+  
   if( $actionComplete == 1 ) {
-     $relations = ereg_replace("[^0-9,\n]", "", $relations);
-     $relations = split(" *[,\n] *", $relations);
-     $input = array(
-		    "id"        => "int",
-		    "relations" => "ignore",
-		    "comments"  => "html"
-		    );
-     $zen->cleanInput($input);
-     $required = array("relations","id");
-     foreach($required as $r) {
-	if( !$$r ) {
-	   $errs[] = tr(" ? is required", array($r));
-	}
-     }
-     
-     if( !$errs ) {
-	$res = $zen->relate_ticket($id, $relations, $login_id, $comments);
-	if( $res ) {
-	   add_system_messages(tr("Ticket ? related.", array($id)));
-	   $setmode = "related";
-	   include("../ticket.php");
-	   exit;
-	   //header("Location:$rootUrl/ticket.php?id=$id&setmode=related");
-	} else {
-	   $errs[] = tr("System error: Ticket ? could not be related, or the entries were the same.", array($id)).$zen->db_error;
-	}
-     }
-     if( $errs )
-       add_system_messages( $errs, 'Error' );     
+    $relations = ereg_replace("[^0-9,\n]", "", $relations);
+    $relations = split(" *[,\n] *", $relations);
+    $input = array(
+    "id"        => "int",
+    "relations" => "ignore",
+    "comments"  => "html"
+    );
+    $zen->cleanInput($input);
+    $required = array("relations","id");
+    foreach($required as $r) {
+      if( !$$r ) {
+        $errs[] = tr(" ? is required", array($r));
+      }
+    }
+    
+    if( !$errs ) {
+      $res = $zen->relate_ticket($id, $relations, $login_id, $comments);
+      if( $res ) {
+        $msg = tr("Ticket ? related.", $id);
+        $action = '';
+      } else {
+        $errs[] = tr("System error: Ticket ? could not be related, or the entries were the same.", array($id)).$zen->db_error;
+      }
+    }
   }
-
+  
   include("$libDir/nav.php");
-
+  $zen->printErrors($errs);
   if( is_array($relations) ) {
-     $relations = join("\n", $relations);
+    $relations = join("\n", $relations);
   } else {
-     $relations = ereg_replace(",", "\n", $ticket["relations"]);
+    $relations = ereg_replace(",", "\n", $ticket["relations"]);
   }
   if( $actionComplete == 1 )
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
+    $ticket = $zen->get_ticket($id);
   if( $zen->inProjectTypeIDs($type_id) ) {
-     include("$templateDir/projectView.php");
+    include("$templateDir/projectView.php");
   } else {
-     include("$templateDir/ticketView.php");     
+    include("$templateDir/ticketView.php");     
   }
-
+  
   include("$libDir/footer.php");
-
-}?>
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/reopen.php zentrack_2-6-pre1/www/actions/reopen.php
--- zentrack_2-5-5-2/www/actions/reopen.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/reopen.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,61 +1,57 @@
 <?{
-   
+  
   /*
   **  REOPEN TICKET
   **  
   **  Open a ticket which was closed in error
   **
   */
-
+  
   $action = "reopen";  
   include("action_header.php");
-
+  
   if( $actionComplete == 1 ) {
-     if( !$tested ) {
-	$tested = 0;
-     }
-     if( !$approved ) {
-	$approved = 0;
-     }
-     $input = array(
-		    "id"       => "int",
-		    "comments" => "html"
-		    );
-     $zen->cleanInput($input);
-     $required = array("id","comments");
-     foreach($required as $r) {
-	if( !strlen($$r) ) {
-	   $errs[] = tr(" ? is required", array($r));
-	}
-     }
-     
-     if( !$errs ) {
-	$res = $zen->reopen_ticket($id, $login_id, $comments);
-	if( $res ) {
-	   add_system_messages(tr("Ticket ? was repoened.", array($id)));
-	   $setmode = "details";
-	   include("../ticket.php");
-	   exit;
-	   //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
-	} else {
-	   $errs[] = tr("System error: Ticket ? could not be reopened.", array($id)) .$zen->db_error;
-	}
-     }
-     if( $errs )
-       add_system_messages( $errs, 'Error' );     
+    if( !$tested ) {
+      $tested = 0;
+    }
+    if( !$approved ) {
+      $approved = 0;
+    }
+    $input = array(
+    "id"       => "int",
+    "comments" => "html"
+    );
+    $zen->cleanInput($input);
+    $required = array("id","comments");
+    foreach($required as $r) {
+      if( !strlen($$r) ) {
+        $errs[] = tr(" ? is required", array($r));
+      }
+    }
+    
+    if( !$errs ) {
+      $res = $zen->reopen_ticket($id, $login_id, $comments);
+      if( $res ) {
+        $msg = tr("Ticket reopened, status moved to OPEN");
+        $setmode = null;
+        $action = null;
+        include("../ticket.php");
+        exit;
+      } else {
+        $errs[] = tr("System error: Ticket ? could not be reopened.", array($id)) .$zen->db_error;
+      }
+    }
   }
-
+  
   include("$libDir/nav.php");
-
-  if( $actionComplete == 1 )
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
-     include("$templateDir/projectView.php");
+  $zen->printErrors($errs);
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
+    include("$templateDir/projectView.php");
   } else {
-     include("$templateDir/ticketView.php");     
+    include("$templateDir/ticketView.php");     
   }
-
+  
   include("$libDir/footer.php");
-
+  
 }?>
diff -Naur zentrack_2-5-5-2/www/actions/test.php zentrack_2-6-pre1/www/actions/test.php
--- zentrack_2-5-5-2/www/actions/test.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/test.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,48 +1,45 @@
 <?{
-   
+  
   /*
   **  TEST TICKET
   **  
   **  Set testing status to completed for a ticket.
   **
   */
-
+  
   $action = "test";  
   include("action_header.php");
-
+  
   if( $actionComplete == 1 ) {
-     $input = array(
-		    "id"       => "int",
-		    "hours"    => "num",
-		    "comments" => "html"
-		    );
-     if( !$errs ) {
-	$res = $zen->test_ticket($id, $login_id, $hours, $comments);
-	if( $res ) {
-	   add_system_messages("Ticket $id tested");
-	   $setmode = "details";
-	   include("../ticket.php");
-	   exit;
-	   //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
-	} else {
-	   $errs[] = tr("System error: Ticket ? could not be tested", array($id)).$zen->db_error;
-	}
-     }
-     if( $errs )
-       add_system_messages( $errs, 'Error' );     
+    $input = array(
+    "id"       => "int",
+    "hours"    => "num",
+    "comments" => "html"
+    );
+    if( !$errs ) {
+      $res = $zen->test_ticket($id, $login_id, $hours, $comments);
+      if( $res ) {
+        $msg = "Ticket marked as tested";
+        $setmode = null;
+        $action = null;
+        include("../ticket.php");
+        exit;
+        //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
+      } else {
+        $errs[] = tr("System error: Ticket ? could not be tested", array($id)).$zen->db_error;
+      }
+    }
   }
-
+  
   include("$libDir/nav.php");
-
-  if( $actionComplete == 1 )
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
-     include("$templateDir/projectView.php");
+  $zen->printErrors($errs);
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
+    include("$templateDir/projectView.php");
   } else {
-     include("$templateDir/ticketView.php");     
+    include("$templateDir/ticketView.php");     
   }
-
+  
   include("$libDir/footer.php");
-
-}?>
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/actions/upload.php zentrack_2-6-pre1/www/actions/upload.php
--- zentrack_2-5-5-2/www/actions/upload.php	2004-09-08 01:22:43.000000000 -0700
+++ zentrack_2-6-pre1/www/actions/upload.php	2005-10-20 11:23:48.000000000 -0700
@@ -28,8 +28,8 @@
     // for use
     $ticket_id = $id;
     $input = array(
-    "ticket_id"       => "int",
-    "userfile_name"  => "text"
+      "ticket_id"       => "int",
+      "userfile_name"  => "text"
     );
     if( $log_id ) {
       $input["log_id"] = "int";
@@ -53,7 +53,7 @@
         $errs[] = tr("The uploaded file exceeds the upload_max_filesize directive in php.ini.");
         break;
         case 2:
-        $errs[] = tr("The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the html form.");
+        $errs[] = tr("The uploaded file exceeds the MAX_FILE_SIZE allowed");
         break;
         case 3:
         $errs[] = tr("The uploaded file was only partially uploaded.");
@@ -65,7 +65,17 @@
         $errs[] = tr("Uploaded file size 0 bytes");
         break;
       }
-    } 
+    }
+    
+    if( !$errs ) {
+      $ext = strtolower(preg_replace('@^.*[.]([a-zA-Z0-9]+)$@', '\\1', $userfile_name));
+      $possibles = $zen->getSetting('attachment_types_allowed');
+      $vals = split(" *, *",$possibles);
+      if( !in_array($ext, $vals) ) {
+        $errs[] = tr("Invalid file type, the allowed types are: ?", $possibles);
+      }
+    }
+    
     // if there aren't any errors, get the file and input to the system
     if( !$errs ) {
       // perform the file transfer to move it to the directory where we 
@@ -83,17 +93,14 @@
         $file_name = $ticket_id."_$randval";	   
       }
       $file_type = ereg_replace(".*[.]", "", $userfile_name);
-      if( preg_match("/\b$file_type\b/i",$zen->settings["attachment_text_types"]) ) {
+      if( preg_match("/\b$file_type\b/i",$zen->getSetting("attachment_text_types")) ) {
         $userfile_type = "text/plain";
       }
-      $max_size = $zen->settings["attachment_max_size"];	
+      $max_size = $zen->getSetting("attachment_max_size");	
       if( !is_uploaded_file($userfile) ) {
         $errs[] = tr("The file was not recieved. Check to insure it's size does not exceed ?KB", array(substr($max_size,0,strlen($max_size)-3)));
       } else if( $userfile_size > $max_size ) {
         $errs[] = tr("The file size (?) exceeded the maximum allowed (?)", array(number_format($userfile_size), number_format($max_size)));
-      } else if( $zen->settings["attachment_types_allowed"] 
-      && !preg_match("/\b$file_type\b/i", $zen->settings["attachment_types_allowed"]) ) {
-        $errs[] = tr("'?' is not an allowed file extension - See your systems administrator for more information", array($file_type));
       } else if( !$userfile_type ) {
         $errs[] = tr("That is not a recognized file type, by your browsers determinations");	   
       } else if( !move_uploaded_file($userfile, $zen->attachmentsDir."/$file_name") ) {
@@ -103,16 +110,16 @@
       if( !$errs ) {
         @chmod($zen->attachmentsDir."/$file_name",0666);
         $params = array(
-			  "name"     => $userfile_name,
-			  "filename" => $file_name,
-			  "filetype" => $userfile_type
+          "name"     => $userfile_name,
+          "filename" => $file_name,
+          "filetype" => $userfile_type
 			  );
         if( $comments )
         $params["description"] = $comments;
         $res = $zen->attach_to_ticket( $ticket_id, $login_id, $params, $log_id);
         if( $res ) {
-          add_system_messages("Attachment $userfile_name uploaded for ticket $id");
-          $setmode = "attachments";
+          $msg[] = "Attachment $userfile_name uploaded";
+          $action = '';
           include("../ticket.php");
           exit;
         } else {
@@ -121,17 +128,10 @@
         }
       }
     }
-    if( $errs )
-    add_system_messages( $errs, 'Error' );     
   }
   
   include("$libDir/nav.php");
-  
-  if( $actionComplete == 1 ) {
-    $id = $ticket_id;
-    $ticket = $zen->get_ticket($id);     
-  }
-  extract($ticket);
+  $zen->printErrors($errs);
   if( strtolower($zen->types["$type_id"]) == "project" ) {
     include("$templateDir/projectView.php");
   } else {
diff -Naur zentrack_2-5-5-2/www/actions/yank.php zentrack_2-6-pre1/www/actions/yank.php
--- zentrack_2-5-5-2/www/actions/yank.php	2003-03-27 09:55:21.000000000 -0800
+++ zentrack_2-6-pre1/www/actions/yank.php	2005-10-11 04:48:19.000000000 -0700
@@ -1,56 +1,52 @@
 <?{
-   
+  
   /*
   **  YANK TICKET
   **  
   **  Pull a ticket from it's owner
   **
   */
-
+  
   $action = "yank";  
   include_once("./action_header.php");
-
+  
   if( $actionComplete == 1 ) {
-     $input = array(
-		    "id"       => "int",
-		    "comments" => "html"
-		    );
-     $zen->cleanInput($input);
-     $required = array("id");
-     foreach($required as $r) {
-	if( !$$r ) {
-	   $errs[] = tr(" ? is required", array($r));
-	}
-     }
-     
-     if( !$errs ) {
-	$res = $zen->yank_ticket($id, $login_id, $comments);
-	if( $res ) {
-	   add_system_messages("Ticket $id yanked from "
-			       .$zen->formatName($ticket["user_id"]).".");
-	   $setmode = "details";
-	   include("../ticket.php");
-	   exit;
-	   //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
-	} else {
-	   $errs[] = tr("System error: Ticket ? could not be yanked.", array($id)) .$zen->db_error;
-	}
-     }
-     if( $errs )
-       add_system_messages( $errs, 'Error' );     
+    $input = array(
+    "id"       => "int",
+    "comments" => "html"
+    );
+    $zen->cleanInput($input);
+    $required = array("id");
+    foreach($required as $r) {
+      if( !$$r ) {
+        $errs[] = tr(" ? is required", array($r));
+      }
+    }
+    
+    if( !$errs ) {
+      $res = $zen->yank_ticket($id, $login_id, $comments);
+      if( $res ) {
+        $msg = tr("Ticket pulled from ?",$zen->formatName($ticket["user_id"]));
+        $setmode = null;
+        $action = null;
+        include("../ticket.php");
+        exit;
+        //header("Location:$rootUrl/ticket.php?id=$id&setmode=details");
+      } else {
+        $errs[] = tr("System error: Ticket ? could not be yanked.", array($id)) .$zen->db_error;
+      }
+    }
   }
-
+  
   include("$libDir/nav.php");
-
-  if( $actionComplete == 1 )
-     $ticket = $zen->get_ticket($id);
-  extract($ticket);
-  if( strtolower($zen->types["$type_id"]) == "project" ) {
-     include("$templateDir/projectView.php");
+  $zen->printErrors($errs);
+  $ticket = $zen->get_ticket($id);
+  if( $zen->inProjectTypeIDs($ticket['type_id']) ) {
+    include("$templateDir/projectView.php");
   } else {
-     include("$templateDir/ticketView.php");     
+    include("$templateDir/ticketView.php");     
   }
-
+  
   include("$libDir/footer.php");
-
-}?>
+  
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/addAgreementSubmit.php zentrack_2-6-pre1/www/addAgreementSubmit.php
--- zentrack_2-5-5-2/www/addAgreementSubmit.php	2005-02-09 05:56:15.000000000 -0800
+++ zentrack_2-6-pre1/www/addAgreementSubmit.php	2005-10-20 11:23:48.000000000 -0700
@@ -5,99 +5,99 @@
   **  Commit new project to database
   **
   */
-    
-  include_once("header.php");
-
+  
+  include_once("contact_header.php");
+  
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
-
+  
   $page_title = tr("Commit New Agreement");
   $expand_agreements = 1;
-
+  
   // initiate default values
   $create_time = time();  // set time ticket opened
   
-	if( $dtime ) {
-     $dtime = $zen->dateParse($dtime);
+  if( $dtime ) {
+    $dtime = $zen->dateParse($dtime);
   }
   if( $stime ) {
-     $stime = $zen->dateParse($stime);
+    $stime = $zen->dateParse($stime);
   }
   
   if (!empty($dtime) && !empty($stime)){	  
-  	if ($dtime < $stime) {
-	 	$errs[] = tr("incorrect date values"); 
-  	}
+    if ($dtime < $stime) {
+      $errs[] = tr("incorrect date values"); 
+    }
   }
-	
+  
   //$description = nl2br(htmlspecialchars($description));
-
+  
   $fields = array(
-		  "contractnr"       => "text",
-		  "company_id"    => "int",
-		  "description" => "ignore",
-		  "title"       => "text",
-		  "create_time" => "int",
-		  "stime" => "int",
-		  "dtime" => "int"
-		  );
- $required = array(
-		   "title"
-		   );
+    "contractnr"       => "text",
+    "company_id"    => "int",
+    "description" => "ignore",
+    "title"       => "text",
+    "create_time" => "int",
+    "stime" => "int",
+    "dtime" => "int"
+  );
+  $required = array(
+    "title"
+  );
   $zen->cleanInput($fields);
   // check for required fields
   foreach($required as $r) {
-     if( !$$r ) {
-	$errs[] = tr("required field missing:") . " " . ucfirst($r);
-     }
+    if( !$$r ) {
+      $errs[] = tr("required field missing:") . " " . ucfirst($r);
+    }
   }
   if( !$errs ) {
-     // create an array of existing fields
-     foreach(array_keys($fields) as $f) {
-	if( strlen($$f) ) {
-	   $params["$f"] = $$f;
-	}
-     }
-     $params["creator_id"] = $login_id;
-     // add the ticket to db
-     $id = $zen->add_contact($params,"ZENTRACK_AGREEMENT");
-     // check for errors
-     if( !$id ) {
-	$errs[] = tr("Could not create agreement.") . " " .$zen->db_error;
-     } else {
-	    
-	$agree_id = $id ;    
-  $fields = array(
-		  "agree_id"    => "int",
-		  );
-
-     $params = array();
-     // create an array of existing fields
-     foreach(array_keys($fields) as $f) {
-         $params["$f"] = $$f;
-     }
-     // update the ticket info
-     $res = $zen->update_contact("0",$params,"ZENTRACK_AGREEMENT_ITEM","agree_id");
-     // check for errors
-     if( !$res ) {
-   $errs[] = tr("System Error").": ".tr("Contact could not be edited.")." ".$zen->db_error;
-     }
-   
-     }
+    // create an array of existing fields
+    foreach(array_keys($fields) as $f) {
+      if( strlen($$f) ) {
+        $params["$f"] = $$f;
+      }
+    }
+    $params["creator_id"] = $login_id;
+    // add the ticket to db
+    $id = $zen->add_contact($params,"ZENTRACK_AGREEMENT");
+    // check for errors
+    if( !$id ) {
+      $errs[] = tr("Could not create agreement.") . " " .$zen->db_error;
+    } else {
+      
+      $agree_id = $id ;    
+      $fields = array(
+        "agree_id"    => "int",
+      );
+      
+      $params = array();
+      // create an array of existing fields
+      foreach(array_keys($fields) as $f) {
+        $params["$f"] = $$f;
+      }
+      // update the ticket info
+      $res = $zen->update_contact("0",$params,"ZENTRACK_AGREEMENT_ITEM","agree_id");
+      // check for errors
+      if( !$res ) {
+        $errs[] = tr("System Error").": ".tr("Contact could not be edited.")." ".$zen->db_error;
+      }
+      
+    }
   }
-
+  
   if( !$errs ) {
-     //$setmode = "tasks";
-     include("agreement.php");//test set contact(s)
-     exit;
-     //header("Location:$rootUrl/project.php?id=$id");
+    //$setmode = "tasks";
+    include("agreement.php");//test set contact(s)
+    exit;
+    //header("Location:$rootUrl/project.php?id=$id");
   } else {
-     include("$libDir/nav.php");
-     $zen->print_errors($errs);
-     include("$templateDir/newAgreementForm.php");
-     include("$libDir/footer.php");
+    include("$libDir/nav.php");
+    $zen->print_errors($errs);
+    include("$templateDir/newAgreementForm.php");
+    include("$libDir/footer.php");
   }
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/addContactSubmit.php zentrack_2-6-pre1/www/addContactSubmit.php
--- zentrack_2-5-5-2/www/addContactSubmit.php	2005-02-09 05:56:15.000000000 -0800
+++ zentrack_2-6-pre1/www/addContactSubmit.php	2005-10-20 11:23:48.000000000 -0700
@@ -6,10 +6,10 @@
   **
   */
     
-  include("header.php");
+  include("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
diff -Naur zentrack_2-5-5-2/www/addContacteSubmit.php zentrack_2-6-pre1/www/addContacteSubmit.php
--- zentrack_2-5-5-2/www/addContacteSubmit.php	2005-02-09 05:56:15.000000000 -0800
+++ zentrack_2-6-pre1/www/addContacteSubmit.php	2005-10-20 11:23:48.000000000 -0700
@@ -6,10 +6,10 @@
   **
   */
     
-  include("header.php");
+  include("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
diff -Naur zentrack_2-5-5-2/www/addProjectSubmit.php zentrack_2-6-pre1/www/addProjectSubmit.php
--- zentrack_2-5-5-2/www/addProjectSubmit.php	2005-05-15 16:45:03.000000000 -0700
+++ zentrack_2-6-pre1/www/addProjectSubmit.php	2005-07-29 12:13:15.000000000 -0700
@@ -46,19 +46,21 @@
         if( !$res ) {
           $errs[] = tr("? created, but variable fields could not be saved", array(tr('Project')));
         }
+      }
+      if( in_array($params["type_id"],$zen->noteTypeIDs()) ) {
+        $zen->close_ticket($id,null,null,'Notes closed automatically');
       }      
     }
   }
   
   if( !$errs ) {
-    $setmode = "tasks";
+    $setmode = "details";
     include("project.php");
     exit;
   } else {
     $onLoad[] = "behavior_js.php?formset=ticketForm";
     include("$libDir/nav.php");
     $zen->print_errors($errs);
-    $view = "project_create";
     include("$templateDir/newTicketForm.php");
     include("$libDir/footer.php");
   }
diff -Naur zentrack_2-5-5-2/www/addSubmit.php zentrack_2-6-pre1/www/addSubmit.php
--- zentrack_2-5-5-2/www/addSubmit.php	2005-05-15 16:45:03.000000000 -0700
+++ zentrack_2-6-pre1/www/addSubmit.php	2005-10-20 11:23:48.000000000 -0700
@@ -27,13 +27,16 @@
   $otime = date('Y-m-d H:i:s');  // set time ticket opened
 
   include("$libDir/validateFields.php");
-  
+
   if( !$errs ) {
     // create an array of existing fields
     // to be inserted for the ticket
     foreach(array_keys($fields) as $f) {
       if( strlen($$f) ) {
         $params["$f"] = $$f;
+        if( $f == 'title' && strlen($params["$f"]) > 50 ) {
+          $params["$f"] = substr($params["$f"],0,50);
+        }
       }
     }
     $params["creator_id"] = $login_id;
@@ -59,7 +62,9 @@
   }
   
   if( !$errs ) {
-    $setmode = "details";
+    $setmode = null;
+    $action = null;
+    $ticketTabAction = 0;
     include("ticket.php");
     exit;
     //header("Location:$rootUrl/ticket.php?id=$id");
diff -Naur zentrack_2-5-5-2/www/admin/admin_header.php zentrack_2-6-pre1/www/admin/admin_header.php
--- zentrack_2-5-5-2/www/admin/admin_header.php	2005-03-31 15:25:39.000000000 -0800
+++ zentrack_2-6-pre1/www/admin/admin_header.php	2005-10-21 03:59:54.000000000 -0700
@@ -1,13 +1,13 @@
 <?
 
+  define('ZT_SECTION', 'admin');
   include_once("../header.php");
   
-  $expand_admin = 1;
   $section = "Admin";
   $page_title = tr("Administration");
 
-  $system_name = $zen->settings["system_name"];
-  if( $zen->checkNum($login_level) < $zen->settings["level_settings"] ) {
+  $system_name = $zen->getSetting("system_name");
+  if( $zen->checkNum($login_level) < $zen->getSetting("level_settings") ) {
      $page_title = "Access Error";    
      $msg = "<p class='hot'>" . tr("You do not have access to administrate zenTrack.") . "</p>\n"; 
      include("$libDir/nav.php");     
@@ -60,6 +60,10 @@
     $cache_pulldown = array($max,$sel,$text);
     return $text;
   }
+  
+  function getPriCount( $current, $lowest ) {
+    return 1 + ($current - $lowest);
+  }
 
   /*
   ** SETTINGS ADMINISTRATION COMMON FIELDS
@@ -71,5 +75,7 @@
 			   "description" => "html"
 			   );
   $settings_required = array("name","value");
+  
+  if( !isset($TODO) ) { $TODO = null; }
 
 ?>
diff -Naur zentrack_2-5-5-2/www/admin/bins.php zentrack_2-6-pre1/www/admin/bins.php
--- zentrack_2-5-5-2/www/admin/bins.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/bins.php	2005-10-05 03:01:21.000000000 -0700
@@ -10,81 +10,57 @@
 
   include("admin_header.php");
 
-  if( $TODO == 'MORE' ) {
-    $more = $more+3;
-  } else if( $TODO == 'LESS' ) {
-    $more = $more-3;
-  }
-
   $vars = array();
-  if( $TODO == 'MORE' || $TODO == 'LESS' ) {
-    for( $i=0; $i<count($newBin); $i++ ) {
-      if( !$newBin[$i] && $newID[$i] ) {
-	$n = $newID[$i];
-	$newBin[$i] = $zen->bins["$n"];
-      }
-      if( $newBin[$i] ) {
-	$vars[] = array(
-			"bid"      => $newID[$i],
-			"name"     => $newBin[$i], 
-			"priority" => $newPri[$i], 
-			"active"   => $newActive[$i]
-			);
-      }
-    }
-  } else if( $TODO == 'Save' ) {
-    if( !is_array($newBin) || !count($newBin) ) {
+  if( $TODO == 'Save' ) {
+    if( !is_array($newName) || !count($newName) ) {
       $errs[] = tr("There was nothing provided to update");
     } else if( $zen->demo_mode == "on" ) {
       $msg = tr("Process completed successfully.  Bins were not updated since this is a demo site.");
       $skip = 1;
     } else {
-	$j = 0;
-      for( $i=0; $i<count($newBin); $i++ ) {
-	if( $newBin[$i] ) {
-	  $updateParams = array( 
-		"name"     => $newBin[$i],
-		"active"   => (strlen($newActive[$i])? $newActive[$i]:0),
-		"priority" => (strlen($newPri[$i])? $newPri[$i]:0)
-				);
-	  $res = ($newID[$i])?
-	    $zen->update_bin($newID[$i], $updateParams) :
-	    $zen->add_bin($updateParams);
-	  if( $res )
-	    $j++;
-	}
+      // find out the lowest count, so we can renumber all priorities
+      // from 1
+      $lowestCount = null;
+      $highestCount = null;
+      for($i=0; $i<count($newPri); $i++) {
+        if( !strlen($lowestCount) || $newPri[$i] < $lowestCount ) {
+          $lowestCount = $newPri[$i];
+        }
+        if( !strlen($highestCount) || $newPri[$i] > $highestCount ) {
+          $highestCount = $newPri[$i];
+        }
       }
-      $msg = tr("? bins were saved to the database. Updates complete", array($j));
+      
+      // iterate each item and perform updates
+      $j = 0;
+      $k = 0;
+      for( $i=0; $i<count($newName); $i++ ) {
+        if( $newName[$i] ) {
+          $updateParams = array( 
+          "name"     => $newName[$i],
+          "active"   => strlen($newActive[$i])? $newActive[$i] : 0,
+          "priority" => getPriCount($newPri[$i],$lowestCount)
+          );
+          $res = ($newID[$i])?
+          $zen->update_bin($newID[$i], $updateParams) :
+          $zen->add_bin($updateParams);
+          if( $res ) { $j++; }
+          $k++;
+        }
+      }
+      $msg = tr("? of ? bins were saved to the database. Updates complete", array($j,$k));
       $skip = 1;
     }
-  } else {
-    $vars = $zen->getBins(1,0);
-  }
-
-  if( $more > 10 ) {
-    $more = 10;
-  } else if( $more < 0 ) {
-    $more = 0;
   }
 
   $page_title = ($skip)? tr("Admin Section") : tr("Update Bins");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
-  if( !$skip ) {    
-    include("$templateDir/binForm.php");
-  } else {
-    include("$templateDir/adminMenu.php");
-  }
+  $vars = $zen->getBins(1,0);
+  $type = "bin";
+  $id_type = $zen->getTableId('bins');
+  include("$templateDir/configForm.php");
   
   include("$libDir/footer.php");
 
-}?>
-
-
-
-
-
-
-
-
-
+}?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/admin/config.php zentrack_2-6-pre1/www/admin/config.php
--- zentrack_2-5-5-2/www/admin/config.php	2005-02-09 05:56:15.000000000 -0800
+++ zentrack_2-6-pre1/www/admin/config.php	2005-10-20 11:23:48.000000000 -0700
@@ -67,10 +67,12 @@
   }
 
   if( !$skip ) {
-    $page_title = tr("? Settings", array($zen->settings["system_name"]));
+    $page_title = tr("? Settings", array($zen->getSetting("system_name")));
     include("$libDir/nav.php");
     $zen->printErrors($errs);
+    print "<blockquote>\n";
     include("$templateDir/configSettingsForm.php");
+    print "</blockquote>\n";
   } else {
     $page_title = "Admin Menu";
     include("$libDir/nav.php");
diff -Naur zentrack_2-5-5-2/www/admin/editUserSubmit.php zentrack_2-6-pre1/www/admin/editUserSubmit.php
--- zentrack_2-5-5-2/www/admin/editUserSubmit.php	2005-02-09 05:56:16.000000000 -0800
+++ zentrack_2-6-pre1/www/admin/editUserSubmit.php	2005-10-20 11:23:48.000000000 -0700
@@ -30,7 +30,7 @@
   if( $user_id == 1 && $access_level < 5 ) {
     $errs[] = tr("The root admin account must have access of 5 or greater");
   }
-  if( $user_id == 1 && $access_level < $zen->settings["level_settings"] ) {
+  if( $user_id == 1 && $access_level < $zen->getSetting("level_settings") ) {
     $errs[] = tr("The root admin access cannot be less than the level_settings parameter");
   }
   if( $user_id == 1 && !$active ) {
diff -Naur zentrack_2-5-5-2/www/admin/empty.gif zentrack_2-6-pre1/www/admin/empty.gif
--- zentrack_2-5-5-2/www/admin/empty.gif	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/admin/empty.gif	2005-10-08 00:48:46.000000000 -0700
@@ -0,0 +1 @@
+GIF89a       333ffffff3333ff333  f         33ff3 3 f3f33 ff f3ff3 f 3 3f f 3 fff33f333 ff    3f  33f f f3f3f f 3f f33 f3 f33 ff3f333ff33 3  f       33ff 3 33f3f 3f f3ff f3 f3 3 ff 3 f3ff3f3 33 ff   3f  33 ff 3ff 3f f3 f3f 3f 33f 3ff33f33ff33  3  f      33ff3 3 f3f33 ff f3f3 ff 3 3f f 3 ff3f3f33 3f f   3f  33 ff 3fff 3 f3 f3f 3f 33f 3                                                                                                                        !   ,        , ;
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/admin/fieldMap.php zentrack_2-6-pre1/www/admin/fieldMap.php
--- zentrack_2-5-5-2/www/admin/fieldMap.php	2005-05-15 16:45:03.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/fieldMap.php	2005-10-21 03:59:54.000000000 -0700
@@ -9,7 +9,6 @@
 
   include("admin_header.php");
   $page_title = tr("Edit Field Map");
-  include("$libDir/nav.php");
   function fmGetSet( $name, $key, $type = '' ) {
     // don't make updates on rows that don't exist (we may skip some fields occasionally
     if( !array_key_exists($name, $_POST) ) { return; }
@@ -34,142 +33,161 @@
       case "t": //text
         $v = strip_tags($_POST[$name][$key]);
         break;
+      case "s": //string
+        $v = $zen->checkAlphaNum($_POST[$name][$key]);
+        break;
       default:
         $v = $_POST[$name][$key];
     }
     $updates[$name][$key] = $v;
   }
 
-  if( !$view || !in_array($view, array_keys($GLOBALS['zt_field_dependencies']['views'])) ) {
-    $view = 'ticket_create';
+  if( $view && !$map->getViewProps($view) ) {
+    $view = '';
   }
 
   if( $TODO == 'save' && $zen->demo_mode == "on" ) {
     $errs[] = "Your operation was completed, but you cannot edit the field map on a demo site.";
   }
   else if( $TODO == 'save' ) {
+    $total = 0;
     $deletes = array();
     $inserts = array();
-    $vprops = getFmViewProps($view);
-
+    
     // copy values for editing
-    $allFields = $map->getFieldMap();
-    $updates = $allFields[$view];
-    unset($allFields);
+    $updates = $map->getFieldMap($view);
     //Zen::printArray($_POST, 'POST_VALS'); //debug
 
     $fields = $map->listFieldsForView($view);
-    foreach($fields as $f) {
-      // collect field properties
-      $field = $map->getFieldFromMap($view, $f);
-      $tprops = getFmTypeProps($field['field_type']);
-
-      // remove deleted sections
-      if( $field['field_type'] == 'section' && !isset($_POST[$f]) ) {
-        $deletes[$f] = $field['field_map_id'];
-      }
-      // skip rows that aren't sent
-      else if( !isset($_POST[$f]) ) { continue; }
-
-      // field_label
-      fmGetSet($f, 'field_label', 'text');
-      // is_visible
-      fmGetSet($f, 'is_visible', 'boolean');
-
-      // num_cols
-      fmGetSet($f, 'num_cols', 'int');
-
-      // num_rows
-      if( !$tprops['multiple'] && !$vprops['multiple'] ) {
-        $updates[$f]['num_rows'] = 1;
-      }
-      else { fmGetSet($f, 'num_rows', 'int'); }
-
-      // the rest does not apply to sections
-      if( $field['field_type'] == 'section' ) { continue; }
-
-      // properties for this field
-      $fprops = getFmFieldProps($view, ZenFieldMap::fieldName($f));
-
-      // field_type is automagic for view_only
-      if( $vprops['view_only'] ) { $updates[$f]['field_type'] = 'label'; }
-      // we don't give the user an option on the form, so don't bother here either
-      else if( count($fprops['types']) == 1 ) { $updates[$f]['field_type'] = $fprops['types'][0]; }
-      else if( array_key_exists('field_type', $_POST[$f]) &&
-               !in_array($_POST[$f]['field_type'], $fprops['types']) ) {
-        // here we have a problem, someone has tried to set a type that is
-        // not valid
-        $errs[] = "$f cannot be set to field_type '".$_POST[$f]['field_type']."'";
-      }
-      // otherwise we post it normally
-      else if( array_key_exists('field_type', $_POST[$f]) )
-        { fmGetSet($f, 'field_type'); }
-
-      // is_required
-      if( $vprops['view_only'] || $view == 'search_form' ) { $updates[$f]['is_required'] = false; }
-      else if( $fprops['always_required'] ) { $updates[$f]['is_required'] = true; }
-      else { fmGetSet($f, 'is_required', 'boolean'); }
-
-      // default_val has some special considerations
-      if( !$vprops['view_only'] ) {
-        if( $fprops['default'] ) { fmGetSet($f, 'default_val'); }
-      }
-    }
-
-    foreach($_POST as $k=>$v) {
-      if( strpos($k, 'section') === 0 && $vprops['sections'] && !array_key_exists($k,$updates) ) {
-        // skip section0, it's a template
-        if( $k == 'section0' ) { continue; }
-        // add the style
-        $inserts[$k] = array(
-          "field_name"  => $k,
-          "field_label" => strip_tags($_POST[$k]['field_label']),
-          "is_visible"  => $_POST[$k]['is_visible']? 1 : 0,
-          "which_view"  => $view,
-          "sort_order"  => 500,
-        );
-      }
-    }
-
-    // set the sort order
-    $i = 1;
-    asort($_POST['orderset']);
-    foreach( $_POST['orderset'] as $k=>$v ) {
-      if( array_key_exists($k, $updates) ) {
-        $updates[$k]['sort_order'] = $i++;
-      }
-      else if( array_key_exists($k, $inserts) ) {
-        $inserts[$k]['sort_order'] = $i++;
+    if( $fields ) {
+      foreach($fields as $f) {
+        // collect field properties
+        $field = $map->getFieldFromMap($view, $f);
+        $tprops = getFmTypeProps($field['field_type']);
+  
+        // remove deleted sections
+        if( $field['field_type'] == 'section' && !isset($_POST[$f]) ) {
+          $deletes[$f] = $field['field_map_id'];
+        }
+        // skip rows that aren't sent
+        else if( !isset($_POST[$f]) ) { continue; }
+  
+        // field_label
+        fmGetSet($f, 'field_label', 'text');
+        // is_visible
+        fmGetSet($f, 'is_visible', 'boolean');
+  
+        // num_cols
+        fmGetSet($f, 'num_cols', 'int');
+  
+        // num_rows
+        if( !$tprops['multiple'] && !$map->getViewProp($view,'multiple') ) {
+          $updates[$f]['num_rows'] = 1;
+        }
+        else { fmGetSet($f, 'num_rows', 'int'); }
+  
+        // the rest does not apply to sections
+        if( $field['field_type'] == 'section' ) { continue; }
+  
+        // properties for this field
+        $fprops = getFmFieldProps($view, ZenFieldMap::fieldName($f));
+  
+        // field_type is automagic for view_only
+        if( $map->getViewProp($view,'view_only') ) { $updates[$f]['field_type'] = 'label'; }
+        // we don't give the user an option on the form, so don't bother here either
+        else if( count($fprops['types']) == 1 ) { $updates[$f]['field_type'] = $fprops['types'][0]; }
+        else if( array_key_exists('field_type', $_POST[$f]) &&
+                 !in_array($_POST[$f]['field_type'], $fprops['types']) ) {
+          // here we have a problem, someone has tried to set a type that is
+          // not valid
+          $errs[] = "$f cannot be set to field_type '".$_POST[$f]['field_type']."'";
+        }
+        // otherwise we post it normally
+        else if( array_key_exists('field_type', $_POST[$f]) )
+          { fmGetSet($f, 'field_type'); }
+  
+        // is_required
+        if( $map->getViewProp($view,'view_only') || $view == 'search_form' ) { $updates[$f]['is_required'] = false; }
+        else if( $fprops['always_required'] ) { $updates[$f]['is_required'] = true; }
+        else { fmGetSet($f, 'is_required', 'boolean'); }
+  
+        // default_val has some special considerations
+        if( !$map->getViewProp($view, 'view_only') ) {
+          if( $fprops['default'] || preg_match('@(ticket|project)_list_filters@', $view) ) { fmGetSet($f, 'default_val'); }
+        }
+      }
+
+      if( isset($_POST) ) {
+        foreach($_POST as $k=>$v) {
+          if( strpos($k, 'section') === 0 && $map->getViewProp($view,'sections') && !array_key_exists($k,$updates) ) {
+            // skip section0, it's a template
+            if( $k == 'section0' ) { continue; }
+            // add the style
+            $inserts[$k] = array(
+              "field_name"  => $k,
+              "field_label" => strip_tags($_POST[$k]['field_label']),
+              "is_visible"  => $_POST[$k]['is_visible']? 1 : 0,
+              "which_view"  => $view,
+              "sort_order"  => 500,
+            );
+          }
+        }
+      }
+  
+      // set the sort order
+      $i = 1;
+      if( isset($_POST['orderset']) ) {
+        asort($_POST['orderset']);
+        foreach( $_POST['orderset'] as $k=>$v ) {
+          if( array_key_exists($k, $updates) ) {
+            $updates[$k]['sort_order'] = $i++;
+          }
+          else if( array_key_exists($k, $inserts) ) {
+            $inserts[$k]['sort_order'] = $i++;
+          }
+        }
       }
-    }
-
-    $total = count($updates) + count($inserts) + count($deletes);
-    if( !$total && !$errs ) {
-      $errs[] = "Nothing to update";
+      
+      $total = count($updates) + count($inserts) + count($deletes);
     }
     if( !$errs ) {
-      $res = $map->updateFieldMap($view, $updates, $inserts, $deletes);
-      print "<p><b>$res[0] of $res[1] updates were saved</b></p>\n";
+      $viewProps = $map->getViewProps($view);
+      $viewUpdates = array();
+      foreach($viewProps as $k=>$v) {
+        if( $v['vm_type'] == 'label' || $v['vm_type'] == 'hidden' ) { continue; }
+        if( $v['vm_type'] == 'checkbox' ) {
+          $viewUpdates[$k] = isset($_POST[$k]);
+        }
+        else {
+          $viewUpdates[$k] = $_POST[$k];
+        }
+      }
+
+      if( !$total && !count($viewUpdates) ) {
+        $errs[] = "Nothing to update";
+      }
+      if( count($viewUpdates) ) {
+        $res = $map->updateViewProps($view, $viewUpdates);
+        $msg[] = tr("? of ? properties were updated successfully",$res);
+      }
+      if( $total ) {
+        $res = $map->updateFieldMap($view, $updates, $inserts, $deletes);
+        $msg[] = tr("? of ? fields were updated successfully",$res);
+      }
     }
-
+    
     //cfalonso changed the following line with the next 3 because it didn't work properly:
     //$fields = $updates;
-    $fields = $map->getFieldMap($view);
     //Zen::printArray($orderset,'RECEIVED ORDERSET');
     //Zen::printArray($updates,'UPDATES');
     //Zen::printArray($inserts,'INSERTS');
     //Zen::printArray($deletes,'DELETES');
 
   }
-  else {
-    $fields = $map->getFieldMap($view);
-  }
 
+  include("$libDir/nav.php");
   $zen->printErrors($errs);
-
   include("$templateDir/fieldMapForm.php");
-
   include("$libDir/footer.php");
 
-
 ?>
diff -Naur zentrack_2-5-5-2/www/admin/priorities.php zentrack_2-6-pre1/www/admin/priorities.php
--- zentrack_2-5-5-2/www/admin/priorities.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/priorities.php	2005-10-05 03:01:21.000000000 -0700
@@ -9,73 +9,67 @@
 
   include("admin_header.php");
 
-  if( $TODO == 'MORE' ) {
-    $more = $more+3;
-  } else if( $TODO == 'LESS' ) {
-    $more = $more-3;
-  }
-
   $vars = array();
-  if( $TODO == 'MORE' || $TODO == 'LESS' ) {
-    for( $i=0; $i<count($newName); $i++ ) {
-      if( !$newName[$i] && $newID[$i] ) {
-	$n = $newID[$i];
-	$newName[$i] = $zen->bins["$n"];
-      }
-      if( $newName[$i] ) {
-	$vars[] = array(
-			"pid"      => $newID[$i],
-			"name"     => $newName[$i], 
-			"priority" => $newPri[$i], 
-			"active"   => $newActive[$i]
-			);
-      }
-    }
-  } else if( $TODO == 'Save' ) {
+  if( $TODO == 'Save' ) {
+    
     if( !is_array($newName) || !count($newName) ) {
       $errs[] = tr("There was nothing provided to update");
     } else if( $zen->demo_mode == "on" ) {
       $msg = tr("Process completed successfully.  Priorities were not updated since this is a demo site.");
       $skip = 1;
     } else {
-	$j = 0;
+      // It is critical that priorities are numbered sequentially, so we will
+      // index, sort, and renumber them to be sure they are accurate and correct
+      $priVals = array();
+      for($i=0; $i<count($newPri); $i++) {
+        $n = $newName[$i];
+        // this little doozie sets all inactive priorities to an impossible
+        // negative number so that we can tell them apart after sorting
+        $priVals[$n] = isset($newActive[$i])? $newPri[$i] : 0-count($newPri)-100;
+      }
+      asort( $priVals );
+      
+      // now that we know the order of the priorities, we will assign
+      // sequential numbers to them
+      $newCount = 1;
+      foreach($priVals as $k=>$v) {
+        if( $v == 0-count($newPri)-100 ) {
+          // inactive items get set to 0
+          $priVals[$k] = 0;
+        }
+        else {
+          $priVals[$k] = $newCount++;
+        }
+      }
+      
+      $j = 0;
       for( $i=0; $i<count($newName); $i++ ) {
-	if( $newName[$i] ) {
-	  $updateParams = array( 
-				"name"     => $newName[$i],
-				"active"   => (strlen($newActive[$i])?$newActive[$i]:0),
-				"priority" => (strlen($newPri[$i])?$newPri[$i]:0)
-				);
-	  $res = ($newID[$i])?
-	    $zen->update_priority($newID[$i], $updateParams) :
-	    $zen->add_priority($updateParams);
-	  if( $res )
-	    $j++;
-	}
+        if( $newName[$i] ) {
+          $n = $newName[$i];
+          $updateParams = array( 
+          "name"     => $n,
+          "active"   => isset($newActive[$i])? $newActive[$i] : 0,
+          "priority" => $priVals[$n]
+          );
+          $res = ($newID[$i])?
+          $zen->update_priority($newID[$i], $updateParams) :
+          $zen->add_priority($updateParams);
+          if( $res )
+          $j++;
+        }
       }
       $msg = tr("? priorities were saved to the database. Updates complete", array($j));
       $skip = 1;
     }
-  } else {
-    $vars = $zen->getPriorities(1,0);
-  }
-
-  if( $more > 10 ) {
-    $more = 10;
-  } else if( $more < 0 ) {
-    $more = 0;
   }
 
   $page_title = ($skip)? tr("Admin Section") : tr("Update Priorities");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
-  if( !$skip ) {  
-    $type = "priority";
-    $id_type = "pid";
-    include("$templateDir/configForm.php");
-  } else {
-    include("$templateDir/adminMenu.php");
-  }
+  $type = "priority";
+  $id_type = "pid";
+  $vars = $zen->getPriorities(1,0);
+  include("$templateDir/configForm.php");
   
   include("$libDir/footer.php");
 
diff -Naur zentrack_2-5-5-2/www/admin/systems.php zentrack_2-6-pre1/www/admin/systems.php
--- zentrack_2-5-5-2/www/admin/systems.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/systems.php	2005-10-05 03:01:21.000000000 -0700
@@ -9,73 +9,55 @@
 
   include("admin_header.php");
 
-  if( $TODO == 'MORE' ) {
-    $more = $more+3;
-  } else if( $TODO == 'LESS' ) {
-    $more = $more-3;
-  }
-
   $vars = array();
-  if( $TODO == 'MORE' || $TODO == 'LESS' ) {
-    for( $i=0; $i<count($newName); $i++ ) {
-      if( !$newName[$i] && $newID[$i] ) {
-	$n = $newID[$i];
-	$newName[$i] = $zen->bins["$n"];
-      }
-      if( $newName[$i] ) {
-	$vars[] = array(
-			"sid"      => $newID[$i],
-			"name"     => $newName[$i], 
-			"priority" => $newPri[$i], 
-			"active"   => $newActive[$i]
-			);
-      }
-    }
-  } else if( $TODO == 'Save' ) {
+  if( $TODO == 'Save' ) {
     if( !is_array($newName) || !count($newName) ) {
       $errs[] = tr("There was nothing provided to update");
     } else if( $zen->demo_mode == "on" ) {
       $msg = tr("Process completed successfully.  Systems were not updated since this is a demo site.");
       $skip = 1;
     } else {
-	$j = 0;
+      // find out the lowest count, so we can renumber all priorities
+      // from 1
+      $lowestCount = null;
+      $highestCount = null;
+      for($i=0; $i<count($newPri); $i++) {
+        if( !strlen($lowestCount) || $newPri[$i] < $lowestCount ) {
+          $lowestCount = $newPri[$i];
+        }
+        if( !strlen($highestCount) || $newPri[$i] > $highestCount ) {
+          $highestCount = $newPri[$i];
+        }
+      }
+      
+      $j = 0;
+      $k = 0;
       for( $i=0; $i<count($newName); $i++ ) {
-	if( $newName[$i] ) {
-	  $updateParams = array( 
-				"name"     => $newName[$i],
-				"active"   => (strlen($newActive[$i])?$newActive[$i]:0),
-				"priority" => (strlen($newPri[$i])?$newPri[$i]:0)
-				);
-	  $res = ($newID[$i])?
-	    $zen->update_system($newID[$i], $updateParams) :
-	    $zen->add_system($updateParams);
-	  if( $res )
-	    $j++;
-	}
+        if( $newName[$i] ) {
+          $updateParams = array( 
+          "name"     => $newName[$i],
+          "active"   => (strlen($newActive[$i])?$newActive[$i]:0),
+          "priority" => getPriCount($newPri[$i],$lowestCount)
+          );
+          $res = ($newID[$i])?
+          $zen->update_system($newID[$i], $updateParams) :
+          $zen->add_system($updateParams);
+          if( $res ) { $j++; }
+          $k++;
+        }
       }
-      $msg = tr("? systems were saved to the database. Updates complete", array($j));
+      $msg = tr("? of ? systems were saved to the database", array($j, $k));
       $skip = 1;
     }
-  } else {
-    $vars = $zen->getSystems(1,0);
-  }
-
-  if( $more > 10 ) {
-    $more = 10;
-  } else if( $more < 0 ) {
-    $more = 0;
   }
 
   $page_title = ($skip)? tr("Admin Section") : tr("Update Systems");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
-  if( !$skip ) {  
-    $type = "system";
-    $id_type = $zen->getTableId('systems');	
-    include("$templateDir/configForm.php");
-  } else {
-    include("$templateDir/adminMenu.php");
-  }
+  $type = "system";
+  $vars = $zen->getSystems(1,0);
+  $id_type = $zen->getTableId('systems');	
+  include("$templateDir/configForm.php");
   
   include("$libDir/footer.php");
 
diff -Naur zentrack_2-5-5-2/www/admin/tasks.php zentrack_2-6-pre1/www/admin/tasks.php
--- zentrack_2-5-5-2/www/admin/tasks.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/tasks.php	2005-10-05 03:01:21.000000000 -0700
@@ -9,73 +9,54 @@
 
   include("admin_header.php");
 
-  if( $TODO == 'MORE' ) {
-    $more = $more+3;
-  } else if( $TODO == 'LESS' ) {
-    $more = $more-3;
-  }
-
   $vars = array();
-  if( $TODO == 'MORE' || $TODO == 'LESS' ) {
-    for( $i=0; $i<count($newName); $i++ ) {
-      if( !$newName[$i] && $newID[$i] ) {
-	$n = $newID[$i];
-	$newName[$i] = $zen->bins["$n"];
-      }
-      if( $newName[$i] ) {
-	$vars[] = array(
-			"task_id"      => $newID[$i],
-			"name"     => $newName[$i], 
-			"priority" => $newPri[$i], 
-			"active"   => $newActive[$i]
-			);
-      }
-    }
-  } else if( $TODO == 'Save' ) {
+  if( $TODO == 'Save' ) {
     if( !is_array($newName) || !count($newName) ) {
       $errs[] = tr("There was nothing provided to update");
     } else if( $zen->demo_mode == "on" ) {
       $msg = tr("Process completed successfully.  Tasks were not updated since this is a demo site.");
       $skip = 1;
     } else {
-	$j = 0;
+      // find out the lowest count, so we can renumber all priorities
+      // from 1
+      $lowestCount = null;
+      $highestCount = null;
+      for($i=0; $i<count($newPri); $i++) {
+        if( !strlen($lowestCount) || $newPri[$i] < $lowestCount ) {
+          $lowestCount = $newPri[$i];
+        }
+        if( !strlen($highestCount) || $newPri[$i] > $highestCount ) {
+          $highestCount = $newPri[$i];
+        }
+      }
+      
+      $j = 0;
       for( $i=0; $i<count($newName); $i++ ) {
-	if( $newName[$i] ) {
-	  $updateParams = array( 
-				"name"     => $newName[$i],
-				"active"   => (strlen($newActive[$i])?$newActive[$i]:0),
-				"priority" => (strlen($newPri[$i])?$newPri[$i]:0)
-				);
-	  $res = ($newID[$i])?
-	    $zen->update_task($newID[$i], $updateParams) :
-	    $zen->add_task($updateParams);
-	  if( $res )
-	    $j++;
-	}
+        if( $newName[$i] ) {
+          $updateParams = array( 
+          "name"     => $newName[$i],
+          "active"   => (strlen($newActive[$i])? $newActive[$i]:0),
+          "priority" => getPriCount($newPri[$i], $lowestCount)
+          );
+          $res = ($newID[$i])?
+          $zen->update_task($newID[$i], $updateParams) :
+          $zen->add_task($updateParams);
+          if( $res )
+          $j++;
+        }
       }
       $msg = tr("? tasks were saved to the database. Updates complete", array($j));
       $skip = 1;
     }
-  } else {
-    $vars = $zen->getTasks(1,0);
   }
-
-  if( $more > 10 ) {
-    $more = 10;
-  } else if( $more < 0 ) {
-    $more = 0;
-  }
-
+  
   $page_title = ($skip)? tr("Admin Section") : tr("Update Tasks");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
-  if( !$skip ) {  
-    $type = "task";
-    $id_type = "task_id";
-    include("$templateDir/configForm.php");
-  } else {
-    include("$templateDir/adminMenu.php");
-  }
+  $type = "task";
+  $id_type = "task_id";
+  $vars = $zen->getTasks(1,0);
+  include("$templateDir/configForm.php");
   
   include("$libDir/footer.php");
 
diff -Naur zentrack_2-5-5-2/www/admin/types.php zentrack_2-6-pre1/www/admin/types.php
--- zentrack_2-5-5-2/www/admin/types.php	2003-07-30 00:25:08.000000000 -0700
+++ zentrack_2-6-pre1/www/admin/types.php	2005-10-05 03:01:21.000000000 -0700
@@ -9,73 +9,54 @@
 
   include("admin_header.php");
 
-  if( $TODO == 'MORE' ) {
-    $more = $more+3;
-  } else if( $TODO == 'LESS' ) {
-    $more = $more-3;
-  }
-
   $vars = array();
-  if( $TODO == 'MORE' || $TODO == 'LESS' ) {
-    for( $i=0; $i<count($newName); $i++ ) {
-      if( !$newName[$i] && $newID[$i] ) {
-	$n = $newID[$i];
-	$newName[$i] = $zen->bins["$n"];
-      }
-      if( $newName[$i] ) {
-	$vars[] = array(
-			"type_id"      => $newID[$i],
-			"name"     => $newName[$i], 
-			"priority" => $newPri[$i], 
-			"active"   => $newActive[$i]
-			);
-      }
-    }
-  } else if( $TODO == 'Save' ) {
+  if( $TODO == 'Save' ) {
     if( !is_array($newName) || !count($newName) ) {
       $errs[] = tr("There was nothing provided to update");
     } else if( $zen->demo_mode == "on" ) {
       $msg = tr("Process completed successfully.  Types were not updated since this is a demo site.");
       $skip = 1;
     } else {
-	$j = 0;
+      // find out the lowest count, so we can renumber all priorities
+      // from 1
+      $lowestCount = null;
+      $highestCount = null;
+      for($i=0; $i<count($newPri); $i++) {
+        if( !strlen($lowestCount) || $newPri[$i] < $lowestCount ) {
+          $lowestCount = $newPri[$i];
+        }
+        if( !strlen($highestCount) || $newPri[$i] > $highestCount ) {
+          $highestCount = $newPri[$i];
+        }
+      }
+      
+      $j = 0;
       for( $i=0; $i<count($newName); $i++ ) {
-	if( $newName[$i] ) {
-	  $updateParams = array( 
-				"name"     => $newName[$i],
-				"active"   => (strlen($newActive[$i])?$newActive[$i]:0),
-				"priority" => (strlen($newPri[$i])?$newPri[$i]:0)
-				);
-	  $res = ($newID[$i])?
-	    $zen->update_type($newID[$i], $updateParams) :
-	    $zen->add_type($updateParams);
-	  if( $res )
-	    $j++;
-	}
+        if( $newName[$i] ) {
+          $updateParams = array( 
+          "name"     => $newName[$i],
+          "active"   => (strlen($newActive[$i])?$newActive[$i]:0),
+          "priority" => getPriCount($newPri[$i], $lowestCount)
+          );
+          $res = ($newID[$i])?
+          $zen->update_type($newID[$i], $updateParams) :
+          $zen->add_type($updateParams);
+          if( $res )
+          $j++;
+        }
       }
       $msg = tr("? types were saved to the database. Updates complete", array($j));
       $skip = 1;
     }
-  } else {
-    $vars = $zen->getTypes(1,0);
-  }
-
-  if( $more > 10 ) {
-    $more = 10;
-  } else if( $more < 0 ) {
-    $more = 0;
   }
 
   $page_title = ($skip)? tr("Admin Section") : tr("Update Types");
   include("$libDir/nav.php");
   $zen->printErrors($errs);
-  if( !$skip ) {  
-    $type = "type";
-    $id_type = "type_id";
-    include("$templateDir/configForm.php");
-  } else {
-    include("$templateDir/adminMenu.php");
-  }
+  $type = "type";
+  $id_type = "type_id";
+  $vars = $zen->getTypes(1,0);
+  include("$templateDir/configForm.php");
   
   include("$libDir/footer.php");
 
diff -Naur zentrack_2-5-5-2/www/agreement.php zentrack_2-6-pre1/www/agreement.php
--- zentrack_2-5-5-2/www/agreement.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-6-pre1/www/agreement.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,15 +7,10 @@
   */
   
   // include the header file
-  if( file_exists("header.php") ) {
-    include_once("header.php");
-  }
-  else if( file_exists("../header.php") ) {
-    include_once("../header.php");
-  }
+  include_once("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
@@ -31,10 +26,16 @@
   
   $agree = $zen->get_contact($id,"ZENTRACK_AGREEMENT","agree_id");
 
+    
+  // place record into history of recently viewed items
+  $history =& $zen->getHistoryManager();
+  $history->storeItem('agreement', $id, $zen->getDataTypeLabel('ZENTRACK_AGREEMENT', $agree));
   
   $page_section = "Agreement $id";
   $expand_agreement = 1;
   
+  $hotkeys->loadSection('agreement_view');
+  
   /*
   ** PRINT OUT THE PAGE
   */ 
diff -Naur zentrack_2-5-5-2/www/agreements.php zentrack_2-6-pre1/www/agreements.php
--- zentrack_2-5-5-2/www/agreements.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-6-pre1/www/agreements.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,10 +7,10 @@
   */
   
   
-  include("header.php");
+  include("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
diff -Naur zentrack_2-5-5-2/www/assignedProjects.php zentrack_2-6-pre1/www/assignedProjects.php
--- zentrack_2-5-5-2/www/assignedProjects.php	2005-05-01 23:59:39.000000000 -0700
+++ zentrack_2-6-pre1/www/assignedProjects.php	2005-07-29 12:13:15.000000000 -0700
@@ -30,9 +30,10 @@
   } else {
     $params["bin_id"] = $zen->getUsersBins($login_id);
   }
-  if( is_array($params) )
-    $tickets = $zen->get_tickets($params);
     
+  include_once("$libDir/sorting.php");
+  if( is_array($params) )
+    $tickets = $zen->get_tickets($params, join(',',$orderby));
   include("$templateDir/listTickets.php");
 
   include("$libDir/footer.php");
diff -Naur zentrack_2-5-5-2/www/assignedTickets.php zentrack_2-6-pre1/www/assignedTickets.php
--- zentrack_2-5-5-2/www/assignedTickets.php	2005-03-08 13:09:36.000000000 -0800
+++ zentrack_2-6-pre1/www/assignedTickets.php	2005-07-29 12:13:15.000000000 -0700
@@ -23,7 +23,8 @@
     $params["bin_id"] = $login_bin;
   }
 
-  $tickets = $zen->get_tickets($params);
+  include_once("$libDir/sorting.php");
+  $tickets = $zen->get_tickets($params, join(',',$orderby));
   include("$templateDir/listTickets.php");
   include("$libDir/paging.php"); //Addition for paging
 
diff -Naur zentrack_2-5-5-2/www/behavior_js.php zentrack_2-6-pre1/www/behavior_js.php
--- zentrack_2-5-5-2/www/behavior_js.php	2005-04-13 09:11:44.000000000 -0700
+++ zentrack_2-6-pre1/www/behavior_js.php	2005-07-29 12:13:15.000000000 -0700
@@ -10,7 +10,7 @@
   include_once(dirname(__FILE__)."/header.php");  
   $behaviors = $zen->getBehaviorList();
   $groups = $_SESSION['data_groups'];
-  
+
   /**
    * Generate field info for behaviors
    *
@@ -145,6 +145,21 @@
   this.label = label;
 }
 
+<?
+  // Generate an array of possible values that can be accessed from Javascript
+  $possible_variables=array('login_id',
+                            'login_name',
+                            'login_language',
+                            'login_inits',
+                            'username');
+  print "var jsVarNames = new Array();\n";
+  print "var jsVarValues = new Array();\n";
+  foreach ($possible_variables as $vn) {
+    $vv=$$vn;
+    print "  jsVarNames[ jsVarNames.length ] = ".$zen->fixJsVal( $vn ).";\n";
+    print "  jsVarValues[ ".$zen->fixJsVal( $vn )." ] = ".$zen->fixJsVal( $vv ).";\n";
+  }
+?>
 var groupMap = new Array();
 var behaviorMap = new Array();
 <?
@@ -191,14 +206,14 @@
         $sets = $zen->getBehaviorFileSet( $b, $group, $userBins, $mode );
         if( $sets && count($sets) ) {
           foreach($sets as $setid=>$vals) {
-            genBehaviorFields($bid, $vals['matches'], &$fieldMap, $setid); 
+            genBehaviorFields($bid, $vals['matches'], $fieldMap, $setid); 
             genGroupFields($group['group_id'], $vals['values'], $setid);
           }
         }
       }
       else {
         // if this is not a file group, then we have a simple match pattern here
-        genBehaviorFields($bid, $b['fields'], &$fieldMap);
+        genBehaviorFields($bid, $b['fields'], $fieldMap);
         genGroupFields($group['group_id'], $group['fields']);
       }
     }
@@ -322,8 +337,12 @@
 
   var fieldObj = formObj[ behavior.field ];
   if( !fieldObj ) {
-    behaviorDebug(1, "(executeBehavior)Behavior field invalid: "+formObj.name+"."+behavior.field);
-    return false;
+    behavior.field = behavior.field + "[]";
+    fieldObj = formObj[ behavior.field ];
+    if( !fieldObj ) {
+      behaviorDebug(1, "(executeBehavior)Behavior field invalid: "+formObj.name+"."+behavior.field);
+      return false;
+    }
   }
 
   // note that this behavior was executed
@@ -397,6 +416,15 @@
     var f = 'window.document.'+fieldObj.form.getAttribute('name');
     var fn = f+'.'+fieldObj.name
     var s = unescape(group.evalText);
+    behaviorDebug(3, "(setFormValsUsingGroup)initial evalText: "+s);
+    var myReplaceText;
+    var myRegExp;
+    for (var i=0; i < jsVarNames.length; i++) {
+      myReplaceText = '\{'+jsVarNames[i]+'\}';
+      myRegExp = new RegExp(myReplaceText, "ig")  
+      s = s.replace( myRegExp, jsVarValues[jsVarNames[i]] );
+      behaviorDebug(3, '(setFormValsUsingGroup)replacing evalText ('+myRegExp+' by '+jsVarValues[jsVarNames[i]]+') results in : '+s);
+    }
     s = s.replace( /\{form\}.\{field\}/ig, "{field}" );
     s = s.replace( /{form}/ig, f);
     var vals = evalJsString( s.replace(/{field}/ig, fn) );
@@ -460,18 +488,28 @@
     case "hidden":
       var labelText = document.getElementById(fieldObj.name+"LabelText");
       if( labelText ) {
-        labelText.innerHTML = fields[oldPos].label;
+        labelText.innerHTML = fields.length>0?fields[oldPos].label : "";
+        if (fields.length>0) {
+          labelText.innerHTML = fields[oldPos].value;
+        } else {
+          behaviorDebug(3, "(setFormValsUsingGroup) Empty string forced for "+fieldObj.name+"LabelText.innerHTML");
+          labelText.innerHTML = "";
+        }
       }
     case "button":
     case "submit":
     case "text":
     case "textarea":
-      fieldObj.value = fields[oldPos].value;
+      if (fields.length>0) {
+        fieldObj.value = fields[oldPos].value;
+      } else {
+        behaviorDebug(3, "(setFormValsUsingGroup) Empty string forced for "+fieldObj.name+".value");
+        fieldObj.value = "";
+      }
       break;
     case "select":
     case "select-one":
-    case "select-multiple":
-      if( fieldObj.selectedIndex && fieldObj.options && fieldObj.options.length > 0 ) {
+      if( fieldObj.selectedIndex != -1 && fieldObj.options && fieldObj.options.length > 0 ) {
         // store the currently selected value and try to reproduce in a minute
         var oldValue = fieldObj.options[ fieldObj.selectedIndex ].value;
         behaviorDebug(3, "(setFormValsUsingGroup)storing oldValue="+oldValue);
@@ -491,6 +529,54 @@
         }
       }
       break;
+    case "select-multiple":
+      var oldValues = new Array();
+      if( fieldObj.options && fieldObj.options.length > 0 ) {
+        // store the currently selected value and try to reproduce in a minute
+        for (var i=0; i< fieldObj.options.length; i++) {
+          if (fieldObj.options[i].selected) {
+            oldValues[fieldObj.options[i].value]=1;
+            behaviorDebug(3, "(setFormValsUsingGroup)storing oldValues["+fieldObj.options[i].value+"] = 1");
+          }
+        }
+      }
+
+      fieldObj.length = 0;
+      for(var i=0; i < fields.length; i++) {
+        var f = fields[i];
+        behaviorDebug(3, "(setFormValsUsingGroup)Setting option "+i+" to ["+f.value+"]"+f.label);
+        fieldObj.options[i] = new Option();
+        fieldObj.options[i].text = f.label;
+        fieldObj.options[i].value = f.value;
+        // try to set to the same value if possible
+        if( oldValues[f.value]==1 ) {
+          fieldObj.options[i].selected = true;
+//          fieldObj.selectedIndex=i;
+        }
+      }
+
+      var labelText = document.getElementById(fieldObj.name+"LabelText");
+      if( labelText ) {
+        labelText.innerHTML = fields.length>0?fields[oldPos].label : "";
+        if (fields.length>0) {
+          if( fieldObj.options && fieldObj.options.length > 0 ) {
+            // store the currently selected value and try to reproduce in a minute
+            separator = "";
+            labelText.innerHTML = "";
+            for (var i=0; i< fieldObj.options.length; i++) {
+              if (fieldObj.options[i].selected) {
+                labelText.innerHTML = labelText.innerHTML + separator + fieldObj.options[i].value;
+                separator = "; ";
+                behaviorDebug(3, "(setFormValsUsingGroup)added "+fieldObj.options[i].value+"to "+fieldObj.name+"LabelText.innerHTML");
+              }
+            }
+          }
+        } else {
+          behaviorDebug(3, "(setFormValsUsingGroup) Empty string forced for "+fieldObj.name+"LabelText.innerHTML");
+          labelText.innerHTML = "";
+        }
+      }
+      break;
     //case "radio":
     //case "file":
     //case "hidden":
@@ -742,6 +828,7 @@
   // clear the behavior flags from any previous uses
   clearBehaviorFlags();
 
+
   var behaviorFormSet = new Array(<?
     if( $_GET['formset'] ) {
       $sep = false;
@@ -864,6 +951,7 @@
   return x;
 }
 
+
 window.onload = mergeFunctions( window.onload, pageLoadedBehavior );
 
 <?
diff -Naur zentrack_2-5-5-2/www/contact.php zentrack_2-6-pre1/www/contact.php
--- zentrack_2-5-5-2/www/contact.php	2005-04-25 05:44:12.000000000 -0700
+++ zentrack_2-6-pre1/www/contact.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,15 +7,10 @@
   */
   
   // include the header file
-  if( file_exists("header.php") ) {
-    include_once("header.php");
-  }
-  else if( file_exists("../header.php") ) {
-    include_once("../header.php");
-  }
+  include_once("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
@@ -23,10 +18,12 @@
 $id = NULL;
   
   if($pid){
+    $ctype = 'employee';
 		$table = "ZENTRACK_EMPLOYEE";
 		$col = "person_id";
 		$id = $pid;
 	} elseif($cid) {
+    $ctype = 'company';
 		$table = "ZENTRACK_COMPANY";
 		$col = "company_id";
 		$id = $cid;
@@ -45,6 +42,10 @@
   */
   
   $contacts = $zen->get_contact($id,$table,$col);
+  $history =& $zen->getHistoryManager();
+  
+  // place record into history of recently viewed items
+  $history->storeItem($ctype, $id, $zen->getDataTypeLabel($table, $contacts));
 
   
   $page_section = "Contact $id";
@@ -62,14 +63,15 @@
 	    	include("$templateDir/contact_personBox.php"); 
 	    	if($overview=="tickets") {
           //collect field map info
-          $view = 'ticket_list';
-          $fields = $map->getFieldMap($view);
-		    	//sort tickets
-          include("$libDir/sorting.php");
+          $view = 'contact_list';
+          
+          // creates the $sortby variable describing how columns will be sorted
+          include_once("$libDir/sorting.php");
+          
           // collect open tickets
-          $tickets = $zen->getTicketsByPerson($id, join(',',$orderby));
-					//$tickets = $zen->get_open_tickets($id,"2");
+          $tickets = $zen->getTicketsByPerson($id, $sortstring);
 					
+          //$tickets = $zen->get_open_tickets($id,"2");
           include("$templateDir/listTickets.php");
 	    	}
 	    	
@@ -78,32 +80,25 @@
 			
 				if ($overview=="agreement"){
 					//show the related agreements
-					$parms = array(1 => array(1 => "company_id", 2 => "=", 3 => $id),
-													2 => array(1 => "status", 2 => "=", 3 => "1"),												
-					);
+					$parms = array(array("company_id","=",$id),
+													array("status","=","1") );
 					$contacts = $zen->get_contacts($parms,"ZENTRACK_AGREEMENT","contractnr asc");	
-					if( is_array($contacts) && count($contacts) ) {
-	  				include("$templateDir/agreement_list.php");
-  				}
+          include("$templateDir/agreement_list.php");
 				} elseif ($overview=="tickets") {
           //collect field map info
-          $view = 'ticket_list';
-          $fields = $map->getFieldMap($view);
+          $view = 'contact_list';
+
           // sort tickets
           include("$libDir/sorting.php");
 					//show open tickets
 					//$tickets = $zen->get_open_tickets($id,"1");
           $tickets = $zen->getTicketsByCompany($id,join(',',$orderby));
-					echo "<br>";
           include("$templateDir/listTickets.php");
 				} else {
 					//show the related contacts
-					$parms = array(1 => array(1 => "company_id", 2 => "=", 3 => $id),
-					);
+					$parms = array(array("company_id","=",$id));
 					$contacts = $zen->get_contacts($parms,"ZENTRACK_EMPLOYEE","lname asc");	
-    			if( is_array($contacts) && count($contacts) ) {
-	  				include("$templateDir/contact_list.php"); 
-  				}
+          include("$templateDir/contact_list.php"); 
 		  	}
 		  }
 	   
diff -Naur zentrack_2-5-5-2/www/contact_header.php zentrack_2-6-pre1/www/contact_header.php
--- zentrack_2-5-5-2/www/contact_header.php	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/contact_header.php	2005-10-21 03:59:54.000000000 -0700
@@ -0,0 +1,13 @@
+<?
+  define('ZT_SECTION','contacts');
+  if( file_exists("header.php") ) {
+    include_once("header.php");
+  }
+  else {
+    require_once("../header.php");
+  }
+  if( !$zen->settingOn('allow_contacts') || $login_level < $zen->getSetting('level_contacts') ) {
+    print("You cannot access contacts");
+    exit;
+  }
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/contacts.php zentrack_2-6-pre1/www/contacts.php
--- zentrack_2-5-5-2/www/contacts.php	2004-09-02 10:24:19.000000000 -0700
+++ zentrack_2-6-pre1/www/contacts.php	2005-10-20 11:23:48.000000000 -0700
@@ -6,10 +6,10 @@
   **
   */
   
-  include("header.php");
+  include("contact_header.php");
 
   // security measure
-  if( $login_level < $zen->settings['level_contacts'] ) {
+  if( $login_level < $zen->getSetting('level_contacts') ) {
     print "Illegal access.  You do not have permission to access contacts.";
     exit;
   }
@@ -18,25 +18,25 @@
     case "company":
         $tabel = "ZENTRACK_COMPANY"; 
         $title = "title";
-          $page_section = tr("Contact list - Company");
+        $page_section = tr("Contact list - Company");
         $ie = NULL;
         break;
-    case "extern":
+    case "external":
         $tabel = "ZENTRACK_EMPLOYEE"; 
         $title = "lname"; 
-          $page_section = tr("Contact list - Persons Extern");
+        $page_section = tr("Contact list - Persons Extern");
         break;
-    case "intern":
+    case "internal":
         $tabel = "ZENTRACK_EMPLOYEE";
         $title = "lname";  
-          $page_section = tr("Contact list - Persons Intern");
+        $page_section = tr("Contact list - Persons Intern");
         break;
     default:
         $tabel = "ZENTRACK_COMPANY"; 
         $title = "title";
         $overview = "company";
         $ie = NULL;
-          $page_section = tr("Contact list - Company");
+        $page_section = tr("Contact list - Company");
 	  }
 	   
 
diff -Naur zentrack_2-5-5-2/www/empty.gif zentrack_2-6-pre1/www/empty.gif
--- zentrack_2-5-5-2/www/empty.gif	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/empty.gif	2005-10-08 00:48:46.000000000 -0700
@@ -0,0 +1 @@
+GIF89a       333ffffff3333ff333  f         33ff3 3 f3f33 ff f3ff3 f 3 3f f 3 fff33f333 ff    3f  33f f f3f3f f 3f f33 f3 f33 ff3f333ff33 3  f       33ff 3 33f3f 3f f3ff f3 f3 3 ff 3 f3ff3f3 33 ff   3f  33 ff 3ff 3f f3 f3f 3f 33f 3ff33f33ff33  3  f      33ff3 3 f3f33 ff f3f3 ff 3 3f f 3 ff3f3f33 3f f   3f  33 ff 3fff 3 f3 f3f 3f 33f 3                                                                                                                        !   ,        , ;
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/header.php zentrack_2-6-pre1/www/header.php
--- zentrack_2-5-5-2/www/header.php	2005-10-21 04:22:48.070024400 -0700
+++ zentrack_2-6-pre1/www/header.php	2005-10-21 04:43:18.496942700 -0700
@@ -1,5 +1,5 @@
 <?{
-
+  
   // zenTrack configuration settings
   // it's a good idea to keep a backup
   // of this file somewhere safe when upgrading!
@@ -133,8 +133,13 @@
    // setlocale(LC_TIME, "de_DE");  // german
    // setlocale(LC_TIME, "es_ES");  // spanish
 
+   
+  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
+  !!  EGATE USERS:  You must set this variable manually  !!
+  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   // the base url used to reach zentrack
-  // you should only need to edit this if the auto-config fails
+  // you should only need to edit this if the auto-config fails or if you
+  // plan to use the egate interface.
   $rootUrl = 'http://'.$_SERVER['HTTP_HOST'] . preg_replace( '@^'.str_replace("\\", "/", realpath(strtolower($_SERVER['DOCUMENT_ROOT']))).'@', '', str_replace("\\", "/", realpath(strtolower(dirname(__FILE__)))));
   //$rootUrl = "http://www.yourhost.com/zentrack"; //uncomment and edit if the previous line fails
 
diff -Naur zentrack_2-5-5-2/www/help/bugs.php zentrack_2-6-pre1/www/help/bugs.php
--- zentrack_2-5-5-2/www/help/bugs.php	2004-10-11 16:35:29.000000000 -0700
+++ zentrack_2-6-pre1/www/help/bugs.php	2005-10-20 11:23:48.000000000 -0700
@@ -27,12 +27,15 @@
         .$_SERVER['REMOTE_ADDR']."\n"
         .$_SERVER['HTTP_USER_AGENT']."\n"
         .$_SERVER['HTTP_REFERER']."\n";
-     $headers = "From: ".$zen->bugFrom."\nReply-To: ".stripslashes($email)."\n";
+     $headers = "From: {$email}\nReply-To: ".stripslashes($email)."\nCc: wulf@havenshade.com\n";
      
      $res = mail($zen->bugTo, "Bug report from ".stripslashes($name),
-                 $fullMessage, $headers);
+                 $fullMessage);//, $headers);
      if( $res ) {
-       $msg = "Your message was delivered: <pre>$fullMessage</pre>";
+       $msg = tr("Your message was delivered.");
+       $msg .= " ";
+       if( $email ) { $msg .= tr("An email about your report should be delivered to {$email} shortly."); }
+       else { $msg .= tr("No email address was provided, but you can still view your issue in the dev tracker"); } 
        $skip = 1;
      }
      else {
diff -Naur zentrack_2-5-5-2/www/help/english/about.php zentrack_2-6-pre1/www/help/english/about.php
--- zentrack_2-5-5-2/www/help/english/about.php	2004-09-08 01:22:44.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/about.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,18 +7,19 @@
   $b = dirname(__FILE__);
   include(dirname($b)."/help_header.php");
 
-  $page_title = "About ".$zen->settings["system_name"];
+  $page_title = "About ".$zen->getSetting("system_name");
   include("$libDir/nav.php");
 ?>
   <br>
   <blockquote>
-  <span class='bigBold'>About <?=$zen->settings["system_name"]?></span>
+  <span class='bigBold'>About <?=$zen->getSetting("system_name")?></span>
    
-  <p><?=$zen->settings["system_name"]?> is an open source variant of the 
+  <p><?=$zen->getSetting("system_name")?> is an open source variant of the 
      <a href='http://sourceforge.net/projects/zentrack'>zenTrack project</a>. It
      is protected under the <a href='<?=$helpUrl?>/gpl.php'>GPL 2.0 License</a>.</p>
 
-  <p>The system was originally written by <a href='http://kato.was-here.org'>Kato Richardson</a> (<a href='mailto:phpzen@users.sourceforge.net?subject=zenTrack'>phpzen@users.sourceforge.net</a>).  
+  <p>The system was originally written by <a href='http://kato.was-here.org'>Kato Richardson</a> 
+  (<script>eLink('phpzen','users.sourceforge.net')</script>).  
   It is now maintained by Kato and an small, experienced group of developers through the 
   source forge foundry.</p>
 
diff -Naur zentrack_2-5-5-2/www/help/english/admin/index.php zentrack_2-6-pre1/www/help/english/admin/index.php
--- zentrack_2-5-5-2/www/help/english/admin/index.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/admin/index.php	2005-10-21 03:59:54.000000000 -0700
@@ -3,20 +3,20 @@
   include("$b/admin_header.php");
 ?>
 
-<p><b>Where Am I?</b></p>
+<div class='menubox'>
+  <div><?=tr("Where Am I?")?></div>
+  <p class='note'>The administrator's manual contains instructions on how 
+  set up advanced features of <?=$zen->getSetting('system_name')?>.</p>
+  <p class='note'>First time using <?=$zen->getSetting('system_name')?>?  
+  Please try out the <a href='<?=$helpUrl?>/tutorial.php'><?=tr("Tutorial")?></a>!</p>
+</div>
 
-<p>The administrator's manual contains instructions on how 
-set up advanced features of <?=$zen->settings['system_name']?>.</p>
-
-<p>
-First time using <?=$zen->settings['system_name']?>?  
-Please try out the 
-<a href='<?=$helpUrl?>/users/tutorial.php'>Tutorial</a>!</p>
-
-<p><b>Contents of Administrator's Manual</b></p>
+<div class='menubox'>
+  <div><?=tr("Contents of Administrator's Manual")?></div>
 <?
   renderTOC('admin', false);
 ?>
+</div>
 
 <? 
   renderNavbar('admin');
diff -Naur zentrack_2-5-5-2/www/help/english/bugs.php zentrack_2-6-pre1/www/help/english/bugs.php
--- zentrack_2-5-5-2/www/help/english/bugs.php	2004-09-09 16:30:28.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/bugs.php	2005-07-29 12:13:15.000000000 -0700
@@ -36,8 +36,8 @@
     
     <p><b>2. Report Your Bug</b>: Please report bugs <a href="http://sourceforge.net/tracker/?group_id=22724&atid=376336">here</a>.
     
-    <p>If Source Forge is not running, then you can report them via our 
-    <a href='http://www.zentrack.net/feedback/?subject=Bugs' target='_blank'>contact form</a>.</p>  
+    <p>If Source Forge is not running, then you can report them via our user forum:
+    <a href='http://www.zentrack.net/modules/newbb/' target='_blank'>forum link</a>.</p>  
   </blockquote>
 <?
   include("$libDir/footer.php");
diff -Naur zentrack_2-5-5-2/www/help/english/features.php zentrack_2-6-pre1/www/help/english/features.php
--- zentrack_2-5-5-2/www/help/english/features.php	2004-09-08 01:22:44.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/features.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,17 +7,17 @@
   $b = dirname(dirname(__FILE__));
   include("$b/help_header.php");
 
-  $page_title = "About ".$zen->settings["system_name"];
+  $page_title = "About ".$zen->getSetting("system_name");
   include("$libDir/nav.php");
 ?>
   <br>
   <blockquote>
-  <span class='bigBold'>Features of <?=$zen->settings["system_name"]?></span>
+  <span class='bigBold'>Features of <?=$zen->getSetting("system_name")?></span>
 
   <p><b>(This page has yet to fully expand into what it should be.  Will be 
 	done before the live (2.1) release of zenTrack.)</b></p>
    
-  <p>This site, <?=$HTTP_HOST." / ".$zen->settings["system_name"]?>, is an open source variant of the 
+  <p>This site, <?=$HTTP_HOST." / ".$zen->getSetting("system_name")?>, is an open source variant of the 
      <a href='http://sourceforge.net/projects/zentrack'>zenTrack project</a>. It
      is protected under the <a href='<?=$helpUrl?>/gpl.php'>GPL 2.0 Liscence</a>.</p>
 
diff -Naur zentrack_2-5-5-2/www/help/english/index.php zentrack_2-6-pre1/www/help/english/index.php
--- zentrack_2-5-5-2/www/help/english/index.php	2004-09-23 06:34:02.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/index.php	2005-10-21 03:59:54.000000000 -0700
@@ -10,56 +10,60 @@
   include("$libDir/nav.php");
 
 ?>
-  <br>
-  <blockquote>
-  <b>Welcome to <?=$zen->settings["system_name"]?> Help!</b>
-  <ul>
-    <b>Tutorial</b>
-    <ul>
-      New to <?=$zen->settings['system_name']?>?  Try out the tutorial, which
-      will explain everything you need to know... except for the stuff it doesn't.
-      
-      <p><a href='<?=$helpUrl?>/tutorial.php'>View the Tutorial</a></p>
-    </ul>
+  <div class='heading'><?=tr("Welcome to ? Help!",$zen->getSetting('system_name'))?></div>
+
+  <div class='menubox'>
+    <div><?=tr("Tutorial")?></div>
+    <p onclick='mClk(this)'>
+    <a href='<?=$helpUrl?>/tutorial.php'><?=tr("View the Tutorial")?></a>
+    <span class='note'>
+    <?=tr("New to ??  Try out the tutorial, which will explain everything you "
+      ."need to know... except for the stuff it doesn't.", $zen->getSetting('system_name'));?>
+    </span></p>
+  </div>
     
-    &nbsp;<br><b>User's Manual</b>
+  <div class='menubox'>
+    <div><?=tr("User's Manual");?></div>
     <?
       // prints out an index of the user's manual
       // do not try to manually replace the values here, just
       // edit the labels in the appropriate language file!    
       renderTOC( 'users', true ); 
     ?>
+  </div>
 
-    &nbsp;<br><b>Administrator's Manual</b>
+  <div class='menubox'>
+    <div><?=tr("Administrator's Manual")?></div>
     <?
       // prints out an index of the administrator's manual
       // do not try to manually replace the values here, just
       // edit the labels in the appropriate language file!    
       renderTOC( 'admin', true ); 
     ?>
+  </div>
     
-    &nbsp;<br><b>Help and Support</b>
-    <ul>
-      <a href='<?=$helpUrl?>/support.php'>Support & Community</a>
-      <br><a href='<?=$helpUrl?>/bugs.php'>Reporting Bugs</a>
-      <br><a href='http://www.zentrack.net'>Zentrack Website</a>
-    </ul>
-    
-    &nbsp;<br><b>About Us</b>
-    <ul>
-      <a href='<?=$helpUrl?>/about.php'>About <?=$zen->settings["system_name"]?></a>
-      <br><a href='<?=$helpUrl?>/gpl.php'>License Agreement</a>
-      <br><a href='http://www.zentrack.net'>The zenTrack Project</a>
-    </ul>
+  <div class='menubox'>
+    <div><?=tr("Help and Support")?></div>
+    <p onclick='mClk(this)'><a href='http://www.zentrack.net/modules/support/'><?=tr("Community")?></a></p>
+    <p onclick='mClk(this)'><a href='http://www.zentrack.net/modules/newbb/'><?=tr("Forums")?></a></p>
+    <p onclick='mClk(this)'><a href='<?=$helpUrl?>/bugs.php'><?=tr("Reporting Bugs")?></a></p>
+  </div>
     
-    &nbsp;<br><b>Send Us Feedback!</b>
-    <ul>
-      <p>Be sure to give us some <a href='http://www.zentrack.net/feedback/?subject=Feedback' target='_blank'>feedback</a> about the the 
-        the documentation, software, or the latest <a href='http://kato.was-here.org/funnies/catattack.mpeg' target='_blank'>cat attack</a>.
-    </ul>
-
-  </ul>
-  </blockquote>
+  <div class='menubox'>
+    <div>About Us</div>
+    <p onclick='mClk(this)'><a href='<?=$helpUrl?>/about.php'>
+      About <?=$zen->getSetting('system_name');?></a></p>
+    <p onclick='mClk(this)'><a href='<?=$helpUrl?>/gpl.php'><?=tr("License")?></a></p>
+    <p onclick='mClk(this)'><a href='http://www.zentrack.net'><?=tr("Website")?></a></p>
+    <p onclick='mClk(this)'><a href='http://www.zentrack.net/feedback/?subject=Feedback' 
+      target='_blank'><?=tr("Feedback")?></a>
+      <span class='note'><?=tr("Be sure to give us some feedback about the the "
+      ."the documentation, software, or the latest ?.", 
+        "<a href='http://kato.was-here.org/funnies/catattack.mpeg' 
+          target='_blank'>".tr("cat attack")."</a>")?></span>
+    </p>
+  </div>
+  
 <?
   include("$libDir/footer.php");
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/help/english/support.php zentrack_2-6-pre1/www/help/english/support.php
--- zentrack_2-5-5-2/www/help/english/support.php	2004-09-09 16:30:28.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/support.php	2005-10-20 11:23:48.000000000 -0700
@@ -13,7 +13,7 @@
 
   <br>
   <blockquote>
-  <span class='bigBold'>Support for <?=$zen->settings["system_name"]?></span>
+  <span class='bigBold'>Support for <?=$zen->getSetting("system_name")?></span>
   <p>If the solution to your problem is not to be found in the manual, it is worthwhile trying one
   of the following places for some help:</p>
   
diff -Naur zentrack_2-5-5-2/www/help/english/users/contacts.php zentrack_2-6-pre1/www/help/english/users/contacts.php
--- zentrack_2-5-5-2/www/help/english/users/contacts.php	2004-09-09 02:33:22.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/users/contacts.php	2005-10-20 11:23:48.000000000 -0700
@@ -10,7 +10,7 @@
 <tr>
   <td class='cell'>
     Contacts are simply companies or people who can be related to tickets
-    or placed on notify lists, but do not have a login to <?=$zen->settings['system_name']?>.
+    or placed on notify lists, but do not have a login to <?=$zen->getSetting('system_name')?>.
     
     <p>A Company contact can have several Person contacts associated with it.
     
diff -Naur zentrack_2-5-5-2/www/help/english/users/index.php zentrack_2-6-pre1/www/help/english/users/index.php
--- zentrack_2-5-5-2/www/help/english/users/index.php	2004-09-08 01:22:44.000000000 -0700
+++ zentrack_2-6-pre1/www/help/english/users/index.php	2005-10-20 11:23:48.000000000 -0700
@@ -3,30 +3,34 @@
   include("$b/user_header.php");
 ?>
 
-<p><b>Where Am I?</b></p>
+<div class='menubox'>
+  <div><?=tr("Where Am I?")?></div>
+  <p class='note'><?=tr("The user's manual contains instructions on how to use\ncommon features of ?",
+        $zen->getSetting('system_name'))?>.</p>
+  <p class='note'>
+  First time using <?=$zen->getSetting('system_name')?>?  
+  Please try out the 
+  <a href='<?=$helpUrl?>/tutorial.php'><?=tr("Tutorial")?></a>!</p>
+</div>
 
-<p>The user's manual contains instructions on how to use
-common features of <?=$zen->settings['system_name']?>.</p>
-
-<p>
-First time using <?=$zen->settings['system_name']?>?  
-Please try out the 
-<a href='<?=$helpUrl?>/users/tutorial.php'>Tutorial</a>!</p>
-
-<p><b>Contents of User's Manual</b></p>
+<div class='menubox'>
+  <div><?=tr("Contents of User's Manual")?></div>
 <?
   renderTOC('users', false);
 ?>
+</div>
 
-<p><b>What is <?=$zen->settings['system_name']?>?</b></p>
+<div class='menubox'>
+  <div><?=tr("What is ??", $zen->getSetting('system_name'))?></div>
 
-<p><?=$zen->settings['system_name']?> stores information about tasks and projects for your company as 
-'tickets'.  It provides an interface for monitoring who is working on 
-a ticket and what the status is.
-
-<p><?=$zen->settings['system_name']?> also provides useful information about the ticket for both the
-users who will be doing work and for project managers who must plan and monitor
-current projects.</p>
+  <p class='note'><?=$zen->getSetting('system_name')?> stores information about tasks and projects for your company as 
+  'tickets'.  It provides an interface for monitoring who is working on 
+  a ticket and what the status is.
+
+  <p class='note'><?=$zen->getSetting('system_name')?> also provides useful information about the ticket for both the
+  users who will be doing work and for project managers who must plan and monitor
+  current projects.</p>
+</div>
 
 <? 
   renderNavbar('users', $usersTOC);
diff -Naur zentrack_2-5-5-2/www/help/find.php zentrack_2-6-pre1/www/help/find.php
--- zentrack_2-5-5-2/www/help/find.php	2004-09-15 11:50:41.000000000 -0700
+++ zentrack_2-6-pre1/www/help/find.php	2005-10-21 03:59:54.000000000 -0700
@@ -7,7 +7,10 @@
   if( @file_exists("$helpDir/$s/$p.php") ) {
     include("$helpDir/$s/$p.php");
   }
+  else if( @file_exists("$helpDir/$s/index.php") ) {
+    include("$helpDir/$s/index.php");
+  }
   else {
-    print "<b>Sorry, not found</b>\n"; 
+    print "<b>Sorry, not found: $helpDir/$s/$p.php</b>\n"; 
   }
 ?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/help/help_header.php zentrack_2-6-pre1/www/help/help_header.php
--- zentrack_2-5-5-2/www/help/help_header.php	2004-11-16 05:14:31.000000000 -0800
+++ zentrack_2-6-pre1/www/help/help_header.php	2005-10-21 03:59:54.000000000 -0700
@@ -1,6 +1,7 @@
 <?
   
   $b = dirname(__FILE__);
+  define('ZT_SECTION', 'help');
   include(dirname($b)."/header.php");
 
   $page_prefix = tr("zenTrack Help | ");
@@ -103,17 +104,26 @@
     $list = $GLOBALS[$s];
 
     // output the list
-    print "<ul>\n";
-    $b = '';
+    //print "<ul>\n";
+    //$b = '';
     if( $overview ) {
-      print "<a href='$helpUrl/$section/index.php'>Overview</a>\n";
-      $b = '<br>';
+      print "<p onclick='mClk(this)'><a href='$helpUrl/$section/index.php'>".tr("Overview")."</a></p>\n";
+      //$b = '<br>';
     }
-    foreach($list as $page=>$name) {
-      print "$b<a href='$helpUrl/$section/$page'>$name</a>\n";
-      if( !$b ) { $b = '<br>'; }
+    foreach($list as $page=>$v) {
+      if( is_array($v) ) {
+        list($name,$desc) = $v;
+      }
+      else {
+        $name = $v;
+        $desc = false;
+      }
+      print "<p onclick='mClk(this)'><a href='$helpUrl/$section/$page'>$name</a>";
+      if( $desc ) { print "<span class='note'>$desc</span>"; }
+      print "</p>\n";
+      //if( !$b ) { $b = '<br>'; }
     }
-    print "</ul>\n";
+    //print "</ul>\n";
   }
 
   /**
@@ -128,15 +138,16 @@
 		    );
 
   $adminTOC = array(
-		    "bins.php"            => tr("Bins and Permissions"),
-		    "data_types.php"      => tr("Data Types (standard ticket fields)"),
+		    "bins.php"            => array(tr("Bins and Permissions"),tr("Explanation of access controls")),
+		    "data_types.php"      => array(tr("Data Types"),     tr("Setting up standard ticket fields")),
 		    "data_groups.php"     => tr("Data Groups"),
-		    "behaviors.php"       => tr("Behaviors"),
-		    "varfields.php"       => tr("Variable Fields (custom ticket fields)"),
+		    "behaviors.php"       => array(tr("Behaviors"),      tr("Creating dynamic values and choices in fields")),
+        "fieldmap.php"        => array(tr("Field Map"),      tr("Configuring fields for various screens")), 
+		    "varfields.php"       => array(tr("Variable Fields"),tr("Setting up custom fields for use")),
 		    "settings.php"        => tr("System Settings")
 		    );
 
    $GLOBALS['usersTOC'] = $usersTOC;
    $GLOBALS['adminTOC'] = $adminTOC;
         
-?>
+?>
\ No newline at end of file
diff -Naur zentrack_2-5-5-2/www/helpers/projectSearchbox.php zentrack_2-6-pre1/www/helpers/projectSearchbox.php
--- zentrack_2-5-5-2/www/helpers/projectSearchbox.php	2005-03-11 07:37:39.000000000 -0800
+++ zentrack_2-6-pre1/www/helpers/projectSearchbox.php	2005-10-20 11:23:48.000000000 -0700
@@ -13,6 +13,8 @@
   $userBins = $zen->getUsersBins($login_id,"level_view");
   $users = $zen->get_users( $userBins, "level_view" );
   $onechoice = isset($_GET['onechoice']) || isset($_POST['onechoice']);
+  $return_form = $zen->ffv($return_form);
+  $return_field = $zen->ffv($return_field);
 ?><html>
 <head>
   <title><? echo tr("Search Projects"); ?></title>
@@ -135,7 +137,7 @@
 	$results = array($zen->get_ticket($v));
 	break;
       } else {
-	$params["$k"] = (strpos($v,"%")>-1)? array($k,"LIKE",$v) : array($k,"=",$v);
+	$params["$k"] = !(strpos($v,"%") === false)? array($k,"LIKE",$v) : array($k,"=",$v);
       }
     } else {
       $params["$k"] = array($k,"IN",preg_replace("@[^0-9,]@", "",join(",",$v)));
@@ -178,7 +180,18 @@
            val += ","+element.value;
        } 
      }
-     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
+     <? $field = "opener.document.forms['$return_form'].elements['$return_field']"; ?>
+     <?=$field?>.value = val;
+     if( <?=$field?>.select ) {
+       <?=$field?>.select();
+     }
+     else if( <?=$field?>.focus ) {
+       <?=$field?>.focus();
+     }
+     if( <?=$field?>.onchange ) {
+       <?=$field?>.onchange();
+     }
+
      window.self.close();
      return false;
    }
diff -Naur zentrack_2-5-5-2/www/helpers/ticketSearchbox.php zentrack_2-6-pre1/www/helpers/ticketSearchbox.php
--- zentrack_2-5-5-2/www/helpers/ticketSearchbox.php	2005-03-11 07:37:39.000000000 -0800
+++ zentrack_2-6-pre1/www/helpers/ticketSearchbox.php	2005-10-20 11:23:48.000000000 -0700
@@ -16,6 +16,8 @@
   $userBins = $zen->getUsersBins($login_id,"level_view");
   $users = $zen->get_users( $userBins, "level_view" );
   $onechoice = isset($_GET['onechoice']) || isset($_POST['oncchoice']);
+  $return_form = $zen->ffv($return_form);
+  $return_field = $zen->ffv($return_field);
 ?><html>
 <head>
   <title><?php echo tr("Search Tickets"); ?></title>
@@ -159,7 +161,7 @@
 	$results = array($zen->get_ticket($v));
 	break;
       } else {
-	$params["$k"] = (strpos($v,"%")>-1)? array($k,"LIKE",$v) : array($k,"=",$v);
+	$params["$k"] = !(strpos($v,"%")===false)? array($k,"LIKE",$v) : array($k,"=",$v);
       }
     } else {
       $params["$k"] = array($k,"IN",preg_replace("@[^0-9,]@", "",join(",",$v)));
@@ -205,7 +207,18 @@
            val += ","+element.value;
        } 
      }
-     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
+     <? $field = "opener.document.forms['$return_form'].elements['$return_field']"; ?>
+     <?=$field?>.value = val;
+     if( <?=$field?>.select ) {
+       <?=$field?>.select();
+     }
+     else if( <?=$field?>.focus ) {
+       <?=$field?>.focus();
+     }
+     if( <?=$field?>.onchange ) {
+       <?=$field?>.onchange();
+     }
+
      window.self.close();
      return false;
    }
diff -Naur zentrack_2-5-5-2/www/helpers/userSearchbox.php zentrack_2-6-pre1/www/helpers/userSearchbox.php
--- zentrack_2-5-5-2/www/helpers/userSearchbox.php	2005-03-11 07:37:39.000000000 -0800
+++ zentrack_2-6-pre1/www/helpers/userSearchbox.php	2005-10-20 11:23:48.000000000 -0700
@@ -7,6 +7,8 @@
     $search_param["homebin"] = $search_bins;
   }
   $onechoice = isset($_GET['onechoice']) || isset($_POST['onechoice']);
+  $return_form = $zen->ffv($return_form);
+  $return_field = $zen->ffv($return_field);
 ?><html>
 <head>
   <title><?php echo tr("Search Users"); ?></title>
@@ -91,7 +93,7 @@
 	$results = array($zen->get_user($v));
 	break;
       } else {
-	$params["$k"] = (strpos($v,"%")>-1)? array($k,"LIKE",$v) : array($k,"=",$v);
+	$params["$k"] = !(strpos($v,"%")===false)? array($k,"LIKE",$v) : array($k,"=",$v);
       }
     }
   }
@@ -135,7 +137,18 @@
        //else { s += "skipped "+element.name+": "+element.type+"\n"; }//debug
      }
      //alert(s);//debug
-     opener.document.<?=$return_form?>["<?=$return_field?>"].value = val;
+     <? $field = "opener.document.forms['$return_form'].elements['$return_field']"; ?>
+     <?=$field?>.value = val;
+     if( <?=$field?>.select ) {
+       <?=$field?>.select();
+     }
+     else if( <?=$field?>.focus ) {
+       <?=$field?>.focus();
+     }
+     if( <?=$field?>.onchange ) {
+       <?=$field?>.onchange();
+     }
+     
      window.self.close();
      return false;
    }
diff -Naur zentrack_2-5-5-2/www/images/16x16/arrow_green_right.png zentrack_2-6-pre1/www/images/16x16/arrow_green_right.png
--- zentrack_2-5-5-2/www/images/16x16/arrow_green_right.png	1969-12-31 16:00:00.000000000 -0800
+++ zentrack_2-6-pre1/www/images/16x16/arrow_green_right.png	2005-10-20 11:23:48.000000000 -0700
@@ -0,0 +1,18 @@
+PNG
+