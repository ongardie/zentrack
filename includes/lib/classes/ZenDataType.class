<? /* -*- Mode: C; c-basic-indent: 3; indent-tabs-mode: nil -*- ex: set tabstop=3 expandtab: */ 

/** 
 * @package zen 
 * 
 * The purpose of the ZenDataType object is to extract all common functionality between various
 * object types such as ZenTicket, ZenUser, ZenAction, ZenTrigger, etc.
 *
 * All Objects which directly correspond to a single data row in the db should extend this object.
 */

class ZenDataType extends Zen {

  /**
   * CONSTRUCTOR - initialize Zen class and load data if appropriate
   *
   * @param Object $child is a $this reference from the calling object
   * @param integer $id the id to load
   */
  function ZenDataType( $child, $id ) { 
    $this->Zen();
    $this->_childobj = $child;
    if( $id ) {
      $this->_id = $id;
      $this->_load();
    }
    // set the primary key field for this table
    $this->_primarykey = getPrimaryKey( $this->_childobj );
    
  }  

  /*****************************
   * COMMON METHODS
   ****************************/
  
  /**
   * tells whether a valid database entry is loaded in this object
   *
   * note that new objects return false(invalid) until save() has been called
   *
   * @return boolean contain a system ID
   */
  function loaded() { return ($this->_id > 0 && count($this->_fields)) }
  
  /**
   * Fetches a field in this object
   *
   * @param string $field the field name to fetch
   * @return mixed value of the field or false if the field is not valid
   */
  function getField( $field ) { }

  /**
   * Sets the value of a field
   *
   * This sets the $this->_changed flag to true
   * 
   * @param string $field the field to set
   * @param mixed $value the value to set
   * @return boolean validated and set
   */
  function setField( $field, $value ) { }

  /**
   * Returns the meta data for all fields associated with this Object type
   * in the form of a ZenMetaTable object
   */
  function getMetaData() { }

  /**
   * Saves changes to database
   *
   * This should check all associated fields for obvious
   * validation issues and return false and set a message
   * if there is an integrity issue
   *
   * Most likely this will be overridden by several methods
   * This sets the $this->_changed flag to false upon completion
   *
   * @return boolean succeeded
   */
  function save() { }

  /**
   * Fetches all triggers associated with this action
   *
   * @return ZenTriggerList containing all triggers associated with this action
   */
  function getTriggers() { }

  /**
   * Loads the Object from its corresponding db entry
   *
   * Only works if $this->_id has been set
   * Checks $this->loaded() and causes an error message if already loaded
   *
   * @private
   * @return boolean load succeeded, id was valid (actually returns $this->loaded())
   */
  function _load() { }

  /**
   * Creates a ticket object from a data set provided by a ZenList class type
   *
   * The data set will be validated to insure all rows are present and correct
   * It will not be checked to insure it matches the db entry.
   *
   * The ONLY ACCEPTABLE USE of this class is by constructing the object from
   * the data row provided by ZenList types.
   *
   * @param array $data is the COMPLETE data set for this database row
   * @return boolean succeeded and validated
   */
  function loadFromListData( $data ) { }

  /****************
   * VARIABLES
   ***************/

  /** @var integer $_id the id associated with this object (used by isEmtpy() */
  var $_id = 0;

  /** @var mixed $_fields are the fields of the current object */
  var $_fields = array();  

  /** @var string $_childobj is a $this reference to the calling class */
  var $_childobj;

  /** @var ZenTriggerList $_triggers all triggers associated with this object */
  var $_triggers;

  /** @var boolean $_changed tells whether properties have been changed since last save */
  var $_changed;

  /** @var string $_primarykey the column used for a primary key by this data type */
  var $_primarykey;

}

?>
